<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>shishi</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.73.2">
<link rel="start" href="index.html" title="Shishi API Reference Manual">
<link rel="up" href="ch01.html" title="Shishi API Reference Manual">
<link rel="prev" href="ch01.html" title="Shishi API Reference Manual">
<meta name="generator" content="GTK-Doc V1.10 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
<link rel="chapter" href="ch01.html" title="Shishi API Reference Manual">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="ch01.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="ch01.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">Shishi API Reference Manual</th>
<td> </td>
</tr>
<tr><td colspan="5" class="shortcuts"><nobr><a href="#shishi-shishi.synopsis" class="shortcut">Top</a>
                   | 
                  <a href="#shishi-shishi.description" class="shortcut">Description</a></nobr></td></tr>
</table>
<div class="refentry" lang="en">
<a name="shishi-shishi"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="shishi-shishi.top_of_page"></a>shishi</span></h2>
<p>shishi</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<a name="shishi-shishi.synopsis"></a><h2>Synopsis</h2>
<pre class="synopsis">
#define             <a class="link" href="shishi-shishi.html#SHISHI-VERSION:CAPS" title="SHISHI_VERSION">SHISHI_VERSION</a>
enum                <a class="link" href="shishi-shishi.html#Shishi-rc" title="enum Shishi_rc">Shishi_rc</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-padata-type" title="enum Shishi_padata_type">Shishi_padata_type</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-tr-type" title="enum Shishi_tr_type">Shishi_tr_type</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-apoptions" title="enum Shishi_apoptions">Shishi_apoptions</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-ticketflags" title="enum Shishi_ticketflags">Shishi_ticketflags</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-KDCOptions" title="enum Shishi_KDCOptions">Shishi_KDCOptions</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-msgtype" title="enum Shishi_msgtype">Shishi_msgtype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-lrtype" title="enum Shishi_lrtype">Shishi_lrtype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-etype" title="enum Shishi_etype">Shishi_etype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-cksumtype" title="enum Shishi_cksumtype">Shishi_cksumtype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-filetype" title="enum Shishi_filetype">Shishi_filetype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-outputtype" title="enum Shishi_outputtype">Shishi_outputtype</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-authorization" title="enum Shishi_authorization">Shishi_authorization</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-keyusage" title="enum Shishi_keyusage">Shishi_keyusage</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-krb-error" title="enum Shishi_krb_error">Shishi_krb_error</a>;
enum                <a class="link" href="shishi-shishi.html#Shishi-tkts-hintflags" title="enum Shishi_tkts_hintflags">Shishi_tkts_hintflags</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a>;
#define             <a class="link" href="shishi-shishi.html#SHISHI-DNS-IN:CAPS" title="SHISHI_DNS_IN">SHISHI_DNS_IN</a>
#define             <a class="link" href="shishi-shishi.html#SHISHI-DNS-TXT:CAPS" title="SHISHI_DNS_TXT">SHISHI_DNS_TXT</a>
#define             <a class="link" href="shishi-shishi.html#SHISHI-DNS-SRV:CAPS" title="SHISHI_DNS_SRV">SHISHI_DNS_SRV</a>
typedef             <a class="link" href="shishi-shishi.html#Shishi-dns" title="Shishi_dns">Shishi_dns</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-dns-srv" title="Shishi_dns_srv">Shishi_dns_srv</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>;
typedef             <a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a>;
#define             <a class="link" href="shishi-shishi.html#SHISHI-GENERALIZEDTIME-LENGTH:CAPS" title="SHISHI_GENERALIZEDTIME_LENGTH">SHISHI_GENERALIZEDTIME_LENGTH</a>
#define             <a class="link" href="shishi-shishi.html#SHISHI-GENERALIZEDTIMEZ-LENGTH:CAPS" title="SHISHI_GENERALIZEDTIMEZ_LENGTH">SHISHI_GENERALIZEDTIMEZ_LENGTH</a>
void                <a class="link" href="shishi-shishi.html#shishi-alloc-fail-function" title="shishi_alloc_fail_function ()">shishi_alloc_fail_function</a>          (void);
<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a>*             <a class="link" href="shishi-shishi.html#shishi" title="shishi ()">shishi</a>                              (void);
<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a>*             <a class="link" href="shishi-shishi.html#shishi-server" title="shishi_server ()">shishi_server</a>                       (void);
void                <a class="link" href="shishi-shishi.html#shishi-done" title="shishi_done ()">shishi_done</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()">shishi_init</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle);
int                 <a class="link" href="shishi-shishi.html#shishi-init-with-paths" title="shishi_init_with_paths ()">shishi_init_with_paths</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle,
                                                         const char *tktsfile,
                                                         const char *systemcfgfile,
                                                         const char *usercfgfile);
int                 <a class="link" href="shishi-shishi.html#shishi-init-server" title="shishi_init_server ()">shishi_init_server</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle);
int                 <a class="link" href="shishi-shishi.html#shishi-init-server-with-paths" title="shishi_init_server_with_paths ()">shishi_init_server_with_paths</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle,
                                                         const char *systemcfgfile);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg" title="shishi_cfg ()">shishi_cfg</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *option);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg-from-file" title="shishi_cfg_from_file ()">shishi_cfg_from_file</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *cfg);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg-print" title="shishi_cfg_print ()">shishi_cfg_print</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh);
const char*         <a class="link" href="shishi-shishi.html#shishi-cfg-default-systemfile" title="shishi_cfg_default_systemfile ()">shishi_cfg_default_systemfile</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
const char*         <a class="link" href="shishi-shishi.html#shishi-cfg-default-userdirectory" title="shishi_cfg_default_userdirectory ()">shishi_cfg_default_userdirectory</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
const char*         <a class="link" href="shishi-shishi.html#shishi-cfg-default-userfile" title="shishi_cfg_default_userfile ()">shishi_cfg_default_userfile</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
char*               <a class="link" href="shishi-shishi.html#shishi-cfg-userdirectory-file" title="shishi_cfg_userdirectory_file ()">shishi_cfg_userdirectory_file</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *file);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg-clientkdcetype" title="shishi_cfg_clientkdcetype ()">shishi_cfg_clientkdcetype</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t **etypes);
int32_t             <a class="link" href="shishi-shishi.html#shishi-cfg-clientkdcetype-fast" title="shishi_cfg_clientkdcetype_fast ()">shishi_cfg_clientkdcetype_fast</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg-clientkdcetype-set" title="shishi_cfg_clientkdcetype_set ()">shishi_cfg_clientkdcetype_set</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *value);
int                 <a class="link" href="shishi-shishi.html#shishi-cfg-authorizationtype-set" title="shishi_cfg_authorizationtype_set ()">shishi_cfg_authorizationtype_set</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *value);
const char*         <a class="link" href="shishi-shishi.html#shishi-strerror" title="shishi_strerror ()">shishi_strerror</a>                     (int err);
const char*         <a class="link" href="shishi-shishi.html#shishi-error" title="shishi_error ()">shishi_error</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-error-clear" title="shishi_error_clear ()">shishi_error_clear</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-error-set" title="shishi_error_set ()">shishi_error_set</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *errstr);
void                <a class="link" href="shishi-shishi.html#shishi-error-printf" title="shishi_error_printf ()">shishi_error_printf</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);
int                 <a class="link" href="shishi-shishi.html#shishi-error-outputtype" title="shishi_error_outputtype ()">shishi_error_outputtype</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-error-set-outputtype" title="shishi_error_set_outputtype ()">shishi_error_set_outputtype</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int type);
void                <a class="link" href="shishi-shishi.html#shishi-info" title="shishi_info ()">shishi_info</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);
void                <a class="link" href="shishi-shishi.html#shishi-warn" title="shishi_warn ()">shishi_warn</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);
void                <a class="link" href="shishi-shishi.html#shishi-verbose" title="shishi_verbose ()">shishi_verbose</a>                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);
char*               <a class="link" href="shishi-shishi.html#shishi-realm-default-guess" title="shishi_realm_default_guess ()">shishi_realm_default_guess</a>          (void);
const char*         <a class="link" href="shishi-shishi.html#shishi-realm-default" title="shishi_realm_default ()">shishi_realm_default</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-realm-default-set" title="shishi_realm_default_set ()">shishi_realm_default_set</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *realm);
char*               <a class="link" href="shishi-shishi.html#shishi-realm-for-server-file" title="shishi_realm_for_server_file ()">shishi_realm_for_server_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);
char*               <a class="link" href="shishi-shishi.html#shishi-realm-for-server-dns" title="shishi_realm_for_server_dns ()">shishi_realm_for_server_dns</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);
char*               <a class="link" href="shishi-shishi.html#shishi-realm-for-server" title="shishi_realm_for_server ()">shishi_realm_for_server</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);
char*               <a class="link" href="shishi-shishi.html#shishi-principal-default-guess" title="shishi_principal_default_guess ()">shishi_principal_default_guess</a>      (void);
const char*         <a class="link" href="shishi-shishi.html#shishi-principal-default" title="shishi_principal_default ()">shishi_principal_default</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-principal-default-set" title="shishi_principal_default_set ()">shishi_principal_default_set</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal);
int                 <a class="link" href="shishi-shishi.html#shishi-principal-name" title="shishi_principal_name ()">shishi_principal_name</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-principal-name-realm" title="shishi_principal_name_realm ()">shishi_principal_name_realm</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> realmnode,
                                                         const char *realmfield,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-principal-name-set" title="shishi_principal_name_set ()">shishi_principal_name_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *name[]);
int                 <a class="link" href="shishi-shishi.html#shishi-principal-set" title="shishi_principal_set ()">shishi_principal_set</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         const char *name);
int                 <a class="link" href="shishi-shishi.html#shishi-parse-name" title="shishi_parse_name ()">shishi_parse_name</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *name,
                                                         char **principal,
                                                         char **realm);
int                 <a class="link" href="shishi-shishi.html#shishi-derive-default-salt" title="shishi_derive_default_salt ()">shishi_derive_default_salt</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *name,
                                                         char **salt);
char*               <a class="link" href="shishi-shishi.html#shishi-server-for-local-service" title="shishi_server_for_local_service ()">shishi_server_for_local_service</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-ticket" title="shishi_ticket ()">shishi_ticket</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-server" title="shishi_ticket_server ()">shishi_ticket_server</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         char **server,
                                                         size_t *serverlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-sname-set" title="shishi_ticket_sname_set ()">shishi_ticket_sname_set</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         char *sname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-srealmserver-set" title="shishi_ticket_srealmserver_set ()">shishi_ticket_srealmserver_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *realm,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-set-server" title="shishi_ticket_set_server ()">shishi_ticket_set_server</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-realm-get" title="shishi_ticket_realm_get ()">shishi_ticket_realm_get</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-realm-set" title="shishi_ticket_realm_set ()">shishi_ticket_realm_set</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-get-enc-part-etype" title="shishi_ticket_get_enc_part_etype ()">shishi_ticket_get_enc_part_etype</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         int32_t *etype);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-set-enc-part" title="shishi_ticket_set_enc_part ()">shishi_ticket_set_enc_part</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-add-enc-part" title="shishi_ticket_add_enc_part ()">shishi_ticket_add_enc_part</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-decrypt" title="shishi_ticket_decrypt ()">shishi_ticket_decrypt</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encticketpart);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tkt-ticket" title="shishi_tkt_ticket ()">shishi_tkt_ticket</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-ticket-set" title="shishi_tkt_ticket_set ()">shishi_tkt_ticket_set</a>               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tkt-kdcrep" title="shishi_tkt_kdcrep ()">shishi_tkt_kdcrep</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tkt-enckdcreppart" title="shishi_tkt_enckdcreppart ()">shishi_tkt_enckdcreppart</a>            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-enckdcreppart-set" title="shishi_tkt_enckdcreppart_set ()">shishi_tkt_enckdcreppart_set</a>        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tkt-encticketpart" title="shishi_tkt_encticketpart ()">shishi_tkt_encticketpart</a>            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-encticketpart-set" title="shishi_tkt_encticketpart_set ()">shishi_tkt_encticketpart_set</a>        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-tkt-key" title="shishi_tkt_key ()">shishi_tkt_key</a>                      (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-key-set" title="shishi_tkt_key_set ()">shishi_tkt_key_set</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt" title="shishi_tkt ()">shishi_tkt</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> **tkt);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkt2" title="shishi_tkt2 ()">shishi_tkt2</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-pretty-print" title="shishi_tkt_pretty_print ()">shishi_tkt_pretty_print</a>             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-realm" title="shishi_tkt_realm ()">shishi_tkt_realm</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-client" title="shishi_tkt_client ()">shishi_tkt_client</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-client-p" title="shishi_tkt_client_p ()">shishi_tkt_client_p</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-clientrealm" title="shishi_tkt_clientrealm ()">shishi_tkt_clientrealm</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-clientrealm-p" title="shishi_tkt_clientrealm_p ()">shishi_tkt_clientrealm_p</a>            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-clientrealm-set" title="shishi_tkt_clientrealm_set ()">shishi_tkt_clientrealm_set</a>          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *realm,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-serverrealm-set" title="shishi_tkt_serverrealm_set ()">shishi_tkt_serverrealm_set</a>          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *realm,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-build" title="shishi_tkt_build ()">shishi_tkt_build</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-lastreq" title="shishi_tkt_lastreq ()">shishi_tkt_lastreq</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **lrtime,
                                                         size_t *lrtimelen,
                                                         int32_t lrtype);
time_t              <a class="link" href="shishi-shishi.html#shishi-tkt-lastreqc" title="shishi_tkt_lastreqc ()">shishi_tkt_lastreqc</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-lrtype" title="enum Shishi_lrtype">Shishi_lrtype</a> lrtype);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-lastreq-pretty-print" title="shishi_tkt_lastreq_pretty_print ()">shishi_tkt_lastreq_pretty_print</a>     (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-authtime" title="shishi_tkt_authtime ()">shishi_tkt_authtime</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **authtime,
                                                         size_t *authtimelen);
time_t              <a class="link" href="shishi-shishi.html#shishi-tkt-authctime" title="shishi_tkt_authctime ()">shishi_tkt_authctime</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-starttime" title="shishi_tkt_starttime ()">shishi_tkt_starttime</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **starttime,
                                                         size_t *starttimelen);
time_t              <a class="link" href="shishi-shishi.html#shishi-tkt-startctime" title="shishi_tkt_startctime ()">shishi_tkt_startctime</a>               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-endtime" title="shishi_tkt_endtime ()">shishi_tkt_endtime</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **endtime,
                                                         size_t *endtimelen);
time_t              <a class="link" href="shishi-shishi.html#shishi-tkt-endctime" title="shishi_tkt_endctime ()">shishi_tkt_endctime</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-renew-till" title="shishi_tkt_renew_till ()">shishi_tkt_renew_till</a>               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **renewtilltime,
                                                         size_t *renewtilllen);
time_t              <a class="link" href="shishi-shishi.html#shishi-tkt-renew-tillc" title="shishi_tkt_renew_tillc ()">shishi_tkt_renew_tillc</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-keytype" title="shishi_tkt_keytype ()">shishi_tkt_keytype</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int32_t *etype);
int32_t             <a class="link" href="shishi-shishi.html#shishi-tkt-keytype-fast" title="shishi_tkt_keytype_fast ()">shishi_tkt_keytype_fast</a>             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-keytype-p" title="shishi_tkt_keytype_p ()">shishi_tkt_keytype_p</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int32_t etype);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-server" title="shishi_tkt_server ()">shishi_tkt_server</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **server,
                                                         size_t *serverlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-server-p" title="shishi_tkt_server_p ()">shishi_tkt_server_p</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-valid-at-time-p" title="shishi_tkt_valid_at_time_p ()">shishi_tkt_valid_at_time_p</a>          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         time_t now);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-valid-now-p" title="shishi_tkt_valid_now_p ()">shishi_tkt_valid_now_p</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-expired-p" title="shishi_tkt_expired_p ()">shishi_tkt_expired_p</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-decrypt" title="shishi_tkt_decrypt ()">shishi_tkt_decrypt</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-tkt-done" title="shishi_tkt_done ()">shishi_tkt_done</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-flags" title="shishi_tkt_flags ()">shishi_tkt_flags</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t *flags);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-flags-set" title="shishi_tkt_flags_set ()">shishi_tkt_flags_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t flags);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-flags-add" title="shishi_tkt_flags_add ()">shishi_tkt_flags_add</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t flag);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-forwardable-p" title="shishi_tkt_forwardable_p ()">shishi_tkt_forwardable_p</a>            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-forwarded-p" title="shishi_tkt_forwarded_p ()">shishi_tkt_forwarded_p</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-proxiable-p" title="shishi_tkt_proxiable_p ()">shishi_tkt_proxiable_p</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-proxy-p" title="shishi_tkt_proxy_p ()">shishi_tkt_proxy_p</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-may-postdate-p" title="shishi_tkt_may_postdate_p ()">shishi_tkt_may_postdate_p</a>           (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-postdated-p" title="shishi_tkt_postdated_p ()">shishi_tkt_postdated_p</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-invalid-p" title="shishi_tkt_invalid_p ()">shishi_tkt_invalid_p</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-renewable-p" title="shishi_tkt_renewable_p ()">shishi_tkt_renewable_p</a>              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-initial-p" title="shishi_tkt_initial_p ()">shishi_tkt_initial_p</a>                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-pre-authent-p" title="shishi_tkt_pre_authent_p ()">shishi_tkt_pre_authent_p</a>            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-hw-authent-p" title="shishi_tkt_hw_authent_p ()">shishi_tkt_hw_authent_p</a>             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-transited-policy-checked-p" title="shishi_tkt_transited_policy_checked_p ()">shishi_tkt_transited_policy_checked_p</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-ok-as-delegate-p" title="shishi_tkt_ok_as_delegate_p ()">shishi_tkt_ok_as_delegate_p</a>         (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
char*               <a class="link" href="shishi-shishi.html#shishi-tkts-default-file-guess" title="shishi_tkts_default_file_guess ()">shishi_tkts_default_file_guess</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
const char*         <a class="link" href="shishi-shishi.html#shishi-tkts-default-file" title="shishi_tkts_default_file ()">shishi_tkts_default_file</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-tkts-default-file-set" title="shishi_tkts_default_file_set ()">shishi_tkts_default_file_set</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *tktsfile);
<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a>*        <a class="link" href="shishi-shishi.html#shishi-tkts-default" title="shishi_tkts_default ()">shishi_tkts_default</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-default-to-file" title="shishi_tkts_default_to_file ()">shishi_tkts_default_to_file</a>         (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()">shishi_tkts</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **tkts);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-nth" title="shishi_tkts_nth ()">shishi_tkts_nth</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         int ticketno);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-size" title="shishi_tkts_size ()">shishi_tkts_size</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-add" title="shishi_tkts_add ()">shishi_tkts_add</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-new" title="shishi_tkts_new ()">shishi_tkts_new</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-remove" title="shishi_tkts_remove ()">shishi_tkts_remove</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         int ticketno);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-expire" title="shishi_tkts_expire ()">shishi_tkts_expire</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-print-for-service" title="shishi_tkts_print_for_service ()">shishi_tkts_print_for_service</a>       (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh,
                                                         const char *service);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-print" title="shishi_tkts_print ()">shishi_tkts_print</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-write" title="shishi_tkts_write ()">shishi_tkts_write</a>                   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-to-file" title="shishi_tkts_to_file ()">shishi_tkts_to_file</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-read" title="shishi_tkts_read ()">shishi_tkts_read</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-from-file" title="shishi_tkts_from_file ()">shishi_tkts_from_file</a>               (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *filename);
void                <a class="link" href="shishi-shishi.html#shishi-tkts-done" title="shishi_tkts_done ()">shishi_tkts_done</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkt-match-p" title="shishi_tkt_match_p ()">shishi_tkt_match_p</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-find" title="shishi_tkts_find ()">shishi_tkts_find</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-find-for-clientserver" title="shishi_tkts_find_for_clientserver ()">shishi_tkts_find_for_clientserver</a>   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *client,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-find-for-server" title="shishi_tkts_find_for_server ()">shishi_tkts_find_for_server</a>         (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get" title="shishi_tkts_get ()">shishi_tkts_get</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get-tgt" title="shishi_tkts_get_tgt ()">shishi_tkts_get_tgt</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get-tgs" title="shishi_tkts_get_tgs ()">shishi_tkts_get_tgs</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tgt);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get-for-clientserver" title="shishi_tkts_get_for_clientserver ()">shishi_tkts_get_for_clientserver</a>    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *client,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get-for-server" title="shishi_tkts_get_for_server ()">shishi_tkts_get_for_server</a>          (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tkts-get-for-localservicepasswd" title="shishi_tkts_get_for_localservicepasswd ()">shishi_tkts_get_for_localservicepasswd</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *service,
                                                         const char *passwd);
char*               <a class="link" href="shishi-shishi.html#shishi-tkts-default-ccache-guess" title="shishi_tkts_default_ccache_guess ()">shishi_tkts_default_ccache_guess</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
const char*         <a class="link" href="shishi-shishi.html#shishi-tkts-default-ccache" title="shishi_tkts_default_ccache ()">shishi_tkts_default_ccache</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-tkts-default-ccache-set" title="shishi_tkts_default_ccache_set ()">shishi_tkts_default_ccache_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *ccache);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-add-ccache-mem" title="shishi_tkts_add_ccache_mem ()">shishi_tkts_add_ccache_mem</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-add-ccache-file" title="shishi_tkts_add_ccache_file ()">shishi_tkts_add_ccache_file</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-from-ccache-mem" title="shishi_tkts_from_ccache_mem ()">shishi_tkts_from_ccache_mem</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **outtkts);
int                 <a class="link" href="shishi-shishi.html#shishi-tkts-from-ccache-file" title="shishi_tkts_from_ccache_file ()">shishi_tkts_from_ccache_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **outtkts);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-print" title="shishi_enckdcreppart_print ()">shishi_enckdcreppart_print</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-save" title="shishi_enckdcreppart_save ()">shishi_enckdcreppart_save</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-parse" title="shishi_enckdcreppart_parse ()">shishi_enckdcreppart_parse</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-read" title="shishi_enckdcreppart_read ()">shishi_enckdcreppart_read</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-save" title="shishi_ticket_save ()">shishi_ticket_save</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-print" title="shishi_ticket_print ()">shishi_ticket_print</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-print" title="shishi_kdc_print ()">shishi_kdc_print</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encasreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-parse" title="shishi_ticket_parse ()">shishi_ticket_parse</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-ticket-read" title="shishi_ticket_read ()">shishi_ticket_read</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-etype-info-print" title="shishi_etype_info_print ()">shishi_etype_info_print</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> etypeinfo);
int                 <a class="link" href="shishi-shishi.html#shishi-etype-info2-print" title="shishi_etype_info2_print ()">shishi_etype_info2_print</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> etypeinfo2);
int                 <a class="link" href="shishi-shishi.html#shishi-padata-print" title="shishi_padata_print ()">shishi_padata_print</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> padata);
int                 <a class="link" href="shishi-shishi.html#shishi-methoddata-print" title="shishi_methoddata_print ()">shishi_methoddata_print</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> methoddata);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()">shishi_authenticator</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-set-crealm" title="shishi_authenticator_set_crealm ()">shishi_authenticator_set_crealm</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *crealm);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-set-cname" title="shishi_authenticator_set_cname ()">shishi_authenticator_set_cname</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-client-set" title="shishi_authenticator_client_set ()">shishi_authenticator_client_set</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-ctime" title="shishi_authenticator_ctime ()">shishi_authenticator_ctime</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **t);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-ctime-set" title="shishi_authenticator_ctime_set ()">shishi_authenticator_ctime_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *t);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-cusec-get" title="shishi_authenticator_cusec_get ()">shishi_authenticator_cusec_get</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t *cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-cusec-set" title="shishi_authenticator_cusec_set ()">shishi_authenticator_cusec_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-seqnumber-get" title="shishi_authenticator_seqnumber_get ()">shishi_authenticator_seqnumber_get</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t *seqnumber);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-seqnumber-remove" title="shishi_authenticator_seqnumber_remove ()">shishi_authenticator_seqnumber_remove</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-seqnumber-set" title="shishi_authenticator_seqnumber_set ()">shishi_authenticator_seqnumber_set</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t seqnumber);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-client" title="shishi_authenticator_client ()">shishi_authenticator_client</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-clientrealm" title="shishi_authenticator_clientrealm ()">shishi_authenticator_clientrealm</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-remove-cksum" title="shishi_authenticator_remove_cksum ()">shishi_authenticator_remove_cksum</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-cksum" title="shishi_authenticator_cksum ()">shishi_authenticator_cksum</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t *cksumtype,
                                                         char **cksum,
                                                         size_t *cksumlen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-set-cksum" title="shishi_authenticator_set_cksum ()">shishi_authenticator_set_cksum</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int cksumtype,
                                                         char *cksum,
                                                         size_t cksumlen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-cksum" title="shishi_authenticator_add_cksum ()">shishi_authenticator_add_cksum</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         char *data,
                                                         size_t datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-cksum-type" title="shishi_authenticator_add_cksum_type ()">shishi_authenticator_add_cksum_type</a> (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int cksumtype,
                                                         char *data,
                                                         size_t datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-remove-subkey" title="shishi_authenticator_remove_subkey ()">shishi_authenticator_remove_subkey</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-authenticator-subkey" title="shishi_authenticator_subkey ()">shishi_authenticator_subkey</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-get-subkey" title="shishi_authenticator_get_subkey ()">shishi_authenticator_get_subkey</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **subkey);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-set-subkey" title="shishi_authenticator_set_subkey ()">shishi_authenticator_set_subkey</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t subkeytype,
                                                         const char *subkey,
                                                         size_t subkeylen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-random-subkey" title="shishi_authenticator_add_random_subkey ()">shishi_authenticator_add_random_subkey</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-random-subkey-etype" title="shishi_authenticator_add_random_subkey_etype ()">shishi_authenticator_add_random_subkey_etype</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int etype);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-subkey" title="shishi_authenticator_add_subkey ()">shishi_authenticator_add_subkey</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *subkey);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-clear-authorizationdata" title="shishi_authenticator_clear_authorizationdata ()">shishi_authenticator_clear_authorizationdata</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-add-authorizationdata" title="shishi_authenticator_add_authorizationdata ()">shishi_authenticator_add_authorizationdata</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t adtype,
                                                         const char *addata,
                                                         size_t addatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-authorizationdata" title="shishi_authenticator_authorizationdata ()">shishi_authenticator_authorizationdata</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t *adtype,
                                                         char **addata,
                                                         size_t *addatalen,
                                                         size_t nth);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-read" title="shishi_authenticator_read ()">shishi_authenticator_read</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-parse" title="shishi_authenticator_parse ()">shishi_authenticator_parse</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-from-file" title="shishi_authenticator_from_file ()">shishi_authenticator_from_file</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-print" title="shishi_authenticator_print ()">shishi_authenticator_print</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-to-file" title="shishi_authenticator_to_file ()">shishi_authenticator_to_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-authenticator-save" title="shishi_authenticator_save ()">shishi_authenticator_save</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-as" title="shishi_as ()">shishi_as</a>                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> **as);
void                <a class="link" href="shishi-shishi.html#shishi-as-done" title="shishi_as_done ()">shishi_as_done</a>                      (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-as-req" title="shishi_as_req ()">shishi_as_req</a>                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
int                 <a class="link" href="shishi-shishi.html#shishi-as-req-build" title="shishi_as_req_build ()">shishi_as_req_build</a>                 (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
void                <a class="link" href="shishi-shishi.html#shishi-as-req-set" title="shishi_as_req_set ()">shishi_as_req_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq);
int                 <a class="link" href="shishi-shishi.html#shishi-as-req-der" title="shishi_as_req_der ()">shishi_as_req_der</a>                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-as-req-der-set" title="shishi_as_req_der_set ()">shishi_as_req_der_set</a>               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-as-rep" title="shishi_as_rep ()">shishi_as_rep</a>                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
void                <a class="link" href="shishi-shishi.html#shishi-as-rep-set" title="shishi_as_rep_set ()">shishi_as_rep_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);
int                 <a class="link" href="shishi-shishi.html#shishi-as-rep-build" title="shishi_as_rep_build ()">shishi_as_rep_build</a>                 (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-as-rep-der" title="shishi_as_rep_der ()">shishi_as_rep_der</a>                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-as-rep-der-set" title="shishi_as_rep_der_set ()">shishi_as_rep_der_set</a>               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-as-krberror" title="shishi_as_krberror ()">shishi_as_krberror</a>                  (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
int                 <a class="link" href="shishi-shishi.html#shishi-as-krberror-der" title="shishi_as_krberror_der ()">shishi_as_krberror_der</a>              (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);
void                <a class="link" href="shishi-shishi.html#shishi-as-krberror-set" title="shishi_as_krberror_set ()">shishi_as_krberror_set</a>              (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-as-tkt" title="shishi_as_tkt ()">shishi_as_tkt</a>                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
void                <a class="link" href="shishi-shishi.html#shishi-as-tkt-set" title="shishi_as_tkt_set ()">shishi_as_tkt_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-as-sendrecv" title="shishi_as_sendrecv ()">shishi_as_sendrecv</a>                  (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);
int                 <a class="link" href="shishi-shishi.html#shishi-as-sendrecv-hint" title="shishi_as_sendrecv_hint ()">shishi_as_sendrecv_hint</a>             (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
int                 <a class="link" href="shishi-shishi.html#shishi-as-rep-process" title="shishi_as_rep_process ()">shishi_as_rep_process</a>               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *password);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs" title="shishi_tgs ()">shishi_tgs</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> **tgs);
void                <a class="link" href="shishi-shishi.html#shishi-tgs-done" title="shishi_tgs_done ()">shishi_tgs_done</a>                     (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tgs-tgtkt" title="shishi_tgs_tgtkt ()">shishi_tgs_tgtkt</a>                    (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
void                <a class="link" href="shishi-shishi.html#shishi-tgs-tgtkt-set" title="shishi_tgs_tgtkt_set ()">shishi_tgs_tgtkt_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tgtkt);
<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a>*          <a class="link" href="shishi-shishi.html#shishi-tgs-ap" title="shishi_tgs_ap ()">shishi_tgs_ap</a>                       (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgs-req" title="shishi_tgs_req ()">shishi_tgs_req</a>                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-req-der" title="shishi_tgs_req_der ()">shishi_tgs_req_der</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-req-der-set" title="shishi_tgs_req_der_set ()">shishi_tgs_req_der_set</a>              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char *der,
                                                         size_t derlen);
void                <a class="link" href="shishi-shishi.html#shishi-tgs-req-set" title="shishi_tgs_req_set ()">shishi_tgs_req_set</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsreq);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-req-build" title="shishi_tgs_req_build ()">shishi_tgs_req_build</a>                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-req-process" title="shishi_tgs_req_process ()">shishi_tgs_req_process</a>              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgs-rep" title="shishi_tgs_rep ()">shishi_tgs_rep</a>                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-rep-der" title="shishi_tgs_rep_der ()">shishi_tgs_rep_der</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-rep-build" title="shishi_tgs_rep_build ()">shishi_tgs_rep_build</a>                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-rep-process" title="shishi_tgs_rep_process ()">shishi_tgs_rep_process</a>              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgs-krberror" title="shishi_tgs_krberror ()">shishi_tgs_krberror</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-krberror-der" title="shishi_tgs_krberror_der ()">shishi_tgs_krberror_der</a>             (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);
void                <a class="link" href="shishi-shishi.html#shishi-tgs-krberror-set" title="shishi_tgs_krberror_set ()">shishi_tgs_krberror_set</a>             (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-tgs-tkt" title="shishi_tgs_tkt ()">shishi_tgs_tkt</a>                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
void                <a class="link" href="shishi-shishi.html#shishi-tgs-tkt-set" title="shishi_tgs_tkt_set ()">shishi_tgs_tkt_set</a>                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-sendrecv" title="shishi_tgs_sendrecv ()">shishi_tgs_sendrecv</a>                 (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-sendrecv-hint" title="shishi_tgs_sendrecv_hint ()">shishi_tgs_sendrecv_hint</a>            (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-set-server" title="shishi_tgs_set_server ()">shishi_tgs_set_server</a>               (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-set-realm" title="shishi_tgs_set_realm ()">shishi_tgs_set_realm</a>                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-set-realmserver" title="shishi_tgs_set_realmserver ()">shishi_tgs_set_realmserver</a>          (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *realm,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq" title="shishi_kdcreq ()">shishi_kdcreq</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *service,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *req);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asreq" title="shishi_asreq ()">shishi_asreq</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asreq-rsc" title="shishi_asreq_rsc ()">shishi_asreq_rsc</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *server,
                                                         char *client);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgsreq" title="shishi_tgsreq ()">shishi_tgsreq</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgsreq-rst" title="shishi_tgsreq_rst ()">shishi_tgsreq_rst</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *server,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-save" title="shishi_kdcreq_save ()">shishi_kdcreq_save</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-print" title="shishi_kdcreq_print ()">shishi_kdcreq_print</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-to-file" title="shishi_kdcreq_to_file ()">shishi_kdcreq_to_file</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-parse" title="shishi_kdcreq_parse ()">shishi_kdcreq_parse</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-read" title="shishi_kdcreq_read ()">shishi_kdcreq_read</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-from-file" title="shishi_kdcreq_from_file ()">shishi_kdcreq_from_file</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-asreq-clientrealm" title="shishi_asreq_clientrealm ()">shishi_asreq_clientrealm</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-nonce" title="shishi_kdcreq_nonce ()">shishi_kdcreq_nonce</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t *nonce);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-nonce-set" title="shishi_kdcreq_nonce_set ()">shishi_kdcreq_nonce_set</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t nonce);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-client" title="shishi_kdcreq_client ()">shishi_kdcreq_client</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-cname" title="shishi_kdcreq_set_cname ()">shishi_kdcreq_set_cname</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *principal);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-server" title="shishi_kdcreq_server ()">shishi_kdcreq_server</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **server,
                                                         size_t *serverlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-sname" title="shishi_kdcreq_set_sname ()">shishi_kdcreq_set_sname</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *sname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-realm" title="shishi_kdcreq_realm ()">shishi_kdcreq_realm</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-realm-get" title="shishi_kdcreq_realm_get ()">shishi_kdcreq_realm_get</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-realm" title="shishi_kdcreq_set_realm ()">shishi_kdcreq_set_realm</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-server" title="shishi_kdcreq_set_server ()">shishi_kdcreq_set_server</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> req,
                                                         const char *service);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-realmserver" title="shishi_kdcreq_set_realmserver ()">shishi_kdcreq_set_realmserver</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> req,
                                                         char *realm,
                                                         char *service);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-till" title="shishi_kdcreq_till ()">shishi_kdcreq_till</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **till,
                                                         size_t *tilllen);
time_t              <a class="link" href="shishi-shishi.html#shishi-kdcreq-tillc" title="shishi_kdcreq_tillc ()">shishi_kdcreq_tillc</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-etype" title="shishi_kdcreq_etype ()">shishi_kdcreq_etype</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int32_t *etype,
                                                         int netype);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-set-etype" title="shishi_kdcreq_set_etype ()">shishi_kdcreq_set_etype</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int32_t *etype,
                                                         int netype);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-options" title="shishi_kdcreq_options ()">shishi_kdcreq_options</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t *flags);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-forwardable-p" title="shishi_kdcreq_forwardable_p ()">shishi_kdcreq_forwardable_p</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-forwarded-p" title="shishi_kdcreq_forwarded_p ()">shishi_kdcreq_forwarded_p</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-proxiable-p" title="shishi_kdcreq_proxiable_p ()">shishi_kdcreq_proxiable_p</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-proxy-p" title="shishi_kdcreq_proxy_p ()">shishi_kdcreq_proxy_p</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-allow-postdate-p" title="shishi_kdcreq_allow_postdate_p ()">shishi_kdcreq_allow_postdate_p</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-postdated-p" title="shishi_kdcreq_postdated_p ()">shishi_kdcreq_postdated_p</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-renewable-p" title="shishi_kdcreq_renewable_p ()">shishi_kdcreq_renewable_p</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-disable-transited-check-p" title="shishi_kdcreq_disable_transited_check_p ()">shishi_kdcreq_disable_transited_check_p</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-renewable-ok-p" title="shishi_kdcreq_renewable_ok_p ()">shishi_kdcreq_renewable_ok_p</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-enc-tkt-in-skey-p" title="shishi_kdcreq_enc_tkt_in_skey_p ()">shishi_kdcreq_enc_tkt_in_skey_p</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-renew-p" title="shishi_kdcreq_renew_p ()">shishi_kdcreq_renew_p</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-validate-p" title="shishi_kdcreq_validate_p ()">shishi_kdcreq_validate_p</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-options-set" title="shishi_kdcreq_options_set ()">shishi_kdcreq_options_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t options);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-options-add" title="shishi_kdcreq_options_add ()">shishi_kdcreq_options_add</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t option);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-clear-padata" title="shishi_kdcreq_clear_padata ()">shishi_kdcreq_clear_padata</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-get-padata" title="shishi_kdcreq_get_padata ()">shishi_kdcreq_get_padata</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-padata-type" title="enum Shishi_padata_type">Shishi_padata_type</a> padatatype,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-get-padata-tgs" title="shishi_kdcreq_get_padata_tgs ()">shishi_kdcreq_get_padata_tgs</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-add-padata" title="shishi_kdcreq_add_padata ()">shishi_kdcreq_add_padata</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int padatatype,
                                                         const char *data,
                                                         size_t datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-add-padata-tgs" title="shishi_kdcreq_add_padata_tgs ()">shishi_kdcreq_add_padata_tgs</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-add-padata-preauth" title="shishi_kdcreq_add_padata_preauth ()">shishi_kdcreq_add_padata_preauth</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-build" title="shishi_kdcreq_build ()">shishi_kdcreq_build</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);
int                 <a class="link" href="shishi-shishi.html#shishi-as-derive-salt" title="shishi_as_derive_salt ()">shishi_as_derive_salt</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         char **salt,
                                                         size_t *saltlen);
int                 <a class="link" href="shishi-shishi.html#shishi-tgs-process" title="shishi_tgs_process ()">shishi_tgs_process</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> oldenckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-as-process" title="shishi_as_process ()">shishi_as_process</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         const char *string,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-process" title="shishi_kdc_process ()">shishi_kdc_process</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-sendrecv" title="shishi_kdcreq_sendrecv ()">shishi_kdcreq_sendrecv</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcreq-sendrecv-hint" title="shishi_kdcreq_sendrecv_hint ()">shishi_kdcreq_sendrecv_hint</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-copy-crealm" title="shishi_kdc_copy_crealm ()">shishi_kdc_copy_crealm</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-as-check-crealm" title="shishi_as_check_crealm ()">shishi_as_check_crealm</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-copy-cname" title="shishi_kdc_copy_cname ()">shishi_kdc_copy_cname</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-as-check-cname" title="shishi_as_check_cname ()">shishi_as_check_cname</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-copy-nonce" title="shishi_kdc_copy_nonce ()">shishi_kdc_copy_nonce</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-check-nonce" title="shishi_kdc_check_nonce ()">shishi_kdc_check_nonce</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asrep" title="shishi_asrep ()">shishi_asrep</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-tgsrep" title="shishi_tgsrep ()">shishi_tgsrep</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-save" title="shishi_kdcrep_save ()">shishi_kdcrep_save</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-print" title="shishi_kdcrep_print ()">shishi_kdcrep_print</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-to-file" title="shishi_kdcrep_to_file ()">shishi_kdcrep_to_file</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-parse" title="shishi_kdcrep_parse ()">shishi_kdcrep_parse</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-read" title="shishi_kdcrep_read ()">shishi_kdcrep_read</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-from-file" title="shishi_kdcrep_from_file ()">shishi_kdcrep_from_file</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-clear-padata" title="shishi_kdcrep_clear_padata ()">shishi_kdcrep_clear_padata</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-get-enc-part-etype" title="shishi_kdcrep_get_enc_part_etype ()">shishi_kdcrep_get_enc_part_etype</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int32_t *etype);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-add-enc-part" title="shishi_kdcrep_add_enc_part ()">shishi_kdcrep_add_enc_part</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-get-ticket" title="shishi_kdcrep_get_ticket ()">shishi_kdcrep_get_ticket</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-set-ticket" title="shishi_kdcrep_set_ticket ()">shishi_kdcrep_set_ticket</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-crealm-set" title="shishi_kdcrep_crealm_set ()">shishi_kdcrep_crealm_set</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *crealm);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-cname-set" title="shishi_kdcrep_cname_set ()">shishi_kdcrep_cname_set</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-client-set" title="shishi_kdcrep_client_set ()">shishi_kdcrep_client_set</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-crealmserver-set" title="shishi_kdcrep_crealmserver_set ()">shishi_kdcrep_crealmserver_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *crealm,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-set-enc-part" title="shishi_kdcrep_set_enc_part ()">shishi_kdcrep_set_enc_part</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdcrep-decrypt" title="shishi_kdcrep_decrypt ()">shishi_kdcrep_decrypt</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-enckdcreppart" title="shishi_enckdcreppart ()">shishi_enckdcreppart</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-encasreppart" title="shishi_encasreppart ()">shishi_encasreppart</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-get-key" title="shishi_enckdcreppart_get_key ()">shishi_enckdcreppart_get_key</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-key-set" title="shishi_enckdcreppart_key_set ()">shishi_enckdcreppart_key_set</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-nonce-set" title="shishi_enckdcreppart_nonce_set ()">shishi_enckdcreppart_nonce_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         uint32_t nonce);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-flags-set" title="shishi_enckdcreppart_flags_set ()">shishi_enckdcreppart_flags_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         int flags);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-authtime-set" title="shishi_enckdcreppart_authtime_set ()">shishi_enckdcreppart_authtime_set</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *authtime);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-starttime-set" title="shishi_enckdcreppart_starttime_set ()">shishi_enckdcreppart_starttime_set</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *starttime);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-endtime-set" title="shishi_enckdcreppart_endtime_set ()">shishi_enckdcreppart_endtime_set</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *endtime);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-renew-till-set" title="shishi_enckdcreppart_renew_till_set ()">shishi_enckdcreppart_renew_till_set</a> (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *renew_till);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-srealm-set" title="shishi_enckdcreppart_srealm_set ()">shishi_enckdcreppart_srealm_set</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *srealm);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-sname-set" title="shishi_enckdcreppart_sname_set ()">shishi_enckdcreppart_sname_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         char *sname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-server-set" title="shishi_enckdcreppart_server_set ()">shishi_enckdcreppart_server_set</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-srealmserver-set" title="shishi_enckdcreppart_srealmserver_set ()">shishi_enckdcreppart_srealmserver_set</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *srealm,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-enckdcreppart-populate-encticketpart" title="shishi_enckdcreppart_populate_encticketpart ()">shishi_enckdcreppart_populate_encticketpart</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()">shishi_krberror</a>                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-print" title="shishi_krberror_print ()">shishi_krberror_print</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-save" title="shishi_krberror_save ()">shishi_krberror_save</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-to-file" title="shishi_krberror_to_file ()">shishi_krberror_to_file</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-parse" title="shishi_krberror_parse ()">shishi_krberror_parse</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-read" title="shishi_krberror_read ()">shishi_krberror_read</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-from-file" title="shishi_krberror_from_file ()">shishi_krberror_from_file</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-build" title="shishi_krberror_build ()">shishi_krberror_build</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-der" title="shishi_krberror_der ()">shishi_krberror_der</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-crealm" title="shishi_krberror_crealm ()">shishi_krberror_crealm</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-crealm" title="shishi_krberror_remove_crealm ()">shishi_krberror_remove_crealm</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-crealm" title="shishi_krberror_set_crealm ()">shishi_krberror_set_crealm</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *crealm);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-client" title="shishi_krberror_client ()">shishi_krberror_client</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-cname" title="shishi_krberror_set_cname ()">shishi_krberror_set_cname</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-cname" title="shishi_krberror_remove_cname ()">shishi_krberror_remove_cname</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-client-set" title="shishi_krberror_client_set ()">shishi_krberror_client_set</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *client);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-realm" title="shishi_krberror_realm ()">shishi_krberror_realm</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **realm,
                                                         size_t *realmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-realm" title="shishi_krberror_set_realm ()">shishi_krberror_set_realm</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-server" title="shishi_krberror_server ()">shishi_krberror_server</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **server,
                                                         size_t *serverlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-sname" title="shishi_krberror_remove_sname ()">shishi_krberror_remove_sname</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-sname" title="shishi_krberror_set_sname ()">shishi_krberror_set_sname</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *sname[]);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-server-set" title="shishi_krberror_server_set ()">shishi_krberror_server_set</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *server);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-ctime" title="shishi_krberror_ctime ()">shishi_krberror_ctime</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **t);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-ctime-set" title="shishi_krberror_ctime_set ()">shishi_krberror_ctime_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *t);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-ctime" title="shishi_krberror_remove_ctime ()">shishi_krberror_remove_ctime</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-cusec" title="shishi_krberror_cusec ()">shishi_krberror_cusec</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t *cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-cusec-set" title="shishi_krberror_cusec_set ()">shishi_krberror_cusec_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-cusec" title="shishi_krberror_remove_cusec ()">shishi_krberror_remove_cusec</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-stime" title="shishi_krberror_stime ()">shishi_krberror_stime</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **t);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-stime-set" title="shishi_krberror_stime_set ()">shishi_krberror_stime_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *t);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-susec" title="shishi_krberror_susec ()">shishi_krberror_susec</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t *susec);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-susec-set" title="shishi_krberror_susec_set ()">shishi_krberror_susec_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t susec);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode-set" title="shishi_krberror_errorcode_set ()">shishi_krberror_errorcode_set</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int errorcode);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-etext" title="shishi_krberror_etext ()">shishi_krberror_etext</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **etext,
                                                         size_t *etextlen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-etext" title="shishi_krberror_set_etext ()">shishi_krberror_set_etext</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *etext);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-etext" title="shishi_krberror_remove_etext ()">shishi_krberror_remove_etext</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-edata" title="shishi_krberror_edata ()">shishi_krberror_edata</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **edata,
                                                         size_t *edatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-set-edata" title="shishi_krberror_set_edata ()">shishi_krberror_set_edata</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *edata);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-remove-edata" title="shishi_krberror_remove_edata ()">shishi_krberror_remove_edata</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode" title="shishi_krberror_errorcode ()">shishi_krberror_errorcode</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int *errorcode);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode-fast" title="shishi_krberror_errorcode_fast ()">shishi_krberror_errorcode_fast</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-pretty-print" title="shishi_krberror_pretty_print ()">shishi_krberror_pretty_print</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
const char*         <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode-message" title="shishi_krberror_errorcode_message ()">shishi_krberror_errorcode_message</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int errorcode);
const char*         <a class="link" href="shishi-shishi.html#shishi-krberror-message" title="shishi_krberror_message ()">shishi_krberror_message</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);
int                 <a class="link" href="shishi-shishi.html#shishi-krberror-methoddata" title="shishi_krberror_methoddata ()">shishi_krberror_methoddata</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *methoddata);
const char*         <a class="link" href="shishi-shishi.html#shishi-generalize-time" title="shishi_generalize_time ()">shishi_generalize_time</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         time_t t);
const char*         <a class="link" href="shishi-shishi.html#shishi-generalize-now" title="shishi_generalize_now ()">shishi_generalize_now</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
time_t              <a class="link" href="shishi-shishi.html#shishi-generalize-ctime" title="shishi_generalize_ctime ()">shishi_generalize_ctime</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *t);
int                 <a class="link" href="shishi-shishi.html#shishi-time" title="shishi_time ()">shishi_time</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **t);
int                 <a class="link" href="shishi-shishi.html#shishi-ctime" title="shishi_ctime ()">shishi_ctime</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         time_t *t);
int                 <a class="link" href="shishi-shishi.html#shishi-randomize" title="shishi_randomize ()">shishi_randomize</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int strong,
                                                         void *data,
                                                         size_t datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-crc" title="shishi_crc ()">shishi_crc</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[4]);
int                 <a class="link" href="shishi-shishi.html#shishi-md4" title="shishi_md4 ()">shishi_md4</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[16]);
int                 <a class="link" href="shishi-shishi.html#shishi-md5" title="shishi_md5 ()">shishi_md5</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[16]);
int                 <a class="link" href="shishi-shishi.html#shishi-hmac-md5" title="shishi_hmac_md5 ()">shishi_hmac_md5</a>                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *outhash[16]);
int                 <a class="link" href="shishi-shishi.html#shishi-hmac-sha1" title="shishi_hmac_sha1 ()">shishi_hmac_sha1</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *outhash[20]);
int                 <a class="link" href="shishi-shishi.html#shishi-des-cbc-mac" title="shishi_des_cbc_mac ()">shishi_des_cbc_mac</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char key[8],
                                                         const char iv[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[8]);
int                 <a class="link" href="shishi-shishi.html#shishi-arcfour" title="shishi_arcfour ()">shishi_arcfour</a>                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char iv[258],
                                                         char *ivout[258],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);
int                 <a class="link" href="shishi-shishi.html#shishi-des" title="shishi_des ()">shishi_des</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char key[8],
                                                         const char iv[8],
                                                         char *ivout[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);
int                 <a class="link" href="shishi-shishi.html#shishi-3des" title="shishi_3des ()">shishi_3des</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char key[24],
                                                         const char iv[8],
                                                         char *ivout[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);
int                 <a class="link" href="shishi-shishi.html#shishi-aes-cts" title="shishi_aes_cts ()">shishi_aes_cts</a>                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char iv[16],
                                                         char *ivout[16],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);
int                 <a class="link" href="shishi-shishi.html#shishi-cipher-supported-p" title="shishi_cipher_supported_p ()">shishi_cipher_supported_p</a>           (int type);
const char*         <a class="link" href="shishi-shishi.html#shishi-cipher-name" title="shishi_cipher_name ()">shishi_cipher_name</a>                  (int type);
int                 <a class="link" href="shishi-shishi.html#shishi-cipher-blocksize" title="shishi_cipher_blocksize ()">shishi_cipher_blocksize</a>             (int type);
int                 <a class="link" href="shishi-shishi.html#shishi-cipher-confoundersize" title="shishi_cipher_confoundersize ()">shishi_cipher_confoundersize</a>        (int type);
size_t              <a class="link" href="shishi-shishi.html#shishi-cipher-keylen" title="shishi_cipher_keylen ()">shishi_cipher_keylen</a>                (int type);
size_t              <a class="link" href="shishi-shishi.html#shishi-cipher-randomlen" title="shishi_cipher_randomlen ()">shishi_cipher_randomlen</a>             (int type);
int                 <a class="link" href="shishi-shishi.html#shishi-cipher-defaultcksumtype" title="shishi_cipher_defaultcksumtype ()">shishi_cipher_defaultcksumtype</a>      (int32_t type);
int                 <a class="link" href="shishi-shishi.html#shishi-cipher-parse" title="shishi_cipher_parse ()">shishi_cipher_parse</a>                 (const char *cipher);
int                 <a class="link" href="shishi-shishi.html#shishi-checksum-supported-p" title="shishi_checksum_supported_p ()">shishi_checksum_supported_p</a>         (int32_t type);
const char*         <a class="link" href="shishi-shishi.html#shishi-checksum-name" title="shishi_checksum_name ()">shishi_checksum_name</a>                (int32_t type);
size_t              <a class="link" href="shishi-shishi.html#shishi-checksum-cksumlen" title="shishi_checksum_cksumlen ()">shishi_checksum_cksumlen</a>            (int32_t type);
int                 <a class="link" href="shishi-shishi.html#shishi-checksum-parse" title="shishi_checksum_parse ()">shishi_checksum_parse</a>               (const char *checksum);
int                 <a class="link" href="shishi-shishi.html#shishi-string-to-key" title="shishi_string_to_key ()">shishi_string_to_key</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t keytype,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *salt,
                                                         size_t saltlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *outkey);
int                 <a class="link" href="shishi-shishi.html#shishi-random-to-key" title="shishi_random_to_key ()">shishi_random_to_key</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t keytype,
                                                         const char *rnd,
                                                         size_t rndlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *outkey);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt-ivupdate-etype" title="shishi_encrypt_ivupdate_etype ()">shishi_encrypt_ivupdate_etype</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt-iv-etype" title="shishi_encrypt_iv_etype ()">shishi_encrypt_iv_etype</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt-etype" title="shishi_encrypt_etype ()">shishi_encrypt_etype</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt-ivupdate" title="shishi_encrypt_ivupdate ()">shishi_encrypt_ivupdate</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt-iv" title="shishi_encrypt_iv ()">shishi_encrypt_iv</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encrypt" title="shishi_encrypt ()">shishi_encrypt</a>                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt-ivupdate-etype" title="shishi_decrypt_ivupdate_etype ()">shishi_decrypt_ivupdate_etype</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt-iv-etype" title="shishi_decrypt_iv_etype ()">shishi_decrypt_iv_etype</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt-etype" title="shishi_decrypt_etype ()">shishi_decrypt_etype</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt-ivupdate" title="shishi_decrypt_ivupdate ()">shishi_decrypt_ivupdate</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt-iv" title="shishi_decrypt_iv ()">shishi_decrypt_iv</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-decrypt" title="shishi_decrypt ()">shishi_decrypt</a>                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-checksum" title="shishi_checksum ()">shishi_checksum</a>                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t cksumtype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-verify" title="shishi_verify ()">shishi_verify</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int cksumtype,
                                                         const char *in,
                                                         size_t inlen,
                                                         const char *cksum,
                                                         size_t cksumlen);
int                 <a class="link" href="shishi-shishi.html#shishi-dk" title="shishi_dk ()">shishi_dk</a>                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *prfconstant,
                                                         size_t prfconstantlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *derivedkey);
int                 <a class="link" href="shishi-shishi.html#shishi-dr" title="shishi_dr ()">shishi_dr</a>                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *prfconstant,
                                                         size_t prfconstantlen,
                                                         char *derivedrandom,
                                                         size_t derivedrandomlen);
int                 <a class="link" href="shishi-shishi.html#shishi-n-fold" title="shishi_n_fold ()">shishi_n_fold</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out,
                                                         size_t outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-pbkdf2-sha1" title="shishi_pbkdf2_sha1 ()">shishi_pbkdf2_sha1</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *P,
                                                         size_t Plen,
                                                         const char *S,
                                                         size_t Slen,
                                                         unsigned int c,
                                                         unsigned int dkLen,
                                                         char *DK);
<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a>*      <a class="link" href="shishi-shishi.html#shishi-crypto" title="shishi_crypto ()">shishi_crypto</a>                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen);
void                <a class="link" href="shishi-shishi.html#shishi-crypto-close" title="shishi_crypto_close ()">shishi_crypto_close</a>                 (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx);
int                 <a class="link" href="shishi-shishi.html#shishi-crypto-encrypt" title="shishi_crypto_encrypt ()">shishi_crypto_encrypt</a>               (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-crypto-decrypt" title="shishi_crypto_decrypt ()">shishi_crypto_decrypt</a>               (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);
const char*         <a class="link" href="shishi-shishi.html#shishi-check-version" title="shishi_check_version ()">shishi_check_version</a>                (const char *req_version);
int                 (<a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()">*shishi_prompt_password_func</a>)      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char **s,
                                                         const char *format,
                                                         va_list ap);
void                <a class="link" href="shishi-shishi.html#shishi-prompt-password-callback-set" title="shishi_prompt_password_callback_set ()">shishi_prompt_password_callback_set</a> (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()">shishi_prompt_password_func</a> cb);
<a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()">shishi_prompt_password_func</a> <a class="link" href="shishi-shishi.html#shishi-prompt-password-callback-get" title="shishi_prompt_password_callback_get ()">shishi_prompt_password_callback_get</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-prompt-password" title="shishi_prompt_password ()">shishi_prompt_password</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char **s,
                                                         const char *format,
                                                         ...);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-number-of-elements" title="shishi_asn1_number_of_elements ()">shishi_asn1_number_of_elements</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         size_t *n);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-empty-p" title="shishi_asn1_empty_p ()">shishi_asn1_empty_p</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read" title="shishi_asn1_read ()">shishi_asn1_read</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **data,
                                                         size_t *datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-inline" title="shishi_asn1_read_inline ()">shishi_asn1_read_inline</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char *data,
                                                         size_t *datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-integer" title="shishi_asn1_read_integer ()">shishi_asn1_read_integer</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int *i);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-int32" title="shishi_asn1_read_int32 ()">shishi_asn1_read_int32</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int32_t *i);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-uint32" title="shishi_asn1_read_uint32 ()">shishi_asn1_read_uint32</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t *i);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-bitstring" title="shishi_asn1_read_bitstring ()">shishi_asn1_read_bitstring</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t *flags);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-read-optional" title="shishi_asn1_read_optional ()">shishi_asn1_read_optional</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **data,
                                                         size_t *datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-write" title="shishi_asn1_write ()">shishi_asn1_write</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         const char *data,
                                                         size_t datalen);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-write-integer" title="shishi_asn1_write_integer ()">shishi_asn1_write_integer</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int n);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-write-int32" title="shishi_asn1_write_int32 ()">shishi_asn1_write_int32</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int32_t n);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-write-uint32" title="shishi_asn1_write_uint32 ()">shishi_asn1_write_uint32</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t n);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-write-bitstring" title="shishi_asn1_write_bitstring ()">shishi_asn1_write_bitstring</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t flags);
void                <a class="link" href="shishi-shishi.html#shishi-asn1-done" title="shishi_asn1_done ()">shishi_asn1_done</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-pa-enc-ts-enc" title="shishi_asn1_pa_enc_ts_enc ()">shishi_asn1_pa_enc_ts_enc</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-encrypteddata" title="shishi_asn1_encrypteddata ()">shishi_asn1_encrypteddata</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-padata" title="shishi_asn1_padata ()">shishi_asn1_padata</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-methoddata" title="shishi_asn1_methoddata ()">shishi_asn1_methoddata</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-etype-info" title="shishi_asn1_etype_info ()">shishi_asn1_etype_info</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-etype-info2" title="shishi_asn1_etype_info2 ()">shishi_asn1_etype_info2</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-asreq" title="shishi_asn1_asreq ()">shishi_asn1_asreq</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-asrep" title="shishi_asn1_asrep ()">shishi_asn1_asrep</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-tgsreq" title="shishi_asn1_tgsreq ()">shishi_asn1_tgsreq</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-tgsrep" title="shishi_asn1_tgsrep ()">shishi_asn1_tgsrep</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-apreq" title="shishi_asn1_apreq ()">shishi_asn1_apreq</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-aprep" title="shishi_asn1_aprep ()">shishi_asn1_aprep</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-ticket" title="shishi_asn1_ticket ()">shishi_asn1_ticket</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-encapreppart" title="shishi_asn1_encapreppart ()">shishi_asn1_encapreppart</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-encticketpart" title="shishi_asn1_encticketpart ()">shishi_asn1_encticketpart</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-authenticator" title="shishi_asn1_authenticator ()">shishi_asn1_authenticator</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-enckdcreppart" title="shishi_asn1_enckdcreppart ()">shishi_asn1_enckdcreppart</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-encasreppart" title="shishi_asn1_encasreppart ()">shishi_asn1_encasreppart</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-krberror" title="shishi_asn1_krberror ()">shishi_asn1_krberror</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-krbsafe" title="shishi_asn1_krbsafe ()">shishi_asn1_krbsafe</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-priv" title="shishi_asn1_priv ()">shishi_asn1_priv</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-asn1-encprivpart" title="shishi_asn1_encprivpart ()">shishi_asn1_encprivpart</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-to-der" title="shishi_asn1_to_der ()">shishi_asn1_to_der</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         char **der,
                                                         size_t *len);
int                 <a class="link" href="shishi-shishi.html#shishi-asn1-to-der-field" title="shishi_asn1_to_der_field ()">shishi_asn1_to_der_field</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **der,
                                                         size_t *len);
<a class="link" href="shishi-shishi.html#Shishi-msgtype" title="enum Shishi_msgtype">Shishi_msgtype</a>      <a class="link" href="shishi-shishi.html#shishi-asn1-msgtype" title="shishi_asn1_msgtype ()">shishi_asn1_msgtype</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node);
<a class="link" href="shishi-shishi.html#Shishi-msgtype" title="enum Shishi_msgtype">Shishi_msgtype</a>      <a class="link" href="shishi-shishi.html#shishi-der-msgtype" title="shishi_der_msgtype ()">shishi_der_msgtype</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
void                <a class="link" href="shishi-shishi.html#shishi-asn1-print" title="shishi_asn1_print ()">shishi_asn1_print</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         FILE *fh);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1" title="shishi_der2asn1 ()">shishi_der2asn1</a>                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-padata" title="shishi_der2asn1_padata ()">shishi_der2asn1_padata</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-methoddata" title="shishi_der2asn1_methoddata ()">shishi_der2asn1_methoddata</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-etype-info" title="shishi_der2asn1_etype_info ()">shishi_der2asn1_etype_info</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-etype-info2" title="shishi_der2asn1_etype_info2 ()">shishi_der2asn1_etype_info2</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-ticket" title="shishi_der2asn1_ticket ()">shishi_der2asn1_ticket</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-encticketpart" title="shishi_der2asn1_encticketpart ()">shishi_der2asn1_encticketpart</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-asreq" title="shishi_der2asn1_asreq ()">shishi_der2asn1_asreq</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-tgsreq" title="shishi_der2asn1_tgsreq ()">shishi_der2asn1_tgsreq</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-asrep" title="shishi_der2asn1_asrep ()">shishi_der2asn1_asrep</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-tgsrep" title="shishi_der2asn1_tgsrep ()">shishi_der2asn1_tgsrep</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-kdcrep" title="shishi_der2asn1_kdcrep ()">shishi_der2asn1_kdcrep</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-kdcreq" title="shishi_der2asn1_kdcreq ()">shishi_der2asn1_kdcreq</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-apreq" title="shishi_der2asn1_apreq ()">shishi_der2asn1_apreq</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-aprep" title="shishi_der2asn1_aprep ()">shishi_der2asn1_aprep</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-authenticator" title="shishi_der2asn1_authenticator ()">shishi_der2asn1_authenticator</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-krberror" title="shishi_der2asn1_krberror ()">shishi_der2asn1_krberror</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-krbsafe" title="shishi_der2asn1_krbsafe ()">shishi_der2asn1_krbsafe</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-priv" title="shishi_der2asn1_priv ()">shishi_der2asn1_priv</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-encasreppart" title="shishi_der2asn1_encasreppart ()">shishi_der2asn1_encasreppart</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-enctgsreppart" title="shishi_der2asn1_enctgsreppart ()">shishi_der2asn1_enctgsreppart</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-enckdcreppart" title="shishi_der2asn1_enckdcreppart ()">shishi_der2asn1_enckdcreppart</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-encapreppart" title="shishi_der2asn1_encapreppart ()">shishi_der2asn1_encapreppart</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-der2asn1-encprivpart" title="shishi_der2asn1_encprivpart ()">shishi_der2asn1_encprivpart</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()">shishi_ap</a>                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-etype" title="shishi_ap_etype ()">shishi_ap_etype</a>                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         int etype);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-nosubkey" title="shishi_ap_nosubkey ()">shishi_ap_nosubkey</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-done" title="shishi_ap_done ()">shishi_ap_done</a>                      (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptions" title="shishi_ap_set_tktoptions ()">shishi_ap_set_tktoptions</a>            (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-tktoptions" title="shishi_ap_tktoptions ()">shishi_ap_tktoptions</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-etype-tktoptionsdata" title="shishi_ap_etype_tktoptionsdata ()">shishi_ap_etype_tktoptionsdata</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         int32_t etype,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsdata" title="shishi_ap_set_tktoptionsdata ()">shishi_ap_set_tktoptionsdata</a>        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-tktoptionsdata" title="shishi_ap_tktoptionsdata ()">shishi_ap_tktoptionsdata</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsraw" title="shishi_ap_set_tktoptionsraw ()">shishi_ap_set_tktoptionsraw</a>         (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         int32_t cksumtype,
                                                         const char *data,
                                                         size_t len);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-tktoptionsraw" title="shishi_ap_tktoptionsraw ()">shishi_ap_tktoptionsraw</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         int32_t cksumtype,
                                                         const char *data,
                                                         size_t len);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsasn1usage" title="shishi_ap_set_tktoptionsasn1usage ()">shishi_ap_set_tktoptionsasn1usage</a>   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int authenticatorcksumkeyusage,
                                                         int authenticatorkeyusage);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-tktoptionsasn1usage" title="shishi_ap_tktoptionsasn1usage ()">shishi_ap_tktoptionsasn1usage</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int authenticatorcksumkeyusage,
                                                         int authenticatorkeyusage);
<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         <a class="link" href="shishi-shishi.html#shishi-ap-tkt" title="shishi_ap_tkt ()">shishi_ap_tkt</a>                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-tkt-set" title="shishi_ap_tkt_set ()">shishi_ap_tkt_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-cksumdata" title="shishi_ap_authenticator_cksumdata ()">shishi_ap_authenticator_cksumdata</a>   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *out,
                                                         size_t *len);
void                <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-cksumdata-set" title="shishi_ap_authenticator_cksumdata_set ()">shishi_ap_authenticator_cksumdata_set</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         const char *authenticatorcksumdata,
                                                         size_t authenticatorcksumdatalen);
void                <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-cksumraw-set" title="shishi_ap_authenticator_cksumraw_set ()">shishi_ap_authenticator_cksumraw_set</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         int32_t authenticatorcksumtype,
                                                         const char *authenticatorcksumraw,
                                                         size_t authenticatorcksumrawlen);
int32_t             <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-cksumtype" title="shishi_ap_authenticator_cksumtype ()">shishi_ap_authenticator_cksumtype</a>   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-cksumtype-set" title="shishi_ap_authenticator_cksumtype_set ()">shishi_ap_authenticator_cksumtype_set</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         int32_t cksumtype);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-ap-authenticator" title="shishi_ap_authenticator ()">shishi_ap_authenticator</a>             (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-authenticator-set" title="shishi_ap_authenticator_set ()">shishi_ap_authenticator_set</a>         (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-ap-req" title="shishi_ap_req ()">shishi_ap_req</a>                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-req-set" title="shishi_ap_req_set ()">shishi_ap_req_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-der" title="shishi_ap_req_der ()">shishi_ap_req_der</a>                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-der-set" title="shishi_ap_req_der_set ()">shishi_ap_req_der_set</a>               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-build" title="shishi_ap_req_build ()">shishi_ap_req_build</a>                 (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-asn1" title="shishi_ap_req_asn1 ()">shishi_ap_req_asn1</a>                  (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-ap-key" title="shishi_ap_key ()">shishi_ap_key</a>                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-decode" title="shishi_ap_req_decode ()">shishi_ap_req_decode</a>                (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-process" title="shishi_ap_req_process ()">shishi_ap_req_process</a>               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-req-process-keyusage" title="shishi_ap_req_process_keyusage ()">shishi_ap_req_process_keyusage</a>      (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int32_t keyusage);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-ap-rep" title="shishi_ap_rep ()">shishi_ap_rep</a>                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-rep-set" title="shishi_ap_rep_set ()">shishi_ap_rep_set</a>                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-der" title="shishi_ap_rep_der ()">shishi_ap_rep_der</a>                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-der-set" title="shishi_ap_rep_der_set ()">shishi_ap_rep_der_set</a>               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-verify" title="shishi_ap_rep_verify ()">shishi_ap_rep_verify</a>                (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-verify-der" title="shishi_ap_rep_verify_der ()">shishi_ap_rep_verify_der</a>            (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-verify-asn1" title="shishi_ap_rep_verify_asn1 ()">shishi_ap_rep_verify_asn1</a>           (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-asn1" title="shishi_ap_rep_asn1 ()">shishi_ap_rep_asn1</a>                  (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-ap-rep-build" title="shishi_ap_rep_build ()">shishi_ap_rep_build</a>                 (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-ap-encapreppart" title="shishi_ap_encapreppart ()">shishi_ap_encapreppart</a>              (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);
void                <a class="link" href="shishi-shishi.html#shishi-ap-encapreppart-set" title="shishi_ap_encapreppart_set ()">shishi_ap_encapreppart_set</a>          (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
const char*         <a class="link" href="shishi-shishi.html#shishi-ap-option2string" title="shishi_ap_option2string ()">shishi_ap_option2string</a>             (<a class="link" href="shishi-shishi.html#Shishi-apoptions" title="enum Shishi_apoptions">Shishi_apoptions</a> option);
<a class="link" href="shishi-shishi.html#Shishi-apoptions" title="enum Shishi_apoptions">Shishi_apoptions</a>    <a class="link" href="shishi-shishi.html#shishi-ap-string2option" title="shishi_ap_string2option ()">shishi_ap_string2option</a>             (const char *str);
const char*         <a class="link" href="shishi-shishi.html#shishi-key-principal" title="shishi_key_principal ()">shishi_key_principal</a>                (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-principal-set" title="shishi_key_principal_set ()">shishi_key_principal_set</a>            (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *principal);
const char*         <a class="link" href="shishi-shishi.html#shishi-key-realm" title="shishi_key_realm ()">shishi_key_realm</a>                    (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-realm-set" title="shishi_key_realm_set ()">shishi_key_realm_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-key-type" title="shishi_key_type ()">shishi_key_type</a>                     (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-type-set" title="shishi_key_type_set ()">shishi_key_type_set</a>                 (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int32_t type);
const char*         <a class="link" href="shishi-shishi.html#shishi-key-value" title="shishi_key_value ()">shishi_key_value</a>                    (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-value-set" title="shishi_key_value_set ()">shishi_key_value_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *value);
const char*         <a class="link" href="shishi-shishi.html#shishi-key-name" title="shishi_key_name ()">shishi_key_name</a>                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
size_t              <a class="link" href="shishi-shishi.html#shishi-key-length" title="shishi_key_length ()">shishi_key_length</a>                   (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
uint32_t            <a class="link" href="shishi-shishi.html#shishi-key-version" title="shishi_key_version ()">shishi_key_version</a>                  (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-version-set" title="shishi_key_version_set ()">shishi_key_version_set</a>              (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         uint32_t kvno);
int                 <a class="link" href="shishi-shishi.html#shishi-key" title="shishi_key ()">shishi_key</a>                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
void                <a class="link" href="shishi-shishi.html#shishi-key-done" title="shishi_key_done ()">shishi_key_done</a>                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
void                <a class="link" href="shishi-shishi.html#shishi-key-copy" title="shishi_key_copy ()">shishi_key_copy</a>                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *dstkey,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *srckey);
int                 <a class="link" href="shishi-shishi.html#shishi-key-print" title="shishi_key_print ()">shishi_key_print</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-to-file" title="shishi_key_to_file ()">shishi_key_to_file</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-parse" title="shishi_key_parse ()">shishi_key_parse</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-random" title="shishi_key_random ()">shishi_key_random</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-from-value" title="shishi_key_from_value ()">shishi_key_from_value</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *value,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-from-base64" title="shishi_key_from_base64 ()">shishi_key_from_base64</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *value,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-key-from-random" title="shishi_key_from_random ()">shishi_key_from_random</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *rnd,
                                                         size_t rndlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);
int                 <a class="link" href="shishi-shishi.html#shishi-key-from-string" title="shishi_key_from_string ()">shishi_key_from_string</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *salt,
                                                         size_t saltlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);
int                 <a class="link" href="shishi-shishi.html#shishi-key-from-name" title="shishi_key_from_name ()">shishi_key_from_name</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *name,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);
int                 <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()">shishi_keys</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **keys);
void                <a class="link" href="shishi-shishi.html#shishi-keys-done" title="shishi_keys_done ()">shishi_keys_done</a>                    (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **keys);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-size" title="shishi_keys_size ()">shishi_keys_size</a>                    (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);
const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*   <a class="link" href="shishi-shishi.html#shishi-keys-nth" title="shishi_keys_nth ()">shishi_keys_nth</a>                     (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         int keyno);
void                <a class="link" href="shishi-shishi.html#shishi-keys-remove" title="shishi_keys_remove ()">shishi_keys_remove</a>                  (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         int keyno);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-add" title="shishi_keys_add ()">shishi_keys_add</a>                     (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-add-keytab-mem" title="shishi_keys_add_keytab_mem ()">shishi_keys_add_keytab_mem</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-add-keytab-file" title="shishi_keys_add_keytab_file ()">shishi_keys_add_keytab_file</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-from-keytab-mem" title="shishi_keys_from_keytab_mem ()">shishi_keys_from_keytab_mem</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **outkeys);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-from-keytab-file" title="shishi_keys_from_keytab_file ()">shishi_keys_from_keytab_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **outkeys);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-print" title="shishi_keys_print ()">shishi_keys_print</a>                   (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         FILE *fh);
int                 <a class="link" href="shishi-shishi.html#shishi-keys-to-file" title="shishi_keys_to_file ()">shishi_keys_to_file</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-keys-for-serverrealm-in-file" title="shishi_keys_for_serverrealm_in_file ()">shishi_keys_for_serverrealm_in_file</a> (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *server,
                                                         const char *realm);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-keys-for-server-in-file" title="shishi_keys_for_server_in_file ()">shishi_keys_for_server_in_file</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-keys-for-localservicerealm-in-file" title="shishi_keys_for_localservicerealm_in_file ()">shishi_keys_for_localservicerealm_in_file</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *service,
                                                         const char *realm);
const char*         <a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()">shishi_hostkeys_default_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file-set" title="shishi_hostkeys_default_file_set ()">shishi_hostkeys_default_file_set</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *hostkeysfile);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-hostkeys-for-server" title="shishi_hostkeys_for_server ()">shishi_hostkeys_for_server</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *server);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-hostkeys-for-serverrealm" title="shishi_hostkeys_for_serverrealm ()">shishi_hostkeys_for_serverrealm</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *server,
                                                         const char *realm);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-hostkeys-for-localservicerealm" title="shishi_hostkeys_for_localservicerealm ()">shishi_hostkeys_for_localservicerealm</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service,
                                                         const char *realm);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-hostkeys-for-localservice" title="shishi_hostkeys_for_localservice ()">shishi_hostkeys_for_localservice</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()">shishi_encapreppart</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-time-copy" title="shishi_encapreppart_time_copy ()">shishi_encapreppart_time_copy</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-ctime" title="shishi_encapreppart_ctime ()">shishi_encapreppart_ctime</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         char **t);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-ctime-set" title="shishi_encapreppart_ctime_set ()">shishi_encapreppart_ctime_set</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         const char *t);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-cusec-get" title="shishi_encapreppart_cusec_get ()">shishi_encapreppart_cusec_get</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t *cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-cusec-set" title="shishi_encapreppart_cusec_set ()">shishi_encapreppart_cusec_set</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t cusec);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-print" title="shishi_encapreppart_print ()">shishi_encapreppart_print</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-save" title="shishi_encapreppart_save ()">shishi_encapreppart_save</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-to-file" title="shishi_encapreppart_to_file ()">shishi_encapreppart_to_file</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-read" title="shishi_encapreppart_read ()">shishi_encapreppart_read</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-parse" title="shishi_encapreppart_parse ()">shishi_encapreppart_parse</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-from-file" title="shishi_encapreppart_from_file ()">shishi_encapreppart_from_file</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-get-key" title="shishi_encapreppart_get_key ()">shishi_encapreppart_get_key</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-seqnumber-get" title="shishi_encapreppart_seqnumber_get ()">shishi_encapreppart_seqnumber_get</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t *seqnumber);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-seqnumber-remove" title="shishi_encapreppart_seqnumber_remove ()">shishi_encapreppart_seqnumber_remove</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-encapreppart-seqnumber-set" title="shishi_encapreppart_seqnumber_set ()">shishi_encapreppart_seqnumber_set</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t seqnumber);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()">shishi_apreq</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-parse" title="shishi_apreq_parse ()">shishi_apreq_parse</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-from-file" title="shishi_apreq_from_file ()">shishi_apreq_from_file</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-print" title="shishi_apreq_print ()">shishi_apreq_print</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-to-file" title="shishi_apreq_to_file ()">shishi_apreq_to_file</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-read" title="shishi_apreq_read ()">shishi_apreq_read</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-save" title="shishi_apreq_save ()">shishi_apreq_save</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-set-ticket" title="shishi_apreq_set_ticket ()">shishi_apreq_set_ticket</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-set-authenticator" title="shishi_apreq_set_authenticator ()">shishi_apreq_set_authenticator</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-add-authenticator" title="shishi_apreq_add_authenticator ()">shishi_apreq_add_authenticator</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-options" title="shishi_apreq_options ()">shishi_apreq_options</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t *flags);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-use-session-key-p" title="shishi_apreq_use_session_key_p ()">shishi_apreq_use_session_key_p</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-mutual-required-p" title="shishi_apreq_mutual_required_p ()">shishi_apreq_mutual_required_p</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-options-set" title="shishi_apreq_options_set ()">shishi_apreq_options_set</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t options);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-options-add" title="shishi_apreq_options_add ()">shishi_apreq_options_add</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t option);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-options-remove" title="shishi_apreq_options_remove ()">shishi_apreq_options_remove</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t option);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-get-ticket" title="shishi_apreq_get_ticket ()">shishi_apreq_get_ticket</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-get-authenticator-etype" title="shishi_apreq_get_authenticator_etype ()">shishi_apreq_get_authenticator_etype</a>
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int32_t *etype);
int                 <a class="link" href="shishi-shishi.html#shishi-apreq-decrypt" title="shishi_apreq_decrypt ()">shishi_apreq_decrypt</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-aprep" title="shishi_aprep ()">shishi_aprep</a>                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-print" title="shishi_aprep_print ()">shishi_aprep_print</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-save" title="shishi_aprep_save ()">shishi_aprep_save</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-to-file" title="shishi_aprep_to_file ()">shishi_aprep_to_file</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-read" title="shishi_aprep_read ()">shishi_aprep_read</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-parse" title="shishi_aprep_parse ()">shishi_aprep_parse</a>                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-from-file" title="shishi_aprep_from_file ()">shishi_aprep_from_file</a>              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-decrypt" title="shishi_aprep_decrypt ()">shishi_aprep_decrypt</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-verify" title="shishi_aprep_verify ()">shishi_aprep_verify</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-enc-part-set" title="shishi_aprep_enc_part_set ()">shishi_aprep_enc_part_set</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int etype,
                                                         const char *buf,
                                                         size_t buflen);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-enc-part-add" title="shishi_aprep_enc_part_add ()">shishi_aprep_enc_part_add</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-enc-part-make" title="shishi_aprep_enc_part_make ()">shishi_aprep_enc_part_make</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-aprep-get-enc-part-etype" title="shishi_aprep_get_enc_part_etype ()">shishi_aprep_get_enc_part_etype</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int32_t *etype);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-sendrecv" title="shishi_kdc_sendrecv ()">shishi_kdc_sendrecv</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         const char *indata,
                                                         size_t inlen,
                                                         char **outdata,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-kdc-sendrecv-hint" title="shishi_kdc_sendrecv_hint ()">shishi_kdc_sendrecv_hint</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         const char *indata,
                                                         size_t inlen,
                                                         char **outdata,
                                                         size_t *outlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-encticketpart" title="shishi_encticketpart ()">shishi_encticketpart</a>                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-key-set" title="shishi_encticketpart_key_set ()">shishi_encticketpart_key_set</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-get-key" title="shishi_encticketpart_get_key ()">shishi_encticketpart_get_key</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-crealm" title="shishi_encticketpart_crealm ()">shishi_encticketpart_crealm</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **crealm,
                                                         size_t *crealmlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-crealm-set" title="shishi_encticketpart_crealm_set ()">shishi_encticketpart_crealm_set</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *realm);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-client" title="shishi_encticketpart_client ()">shishi_encticketpart_client</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-clientrealm" title="shishi_encticketpart_clientrealm ()">shishi_encticketpart_clientrealm</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **client,
                                                         size_t *clientlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-cname-set" title="shishi_encticketpart_cname_set ()">shishi_encticketpart_cname_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *principal);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-print" title="shishi_encticketpart_print ()">shishi_encticketpart_print</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-flags-set" title="shishi_encticketpart_flags_set ()">shishi_encticketpart_flags_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         int flags);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-transited-set" title="shishi_encticketpart_transited_set ()">shishi_encticketpart_transited_set</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         int32_t trtype,
                                                         const char *trdata,
                                                         size_t trdatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-authtime-set" title="shishi_encticketpart_authtime_set ()">shishi_encticketpart_authtime_set</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *authtime);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-endtime-set" title="shishi_encticketpart_endtime_set ()">shishi_encticketpart_endtime_set</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *endtime);
int                 <a class="link" href="shishi-shishi.html#shishi-encticketpart-authtime" title="shishi_encticketpart_authtime ()">shishi_encticketpart_authtime</a>       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char *authtime,
                                                         size_t *authtimelen);
time_t              <a class="link" href="shishi-shishi.html#shishi-encticketpart-authctime" title="shishi_encticketpart_authctime ()">shishi_encticketpart_authctime</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);
int                 <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()">shishi_safe</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> **safe);
void                <a class="link" href="shishi-shishi.html#shishi-safe-done" title="shishi_safe_done ()">shishi_safe_done</a>                    (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-safe-key" title="shishi_safe_key ()">shishi_safe_key</a>                     (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);
void                <a class="link" href="shishi-shishi.html#shishi-safe-key-set" title="shishi_safe_key_set ()">shishi_safe_key_set</a>                 (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-safe-safe" title="shishi_safe_safe ()">shishi_safe_safe</a>                    (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);
void                <a class="link" href="shishi-shishi.html#shishi-safe-safe-set" title="shishi_safe_safe_set ()">shishi_safe_safe_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1safe);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-safe-der" title="shishi_safe_safe_der ()">shishi_safe_safe_der</a>                (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-safe-der-set" title="shishi_safe_safe_der_set ()">shishi_safe_safe_der_set</a>            (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-print" title="shishi_safe_print ()">shishi_safe_print</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-save" title="shishi_safe_save ()">shishi_safe_save</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-to-file" title="shishi_safe_to_file ()">shishi_safe_to_file</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-parse" title="shishi_safe_parse ()">shishi_safe_parse</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-read" title="shishi_safe_read ()">shishi_safe_read</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-from-file" title="shishi_safe_from_file ()">shishi_safe_from_file</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-cksum" title="shishi_safe_cksum ()">shishi_safe_cksum</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int32_t *cksumtype,
                                                         char **cksum,
                                                         size_t *cksumlen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-set-cksum" title="shishi_safe_set_cksum ()">shishi_safe_set_cksum</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int32_t cksumtype,
                                                         const char *cksum,
                                                         size_t cksumlen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-user-data" title="shishi_safe_user_data ()">shishi_safe_user_data</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         char **userdata,
                                                         size_t *userdatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-set-user-data" title="shishi_safe_set_user_data ()">shishi_safe_set_user_data</a>           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         const char *userdata,
                                                         size_t userdatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-build" title="shishi_safe_build ()">shishi_safe_build</a>                   (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-safe-verify" title="shishi_safe_verify ()">shishi_safe_verify</a>                  (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()">shishi_priv</a>                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> **priv);
void                <a class="link" href="shishi-shishi.html#shishi-priv-done" title="shishi_priv_done ()">shishi_priv_done</a>                    (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);
<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         <a class="link" href="shishi-shishi.html#shishi-priv-key" title="shishi_priv_key ()">shishi_priv_key</a>                     (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);
void                <a class="link" href="shishi-shishi.html#shishi-priv-key-set" title="shishi_priv_key_set ()">shishi_priv_key_set</a>                 (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-priv-priv" title="shishi_priv_priv ()">shishi_priv_priv</a>                    (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);
void                <a class="link" href="shishi-shishi.html#shishi-priv-priv-set" title="shishi_priv_priv_set ()">shishi_priv_priv_set</a>                (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1priv);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-priv-der" title="shishi_priv_priv_der ()">shishi_priv_priv_der</a>                (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-priv-der-set" title="shishi_priv_priv_der_set ()">shishi_priv_priv_der_set</a>            (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char *der,
                                                         size_t derlen);
<a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         <a class="link" href="shishi-shishi.html#shishi-priv-encprivpart" title="shishi_priv_encprivpart ()">shishi_priv_encprivpart</a>             (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);
void                <a class="link" href="shishi-shishi.html#shishi-priv-encprivpart-set" title="shishi_priv_encprivpart_set ()">shishi_priv_encprivpart_set</a>         (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1encprivpart);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-encprivpart-der" title="shishi_priv_encprivpart_der ()">shishi_priv_encprivpart_der</a>         (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char **out,
                                                         size_t *outlen);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-encprivpart-der-set" title="shishi_priv_encprivpart_der_set ()">shishi_priv_encprivpart_der_set</a>     (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char *der,
                                                         size_t derlen);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-print" title="shishi_priv_print ()">shishi_priv_print</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-save" title="shishi_priv_save ()">shishi_priv_save</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-to-file" title="shishi_priv_to_file ()">shishi_priv_to_file</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-parse" title="shishi_priv_parse ()">shishi_priv_parse</a>                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-read" title="shishi_priv_read ()">shishi_priv_read</a>                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-from-file" title="shishi_priv_from_file ()">shishi_priv_from_file</a>               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv,
                                                         int filetype,
                                                         const char *filename);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-enc-part-etype" title="shishi_priv_enc_part_etype ()">shishi_priv_enc_part_etype</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int32_t *etype);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-set-enc-part" title="shishi_priv_set_enc_part ()">shishi_priv_set_enc_part</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int32_t etype,
                                                         const char *encpart,
                                                         size_t encpartlen);
int                 <a class="link" href="shishi-shishi.html#shishi-encprivpart-user-data" title="shishi_encprivpart_user_data ()">shishi_encprivpart_user_data</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encprivpart,
                                                         char **userdata,
                                                         size_t *userdatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-encprivpart-set-user-data" title="shishi_encprivpart_set_user_data ()">shishi_encprivpart_set_user_data</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encprivpart,
                                                         const char *userdata,
                                                         size_t userdatalen);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-build" title="shishi_priv_build ()">shishi_priv_build</a>                   (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-priv-process" title="shishi_priv_process ()">shishi_priv_process</a>                 (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);
int                 <a class="link" href="shishi-shishi.html#shishi-authorized-p" title="shishi_authorized_p ()">shishi_authorized_p</a>                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *authzname);
int                 <a class="link" href="shishi-shishi.html#shishi-authorization-parse" title="shishi_authorization_parse ()">shishi_authorization_parse</a>          (const char *authorization);
int                 <a class="link" href="shishi-shishi.html#shishi-authorize-strcmp" title="shishi_authorize_strcmp ()">shishi_authorize_strcmp</a>             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal,
                                                         const char *authzname);
int                 <a class="link" href="shishi-shishi.html#shishi-authorize-k5login" title="shishi_authorize_k5login ()">shishi_authorize_k5login</a>            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal,
                                                         const char *authzname);
char*               <a class="link" href="shishi-shishi.html#shishi-x509ca-default-file-guess" title="shishi_x509ca_default_file_guess ()">shishi_x509ca_default_file_guess</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-x509ca-default-file-set" title="shishi_x509ca_default_file_set ()">shishi_x509ca_default_file_set</a>      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509cafile);
const char*         <a class="link" href="shishi-shishi.html#shishi-x509ca-default-file" title="shishi_x509ca_default_file ()">shishi_x509ca_default_file</a>          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
char*               <a class="link" href="shishi-shishi.html#shishi-x509cert-default-file-guess" title="shishi_x509cert_default_file_guess ()">shishi_x509cert_default_file_guess</a>  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-x509cert-default-file-set" title="shishi_x509cert_default_file_set ()">shishi_x509cert_default_file_set</a>    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509certfile);
const char*         <a class="link" href="shishi-shishi.html#shishi-x509cert-default-file" title="shishi_x509cert_default_file ()">shishi_x509cert_default_file</a>        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
char*               <a class="link" href="shishi-shishi.html#shishi-x509key-default-file-guess" title="shishi_x509key_default_file_guess ()">shishi_x509key_default_file_guess</a>   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
void                <a class="link" href="shishi-shishi.html#shishi-x509key-default-file-set" title="shishi_x509key_default_file_set ()">shishi_x509key_default_file_set</a>     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509keyfile);
const char*         <a class="link" href="shishi-shishi.html#shishi-x509key-default-file" title="shishi_x509key_default_file ()">shishi_x509key_default_file</a>         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);
time_t              <a class="link" href="shishi-shishi.html#shishi-get-date" title="shishi_get_date ()">shishi_get_date</a>                     (const char *p,
                                                         const time_t *now);
void                <a class="link" href="shishi-shishi.html#shishi-xalloc-die" title="shishi_xalloc_die ()">shishi_xalloc_die</a>                   (void);
<a class="link" href="shishi-shishi.html#Shishi-dns" title="Shishi_dns">Shishi_dns</a>          <a class="link" href="shishi-shishi.html#shishi-resolv" title="shishi_resolv ()">shishi_resolv</a>                       (const char *zone,
                                                         uint16_t querytype);
void                <a class="link" href="shishi-shishi.html#shishi-resolv-free" title="shishi_resolv_free ()">shishi_resolv_free</a>                  (<a class="link" href="shishi-shishi.html#Shishi-dns" title="Shishi_dns">Shishi_dns</a> rrs);
</pre>
</div>
<div class="refsect1" lang="en">
<a name="shishi-shishi.description"></a><h2>Description</h2>
<p>

</p>
</div>
<div class="refsect1" lang="en">
<a name="shishi-shishi.details"></a><h2>Details</h2>
<div class="refsect2" lang="en">
<a name="SHISHI-VERSION:CAPS"></a><h3>SHISHI_VERSION</h3>
<pre class="programlisting">#define SHISHI_VERSION "0.0.39"
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-rc"></a><h3>enum Shishi_rc</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_OK = 0,
  SHISHI_ASN1_ERROR = 1,
  SHISHI_FOPEN_ERROR = 2,
  SHISHI_IO_ERROR = 3,
  SHISHI_MALLOC_ERROR = 4,
  SHISHI_BASE64_ERROR = 5,
  SHISHI_REALM_MISMATCH = 6,
  SHISHI_CNAME_MISMATCH = 7,
  SHISHI_NONCE_MISMATCH = 8,
  SHISHI_TGSREP_BAD_KEYTYPE = 9,
  SHISHI_KDCREP_BAD_KEYTYPE = 10,
  SHISHI_APREP_BAD_KEYTYPE = 11,
  SHISHI_APREP_VERIFY_FAILED = 12,
  SHISHI_APREQ_BAD_KEYTYPE = 13,
  SHISHI_TOO_SMALL_BUFFER = 14,
  SHISHI_DERIVEDKEY_TOO_SMALL = 15,
  SHISHI_KEY_TOO_LARGE = 16,
  SHISHI_CRYPTO_ERROR = 17,
  SHISHI_CRYPTO_INTERNAL_ERROR = 18,
  SHISHI_SOCKET_ERROR = 19,
  SHISHI_BIND_ERROR = 20,
  SHISHI_SENDTO_ERROR = 21,
  SHISHI_RECVFROM_ERROR = 22,
  SHISHI_CLOSE_ERROR = 23,
  SHISHI_KDC_TIMEOUT = 24,
  SHISHI_KDC_NOT_KNOWN_FOR_REALM = 25,
  SHISHI_TTY_ERROR = 26,
  SHISHI_GOT_KRBERROR = 27,
  SHISHI_HANDLE_ERROR = 28,
  SHISHI_INVALID_TKTS = 29,
  SHISHI_TICKET_BAD_KEYTYPE = 30,
  SHISHI_INVALID_KEY = 31,
  SHISHI_APREQ_DECRYPT_FAILED = 32,
  SHISHI_TICKET_DECRYPT_FAILED = 33,
  SHISHI_INVALID_TICKET = 34,
  SHISHI_OUT_OF_RANGE = 35,
  SHISHI_ASN1_NO_ELEMENT = 36,
  SHISHI_SAFE_BAD_KEYTYPE = 37,
  SHISHI_SAFE_VERIFY_FAILED = 38,
  SHISHI_PKCS5_INVALID_PRF = 39,
  SHISHI_PKCS5_INVALID_ITERATION_COUNT = 40,
  SHISHI_PKCS5_INVALID_DERIVED_KEY_LENGTH = 41,
  SHISHI_PKCS5_DERIVED_KEY_TOO_LONG = 42,
  SHISHI_INVALID_PRINCIPAL_NAME = 43,
  SHISHI_INVALID_ARGUMENT = 44,
  SHISHI_ASN1_NO_VALUE = 45,
  SHISHI_CONNECT_ERROR = 46,
  SHISHI_VERIFY_FAILED = 47,
  SHISHI_PRIV_BAD_KEYTYPE = 48,
  SHISHI_FILE_ERROR = 49,
  SHISHI_ENCAPREPPART_BAD_KEYTYPE = 50,
  SHISHI_GETTIMEOFDAY_ERROR = 51,
  SHISHI_KEYTAB_ERROR = 52,
  SHISHI_CCACHE_ERROR = 53,
  SHISHI_LAST_ERROR = 53
}
Shishi_rc;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-name-type"></a><h3>enum Shishi_name_type</h3>
<pre class="programlisting">typedef enum
{
  /* Name type not known */
  SHISHI_NT_UNKNOWN = 0,
  /* Just the name of the principal as in DCE, or for users */
  SHISHI_NT_PRINCIPAL = 1,
  /* Service and other unique instance (krbtgt) */
  SHISHI_NT_SRV_INST = 2,
  /* Service with host name as instance (telnet, rcommands) */
  SHISHI_NT_SRV_HST = 3,
  /* Service with host as remaining components */
  SHISHI_NT_SRV_XHST = 4,
  /* Unique ID */
  SHISHI_NT_UID = 5,
  /* Encoded X.509 Distingished name [RFC 2253] */
  SHISHI_NT_X500_PRINCIPAL = 6,
  /* Name in form of SMTP email name (e.g. user@foo.com) */
  SHISHI_NT_SMTP_NAME = 7,
  /*  Enterprise name - may be mapped to principal name */
  SHISHI_NT_ENTERPRISE = 10
}
Shishi_name_type;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-padata-type"></a><h3>enum Shishi_padata_type</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_PA_TGS_REQ = 1,
  SHISHI_PA_ENC_TIMESTAMP = 2,
  SHISHI_PA_PW_SALT = 3,
  SHISHI_PA_RESERVED = 4,
  SHISHI_PA_ENC_UNIX_TIME = 5,	/* (deprecated) */
  SHISHI_PA_SANDIA_SECUREID = 6,
  SHISHI_PA_SESAME = 7,
  SHISHI_PA_OSF_DCE = 8,
  SHISHI_PA_CYBERSAFE_SECUREID = 9,
  SHISHI_PA_AFS3_SALT = 10,
  SHISHI_PA_ETYPE_INFO = 11,
  SHISHI_PA_SAM_CHALLENGE = 12,	/* (sam/otp) */
  SHISHI_PA_SAM_RESPONSE = 13,	/* (sam/otp) */
  SHISHI_PA_PK_AS_REQ = 14,	/* (pkinit) */
  SHISHI_PA_PK_AS_REP = 15,	/* (pkinit) */
  SHISHI_PA_ETYPE_INFO2 = 19,	/* (replaces pa_etype_info) */
  SHISHI_PA_USE_SPECIFIED_KVNO = 20,
  SHISHI_PA_SAM_REDIRECT = 21,	/* (sam/otp) */
  SHISHI_PA_GET_FROM_TYPED_DATA = 22,	/* (embedded in typed data) */
  SHISHI_TD_PADATA = 22,	/* (embeds padata) */
  SHISHI_PA_SAM_ETYPE_INFO = 23,	/* (sam/otp) */
  SHISHI_PA_ALT_PRINC = 24,	/* (crawdad@fnal.gov) */
  SHISHI_PA_SAM_CHALLENGE2 = 30,	/* (kenh@pobox.com) */
  SHISHI_PA_SAM_RESPONSE2 = 31,	/* (kenh@pobox.com) */
  SHISHI_PA_EXTRA_TGT = 41,	/* Reserved extra TGT */
  SHISHI_TD_PKINIT_CMS_CERTIFICATES = 101,	/* CertificateSet from CMS */
  SHISHI_TD_KRB_PRINCIPAL = 102,	/* PrincipalName */
  SHISHI_TD_KRB_REALM = 103,	/* Realm */
  SHISHI_TD_TRUSTED_CERTIFIERS = 104,	/* from PKINIT */
  SHISHI_TD_CERTIFICATE_INDEX = 105,	/* from PKINIT */
  SHISHI_TD_APP_DEFINED_ERROR = 106,	/* application specific */
  SHISHI_TD_REQ_NONCE = 107,	/* INTEGER */
  SHISHI_TD_REQ_SEQ = 108,	/* INTEGER */
  SHISHI_PA_PAC_REQUEST = 128	/* (jbrezak@exchange.microsoft.com) */
}
Shishi_padata_type;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tr-type"></a><h3>enum Shishi_tr_type</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_TR_DOMAIN_X500_COMPRESS = 1
}
Shishi_tr_type;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-apoptions"></a><h3>enum Shishi_apoptions</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_APOPTIONS_RESERVED = 0x1,	/* bit 0 */
  SHISHI_APOPTIONS_USE_SESSION_KEY = 0x2,	/* bit 1 */
  SHISHI_APOPTIONS_MUTUAL_REQUIRED = 0x4	/* bit 2 */
}
Shishi_apoptions;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-ticketflags"></a><h3>enum Shishi_ticketflags</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_TICKETFLAGS_RESERVED = 0x1,	/* bit 0 */
  SHISHI_TICKETFLAGS_FORWARDABLE = 0x2,	/* bit 1 */
  SHISHI_TICKETFLAGS_FORWARDED = 0x4,	/* bit 2 */
  SHISHI_TICKETFLAGS_PROXIABLE = 0x8,	/* bit 3 */
  SHISHI_TICKETFLAGS_PROXY = 0x10,	/* bit 4 */
  SHISHI_TICKETFLAGS_MAY_POSTDATE = 0x20,	/* bit 5 */
  SHISHI_TICKETFLAGS_POSTDATED = 0x40,	/* bit 6 */
  SHISHI_TICKETFLAGS_INVALID = 0x80,	/* bit 7 */
  SHISHI_TICKETFLAGS_RENEWABLE = 0x100,	/* bit 8 */
  SHISHI_TICKETFLAGS_INITIAL = 0x200,	/* bit 9 */
  SHISHI_TICKETFLAGS_PRE_AUTHENT = 0x400,	/* bit 10 */
  SHISHI_TICKETFLAGS_HW_AUTHENT = 0x800,	/* bit 11 */
  SHISHI_TICKETFLAGS_TRANSITED_POLICY_CHECKED = 0x1000,	/* bit 12 */
  SHISHI_TICKETFLAGS_OK_AS_DELEGATE = 0x2000	/* bit 13 */
}
Shishi_ticketflags;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-KDCOptions"></a><h3>enum Shishi_KDCOptions</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_KDCOPTIONS_RESERVED = 0x1,	/* bit 0 */
  SHISHI_KDCOPTIONS_FORWARDABLE = 0x2,	/* bit 1 */
  SHISHI_KDCOPTIONS_FORWARDED = 0x4,	/* bit 2 */
  SHISHI_KDCOPTIONS_PROXIABLE = 0x8,	/* bit 3 */
  SHISHI_KDCOPTIONS_PROXY = 0x10,	/* bit 4 */
  SHISHI_KDCOPTIONS_ALLOW_POSTDATE = 0x20,	/* bit 5 */
  SHISHI_KDCOPTIONS_POSTDATED = 0x40,	/* bit 6 */
  SHISHI_KDCOPTIONS_UNUSED7 = 0x80,	/* bit 7 */
  SHISHI_KDCOPTIONS_RENEWABLE = 0x100,	/* bit 8 */
  SHISHI_KDCOPTIONS_UNUSED9 = 0x200,	/* bit 9 */
  SHISHI_KDCOPTIONS_UNUSED10 = 0x400,	/* bit 10 */
  SHISHI_KDCOPTIONS_UNUSED11 = 0x800	/* bit 11 */
#define SHISHI_KDCOPTIONS_DISABLE_TRANSITED_CHECK 0x4000000	/* bit 26 */
#define SHISHI_KDCOPTIONS_RENEWABLE_OK		  0x8000000	/* bit 27 */
#define SHISHI_KDCOPTIONS_ENC_TKT_IN_SKEY	  0x10000000	/* bit 28 */
#define SHISHI_KDCOPTIONS_RENEW			  0x40000000	/* bit 30 */
#define SHISHI_KDCOPTIONS_VALIDATE		  0x80000000	/* bit 31 */
}
Shishi_KDCOptions;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-msgtype"></a><h3>enum Shishi_msgtype</h3>
<pre class="programlisting">typedef enum
{
  /* 0                             unused */
  /* 1              Ticket         PDU */
  /* 2              Authenticator  non-PDU */
  /* 3              EncTicketPart  non-PDU */
  /* 4-9                           unused */
  /* Request for initial authentication */
  SHISHI_MSGTYPE_AS_REQ = 10,
  /* Response to SHISHI_MSGTYPE_AS_REQ request */
  SHISHI_MSGTYPE_AS_REP = 11,
  /* Request for authentication based on TGT */
  SHISHI_MSGTYPE_TGS_REQ = 12,
  /* Response to SHISHI_MSGTYPE_TGS_REQ request */
  SHISHI_MSGTYPE_TGS_REP = 13,
  /* application request to server */
  SHISHI_MSGTYPE_AP_REQ = 14,
  /* Response to SHISHI_MSGTYPE_AP_REQ_MUTUAL */
  SHISHI_MSGTYPE_AP_REP = 15,
  /* Reserved for user-to-user krb_tgt_request */
  SHISHI_MSGTYPE_RESERVED16 = 16,
  /* Reserved for user-to-user krb_tgt_reply */
  SHISHI_MSGTYPE_RESERVED17 = 17,
  /* 18-19                         unused */
  /* Safe (checksummed) application message */
  SHISHI_MSGTYPE_SAFE = 20,
  /* Private (encrypted) application message */
  SHISHI_MSGTYPE_PRIV = 21,
  /* Private (encrypted) message to forward credentials */
  SHISHI_MSGTYPE_CRED = 22,
  /* 23-24                         unused */
  /* 25             EncASRepPart   non-PDU */
  /* 26             EncTGSRepPart  non-PDU */
  /* 27             EncApRepPart   non-PDU */
  /* 28             EncKrbPrivPart non-PDU */
  /* 29             EncKrbCredPart non-PDU */
  /* Error response */
  SHISHI_MSGTYPE_ERROR = 30
}
Shishi_msgtype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-lrtype"></a><h3>enum Shishi_lrtype</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_LRTYPE_LAST_INITIAL_TGT_REQUEST = 1,
  SHISHI_LRTYPE_LAST_INITIAL_REQUEST = 2,
  SHISHI_LRTYPE_NEWEST_TGT_ISSUE = 3,
  SHISHI_LRTYPE_LAST_RENEWAL = 4,
  SHISHI_LRTYPE_LAST_REQUEST = 5
}
Shishi_lrtype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-etype"></a><h3>enum Shishi_etype</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_NULL = 0,
  SHISHI_DES_CBC_CRC = 1,
  SHISHI_DES_CBC_MD4 = 2,
  SHISHI_DES_CBC_MD5 = 3,
  SHISHI_DES_CBC_NONE = 4,
  SHISHI_DES3_CBC_NONE = 6,
  SHISHI_DES3_CBC_HMAC_SHA1_KD = 16,
  SHISHI_AES128_CTS_HMAC_SHA1_96 = 17,
  SHISHI_AES256_CTS_HMAC_SHA1_96 = 18,
  SHISHI_ARCFOUR_HMAC = 23,
  SHISHI_ARCFOUR_HMAC_EXP = 24
}
Shishi_etype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-cksumtype"></a><h3>enum Shishi_cksumtype</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_CRC32 = 1,
  SHISHI_RSA_MD4 = 2,
  SHISHI_RSA_MD4_DES = 3,
  SHISHI_DES_MAC = 4,
  SHISHI_DES_MAC_K = 5,
  SHISHI_RSA_MD4_DES_K = 6,
  SHISHI_RSA_MD5 = 7,
  SHISHI_RSA_MD5_DES = 8,
  SHISHI_RSA_MD5_DES_GSS = 9,	/* XXX */
  SHISHI_HMAC_SHA1_DES3_KD = 12,
  SHISHI_HMAC_SHA1_96_AES128 = 15,
  SHISHI_HMAC_SHA1_96_AES256 = 16,
  SHISHI_ARCFOUR_HMAC_MD5 = -138,
  SHISHI_KRB5_GSSAPI_CKSUM = 8003,
  SHISHI_NO_CKSUMTYPE = -1
}
Shishi_cksumtype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-filetype"></a><h3>enum Shishi_filetype</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_FILETYPE_TEXT = 0,
  SHISHI_FILETYPE_DER,
  SHISHI_FILETYPE_HEX,
  SHISHI_FILETYPE_BASE64,
  SHISHI_FILETYPE_BINARY
}
Shishi_filetype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-outputtype"></a><h3>enum Shishi_outputtype</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_OUTPUTTYPE_NULL = 0,
  SHISHI_OUTPUTTYPE_STDERR,
  SHISHI_OUTPUTTYPE_SYSLOG
}
Shishi_outputtype;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-authorization"></a><h3>enum Shishi_authorization</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_AUTHORIZATION_BASIC = 0,
  SHISHI_AUTHORIZATION_K5LOGIN
}
Shishi_authorization;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-keyusage"></a><h3>enum Shishi_keyusage</h3>
<pre class="programlisting">typedef enum
{
  /* 1. AS-REQ PA-ENC-TIMESTAMP padata timestamp, encrypted with the
     client key */
  SHISHI_KEYUSAGE_ASREQ_PA_ENC_TIMESTAMP = 1,
  /* 2. AS-REP Ticket and TGS-REP Ticket (includes TGS session key or
     application session key), encrypted with the service key  */
  SHISHI_KEYUSAGE_ENCTICKETPART = 2,
  /* 3. AS-REP encrypted part (includes TGS session key or application
     session key), encrypted with the client key */
  SHISHI_KEYUSAGE_ENCASREPPART = 3,
  /* 4. TGS-REQ KDC-REQ-BODY AuthorizationData, encrypted with the TGS
     session key  */
  SHISHI_KEYUSAGE_TGSREQ_AUTHORIZATIONDATA_TGS_SESSION_KEY = 4,
  /* 5. TGS-REQ KDC-REQ-BODY AuthorizationData, encrypted with the TGS
     authenticator subkey (section 5.4.1) */
  SHISHI_KEYUSAGE_TGSREQ_AUTHORIZATIONDATA_TGS_AUTHENTICATOR_KEY = 5,
  /* 6. TGS-REQ PA-TGS-REQ padata AP-REQ Authenticator cksum, keyed with the
     TGS session key  */
  SHISHI_KEYUSAGE_TGSREQ_APREQ_AUTHENTICATOR_CKSUM = 6,
  /* 7. TGS-REQ PA-TGS-REQ padata AP-REQ Authenticator (includes TGS
     authenticator subkey), encrypted with the TGS session key */
  SHISHI_KEYUSAGE_TGSREQ_APREQ_AUTHENTICATOR = 7,
  /* 8. TGS-REP encrypted part (includes application session key), encrypted
     with the TGS session key */
  SHISHI_KEYUSAGE_ENCTGSREPPART_SESSION_KEY = 8,
  /* 9. TGS-REP encrypted part (includes application session key), encrypted
     with the TGS authenticator subkey */
  SHISHI_KEYUSAGE_ENCTGSREPPART_AUTHENTICATOR_KEY = 9,
  /* 10. AP-REQ Authenticator cksum, keyed with the application
     session key */
  SHISHI_KEYUSAGE_APREQ_AUTHENTICATOR_CKSUM = 10,
  /* 11. AP-REQ Authenticator (includes application authenticator subkey),
     encrypted with the application session key */
  SHISHI_KEYUSAGE_APREQ_AUTHENTICATOR = 11,
  /* 12. AP-REP encrypted part (includes application session subkey),
     encrypted with the application session key */
  SHISHI_KEYUSAGE_ENCAPREPPART = 12,
  /* 13. KRB-PRIV encrypted part, encrypted with a key chosen by the
     application */
  SHISHI_KEYUSAGE_KRB_PRIV = 13,
  /* 14. KRB-CRED encrypted part, encrypted with a key chosen by the
     application */
  SHISHI_KEYUSAGE_KRB_CRED = 14,
  /* 15. KRB-SAFE cksum, keyed with a key chosen by the application */
  SHISHI_KEYUSAGE_KRB_SAFE = 15,
  /* 18. KRB-ERROR checksum (e-cksum) */
  SHISHI_KEYUSAGE_KRB_ERROR = 18,
  /* 19. AD-KDCIssued checksum (ad-checksum) */
  SHISHI_KEYUSAGE_AD_KDCISSUED = 19,
  /* 20. Checksum for Mandatory Ticket Extensions */
  SHISHI_KEYUSAGE_TICKET_EXTENSION = 20,
  /* 21. Checksum in Authorization Data in Ticket Extensions */
  SHISHI_KEYUSAGE_TICKET_EXTENSION_AUTHORIZATION = 21,
  /* 22-24. Reserved for use in GSSAPI mechanisms derived from RFC 1964.
     (raeburn/MIT) */
  SHISHI_KEYUSAGE_GSS_R1 = 22,
  SHISHI_KEYUSAGE_GSS_R2 = 23,
  SHISHI_KEYUSAGE_GSS_R3 = 24,
  /* draft-ietf-krb-wg-gssapi-cfx */
  SHISHI_KEYUSAGE_ACCEPTOR_SEAL = 22,
  SHISHI_KEYUSAGE_ACCEPTOR_SIGN = 23,
  SHISHI_KEYUSAGE_INITIATOR_SEAL = 24,
  SHISHI_KEYUSAGE_INITIATOR_SIGN = 25,
  /* 16-18,20-21,25-511. Reserved for future use. */
  /* 512-1023.  Reserved for uses internal implementations. */
  /* 1024.         Encryption for application use in protocols that
     do not specify key usage values */
  /* 1025.         Checksums for application use in protocols that
     do not specify key usage values */
  /* 1026-2047.      Reserved for application use.
     1026,1028,1030,1032,1034 used in KCMD protocol */
  SHISHI_KEYUSAGE_KCMD_DES = 1026,
  SHISHI_KEYUSAGE_KCMD_INPUT = 1028,
  SHISHI_KEYUSAGE_KCMD_OUTPUT = 1030,
  SHISHI_KEYUSAGE_KCMD_STDERR_INPUT = 1032,
  SHISHI_KEYUSAGE_KCMD_STDERR_OUTPUT = 1034
}
Shishi_keyusage;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-krb-error"></a><h3>enum Shishi_krb_error</h3>
<pre class="programlisting">typedef enum
{
  /* No error */
  SHISHI_KDC_ERR_NONE = 0,
  /* Client's entry in database has expired */
  SHISHI_KDC_ERR_NAME_EXP = 1,
  /* Server's entry in database has expired */
  SHISHI_KDC_ERR_SERVICE_EXP = 2,
  /* Requested protocol version number  - not supported */
  SHISHI_KDC_ERR_BAD_PVNO = 3,
  /* Client's key encrypted in old master key */
  SHISHI_KDC_ERR_C_OLD_MAST_KVNO = 4,
  /* Server's key encrypted in old master key */
  SHISHI_KDC_ERR_S_OLD_MAST_KVNO = 5,
  /* Client not found in database */
  SHISHI_KDC_ERR_C_PRINCIPAL_UNKNOWN = 6,
  /* Server not found in database */
  SHISHI_KDC_ERR_S_PRINCIPAL_UNKNOWN = 7,
  /* Multiple principal entries in database */
  SHISHI_KDC_ERR_PRINCIPAL_NOT_UNIQUE = 8,
  /* The client or server has a null key */
  SHISHI_KDC_ERR_NULL_KEY = 9,
  /* Ticket not eligible for postdating */
  SHISHI_KDC_ERR_CANNOT_POSTDATE = 10,
  /* Requested start time is later than end time */
  SHISHI_KDC_ERR_NEVER_VALID = 11,
  /* KDC policy rejects request */
  SHISHI_KDC_ERR_POLICY = 12,
  /* KDC cannot accommodate requested option */
  SHISHI_KDC_ERR_BADOPTION = 13,
  /* KDC has no support for encryption type */
  SHISHI_KDC_ERR_ETYPE_NOSUPP = 14,
  /* KDC has no support for checksum type */
  SHISHI_KDC_ERR_SUMTYPE_NOSUPP = 15,
  /* KDC has no support for padata type */
  SHISHI_KDC_ERR_PADATA_TYPE_NOSUPP = 16,
  /* KDC has no support for transited type */
  SHISHI_KDC_ERR_TRTYPE_NOSUPP = 17,
  /* Clients credentials have been revoked */
  SHISHI_KDC_ERR_CLIENT_REVOKED = 18,
  /* Credentials for server have been revoked */
  SHISHI_KDC_ERR_SERVICE_REVOKED = 19,
  /* TGT has been revoked */
  SHISHI_KDC_ERR_TGT_REVOKED = 20,
  /* Client not yet valid - try again later */
  SHISHI_KDC_ERR_CLIENT_NOTYET = 21,
  /* Server not yet valid - try again later */
  SHISHI_KDC_ERR_SERVICE_NOTYET = 22,
  /* Password has expired - change password to reset */
  SHISHI_KDC_ERR_KEY_EXPIRED = 23,
  /* Pre-authentication information was invalid */
  SHISHI_KDC_ERR_PREAUTH_FAILED = 24,
  /* Additional pre-authenticationrequired */
  SHISHI_KDC_ERR_PREAUTH_REQUIRED = 25,
  /* Requested server and ticket don't match */
  SHISHI_KDC_ERR_SERVER_NOMATCH = 26,
  /* Server principal valid for user = 2,user only */
  SHISHI_KDC_ERR_MUST_USE_USER2USER = 27,
  /* KDC Policy rejects transited path */
  SHISHI_KDC_ERR_PATH_NOT_ACCPETED = 28,
  /* A service is not available */
  SHISHI_KDC_ERR_SVC_UNAVAILABLE = 29,
  /* Integrity check on decrypted field failed */
  SHISHI_KRB_AP_ERR_BAD_INTEGRITY = 31,
  /* Ticket expired */
  SHISHI_KRB_AP_ERR_TKT_EXPIRED = 32,
  /* Ticket not yet valid */
  SHISHI_KRB_AP_ERR_TKT_NYV = 33,
  /* Request is a replay */
  SHISHI_KRB_AP_ERR_REPEAT = 34,
  /* The ticket isn't for us */
  SHISHI_KRB_AP_ERR_NOT_US = 35,
  /* Ticket and authenticator don't match */
  SHISHI_KRB_AP_ERR_BADMATCH = 36,
  /* Clock skew too great */
  SHISHI_KRB_AP_ERR_SKEW = 37,
  /* Incorrect net address */
  SHISHI_KRB_AP_ERR_BADADDR = 38,
  /* Protocol version mismatch */
  SHISHI_KRB_AP_ERR_BADVERSION = 39,
  /* Invalid msg type */
  SHISHI_KRB_AP_ERR_MSG_TYPE = 40,
  /* Message stream modified */
  SHISHI_KRB_AP_ERR_MODIFIED = 41,
  /* Message out of order */
  SHISHI_KRB_AP_ERR_BADORDER = 42,
  /* Specified version of key is not available */
  SHISHI_KRB_AP_ERR_BADKEYVER = 44,
  /* Service key not available */
  SHISHI_KRB_AP_ERR_NOKEY = 45,
  /* Mutual authentication failed */
  SHISHI_KRB_AP_ERR_MUT_FAIL = 46,
  /* Incorrect message direction */
  SHISHI_KRB_AP_ERR_BADDIRECTION = 47,
  /* Alternative authentication method required */
  SHISHI_KRB_AP_ERR_METHOD = 48,
  /* Incorrect sequence number in message */
  SHISHI_KRB_AP_ERR_BADSEQ = 49,
  /* Inappropriate type of checksum in message */
  SHISHI_KRB_AP_ERR_INAPP_CKSUM = 50,
  /* Policy rejects transited path */
  SHISHI_KRB_AP_PATH_NOT_ACCEPTED = 51,
  /* Response too big for UDP, retry with TCP */
  SHISHI_KRB_ERR_RESPONSE_TOO_BIG = 52,
  /* Generic error (description in e-text) */
  SHISHI_KRB_ERR_GENERIC = 60,
  /* Field is too long for this implementation */
  SHISHI_KRB_ERR_FIELD_TOOLONG = 61,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERROR_CLIENT_NOT_TRUSTED = 62,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERROR_KDC_NOT_TRUSTED = 63,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERROR_INVALID_SIG = 64,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_KEY_TOO_WEAK = 65,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_CERTIFICATE_MISMATCH = 66,
  /* No TGT available to validate USER-TO-USER */
  SHISHI_KRB_AP_ERR_NO_TGT = 67,
  /* USER-TO-USER TGT issued different KDC */
  SHISHI_KDC_ERR_WRONG_REALM = 68,
  /* Ticket must be for USER-TO-USER */
  SHISHI_KRB_AP_ERR_USER_TO_USER_REQUIRED = 69,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_CANT_VERIFY_CERTIFICATE = 70,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_INVALID_CERTIFICATE = 71,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_REVOKED_CERTIFICATE = 72,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_REVOCATION_STATUS_UNKNOWN = 73,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_REVOCATION_STATUS_UNAVAILABLE = 74,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_CLIENT_NAME_MISMATCH = 75,
  /* Reserved for PKINIT */
  SHISHI_KDC_ERR_KDC_NAME_MISMATCH = 76,
  SHISHI_LAST_ERROR_CODE = 76
}
Shishi_krb_error;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tkts-hintflags"></a><h3>enum Shishi_tkts_hintflags</h3>
<pre class="programlisting">typedef enum
{
  SHISHI_TKTSHINTFLAGS_ACCEPT_EXPIRED = 1,
  SHISHI_TKTSHINTFLAGS_NON_INTERACTIVE = 2
}
Shishi_tkts_hintflags;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tkts-hint"></a><h3>Shishi_tkts_hint</h3>
<pre class="programlisting">typedef struct Shishi_tkts_hint Shishi_tkts_hint;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="SHISHI-DNS-IN:CAPS"></a><h3>SHISHI_DNS_IN</h3>
<pre class="programlisting">#define SHISHI_DNS_IN 1
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="SHISHI-DNS-TXT:CAPS"></a><h3>SHISHI_DNS_TXT</h3>
<pre class="programlisting">#define SHISHI_DNS_TXT 16
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="SHISHI-DNS-SRV:CAPS"></a><h3>SHISHI_DNS_SRV</h3>
<pre class="programlisting">#define SHISHI_DNS_SRV 33
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-dns"></a><h3>Shishi_dns</h3>
<pre class="programlisting">typedef struct Shishi_dns_st *Shishi_dns;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-dns-srv"></a><h3>Shishi_dns_srv</h3>
<pre class="programlisting">typedef struct Shishi_dns_srv_st *Shishi_dns_srv;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi"></a><h3>Shishi</h3>
<pre class="programlisting">typedef struct Shishi Shishi;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tkt"></a><h3>Shishi_tkt</h3>
<pre class="programlisting">typedef struct Shishi_tkt Shishi_tkt;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tkts"></a><h3>Shishi_tkts</h3>
<pre class="programlisting">typedef struct Shishi_tkts Shishi_tkts;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-as"></a><h3>Shishi_as</h3>
<pre class="programlisting">typedef struct Shishi_as Shishi_as;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-tgs"></a><h3>Shishi_tgs</h3>
<pre class="programlisting">typedef struct Shishi_tgs Shishi_tgs;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-ap"></a><h3>Shishi_ap</h3>
<pre class="programlisting">typedef struct Shishi_ap Shishi_ap;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-key"></a><h3>Shishi_key</h3>
<pre class="programlisting">typedef struct Shishi_key Shishi_key;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-keys"></a><h3>Shishi_keys</h3>
<pre class="programlisting">typedef struct Shishi_keys Shishi_keys;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-safe"></a><h3>Shishi_safe</h3>
<pre class="programlisting">typedef struct Shishi_safe Shishi_safe;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-priv"></a><h3>Shishi_priv</h3>
<pre class="programlisting">typedef struct Shishi_priv Shishi_priv;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-asn1"></a><h3>Shishi_asn1</h3>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="Shishi-crypto"></a><h3>Shishi_crypto</h3>
<pre class="programlisting">typedef struct Shishi_crypto Shishi_crypto;
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="SHISHI-GENERALIZEDTIME-LENGTH:CAPS"></a><h3>SHISHI_GENERALIZEDTIME_LENGTH</h3>
<pre class="programlisting">#define SHISHI_GENERALIZEDTIME_LENGTH 15
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="SHISHI-GENERALIZEDTIMEZ-LENGTH:CAPS"></a><h3>SHISHI_GENERALIZEDTIMEZ_LENGTH</h3>
<pre class="programlisting">#define SHISHI_GENERALIZEDTIMEZ_LENGTH (SHISHI_GENERALIZEDTIME_LENGTH + 1)
</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-alloc-fail-function"></a><h3>shishi_alloc_fail_function ()</h3>
<pre class="programlisting">void                shishi_alloc_fail_function          (void);</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi"></a><h3>shishi ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a>*             shishi                              (void);</pre>
<p>
Initializes the Shishi library, and set up, using
<a class="link" href="shishi-shishi.html#shishi-error-set-outputtype" title="shishi_error_set_outputtype ()"><code class="function">shishi_error_set_outputtype()</code></a>, the library so that future warnings
and informational messages are printed to stderr.  If this function
fails, it may print diagnostic errors to stderr.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns Shishi library handle, or <code class="literal">NULL</code> on error.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-server"></a><h3>shishi_server ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a>*             shishi_server                       (void);</pre>
<p>
Initializes the Shishi library, and set up, using
<a class="link" href="shishi-shishi.html#shishi-error-set-outputtype" title="shishi_error_set_outputtype ()"><code class="function">shishi_error_set_outputtype()</code></a>, the library so that future warnings
and informational messages are printed to the syslog.  If this
function fails, it may print diagnostic errors to the syslog.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns Shishi library handle, or <code class="literal">NULL</code> on error.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-done"></a><h3>shishi_done ()</h3>
<pre class="programlisting">void                shishi_done                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Deallocates the shishi library handle.  The handle must not be used
in any calls to shishi functions after this.
</p>
<p>
If there is a default tkts, it is written to the default tkts file
(call <a class="link" href="shishi-shishi.html#shishi-tkts-default-file-set" title="shishi_tkts_default_file_set ()"><code class="function">shishi_tkts_default_file_set()</code></a> to change the default tkts
file). If you do not wish to write the default tkts file, close the
default tkts with shishi_tkts_done(handle, NULL) before calling
this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-init"></a><h3>shishi_init ()</h3>
<pre class="programlisting">int                 shishi_init                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle);</pre>
<p>
Create a Shishi library handle, using <a class="link" href="shishi-shishi.html#shishi" title="shishi ()"><code class="function">shishi()</code></a>, and read the system
configuration file, user configuration file and user tickets from
their default locations.  The paths to the system configuration
file is decided at compile time, and is $sysconfdir/shishi.conf.
The user configuration file is $HOME/.shishi/config, and the user
ticket file is $HOME/.shishi/ticket.
</p>
<p>
The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the files.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> pointer to handle to be created.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-init-with-paths"></a><h3>shishi_init_with_paths ()</h3>
<pre class="programlisting">int                 shishi_init_with_paths              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle,
                                                         const char *tktsfile,
                                                         const char *systemcfgfile,
                                                         const char *usercfgfile);</pre>
<p>
Create a Shishi library handle, using <a class="link" href="shishi-shishi.html#shishi" title="shishi ()"><code class="function">shishi()</code></a>, and read the system
configuration file, user configuration file, and user tickets from
the specified locations.  If any of <em class="parameter"><code>usercfgfile</code></em> or <em class="parameter"><code>systemcfgfile</code></em>
is NULL, the file is read from its default location, which for the
system configuration file is decided at compile time, and is
$sysconfdir/shishi.conf, and for the user configuration file is
$HOME/.shishi/config.  If the ticket file is NULL, a ticket file is
not read at all.
</p>
<p>
The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the files.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> pointer to handle to be created.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tktsfile</code></em> :</span></p></td>
<td> Filename of ticket file, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>systemcfgfile</code></em> :</span></p></td>
<td> Filename of system configuration, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>usercfgfile</code></em> :</span></p></td>
<td> Filename of user configuration, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-init-server"></a><h3>shishi_init_server ()</h3>
<pre class="programlisting">int                 shishi_init_server                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle);</pre>
<p>
Create a Shishi library handle, using <a class="link" href="shishi-shishi.html#shishi-server" title="shishi_server ()"><code class="function">shishi_server()</code></a>, and read the
system configuration file.  The paths to the system configuration
file is decided at compile time, and is $sysconfdir/shishi.conf.
</p>
<p>
The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the file.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> pointer to handle to be created.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-init-server-with-paths"></a><h3>shishi_init_server_with_paths ()</h3>
<pre class="programlisting">int                 shishi_init_server_with_paths       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> **handle,
                                                         const char *systemcfgfile);</pre>
<p>
Create a Shishi library handle, using <a class="link" href="shishi-shishi.html#shishi-server" title="shishi_server ()"><code class="function">shishi_server()</code></a>, and read the
system configuration file from specified location.  The paths to
the system configuration file is decided at compile time, and is
$sysconfdir/shishi.conf.  The handle is allocated regardless of
return values, except for SHISHI_HANDLE_ERROR which indicates a
problem allocating the handle.  (The other error conditions comes
from reading the file.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> pointer to handle to be created.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>systemcfgfile</code></em> :</span></p></td>
<td> Filename of system configuration, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg"></a><h3>shishi_cfg ()</h3>
<pre class="programlisting">int                 shishi_cfg                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *option);</pre>
<p>
Configure shishi library with given option.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>option</code></em> :</span></p></td>
<td> string with shishi library option.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if option was valid.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-from-file"></a><h3>shishi_cfg_from_file ()</h3>
<pre class="programlisting">int                 shishi_cfg_from_file                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *cfg);</pre>
<p>
Configure shishi library using configuration file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cfg</code></em> :</span></p></td>
<td> filename to read configuration from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-print"></a><h3>shishi_cfg_print ()</h3>
<pre class="programlisting">int                 shishi_cfg_print                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh);</pre>
<p>
Print library configuration status, mostly for debugging purposes.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor opened for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-default-systemfile"></a><h3>shishi_cfg_default_systemfile ()</h3>
<pre class="programlisting">const char*         shishi_cfg_default_systemfile       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
The system configuration file name is decided at compile-time, but
may be overridden by the environment variable SHISHI_CONFIG.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return system configuration file name.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-default-userdirectory"></a><h3>shishi_cfg_default_userdirectory ()</h3>
<pre class="programlisting">const char*         shishi_cfg_default_userdirectory    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
The default user directory (used for, e.g. Shishi ticket cache) is
normally computed by appending BASE_DIR ("/.shishi") to the content
of the environment variable $HOME, but can be overridden by
specifying the complete path in the environment variable
SHISHI_HOME.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return directory with configuration files etc.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-default-userfile"></a><h3>shishi_cfg_default_userfile ()</h3>
<pre class="programlisting">const char*         shishi_cfg_default_userfile         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename of default user configuration file, typically
$HOME/shishi.conf.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return user configuration filename.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-userdirectory-file"></a><h3>shishi_cfg_userdirectory_file ()</h3>
<pre class="programlisting">char*               shishi_cfg_userdirectory_file       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *file);</pre>
<p>
Get the full path to specified <em class="parameter"><code>file</code></em> in the users' configuration
directory.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>file</code></em> :</span></p></td>
<td> basename of file to find in user directory.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return full path to given relative filename, relative
  to the user specific Shishi configuration directory as returned
  by <a class="link" href="shishi-shishi.html#shishi-cfg-default-userdirectory" title="shishi_cfg_default_userdirectory ()"><code class="function">shishi_cfg_default_userdirectory()</code></a> (typically $HOME/.shishi).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-clientkdcetype"></a><h3>shishi_cfg_clientkdcetype ()</h3>
<pre class="programlisting">int                 shishi_cfg_clientkdcetype           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t **etypes);</pre>
<p>
Set the etypes variable to the array of preferred client etypes.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etypes</code></em> :</span></p></td>
<td> output array with encryption types.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return the number of encryption types in the array,
              0 means none.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-clientkdcetype-fast"></a><h3>shishi_cfg_clientkdcetype_fast ()</h3>
<pre class="programlisting">int32_t             shishi_cfg_clientkdcetype_fast      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Extract the default etype from the list of preferred client etypes.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return the default encryption types.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-clientkdcetype-set"></a><h3>shishi_cfg_clientkdcetype_set ()</h3>
<pre class="programlisting">int                 shishi_cfg_clientkdcetype_set       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *value);</pre>
<p>
Set the "client-kdc-etypes" configuration option from given string.
The string contains encryption types (integer or names) separated
by comma or whitespace, e.g. "aes256-cts-hmac-sha1-96
des3-cbc-sha1-kd des-cbc-md5".</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>value</code></em> :</span></p></td>
<td> string with encryption types.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cfg-authorizationtype-set"></a><h3>shishi_cfg_authorizationtype_set ()</h3>
<pre class="programlisting">int                 shishi_cfg_authorizationtype_set    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *value);</pre>
<p>
Set the "authorization-types" configuration option from given string.
The string contains authorization types (integer or names) separated
by comma or whitespace, e.g. "basic k5login".</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>value</code></em> :</span></p></td>
<td> string with authorization types.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-strerror"></a><h3>shishi_strerror ()</h3>
<pre class="programlisting">const char*         shishi_strerror                     (int err);</pre>
<p>
Convert return code to human readable string.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>err</code></em> :</span></p></td>
<td> shishi error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a pointer to a statically allocated string
containing a description of the error with the error value <em class="parameter"><code>err</code></em>.
This string can be used to output a diagnostic message to the user.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error"></a><h3>shishi_error ()</h3>
<pre class="programlisting">const char*         shishi_error                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Extract detailed error information string.  Note that the memory is
managed by the Shishi library, so you must not deallocate the
string.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns pointer to error information string, that must
  not be deallocate by caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error-clear"></a><h3>shishi_error_clear ()</h3>
<pre class="programlisting">void                shishi_error_clear                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Clear the detailed error information string.  See <a class="link" href="shishi-shishi.html#shishi-error" title="shishi_error ()"><code class="function">shishi_error()</code></a>
for how to access the error string, and <a class="link" href="shishi-shishi.html#shishi-error-set" title="shishi_error_set ()"><code class="function">shishi_error_set()</code></a> and
<a class="link" href="shishi-shishi.html#shishi-error-printf" title="shishi_error_printf ()"><code class="function">shishi_error_printf()</code></a> for how to set the error string.  This
function is mostly for Shishi internal use, but if you develop an
extension of Shishi, it may be useful to use the same error
handling infrastructure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error-set"></a><h3>shishi_error_set ()</h3>
<pre class="programlisting">void                shishi_error_set                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *errstr);</pre>
<p>
Set the detailed error information string to specified string.  The
string is copied into the Shishi internal structure, so you can
deallocate the string passed to this function after the call.  This
function is mostly for Shishi internal use, but if you develop an
extension of Shishi, it may be useful to use the same error
handling infrastructure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>errstr</code></em> :</span></p></td>
<td> Zero terminated character array containing error description,
  or NULL to clear the error description string.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error-printf"></a><h3>shishi_error_printf ()</h3>
<pre class="programlisting">void                shishi_error_printf                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);</pre>
<p>
Set the detailed error information string to a printf formatted
string.  This function is mostly for Shishi internal use, but if
you develop an extension of Shishi, it may be useful to use the
same error handling infrastructure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td> printf style format string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>...</code></em> :</span></p></td>
<td> print style arguments.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error-outputtype"></a><h3>shishi_error_outputtype ()</h3>
<pre class="programlisting">int                 shishi_error_outputtype             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get the current output type for logging messages.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return output type (NULL, stderr or syslog) for
  informational and warning messages.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-error-set-outputtype"></a><h3>shishi_error_set_outputtype ()</h3>
<pre class="programlisting">void                shishi_error_set_outputtype         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int type);</pre>
<p>
Set output type (NULL, stderr or syslog) for informational
and warning messages.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> output type.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-info"></a><h3>shishi_info ()</h3>
<pre class="programlisting">void                shishi_info                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);</pre>
<p>
Print informational message to output as defined in handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td> printf style format string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>...</code></em> :</span></p></td>
<td> print style arguments.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-warn"></a><h3>shishi_warn ()</h3>
<pre class="programlisting">void                shishi_warn                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);</pre>
<p>
Print a warning to output as defined in handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td> printf style format string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>...</code></em> :</span></p></td>
<td> print style arguments.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-verbose"></a><h3>shishi_verbose ()</h3>
<pre class="programlisting">void                shishi_verbose                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *format,
                                                         ...);</pre>
<p>
Print a diagnostic message to output as defined in handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td> printf style format string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>...</code></em> :</span></p></td>
<td> print style arguments.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-default-guess"></a><h3>shishi_realm_default_guess ()</h3>
<pre class="programlisting">char*               shishi_realm_default_guess          (void);</pre>
<p>
Guesses a realm based on <code class="function">getdomainname()</code> (which really is NIS/YP
domain, but if it is set it might be a good guess), or if it fails,
based on <code class="function">gethostname()</code>, or if it fails, the string
"could-not-guess-default-realm". Note that the hostname is not
trimmed off of the data returned by <code class="function">gethostname()</code> to get the domain
name and use that as the realm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns guessed realm for host as a string that has
to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-default"></a><h3>shishi_realm_default ()</h3>
<pre class="programlisting">const char*         shishi_realm_default                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get name of default realm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default realm used in the library.  (Not
a copy of it, so don't modify or deallocate it.)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-default-set"></a><h3>shishi_realm_default_set ()</h3>
<pre class="programlisting">void                shishi_realm_default_set            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *realm);</pre>
<p>
Set the default realm used in the library.  The string is copied
into the library, so you can dispose of the variable immediately
after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> string with new default realm name, or NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-for-server-file"></a><h3>shishi_realm_for_server_file ()</h3>
<pre class="programlisting">char*               shishi_realm_for_server_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);</pre>
<p>
Find realm for a host using configuration file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> hostname to find realm for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns realm for host, or NULL if not found.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-for-server-dns"></a><h3>shishi_realm_for_server_dns ()</h3>
<pre class="programlisting">char*               shishi_realm_for_server_dns         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);</pre>
<p>
Find realm for a host using DNS lookups, according to
draft-ietf-krb-wg-krb-dns-locate-03.txt.  Since DNS lookups may be
spoofed, relying on the realm information may result in a
redirection attack.  In a single-realm scenario, this only achieves
a denial of service, but with cross-realm trust it may redirect you
to a compromised realm.  For this reason, Shishi prints a warning,
suggesting that the user should add the proper 'server-realm'
configuration tokens instead.
</p>
<p>
To illustrate the DNS information used, here is an extract from a
zone file for the domain ASDF.COM:
</p>
<p>
_kerberos.asdf.com.             IN      TXT     "ASDF.COM"
_kerberos.mrkserver.asdf.com.   IN      TXT     "MARKETING.ASDF.COM"
_kerberos.salesserver.asdf.com. IN      TXT     "SALES.ASDF.COM"
</p>
<p>
Let us suppose that in this case, a client wishes to use a service
on the host foo.asdf.com.  It would first query:
</p>
<p>
_kerberos.foo.asdf.com. IN TXT
</p>
<p>
Finding no match, it would then query:
</p>
<p>
_kerberos.asdf.com. IN TXT</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> hostname to find realm for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns realm for host, or NULL if not found.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-realm-for-server"></a><h3>shishi_realm_for_server ()</h3>
<pre class="programlisting">char*               shishi_realm_for_server             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *server);</pre>
<p>
Find realm for a host, using various methods.  Currently this
includes static configuration files (see
<a class="link" href="shishi-shishi.html#shishi-realm-for-server-file" title="shishi_realm_for_server_file ()"><code class="function">shishi_realm_for_server_file()</code></a>) and DNS (see
<a class="link" href="shishi-shishi.html#shishi-realm-for-server-dns" title="shishi_realm_for_server_dns ()"><code class="function">shishi_realm_for_server_dns()</code></a>).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> hostname to find realm for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns realm for host, or NULL if not found.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-default-guess"></a><h3>shishi_principal_default_guess ()</h3>
<pre class="programlisting">char*               shishi_principal_default_guess      (void);</pre>
<p>
Guesses the principal name for the user, looking at environment
variables SHISHI_USER and USER, or if that fails, returns the
string "user".</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns guessed default principal for user as a
string that has to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-default"></a><h3>shishi_principal_default ()</h3>
<pre class="programlisting">const char*         shishi_principal_default            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
The default principal name is the name in the environment variable
USER, but can be overridden by specifying the environment variable
SHISHI_USER.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default principal name used in the
library.  (Not a copy of it, so don't modify or deallocate it.)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-default-set"></a><h3>shishi_principal_default_set ()</h3>
<pre class="programlisting">void                shishi_principal_default_set        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal);</pre>
<p>
Set the default realm used in the library.  The string is copied
into the library, so you can dispose of the variable immediately
after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td> string with new default principal name, or NULL to
reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-name"></a><h3>shishi_principal_name ()</h3>
<pre class="programlisting">int                 shishi_principal_name               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Represent principal name in ASN.1 structure as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>outlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namenode</code></em> :</span></p></td>
<td> ASN.1 structure with principal in <em class="parameter"><code>namefield</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namefield</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>namenode</code></em> containing principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>outlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>out</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>out</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-name-realm"></a><h3>shishi_principal_name_realm ()</h3>
<pre class="programlisting">int                 shishi_principal_name_realm         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> realmnode,
                                                         const char *realmfield,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Represent principal name and realm in ASN.1 structure as
zero-terminated string.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <em class="parameter"><code>outlen</code></em> does not include the terminating
zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namenode</code></em> :</span></p></td>
<td> ASN.1 structure with principal name in <em class="parameter"><code>namefield</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namefield</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>namenode</code></em> containing principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmnode</code></em> :</span></p></td>
<td> ASN.1 structure with principal realm in <em class="parameter"><code>realmfield</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmfield</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>realmnode</code></em> containing principal realm.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>outlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>out</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>out</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-name-set"></a><h3>shishi_principal_name_set ()</h3>
<pre class="programlisting">int                 shishi_principal_name_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *name[]);</pre>
<p>
Set the given principal name field to given name.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namenode</code></em> :</span></p></td>
<td> ASN.1 structure with principal in <em class="parameter"><code>namefield</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namefield</code></em> :</span></p></td>
<td> name of field in namenode containing principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name</code></em> :</span></p></td>
<td> zero-terminated input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-principal-set"></a><h3>shishi_principal_set ()</h3>
<pre class="programlisting">int                 shishi_principal_set                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> namenode,
                                                         const char *namefield,
                                                         const char *name);</pre>
<p>
Set principal name field in ASN.1 structure to given name.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namenode</code></em> :</span></p></td>
<td> ASN.1 structure with principal in <em class="parameter"><code>namefield</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>namefield</code></em> :</span></p></td>
<td> name of field in namenode containing principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name</code></em> :</span></p></td>
<td> zero-terminated string with principal name on RFC 1964 form.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-parse-name"></a><h3>shishi_parse_name ()</h3>
<pre class="programlisting">int                 shishi_parse_name                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *name,
                                                         char **principal,
                                                         char **realm);</pre>
<p>
Split up principal name (e.g., "simon<em class="parameter"><code>JOSEFSSON.ORG</code></em>") into two
newly allocated strings, the principal ("simon") and realm
("JOSEFSSON.ORG").  If there is no realm part in NAME, REALM is set
to NULL.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name</code></em> :</span></p></td>
<td> Input principal name string, e.g. imap/mail.gnu.org<em class="parameter"><code>GNU.ORG</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td> newly allocated output string with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> newly allocated output string with realm name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_INVALID_PRINCIPAL_NAME if NAME is NULL
  or ends with the escape character "\", or SHISHI_OK iff
  successful
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-derive-default-salt"></a><h3>shishi_derive_default_salt ()</h3>
<pre class="programlisting">int                 shishi_derive_default_salt          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *name,
                                                         char **salt);</pre>
<p>
Derive the default salt from a principal.  The default salt is the
concatenation of the decoded realm and principal.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name</code></em> :</span></p></td>
<td> principal name of user.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>salt</code></em> :</span></p></td>
<td> output variable with newly allocated salt string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return SHISHI_OK if successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-server-for-local-service"></a><h3>shishi_server_for_local_service ()</h3>
<pre class="programlisting">char*               shishi_server_for_local_service     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service);</pre>
<p>
Construct a service principal (e.g., "imap/yxa.extuno.com") based
on supplied service name (i.e., "imap") and the system hostname as
returned by <code class="function">hostname()</code> (i.e., "yxa.extundo.com").  The string must
be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td> zero terminated string with name of service, e.g., "host".
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return newly allocated service name string.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket"></a><h3>shishi_ticket ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_ticket                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new ASN.1 Ticket, populated with some
default values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ticket or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-server"></a><h3>shishi_ticket_server ()</h3>
<pre class="programlisting">int                 shishi_ticket_server                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         char **server,
                                                         size_t *serverlen);</pre>
<p>
Represent server principal name in Ticket as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>serverlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> ASN.1 Ticket variable to get server name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>serverlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>serverlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>server</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>server</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-sname-set"></a><h3>shishi_ticket_sname_set ()</h3>
<pre class="programlisting">int                 shishi_ticket_sname_set             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         char *sname[]);</pre>
<p>
Set the server name field in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> Ticket variable to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-srealmserver-set"></a><h3>shishi_ticket_srealmserver_set ()</h3>
<pre class="programlisting">int                 shishi_ticket_srealmserver_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *realm,
                                                         const char *server);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-set-server"></a><h3>shishi_ticket_set_server ()</h3>
<pre class="programlisting">int                 shishi_ticket_set_server            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *server);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-realm-get"></a><h3>shishi_ticket_realm_get ()</h3>
<pre class="programlisting">int                 shishi_ticket_realm_get             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>
Extract realm from ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> output array with newly allocated name of realm in ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td> size of output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-realm-set"></a><h3>shishi_ticket_realm_set ()</h3>
<pre class="programlisting">int                 shishi_ticket_realm_set             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         const char *realm);</pre>
<p>
Set the realm field in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> input array with name of realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-get-enc-part-etype"></a><h3>shishi_ticket_get_enc_part_etype ()</h3>
<pre class="programlisting">int                 shishi_ticket_get_enc_part_etype    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         int32_t *etype);</pre>
<p>
Extract Ticket.enc-part.etype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> Ticket variable to get value from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output variable that holds the value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-set-enc-part"></a><h3>shishi_ticket_set_enc_part ()</h3>
<pre class="programlisting">int                 shishi_ticket_set_enc_part          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);</pre>
<p>
Set the encrypted enc-part field in the Ticket.  The encrypted data
is usually created by calling <a class="link" href="shishi-shishi.html#shishi-encrypt" title="shishi_encrypt ()"><code class="function">shishi_encrypt()</code></a> on the DER encoded
enc-part.  To save time, you may want to use
<a class="link" href="shishi-shishi.html#shishi-ticket-add-enc-part" title="shishi_ticket_add_enc_part ()"><code class="function">shishi_ticket_add_enc_part()</code></a> instead, which calculates the
encrypted data and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> Ticket to add enc-part field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type used to encrypt enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kvno</code></em> :</span></p></td>
<td> key version number.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buf</code></em> :</span></p></td>
<td> input array with encrypted enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buflen</code></em> :</span></p></td>
<td> size of input array with encrypted enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-add-enc-part"></a><h3>shishi_ticket_add_enc_part ()</h3>
<pre class="programlisting">int                 shishi_ticket_add_enc_part          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>
Encrypts DER encoded EncTicketPart using key and stores it in the
Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> Ticket to add enc-part field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key used to encrypt enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> EncTicketPart to add.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-decrypt"></a><h3>shishi_ticket_decrypt ()</h3>
<pre class="programlisting">int                 shishi_ticket_decrypt               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encticketpart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-ticket"></a><h3>shishi_tkt_ticket ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tkt_ticket                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Get ASN.1 Ticket structure from ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns actual ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-ticket-set"></a><h3>shishi_tkt_ticket_set ()</h3>
<pre class="programlisting">void                shishi_tkt_ticket_set               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);</pre>
<p>
Set the ASN.1 Ticket in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> ASN.1 Ticket to store in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-kdcrep"></a><h3>shishi_tkt_kdcrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tkt_kdcrep                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Get ASN.1 KDCRep structure from ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns KDC-REP information.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-enckdcreppart"></a><h3>shishi_tkt_enckdcreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tkt_enckdcreppart            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Get ASN.1 EncKDCRepPart structure from ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns auxilliary ticket information.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-enckdcreppart-set"></a><h3>shishi_tkt_enckdcreppart_set ()</h3>
<pre class="programlisting">void                shishi_tkt_enckdcreppart_set        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>
Set the EncKDCRepPart in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> structure that holds information about Ticket exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> EncKDCRepPart to store in Ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-encticketpart"></a><h3>shishi_tkt_encticketpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tkt_encticketpart            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Get ASN.1 EncTicketPart structure from ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns EncTicketPart information.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-encticketpart-set"></a><h3>shishi_tkt_encticketpart_set ()</h3>
<pre class="programlisting">void                shishi_tkt_encticketpart_set        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>
Set the EncTicketPart in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> encticketpart to store in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-key"></a><h3>shishi_tkt_key ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_tkt_key                      (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Get key used in ticket, by looking first in EncKDCRepPart and then
in EncTicketPart.  If key is already populated, it is not extracted
again.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns key extracted from EncKDCRepPart or
EncTicketPart.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-key-set"></a><h3>shishi_tkt_key_set ()</h3>
<pre class="programlisting">int                 shishi_tkt_key_set                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Set the key in the EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to store in ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt"></a><h3>shishi_tkt ()</h3>
<pre class="programlisting">int                 shishi_tkt                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> **tkt);</pre>
<p>
Create a new ticket handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> output variable with newly allocated ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt2"></a><h3>shishi_tkt2 ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkt2                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);</pre>
<p>
Create a new ticket handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input variable with ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input variable with auxilliary ticket information.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> input variable with KDC-REP ticket information.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns new ticket handle, or <code class="literal">NULL</code> on error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-pretty-print"></a><h3>shishi_tkt_pretty_print ()</h3>
<pre class="programlisting">void                shishi_tkt_pretty_print             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         FILE *fh);</pre>
<p>
Print a human readable representation of a ticket to file handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-realm"></a><h3>shishi_tkt_realm ()</h3>
<pre class="programlisting">int                 shishi_tkt_realm                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>
Extract realm of server in ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> pointer to newly allocated character array with realm name.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td> length of newly allocated character array with realm name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-client"></a><h3>shishi_tkt_client ()</h3>
<pre class="programlisting">int                 shishi_tkt_client                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Represent client principal name in Ticket KDC-REP as
zero-terminated string.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <em class="parameter"><code>clientlen</code></em> does not include the terminating
zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-client-p"></a><h3>shishi_tkt_client_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_client_p                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *client);</pre>
<p>
Determine if ticket is for specified client.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> client name of ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff ticket is for specified client.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-clientrealm"></a><h3>shishi_tkt_clientrealm ()</h3>
<pre class="programlisting">int                 shishi_tkt_clientrealm              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Convert cname and realm fields from AS-REQ to printable principal
name format.  The string is allocate by this function, and it is
the responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>clientlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name and realm.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-clientrealm-p"></a><h3>shishi_tkt_clientrealm_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_clientrealm_p            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *client);</pre>
<p>
Determine if ticket is for specified client principal.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> principal name (client name and realm) of ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff ticket is for specified client principal.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-clientrealm-set"></a><h3>shishi_tkt_clientrealm_set ()</h3>
<pre class="programlisting">int                 shishi_tkt_clientrealm_set          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *realm,
                                                         const char *client);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-serverrealm-set"></a><h3>shishi_tkt_serverrealm_set ()</h3>
<pre class="programlisting">int                 shishi_tkt_serverrealm_set          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *realm,
                                                         const char *server);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-build"></a><h3>shishi_tkt_build ()</h3>
<pre class="programlisting">int                 shishi_tkt_build                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-lastreq"></a><h3>shishi_tkt_lastreq ()</h3>
<pre class="programlisting">int                 shishi_tkt_lastreq                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **lrtime,
                                                         size_t *lrtimelen,
                                                         int32_t lrtype);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>lrtime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>lrtimelen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>lrtype</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-lastreqc"></a><h3>shishi_tkt_lastreqc ()</h3>
<pre class="programlisting">time_t              shishi_tkt_lastreqc                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-lrtype" title="enum Shishi_lrtype">Shishi_lrtype</a> lrtype);</pre>
<p>
Extract C time corresponding to given lastreq type field in the
ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>lrtype</code></em> :</span></p></td>
<td> lastreq type to extract, see Shishi_lrtype.  E.g.,
  SHISHI_LRTYPE_LAST_REQUEST.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the specified
  lastreq field, or (time_t) -1.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-lastreq-pretty-print"></a><h3>shishi_tkt_lastreq_pretty_print ()</h3>
<pre class="programlisting">void                shishi_tkt_lastreq_pretty_print     (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         FILE *fh);</pre>
<p>
Print a human readable representation of the various lastreq fields
in the ticket (really EncKDCRepPart).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-authtime"></a><h3>shishi_tkt_authtime ()</h3>
<pre class="programlisting">int                 shishi_tkt_authtime                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **authtime,
                                                         size_t *authtimelen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtimelen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-authctime"></a><h3>shishi_tkt_authctime ()</h3>
<pre class="programlisting">time_t              shishi_tkt_authctime                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Extract C time corresponding to the authtime field.  The field
holds the time when the original authentication took place that
later resulted in this ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the endtime in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-starttime"></a><h3>shishi_tkt_starttime ()</h3>
<pre class="programlisting">int                 shishi_tkt_starttime                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **starttime,
                                                         size_t *starttimelen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>starttime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>starttimelen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-startctime"></a><h3>shishi_tkt_startctime ()</h3>
<pre class="programlisting">time_t              shishi_tkt_startctime               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Extract C time corresponding to the starttime field.  The field
holds the time where the ticket start to be valid (typically in the
past).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the endtime in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-endtime"></a><h3>shishi_tkt_endtime ()</h3>
<pre class="programlisting">int                 shishi_tkt_endtime                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **endtime,
                                                         size_t *endtimelen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>endtime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>endtimelen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-endctime"></a><h3>shishi_tkt_endctime ()</h3>
<pre class="programlisting">time_t              shishi_tkt_endctime                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Extract C time corresponding to the endtime field.  The field holds
the time where the ticket stop being valid.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the endtime in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-renew-till"></a><h3>shishi_tkt_renew_till ()</h3>
<pre class="programlisting">int                 shishi_tkt_renew_till               (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **renewtilltime,
                                                         size_t *renewtilllen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>renewtilltime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>renewtilllen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-renew-tillc"></a><h3>shishi_tkt_renew_tillc ()</h3>
<pre class="programlisting">time_t              shishi_tkt_renew_tillc              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Extract C time corresponding to the renew-till field.  The field
holds the time where the ticket stop being valid for renewal.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the renew-till in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-keytype"></a><h3>shishi_tkt_keytype ()</h3>
<pre class="programlisting">int                 shishi_tkt_keytype                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int32_t *etype);</pre>
<p>
Extract encryption type of key in ticket (really EncKDCRepPart).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> pointer to encryption type that is set, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-keytype-fast"></a><h3>shishi_tkt_keytype_fast ()</h3>
<pre class="programlisting">int32_t             shishi_tkt_keytype_fast             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Extract encryption type of key in ticket (really EncKDCRepPart).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns encryption type of session key in ticket
  (really EncKDCRepPart), or -1 on error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-keytype-p"></a><h3>shishi_tkt_keytype_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_keytype_p                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int32_t etype);</pre>
<p>
Determine if key in ticket (really EncKDCRepPart) is of specified
key type (really encryption type).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff key in ticket is of specified
  encryption type.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-server"></a><h3>shishi_tkt_server ()</h3>
<pre class="programlisting">int                 shishi_tkt_server                   (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         char **server,
                                                         size_t *serverlen);</pre>
<p>
Represent server principal name in Ticket as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>serverlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>serverlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>serverlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>server</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>server</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-server-p"></a><h3>shishi_tkt_server_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_server_p                 (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *server);</pre>
<p>
Determine if ticket is for specified server.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name of ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff ticket is for specified server.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-valid-at-time-p"></a><h3>shishi_tkt_valid_at_time_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_valid_at_time_p          (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         time_t now);</pre>
<p>
Determine if ticket is valid at a specific point in time.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>now</code></em> :</span></p></td>
<td> time to check for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff ticket is valid (not expired and
  after starttime) at specified time.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-valid-now-p"></a><h3>shishi_tkt_valid_now_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_valid_now_p              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is valid now.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns 0 iff ticket is invalid (expired or not yet
  valid).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-expired-p"></a><h3>shishi_tkt_expired_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_expired_p                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket has expired (i.e., endtime is in the past).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns 0 iff ticket has expired.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-decrypt"></a><h3>shishi_tkt_decrypt ()</h3>
<pre class="programlisting">int                 shishi_tkt_decrypt                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-done"></a><h3>shishi_tkt_done ()</h3>
<pre class="programlisting">void                shishi_tkt_done                     (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Deallocate resources associated with ticket.  The ticket must not
be used again after this call.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-flags"></a><h3>shishi_tkt_flags ()</h3>
<pre class="programlisting">int                 shishi_tkt_flags                    (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t *flags);</pre>
<p>
Extract flags in ticket (i.e., EncKDCRepPart).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> pointer to output integer with flags.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-flags-set"></a><h3>shishi_tkt_flags_set ()</h3>
<pre class="programlisting">int                 shishi_tkt_flags_set                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t flags);</pre>
<p>
Set flags in ticket, i.e., both EncTicketPart and EncKDCRepPart.
Note that this reset any already existing flags.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> integer with flags to store in ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-flags-add"></a><h3>shishi_tkt_flags_add ()</h3>
<pre class="programlisting">int                 shishi_tkt_flags_add                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         uint32_t flag);</pre>
<p>
Add ticket flags to Ticket and EncKDCRepPart.  This preserves all
existing options.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flag</code></em> :</span></p></td>
<td> integer with flags to store in ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-forwardable-p"></a><h3>shishi_tkt_forwardable_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_forwardable_p            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is forwardable.
</p>
<p>
The FORWARDABLE flag in a ticket is normally only interpreted by
the ticket-granting service. It can be ignored by application
servers.  The FORWARDABLE flag has an interpretation similar to
that of the PROXIABLE flag, except ticket-granting tickets may also
be issued with different network addresses. This flag is reset by
default, but users MAY request that it be set by setting the
FORWARDABLE option in the AS request when they request their
initial ticket-granting ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff forwardable flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-forwarded-p"></a><h3>shishi_tkt_forwarded_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_forwarded_p              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is forwarded.
</p>
<p>
The FORWARDED flag is set by the TGS when a client presents a
ticket with the FORWARDABLE flag set and requests a forwarded
ticket by specifying the FORWARDED KDC option and supplying a set
of addresses for the new ticket. It is also set in all tickets
issued based on tickets with the FORWARDED flag set. Application
servers may choose to process FORWARDED tickets differently than
non-FORWARDED tickets.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff forwarded flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-proxiable-p"></a><h3>shishi_tkt_proxiable_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_proxiable_p              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is proxiable.
</p>
<p>
The PROXIABLE flag in a ticket is normally only interpreted by the
ticket-granting service. It can be ignored by application servers.
When set, this flag tells the ticket-granting server that it is OK
to issue a new ticket (but not a ticket-granting ticket) with a
different network address based on this ticket. This flag is set if
requested by the client on initial authentication. By default, the
client will request that it be set when requesting a
ticket-granting ticket, and reset when requesting any other ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff proxiable flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-proxy-p"></a><h3>shishi_tkt_proxy_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_proxy_p                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is proxy ticket.
</p>
<p>
The PROXY flag is set in a ticket by the TGS when it issues a proxy
ticket.  Application servers MAY check this flag and at their
option they MAY require additional authentication from the agent
presenting the proxy in order to provide an audit trail.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff proxy flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-may-postdate-p"></a><h3>shishi_tkt_may_postdate_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_may_postdate_p           (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket may be used to grant postdated tickets.
</p>
<p>
The MAY-POSTDATE flag in a ticket is normally only interpreted by
the ticket-granting service. It can be ignored by application
servers.  This flag MUST be set in a ticket-granting ticket in
order to issue a postdated ticket based on the presented ticket. It
is reset by default; it MAY be requested by a client by setting the
ALLOW- POSTDATE option in the KRB_AS_REQ message.  This flag does
not allow a client to obtain a postdated ticket-granting ticket;
postdated ticket-granting tickets can only by obtained by
requesting the postdating in the KRB_AS_REQ message. The life
(endtime-starttime) of a postdated ticket will be the remaining
life of the ticket-granting ticket at the time of the request,
unless the RENEWABLE option is also set, in which case it can be
the full life (endtime-starttime) of the ticket-granting
ticket. The KDC MAY limit how far in the future a ticket may be
postdated.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff may-postdate flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-postdated-p"></a><h3>shishi_tkt_postdated_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_postdated_p              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is postdated.
</p>
<p>
The POSTDATED flag indicates that a ticket has been postdated. The
application server can check the authtime field in the ticket to
see when the original authentication occurred. Some services MAY
choose to reject postdated tickets, or they may only accept them
within a certain period after the original authentication. When the
KDC issues a POSTDATED ticket, it will also be marked as INVALID,
so that the application client MUST present the ticket to the KDC
to be validated before use.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff postdated flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-invalid-p"></a><h3>shishi_tkt_invalid_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_invalid_p                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is invalid.
</p>
<p>
The INVALID flag indicates that a ticket is invalid. Application
servers MUST reject tickets which have this flag set. A postdated
ticket will be issued in this form. Invalid tickets MUST be
validated by the KDC before use, by presenting them to the KDC in a
TGS request with the VALIDATE option specified. The KDC will only
validate tickets after their starttime has passed. The validation
is required so that postdated tickets which have been stolen before
their starttime can be rendered permanently invalid (through a
hot-list mechanism).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff invalid flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-renewable-p"></a><h3>shishi_tkt_renewable_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_renewable_p              (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is renewable.
</p>
<p>
The RENEWABLE flag in a ticket is normally only interpreted by the
ticket-granting service (discussed below in section 3.3). It can
usually be ignored by application servers. However, some
particularly careful application servers MAY disallow renewable
tickets.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff renewable flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-initial-p"></a><h3>shishi_tkt_initial_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_initial_p                (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket was issued using AS exchange.
</p>
<p>
The INITIAL flag indicates that a ticket was issued using the AS
protocol, rather than issued based on a ticket-granting ticket.
Application servers that want to require the demonstrated knowledge
of a client's secret key (e.g. a password-changing program) can
insist that this flag be set in any tickets they accept, and thus
be assured that the client's key was recently presented to the
application client.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff initial flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-pre-authent-p"></a><h3>shishi_tkt_pre_authent_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_pre_authent_p            (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket was pre-authenticated.
</p>
<p>
The PRE-AUTHENT and HW-AUTHENT flags provide additional information
about the initial authentication, regardless of whether the current
ticket was issued directly (in which case INITIAL will also be set)
or issued on the basis of a ticket-granting ticket (in which case
the INITIAL flag is clear, but the PRE-AUTHENT and HW-AUTHENT flags
are carried forward from the ticket-granting ticket).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff pre-authent flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-hw-authent-p"></a><h3>shishi_tkt_hw_authent_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_hw_authent_p             (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is authenticated using a hardware token.
</p>
<p>
The PRE-AUTHENT and HW-AUTHENT flags provide additional information
about the initial authentication, regardless of whether the current
ticket was issued directly (in which case INITIAL will also be set)
or issued on the basis of a ticket-granting ticket (in which case
the INITIAL flag is clear, but the PRE-AUTHENT and HW-AUTHENT flags
are carried forward from the ticket-granting ticket).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff hw-authent flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-transited-policy-checked-p"></a><h3>shishi_tkt_transited_policy_checked_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_transited_policy_checked_p
                                                        (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket has been policy checked for transit.
</p>
<p>
The application server is ultimately responsible for accepting or
rejecting authentication and SHOULD check that only suitably
trusted KDCs are relied upon to authenticate a principal.  The
transited field in the ticket identifies which realms (and thus
which KDCs) were involved in the authentication process and an
application server would normally check this field. If any of these
are untrusted to authenticate the indicated client principal
(probably determined by a realm-based policy), the authentication
attempt MUST be rejected. The presence of trusted KDCs in this list
does not provide any guarantee; an untrusted KDC may have
fabricated the list.
</p>
<p>
While the end server ultimately decides whether authentication is
valid, the KDC for the end server's realm MAY apply a realm
specific policy for validating the transited field and accepting
credentials for cross-realm authentication. When the KDC applies
such checks and accepts such cross-realm authentication it will set
the TRANSITED-POLICY-CHECKED flag in the service tickets it issues
based on the cross-realm TGT. A client MAY request that the KDCs
not check the transited field by setting the
DISABLE-TRANSITED-CHECK flag. KDCs are encouraged but not required
to honor this flag.
</p>
<p>
Application servers MUST either do the transited-realm checks
themselves, or reject cross-realm tickets without TRANSITED-POLICY-
CHECKED set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff transited-policy-checked flag is
  set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-ok-as-delegate-p"></a><h3>shishi_tkt_ok_as_delegate_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_ok_as_delegate_p         (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Determine if ticket is ok as delegated ticket.
</p>
<p>
The copy of the ticket flags in the encrypted part of the KDC reply
may have the OK-AS-DELEGATE flag set to indicates to the client
that the server specified in the ticket has been determined by
policy of the realm to be a suitable recipient of delegation.  A
client can use the presence of this flag to help it make a decision
whether to delegate credentials (either grant a proxy or a
forwarded ticket- granting ticket) to this server.  It is
acceptable to ignore the value of this flag. When setting this
flag, an administrator should consider the security and placement
of the server on which the service will run, as well as whether the
service requires the use of delegated credentials.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff ok-as-delegate flag is set in ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-file-guess"></a><h3>shishi_tkts_default_file_guess ()</h3>
<pre class="programlisting">char*               shishi_tkts_default_file_guess      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Guesses the default ticket filename; it is $SHISHI_TICKETS,
$SHISHI_HOME/tickets, or $HOME/.shishi/tickets.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns default tkts filename as a string that
has to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-file"></a><h3>shishi_tkts_default_file ()</h3>
<pre class="programlisting">const char*         shishi_tkts_default_file            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename of default ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default ticket set filename used in the
library.  The string is not a copy, so don't modify or deallocate
it.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-file-set"></a><h3>shishi_tkts_default_file_set ()</h3>
<pre class="programlisting">void                shishi_tkts_default_file_set        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *tktsfile);</pre>
<p>
Set the default ticket set filename used in the library.  The
string is copied into the library, so you can dispose of the
variable immediately after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tktsfile</code></em> :</span></p></td>
<td> string with new default tkts file name, or
                NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default"></a><h3>shishi_tkts_default ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a>*        shishi_tkts_default                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get the default ticket set for library handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return the handle global ticket set.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-to-file"></a><h3>shishi_tkts_default_to_file ()</h3>
<pre class="programlisting">int                 shishi_tkts_default_to_file         (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts"></a><h3>shishi_tkts ()</h3>
<pre class="programlisting">int                 shishi_tkts                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **tkts);</pre>
<p>
Get a new ticket set handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> output pointer to newly allocated tkts handle.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-nth"></a><h3>shishi_tkts_nth ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_nth                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         int ticketno);</pre>
<p>
Get the n:th ticket in ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticketno</code></em> :</span></p></td>
<td> integer indicating requested ticket in ticket set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket handle to the ticketno:th ticket in
  the ticket set, or NULL if ticket set is invalid or ticketno is
  out of bounds.  The first ticket is ticketno 0, the second
  ticketno 1, and so on.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-size"></a><h3>shishi_tkts_size ()</h3>
<pre class="programlisting">int                 shishi_tkts_size                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);</pre>
<p>
Get size of ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns number of tickets stored in ticket set.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-add"></a><h3>shishi_tkts_add ()</h3>
<pre class="programlisting">int                 shishi_tkts_add                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Add a ticket to the ticket set.  Only the pointer is stored, so if
you modify <em class="parameter"><code>tkt</code></em>, the ticket in the ticket set will also be
modified.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to be added to ticket set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-new"></a><h3>shishi_tkts_new ()</h3>
<pre class="programlisting">int                 shishi_tkts_new                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);</pre>
<p>
Allocate a new ticket and add it to the ticket set.
</p>
<p>
Note that <em class="parameter"><code>ticket</code></em>, <em class="parameter"><code>enckdcreppart</code></em> and <em class="parameter"><code>kdcrep</code></em> are stored by
reference, so you must not de-allocate them before the ticket is
removed from the ticket set and de-allocated.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input ticket variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input ticket detail variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> input KDC-REP variable.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-remove"></a><h3>shishi_tkts_remove ()</h3>
<pre class="programlisting">int                 shishi_tkts_remove                  (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         int ticketno);</pre>
<p>
Remove a ticket, indexed by <em class="parameter"><code>ticketno</code></em>, in ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticketno</code></em> :</span></p></td>
<td> ticket number of ticket in the set to remove.  The first
  ticket is ticket number 0.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if succesful or if ticketno larger
  than size of ticket set.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-expire"></a><h3>shishi_tkts_expire ()</h3>
<pre class="programlisting">int                 shishi_tkts_expire                  (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);</pre>
<p>
Remove expired tickets from ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-print-for-service"></a><h3>shishi_tkts_print_for_service ()</h3>
<pre class="programlisting">int                 shishi_tkts_print_for_service       (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh,
                                                         const char *service);</pre>
<p>
Print description of tickets for specified service to file
descriptor.  If service is NULL, all tickets are printed.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor to print to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td> service to limit tickets printed to, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-print"></a><h3>shishi_tkts_print ()</h3>
<pre class="programlisting">int                 shishi_tkts_print                   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);</pre>
<p>
Print description of all tickets to file descriptor.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor to print to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-write"></a><h3>shishi_tkts_write ()</h3>
<pre class="programlisting">int                 shishi_tkts_write                   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);</pre>
<p>
Write tickets in set to file descriptor.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor to write tickets to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-to-file"></a><h3>shishi_tkts_to_file ()</h3>
<pre class="programlisting">int                 shishi_tkts_to_file                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *filename);</pre>
<p>
Write tickets in set to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> filename to write tickets to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-read"></a><h3>shishi_tkts_read ()</h3>
<pre class="programlisting">int                 shishi_tkts_read                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         FILE *fh);</pre>
<p>
Read tickets from file descriptor and add them to the ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-from-file"></a><h3>shishi_tkts_from_file ()</h3>
<pre class="programlisting">int                 shishi_tkts_from_file               (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *filename);</pre>
<p>
Read tickets from file and add them to the ticket set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> filename to read tickets from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-done"></a><h3>shishi_tkts_done ()</h3>
<pre class="programlisting">void                shishi_tkts_done                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **tkts);</pre>
<p>
Deallocates all resources associated with ticket set.  The ticket
set handle must not be used in calls to other shishi_tkts_*()
functions after this.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkt-match-p"></a><h3>shishi_tkt_match_p ()</h3>
<pre class="programlisting">int                 shishi_tkt_match_p                  (<a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Test if a ticket matches specified hints.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to test hints on.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> structure with characteristics of ticket to be found.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns 0 iff ticket fails to match given criteria.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-find"></a><h3>shishi_tkts_find ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_find                    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Search the ticketset sequentially (from ticket number 0 through all
tickets in the set) for a ticket that fits the given
characteristics.  If a ticket is found, the hint-&gt;startpos field is
updated to point to the next ticket in the set, so this function
can be called repeatedly with the same hint argument in order to
find all tickets matching a certain criterium.  Note that if
tickets are added to, or removed from, the ticketset during a query
with the same hint argument, the hint-&gt;startpos field must be
updated appropriately.
</p>
<p>
Here is how you would typically use this function:
</p>
<p>
  Shishi_tkts_hint  hint;
</p>
<p>
  Shishi_tkt  tkt;
</p>
<p>
  memset(&amp;hint, 0, sizeof(hint));
</p>
<p>
  hint.server = "imap/mail.example.org";
</p>
<p>
  tkt = shishi_tkts_find (shishi_tkts_default(handle), &amp;hint);
</p>
<p>
  if (!tkt)
</p>
<p>
    printf("No ticket found...\n");
</p>
<p>
  else
</p>
<p>
    do_something_with_ticket (tkt);</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> structure with characteristics of ticket to be found.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL if no further
              matching tickets could be found.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-find-for-clientserver"></a><h3>shishi_tkts_find_for_clientserver ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_find_for_clientserver   (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *client,
                                                         const char *server);</pre>
<p>
Short-hand function for searching the ticket set for a ticket for
the given client and server.  See <a class="link" href="shishi-shishi.html#shishi-tkts-find" title="shishi_tkts_find ()"><code class="function">shishi_tkts_find()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> client name to find ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to find ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-find-for-server"></a><h3>shishi_tkts_find_for_server ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_find_for_server         (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *server);</pre>
<p>
Short-hand function for searching the ticket set for a ticket for
the given server using the default client principal.  See
<a class="link" href="shishi-shishi.html#shishi-tkts-find-for-clientserver" title="shishi_tkts_find_for_clientserver ()"><code class="function">shishi_tkts_find_for_clientserver()</code></a> and <a class="link" href="shishi-shishi.html#shishi-tkts-find" title="shishi_tkts_find ()"><code class="function">shishi_tkts_find()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to find ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get"></a><h3>shishi_tkts_get ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get                     (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Get a ticket matching given characteristics.  This function first
looks in the ticket set for the ticket, then tries to find a
suitable TGT, possibly via an AS exchange, using
<a class="link" href="shishi-shishi.html#shishi-tkts-get-tgt" title="shishi_tkts_get_tgt ()"><code class="function">shishi_tkts_get_tgt()</code></a>, and then use that TGT in a TGS exchange to
get the ticket.
</p>
<p>
Currently this function do not implement cross realm logic.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> structure with characteristics of ticket to begot.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL if this function
              is unable to get the ticket.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get-tgt"></a><h3>shishi_tkts_get_tgt ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get_tgt                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Get a ticket granting ticket (TGT) suitable for acquiring ticket
matching the hint.  I.e., get a TGT for the server realm in the
hint structure (hint-&gt;serverrealm), or the default realm if the
serverrealm field is NULL.  Can result in AS exchange.
</p>
<p>
Currently this function do not implement cross realm logic.
</p>
<p>
This function is used by <a class="link" href="shishi-shishi.html#shishi-tkts-get" title="shishi_tkts_get ()"><code class="function">shishi_tkts_get()</code></a>, which is probably what
you really want to use unless you have special needs.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> structure with characteristics of ticket to begot.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket granting ticket if successful, or
  NULL if this function is unable to acquire on.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get-tgs"></a><h3>shishi_tkts_get_tgs ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get_tgs                 (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tgt);</pre>
<p>
Get a ticket via TGS exchange using specified ticket granting
ticket.
</p>
<p>
This function is used by <a class="link" href="shishi-shishi.html#shishi-tkts-get" title="shishi_tkts_get ()"><code class="function">shishi_tkts_get()</code></a>, which is probably what
you really want to use unless you have special needs.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> structure with characteristics of ticket to begot.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgt</code></em> :</span></p></td>
<td> ticket granting ticket to use.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if successful, or NULL if this
  function is unable to acquire on.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get-for-clientserver"></a><h3>shishi_tkts_get_for_clientserver ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get_for_clientserver    (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *client,
                                                         const char *server);</pre>
<p>
Short-hand function for getting a ticket for the given client and
server.  See <a class="link" href="shishi-shishi.html#shishi-tkts-get" title="shishi_tkts_get ()"><code class="function">shishi_tkts_get()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> client name to get ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get-for-server"></a><h3>shishi_tkts_get_for_server ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get_for_server          (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *server);</pre>
<p>
Short-hand function for getting a ticket for the given server and
the default principal client.  See <a class="link" href="shishi-shishi.html#shishi-tkts-get" title="shishi_tkts_get ()"><code class="function">shishi_tkts_get()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> ticket set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-tkts" title="shishi_tkts ()"><code class="function">shishi_tkts()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a ticket if found, or NULL.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-get-for-localservicepasswd"></a><h3>shishi_tkts_get_for_localservicepasswd ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tkts_get_for_localservicepasswd
                                                        (<a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts,
                                                         const char *service,
                                                         const char *passwd);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>passwd</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-ccache-guess"></a><h3>shishi_tkts_default_ccache_guess ()</h3>
<pre class="programlisting">char*               shishi_tkts_default_ccache_guess    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Guesses the default ccache ticket filename; it is the contents of
the environment variable KRB5CCNAME or /tmp/krb5cc_UID where UID is
the user's identity in decimal, as returned by <code class="function">getuid()</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns default ccache filename as a string that has
  to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-ccache"></a><h3>shishi_tkts_default_ccache ()</h3>
<pre class="programlisting">const char*         shishi_tkts_default_ccache          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename of default ccache filename.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default ccache filename used in the
  library.  The string is not a copy, so don't modify or deallocate
  it.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-default-ccache-set"></a><h3>shishi_tkts_default_ccache_set ()</h3>
<pre class="programlisting">void                shishi_tkts_default_ccache_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *ccache);</pre>
<p>
Set the default ccache filename used in the library.  The string is
copied into the library, so you can dispose of the variable
immediately after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ccache</code></em> :</span></p></td>
<td> string with new default ccache filename, or
                NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-add-ccache-mem"></a><h3>shishi_tkts_add_ccache_mem ()</h3>
<pre class="programlisting">int                 shishi_tkts_add_ccache_mem          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);</pre>
<p>
Read tickets from a ccache data structure, and add them to the
ticket set.
</p>
<p>
The ccache format is proprietary, and this function support (at
least) the 0x0504 format.  See the section The Credential Cache
Binary File Format in the Shishi manual for a description of the
file format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> constant memory buffer with ccache of <em class="parameter"><code>len</code></em> size.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> size of memory buffer with ccache data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> allocated key set to store tickets in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_CCACHE_ERROR</code> if the data does not
  represent a valid ccache structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-add-ccache-file"></a><h3>shishi_tkts_add_ccache_file ()</h3>
<pre class="programlisting">int                 shishi_tkts_add_ccache_file         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> *tkts);</pre>
<p>
Read tickets from a ccache data structure, and add them to the
ticket set.
</p>
<p>
The ccache format is proprietary, and this function support (at
least) the 0x0504 format.  See the section The Credential Cache
Binary File Format in the Shishi manual for a description of the
file format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> name of file to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkts</code></em> :</span></p></td>
<td> allocated ticket set to store tickets in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_IO_ERROR</code> if the file cannot be read,
  <code class="literal">SHISHI_CCACHE_ERROR</code> if the data cannot be parsed as a valid ccache
  structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-from-ccache-mem"></a><h3>shishi_tkts_from_ccache_mem ()</h3>
<pre class="programlisting">int                 shishi_tkts_from_ccache_mem         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **outtkts);</pre>
<p>
Read tickets from a ccache data structure, and add them to the
ticket set.
</p>
<p>
The ccache format is proprietary, and this function support (at
least) the 0x0504 format.  See the section The Credential Cache
Binary File Format in the Shishi manual for a description of the
file format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> constant memory buffer with ccache of <em class="parameter"><code>len</code></em> size.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> size of memory buffer with ccache data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outtkts</code></em> :</span></p></td>
<td> pointer to ticket set that will be allocated and populated,
  must be deallocated by caller on succes.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_CCACHE_ERROR</code> if the data does not
  represent a valid ccache structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tkts-from-ccache-file"></a><h3>shishi_tkts_from_ccache_file ()</h3>
<pre class="programlisting">int                 shishi_tkts_from_ccache_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts" title="Shishi_tkts">Shishi_tkts</a> **outtkts);</pre>
<p>
Read tickets from a ccache data structure, and add them to the
ticket set.
</p>
<p>
The ccache format is proprietary, and this function support (at
least) the 0x0504 format.  See the section The Credential Cache
Binary File Format in the Shishi manual for a description of the
file format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> name of file to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outtkts</code></em> :</span></p></td>
<td> pointer to ticket set that will be allocated and populated,
  must be deallocated by caller on succes.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_IO_ERROR</code> if the file cannot be read,
  <code class="literal">SHISHI_CCACHE_ERROR</code> if the data cannot be parsed as a valid ccache
  structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-print"></a><h3>shishi_enckdcreppart_print ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_print          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-save"></a><h3>shishi_enckdcreppart_save ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_save           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-parse"></a><h3>shishi_enckdcreppart_parse ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_parse          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-read"></a><h3>shishi_enckdcreppart_read ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_read           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-save"></a><h3>shishi_ticket_save ()</h3>
<pre class="programlisting">int                 shishi_ticket_save                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-print"></a><h3>shishi_ticket_print ()</h3>
<pre class="programlisting">int                 shishi_ticket_print                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-print"></a><h3>shishi_kdc_print ()</h3>
<pre class="programlisting">int                 shishi_kdc_print                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encasreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encasreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-parse"></a><h3>shishi_ticket_parse ()</h3>
<pre class="programlisting">int                 shishi_ticket_parse                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ticket-read"></a><h3>shishi_ticket_read ()</h3>
<pre class="programlisting">int                 shishi_ticket_read                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-etype-info-print"></a><h3>shishi_etype_info_print ()</h3>
<pre class="programlisting">int                 shishi_etype_info_print             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> etypeinfo);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etypeinfo</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-etype-info2-print"></a><h3>shishi_etype_info2_print ()</h3>
<pre class="programlisting">int                 shishi_etype_info2_print            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> etypeinfo2);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etypeinfo2</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-padata-print"></a><h3>shishi_padata_print ()</h3>
<pre class="programlisting">int                 shishi_padata_print                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> padata);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>padata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-methoddata-print"></a><h3>shishi_methoddata_print ()</h3>
<pre class="programlisting">int                 shishi_methoddata_print             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> methoddata);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>methoddata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator"></a><h3>shishi_authenticator ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_authenticator                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new Authenticator, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the authenticator or NULL on
failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-set-crealm"></a><h3>shishi_authenticator_set_crealm ()</h3>
<pre class="programlisting">int                 shishi_authenticator_set_crealm     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *crealm);</pre>
<p>
Set realm field in authenticator to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealm</code></em> :</span></p></td>
<td> input array with realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-set-cname"></a><h3>shishi_authenticator_set_cname ()</h3>
<pre class="programlisting">int                 shishi_authenticator_set_cname      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);</pre>
<p>
Set principal field in authenticator to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-client-set"></a><h3>shishi_authenticator_client_set ()</h3>
<pre class="programlisting">int                 shishi_authenticator_client_set     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *client);</pre>
<p>
Set the client name field in the Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> zero-terminated string with principal name on RFC 1964 form.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-ctime"></a><h3>shishi_authenticator_ctime ()</h3>
<pre class="programlisting">int                 shishi_authenticator_ctime          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **t);</pre>
<p>
Extract client time from Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> newly allocated zero-terminated character array with client time.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-ctime-set"></a><h3>shishi_authenticator_ctime_set ()</h3>
<pre class="programlisting">int                 shishi_authenticator_ctime_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         const char *t);</pre>
<p>
Store client time in Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> string with generalized time value to store in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-cusec-get"></a><h3>shishi_authenticator_cusec_get ()</h3>
<pre class="programlisting">int                 shishi_authenticator_cusec_get      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t *cusec);</pre>
<p>
Extract client microseconds field from Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> output integer with client microseconds field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-cusec-set"></a><h3>shishi_authenticator_cusec_set ()</h3>
<pre class="programlisting">int                 shishi_authenticator_cusec_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t cusec);</pre>
<p>
Set the cusec field in the Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> client microseconds to set in authenticator, 0-999999.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-seqnumber-get"></a><h3>shishi_authenticator_seqnumber_get ()</h3>
<pre class="programlisting">int                 shishi_authenticator_seqnumber_get  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t *seqnumber);</pre>
<p>
Extract sequence number field from Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>seqnumber</code></em> :</span></p></td>
<td> output integer with sequence number field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-seqnumber-remove"></a><h3>shishi_authenticator_seqnumber_remove ()</h3>
<pre class="programlisting">int                 shishi_authenticator_seqnumber_remove
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Remove sequence number field in Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-seqnumber-set"></a><h3>shishi_authenticator_seqnumber_set ()</h3>
<pre class="programlisting">int                 shishi_authenticator_seqnumber_set  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         uint32_t seqnumber);</pre>
<p>
Store sequence number field in Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>seqnumber</code></em> :</span></p></td>
<td> integer with sequence number field to store in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-client"></a><h3>shishi_authenticator_client ()</h3>
<pre class="programlisting">int                 shishi_authenticator_client         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Represent client principal name in Authenticator as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>clientlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator variable to get client name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-clientrealm"></a><h3>shishi_authenticator_clientrealm ()</h3>
<pre class="programlisting">int                 shishi_authenticator_clientrealm    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Convert cname and realm fields from Authenticator to printable
principal name format.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <em class="parameter"><code>clientlen</code></em> does not include the terminating
zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator variable to get client name and realm from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name and realm.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-remove-cksum"></a><h3>shishi_authenticator_remove_cksum ()</h3>
<pre class="programlisting">int                 shishi_authenticator_remove_cksum   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-cksum"></a><h3>shishi_authenticator_cksum ()</h3>
<pre class="programlisting">int                 shishi_authenticator_cksum          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t *cksumtype,
                                                         char **cksum,
                                                         size_t *cksumlen);</pre>
<p>
Read checksum value from authenticator.  <em class="parameter"><code>cksum</code></em> is allocated by
this function, and it is the responsibility of caller to deallocate
it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> output checksum type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksum</code></em> :</span></p></td>
<td> newly allocated output checksum data from authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumlen</code></em> :</span></p></td>
<td> on output, actual size of allocated output checksum data buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-set-cksum"></a><h3>shishi_authenticator_set_cksum ()</h3>
<pre class="programlisting">int                 shishi_authenticator_set_cksum      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int cksumtype,
                                                         char *cksum,
                                                         size_t cksumlen);</pre>
<p>
Store checksum value in authenticator.  A checksum is usually created
by calling <a class="link" href="shishi-shishi.html#shishi-checksum" title="shishi_checksum ()"><code class="function">shishi_checksum()</code></a> on some application specific data using
the key from the ticket that is being used.  To save time, you may
want to use <a class="link" href="shishi-shishi.html#shishi-authenticator-add-cksum" title="shishi_authenticator_add_cksum ()"><code class="function">shishi_authenticator_add_cksum()</code></a> instead, which calculates
the checksum and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> input checksum type to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksum</code></em> :</span></p></td>
<td> input checksum data to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumlen</code></em> :</span></p></td>
<td> size of input checksum data to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-cksum"></a><h3>shishi_authenticator_add_cksum ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_cksum      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         char *data,
                                                         size_t datalen);</pre>
<p>
Calculate checksum for data and store it in the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to to use for encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> cryptographic key usage value to use in encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to calculate checksum on.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> size of input array with data to calculate checksum on.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-cksum-type"></a><h3>shishi_authenticator_add_cksum_type ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_cksum_type (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int cksumtype,
                                                         char *data,
                                                         size_t datalen);</pre>
<p>
Calculate checksum for data and store it in the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to to use for encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> cryptographic key usage value to use in encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> checksum to type to calculate checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to calculate checksum on.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> size of input array with data to calculate checksum on.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-remove-subkey"></a><h3>shishi_authenticator_remove_subkey ()</h3>
<pre class="programlisting">int                 shishi_authenticator_remove_subkey  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Remove subkey from the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-subkey"></a><h3>shishi_authenticator_subkey ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_authenticator_subkey         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new Authenticator, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields. It adds a random subkey.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the authenticator or NULL on
failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-get-subkey"></a><h3>shishi_authenticator_get_subkey ()</h3>
<pre class="programlisting">int                 shishi_authenticator_get_subkey     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **subkey);</pre>
<p>
Read subkey value from authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkey</code></em> :</span></p></td>
<td> output newly allocated subkey from authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful or SHISHI_ASN1_NO_ELEMENT
              if subkey is not present.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-set-subkey"></a><h3>shishi_authenticator_set_subkey ()</h3>
<pre class="programlisting">int                 shishi_authenticator_set_subkey     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t subkeytype,
                                                         const char *subkey,
                                                         size_t subkeylen);</pre>
<p>
Store subkey value in authenticator.  A subkey is usually created
by calling <a class="link" href="shishi-shishi.html#shishi-key-random" title="shishi_key_random ()"><code class="function">shishi_key_random()</code></a> using the default encryption type of
the key from the ticket that is being used.  To save time, you may
want to use <a class="link" href="shishi-shishi.html#shishi-authenticator-add-subkey" title="shishi_authenticator_add_subkey ()"><code class="function">shishi_authenticator_add_subkey()</code></a> instead, which calculates
the subkey and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkeytype</code></em> :</span></p></td>
<td> input subkey type to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkey</code></em> :</span></p></td>
<td> input subkey data to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkeylen</code></em> :</span></p></td>
<td> size of input subkey data to store in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-random-subkey"></a><h3>shishi_authenticator_add_random_subkey ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_random_subkey
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Generate random subkey, of the default encryption type from
configuration, and store it in the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-random-subkey-etype"></a><h3>shishi_authenticator_add_random_subkey_etype ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_random_subkey_etype
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int etype);</pre>
<p>
Generate random subkey of indicated encryption type, and store it
in the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type of random key to generate.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-subkey"></a><h3>shishi_authenticator_add_subkey ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_subkey     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *subkey);</pre>
<p>
Store subkey in the authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkey</code></em> :</span></p></td>
<td> subkey to add to authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-clear-authorizationdata"></a><h3>shishi_authenticator_clear_authorizationdata ()</h3>
<pre class="programlisting">int                 shishi_authenticator_clear_authorizationdata
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Remove the authorization-data field from Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-add-authorizationdata"></a><h3>shishi_authenticator_add_authorizationdata ()</h3>
<pre class="programlisting">int                 shishi_authenticator_add_authorizationdata
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t adtype,
                                                         const char *addata,
                                                         size_t addatalen);</pre>
<p>
Add authorization data to authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>adtype</code></em> :</span></p></td>
<td> input authorization data type to add.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>addata</code></em> :</span></p></td>
<td> input authorization data to add.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>addatalen</code></em> :</span></p></td>
<td> size of input authorization data to add.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-authorizationdata"></a><h3>shishi_authenticator_authorizationdata ()</h3>
<pre class="programlisting">int                 shishi_authenticator_authorizationdata
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int32_t *adtype,
                                                         char **addata,
                                                         size_t *addatalen,
                                                         size_t nth);</pre>
<p>
Extract n:th authorization data from authenticator.  The first
field is 1.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>adtype</code></em> :</span></p></td>
<td> output authorization data type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>addata</code></em> :</span></p></td>
<td> newly allocated output authorization data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>addatalen</code></em> :</span></p></td>
<td> on output, actual size of newly allocated authorization data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>nth</code></em> :</span></p></td>
<td> element number of authorization-data to extract.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-read"></a><h3>shishi_authenticator_read ()</h3>
<pre class="programlisting">int                 shishi_authenticator_read           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);</pre>
<p>
Read DER encoded authenticator from file and populate given
authenticator variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> output variable with newly allocated authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-parse"></a><h3>shishi_authenticator_parse ()</h3>
<pre class="programlisting">int                 shishi_authenticator_parse          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);</pre>
<p>
Read ASCII armored DER encoded authenticator from file and populate
given authenticator variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> output variable with newly allocated authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-from-file"></a><h3>shishi_authenticator_from_file ()</h3>
<pre class="programlisting">int                 shishi_authenticator_from_file      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read Authenticator from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> output variable with newly allocated Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-print"></a><h3>shishi_authenticator_print ()</h3>
<pre class="programlisting">int                 shishi_authenticator_print          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Print ASCII armored DER encoding of authenticator to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-to-file"></a><h3>shishi_authenticator_to_file ()</h3>
<pre class="programlisting">int                 shishi_authenticator_to_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write Authenticator to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authenticator-save"></a><h3>shishi_authenticator_save ()</h3>
<pre class="programlisting">int                 shishi_authenticator_save           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Save DER encoding of authenticator to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as"></a><h3>shishi_as ()</h3>
<pre class="programlisting">int                 shishi_as                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> **as);</pre>
<p>
Allocate a new AS exchange variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> holds pointer to newly allocate Shishi_as structure.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-done"></a><h3>shishi_as_done ()</h3>
<pre class="programlisting">void                shishi_as_done                      (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Deallocate resources associated with AS exchange.  This should be
called by the application when it no longer need to utilize the AS
exchange handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-req"></a><h3>shishi_as_req ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_as_req                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Get ASN.1 AS-REQ structure from AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the generated AS-REQ packet from the AS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-req-build"></a><h3>shishi_as_req_build ()</h3>
<pre class="programlisting">int                 shishi_as_req_build                 (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Possibly remove unset fields (e.g., rtime).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-req-set"></a><h3>shishi_as_req_set ()</h3>
<pre class="programlisting">void                shishi_as_req_set                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq);</pre>
<p>
Set the AS-REQ in the AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> asreq to store in AS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-req-der"></a><h3>shishi_as_req_der ()</h3>
<pre class="programlisting">int                 shishi_as_req_der                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode AS-REQ.  <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of AS-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of AS-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-req-der-set"></a><h3>shishi_as_req_der_set ()</h3>
<pre class="programlisting">int                 shishi_as_req_der_set               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode AS-REQ and set it AS exchange.  If decoding fails, the
AS-REQ in the AS exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep"></a><h3>shishi_as_rep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_as_rep                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Get ASN.1 AS-REP structure from AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the received AS-REP packet from the AS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep-set"></a><h3>shishi_as_rep_set ()</h3>
<pre class="programlisting">void                shishi_as_rep_set                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);</pre>
<p>
Set the AS-REP in the AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td> asrep to store in AS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep-build"></a><h3>shishi_as_rep_build ()</h3>
<pre class="programlisting">int                 shishi_as_rep_build                 (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Build AS-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> user's key, used to encrypt the encrypted part of the AS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep-der"></a><h3>shishi_as_rep_der ()</h3>
<pre class="programlisting">int                 shishi_as_rep_der                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode AS-REP. <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of AS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of AS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep-der-set"></a><h3>shishi_as_rep_der_set ()</h3>
<pre class="programlisting">int                 shishi_as_rep_der_set               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode AS-REP and set it AS exchange.  If decoding fails, the
AS-REP in the AS exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-krberror"></a><h3>shishi_as_krberror ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_as_krberror                  (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Get ASN.1 KRB-ERROR structure from AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the received KRB-ERROR packet from the AS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-krberror-der"></a><h3>shishi_as_krberror_der ()</h3>
<pre class="programlisting">int                 shishi_as_krberror_der              (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode KRB-ERROR. <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-krberror-set"></a><h3>shishi_as_krberror_set ()</h3>
<pre class="programlisting">void                shishi_as_krberror_set              (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Set the KRB-ERROR in the AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror to store in AS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-tkt"></a><h3>shishi_as_tkt ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_as_tkt                       (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Get Ticket in AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the newly aquired tkt from the AS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-tkt-set"></a><h3>shishi_as_tkt_set ()</h3>
<pre class="programlisting">void                shishi_as_tkt_set                   (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Set the Tkt in the AS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> tkt to store in AS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-sendrecv"></a><h3>shishi_as_sendrecv ()</h3>
<pre class="programlisting">int                 shishi_as_sendrecv                  (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as);</pre>
<p>
Send AS-REQ and receive AS-REP or KRB-ERROR.  This is the initial
authentication, usually used to acquire a Ticket Granting Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-sendrecv-hint"></a><h3>shishi_as_sendrecv_hint ()</h3>
<pre class="programlisting">int                 shishi_as_sendrecv_hint             (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Send AS-REQ and receive AS-REP or KRB-ERROR.  This is the initial
authentication, usually used to acquire a Ticket Granting Ticket.
The <em class="parameter"><code>hint</code></em> structure can be used to set, e.g., parameters for TLS
authentication.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> additional parameters that modify connection behaviour, or <code class="literal">NULL</code>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-rep-process"></a><h3>shishi_as_rep_process ()</h3>
<pre class="programlisting">int                 shishi_as_rep_process               (<a class="link" href="shishi-shishi.html#Shishi-as" title="Shishi_as">Shishi_as</a> *as,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *password);</pre>
<p>
Process new AS-REP and set ticket.  The key is used to decrypt the
AP-REP.  If both key and password is NULL, the user is queried for
it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>as</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> user's key, used to encrypt the encrypted part of the AS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em> :</span></p></td>
<td> user's password, used if key is NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs"></a><h3>shishi_tgs ()</h3>
<pre class="programlisting">int                 shishi_tgs                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> **tgs);</pre>
<p>
Allocate a new TGS exchange variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> holds pointer to newly allocate Shishi_tgs structure.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-done"></a><h3>shishi_tgs_done ()</h3>
<pre class="programlisting">void                shishi_tgs_done                     (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Deallocate resources associated with TGS exchange.  This should be
called by the application when it no longer need to utilize the TGS
exchange handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about AS exchange
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-tgtkt"></a><h3>shishi_tgs_tgtkt ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tgs_tgtkt                    (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get Ticket-granting-ticket from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ticket-granting-ticket used in the TGS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-tgtkt-set"></a><h3>shishi_tgs_tgtkt_set ()</h3>
<pre class="programlisting">void                shishi_tgs_tgtkt_set                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tgtkt);</pre>
<p>
Set the Ticket in the TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgtkt</code></em> :</span></p></td>
<td> ticket granting ticket to store in TGS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-ap"></a><h3>shishi_tgs_ap ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a>*          shishi_tgs_ap                       (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get the AP from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AP exchange (part of TGS-REQ) from the
              TGS exchange, or NULL if not yet set or an error
              occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req"></a><h3>shishi_tgs_req ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgs_req                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get the TGS-REQ from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the generated TGS-REQ from the TGS exchange,
              or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req-der"></a><h3>shishi_tgs_req_der ()</h3>
<pre class="programlisting">int                 shishi_tgs_req_der                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode TGS-REQ. <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of TGS-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of TGS-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req-der-set"></a><h3>shishi_tgs_req_der_set ()</h3>
<pre class="programlisting">int                 shishi_tgs_req_der_set              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode TGS-REQ and set it TGS exchange.  If decoding fails, the
TGS-REQ in the TGS exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req-set"></a><h3>shishi_tgs_req_set ()</h3>
<pre class="programlisting">void                shishi_tgs_req_set                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsreq);</pre>
<p>
Set the TGS-REQ in the TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgsreq</code></em> :</span></p></td>
<td> tgsreq to store in TGS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req-build"></a><h3>shishi_tgs_req_build ()</h3>
<pre class="programlisting">int                 shishi_tgs_req_build                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Checksum data in authenticator and add ticket and authenticator to
TGS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-req-process"></a><h3>shishi_tgs_req_process ()</h3>
<pre class="programlisting">int                 shishi_tgs_req_process              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Process new TGS-REQ and set ticket.  The key to decrypt the TGS-REQ
is taken from the EncKDCReqPart of the TGS tgticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-rep"></a><h3>shishi_tgs_rep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgs_rep                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get TGS-REP from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the received TGS-REP from the TGS exchange,
              or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-rep-der"></a><h3>shishi_tgs_rep_der ()</h3>
<pre class="programlisting">int                 shishi_tgs_rep_der                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode TGS-REP. <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of TGS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of TGS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-rep-build"></a><h3>shishi_tgs_rep_build ()</h3>
<pre class="programlisting">int                 shishi_tgs_rep_build                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Build TGS-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> keyusage integer.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> user's key, used to encrypt the encrypted part of the TGS-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-rep-process"></a><h3>shishi_tgs_rep_process ()</h3>
<pre class="programlisting">int                 shishi_tgs_rep_process              (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Process new TGS-REP and set ticket.  The key to decrypt the TGS-REP
is taken from the EncKDCRepPart of the TGS tgticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-krberror"></a><h3>shishi_tgs_krberror ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgs_krberror                 (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get KRB-ERROR from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the received TGS-REP from the TGS exchange,
              or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-krberror-der"></a><h3>shishi_tgs_krberror_der ()</h3>
<pre class="programlisting">int                 shishi_tgs_krberror_der             (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode KRB-ERROR.  <em class="parameter"><code>out</code></em> is allocated by this function, and it is
the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-krberror-set"></a><h3>shishi_tgs_krberror_set ()</h3>
<pre class="programlisting">void                shishi_tgs_krberror_set             (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Set the KRB-ERROR in the TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror to store in TGS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-tkt"></a><h3>shishi_tgs_tkt ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_tgs_tkt                      (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Get Ticket from TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the newly aquired ticket from the TGS
              exchange, or NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-tkt-set"></a><h3>shishi_tgs_tkt_set ()</h3>
<pre class="programlisting">void                shishi_tgs_tkt_set                  (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Set the Ticket in the TGS exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to store in TGS.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-sendrecv"></a><h3>shishi_tgs_sendrecv ()</h3>
<pre class="programlisting">int                 shishi_tgs_sendrecv                 (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs);</pre>
<p>
Send TGS-REQ and receive TGS-REP or KRB-ERROR.  This is the
subsequent authentication, usually used to acquire server tickets.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-sendrecv-hint"></a><h3>shishi_tgs_sendrecv_hint ()</h3>
<pre class="programlisting">int                 shishi_tgs_sendrecv_hint            (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>
Send TGS-REQ and receive TGS-REP or KRB-ERROR.  This is the
subsequent authentication, usually used to acquire server tickets.
The <em class="parameter"><code>hint</code></em> structure can be used to set, e.g., parameters for TLS
authentication.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td> additional parameters that modify connection behaviour, or <code class="literal">NULL</code>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-set-server"></a><h3>shishi_tgs_set_server ()</h3>
<pre class="programlisting">int                 shishi_tgs_set_server               (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *server);</pre>
<p>
Set the server in the TGS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> indicates the server to acquire ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-set-realm"></a><h3>shishi_tgs_set_realm ()</h3>
<pre class="programlisting">int                 shishi_tgs_set_realm                (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *realm);</pre>
<p>
Set the server in the TGS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> indicates the realm to acquire ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-set-realmserver"></a><h3>shishi_tgs_set_realmserver ()</h3>
<pre class="programlisting">int                 shishi_tgs_set_realmserver          (<a class="link" href="shishi-shishi.html#Shishi-tgs" title="Shishi_tgs">Shishi_tgs</a> *tgs,
                                                         const char *realm,
                                                         const char *server);</pre>
<p>
Set the realm and server in the TGS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgs</code></em> :</span></p></td>
<td> structure that holds information about TGS exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> indicates the realm to acquire ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> indicates the server to acquire ticket for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq"></a><h3>shishi_kdcreq ()</h3>
<pre class="programlisting">int                 shishi_kdcreq                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *service,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *req);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>req</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asreq"></a><h3>shishi_asreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asreq                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new AS-REQ, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AS-REQ or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asreq-rsc"></a><h3>shishi_asreq_rsc ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asreq_rsc                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *server,
                                                         char *client);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgsreq"></a><h3>shishi_tgsreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgsreq                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new TGS-REQ, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the TGS-REQ or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgsreq-rst"></a><h3>shishi_tgsreq_rst ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgsreq_rst                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         char *server,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-save"></a><h3>shishi_kdcreq_save ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_save                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Print DER encoding of KDC-REQ to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-print"></a><h3>shishi_kdcreq_print ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_print                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Print ASCII armored DER encoding of KDC-REQ to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-to-file"></a><h3>shishi_kdcreq_to_file ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_to_file               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write KDC-REQ to file in specified TYPE.  The file will be truncated
if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-parse"></a><h3>shishi_kdcreq_parse ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_parse                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq);</pre>
<p>
Read ASCII armored DER encoded KDC-REQ from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-read"></a><h3>shishi_kdcreq_read ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_read                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq);</pre>
<p>
Read DER encoded KDC-REQ from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-from-file"></a><h3>shishi_kdcreq_from_file ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_from_file             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcreq,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read KDC-REQ from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asreq-clientrealm"></a><h3>shishi_asreq_clientrealm ()</h3>
<pre class="programlisting">int                 shishi_asreq_clientrealm            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Convert cname and realm fields from AS-REQ to printable principal
name format.  The string is allocate by this function, and it is
the responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>clientlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> AS-REQ variable to get client name and realm from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name and realm.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-nonce"></a><h3>shishi_kdcreq_nonce ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_nonce                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t *nonce);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>nonce</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-nonce-set"></a><h3>shishi_kdcreq_nonce_set ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_nonce_set             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t nonce);</pre>
<p>
Store nonce number field in KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>nonce</code></em> :</span></p></td>
<td> integer nonce to store in KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-client"></a><h3>shishi_kdcreq_client ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_client                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Represent client principal name in KDC-REQ as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>clientlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get client name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-cname"></a><h3>shishi_kdcreq_set_cname ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_cname             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *principal);</pre>
<p>
Set the client name field in the KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-server"></a><h3>shishi_kdcreq_server ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_server                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **server,
                                                         size_t *serverlen);</pre>
<p>
Represent server principal name in KDC-REQ as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>serverlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get server name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>serverlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>serverlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>server</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>server</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-sname"></a><h3>shishi_kdcreq_set_sname ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_sname             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *sname[]);</pre>
<p>
Set the server name field in the KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-realm"></a><h3>shishi_kdcreq_realm ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_realm                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>
Get realm field in KDC-REQ as zero-terminated string.  The string
is allocate by this function, and it is the responsibility of the
caller to deallocate it.  Note that the output length <em class="parameter"><code>realmlen</code></em>
does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get client name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  realm.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>realmlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>realm</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>realmlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-realm-get"></a><h3>shishi_kdcreq_realm_get ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_realm_get             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-realm"></a><h3>shishi_kdcreq_set_realm ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_realm             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         const char *realm);</pre>
<p>
Set the realm field in the KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set realm field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> input array with name of realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-server"></a><h3>shishi_kdcreq_set_server ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_server            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> req,
                                                         const char *service);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>req</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-realmserver"></a><h3>shishi_kdcreq_set_realmserver ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_realmserver       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> req,
                                                         char *realm,
                                                         char *service);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>req</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-till"></a><h3>shishi_kdcreq_till ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_till                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         char **till,
                                                         size_t *tilllen);</pre>
<p>
Get "till" field (i.e. "endtime") in KDC-REQ, as zero-terminated
string.  The string is typically 15 characters long.  The string is
allocated by this function, and it is the responsibility of the
caller to deallocate it.  Note that the output length <em class="parameter"><code>realmlen</code></em>
does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get client name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>till</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  "till" field with generalized time.  May be <code class="literal">NULL</code> (to only
  populate <em class="parameter"><code>realmlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tilllen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>till</code></em> on output, excluding
  terminating zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>tilllen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-tillc"></a><h3>shishi_kdcreq_tillc ()</h3>
<pre class="programlisting">time_t              shishi_kdcreq_tillc                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Extract C time corresponding to the "till" field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get till field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time interpretation of the "till" field in
KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-etype"></a><h3>shishi_kdcreq_etype ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_etype                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int32_t *etype,
                                                         int netype);</pre>
<p>
Return the netype:th encryption type from KDC-REQ.  The first etype
is number 1.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get etype field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output encryption type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>netype</code></em> :</span></p></td>
<td> element number to return.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff etype successful set.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-set-etype"></a><h3>shishi_kdcreq_set_etype ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_set_etype             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int32_t *etype,
                                                         int netype);</pre>
<p>
Set the list of supported or wanted encryption types in the
request.  The list should be sorted in priority order.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set etype field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> input array with encryption types.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>netype</code></em> :</span></p></td>
<td> number of elements in input array with encryption types.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-options"></a><h3>shishi_kdcreq_options ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_options               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t *flags);</pre>
<p>
Extract KDC-Options from KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> pointer to output integer with flags.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-forwardable-p"></a><h3>shishi_kdcreq_forwardable_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_forwardable_p         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option forwardable flag is set.
</p>
<p>
The FORWARDABLE option indicates that the ticket to be issued is to
have its forwardable flag set. It may only be set on the initial
request, or in a subsequent request if the ticket-granting ticket
on which it is based is also forwardable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff forwardable flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-forwarded-p"></a><h3>shishi_kdcreq_forwarded_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_forwarded_p           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option forwarded flag is set.
</p>
<p>
The FORWARDED option is only specified in a request to the
ticket-granting server and will only be honored if the
ticket-granting ticket in the request has its FORWARDABLE bit
set. This option indicates that this is a request for
forwarding. The address(es) of the host from which the resulting
ticket is to be valid are included in the addresses field of the
request.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff forwarded flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-proxiable-p"></a><h3>shishi_kdcreq_proxiable_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_proxiable_p           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option proxiable flag is set.
</p>
<p>
The PROXIABLE option indicates that the ticket to be issued is to
have its proxiable flag set. It may only be set on the initial
request, or in a subsequent request if the ticket-granting ticket
on which it is based is also proxiable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff proxiable flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-proxy-p"></a><h3>shishi_kdcreq_proxy_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_proxy_p               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option proxy flag is set.
</p>
<p>
The PROXY option indicates that this is a request for a proxy. This
option will only be honored if the ticket-granting ticket in the
request has its PROXIABLE bit set.  The address(es) of the host
from which the resulting ticket is to be valid are included in the
addresses field of the request.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff proxy flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-allow-postdate-p"></a><h3>shishi_kdcreq_allow_postdate_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_allow_postdate_p      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option allow-postdate flag is set.
</p>
<p>
The ALLOW-POSTDATE option indicates that the ticket to be issued is
to have its MAY-POSTDATE flag set. It may only be set on the
initial request, or in a subsequent request if the ticket-granting
ticket on which it is based also has its MAY-POSTDATE flag set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff allow-postdate flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-postdated-p"></a><h3>shishi_kdcreq_postdated_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_postdated_p           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option postdated flag is set.
</p>
<p>
The POSTDATED option indicates that this is a request for a
postdated ticket. This option will only be honored if the
ticket-granting ticket on which it is based has its MAY-POSTDATE
flag set. The resulting ticket will also have its INVALID flag set,
and that flag may be reset by a subsequent request to the KDC after
the starttime in the ticket has been reached.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff postdated flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-renewable-p"></a><h3>shishi_kdcreq_renewable_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_renewable_p           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option renewable flag is set.
</p>
<p>
The RENEWABLE option indicates that the ticket to be issued is to
have its RENEWABLE flag set. It may only be set on the initial
request, or when the ticket-granting ticket on which the request is
based is also renewable. If this option is requested, then the
rtime field in the request contains the desired absolute expiration
time for the ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff renewable flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-disable-transited-check-p"></a><h3>shishi_kdcreq_disable_transited_check_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_disable_transited_check_p
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option disable-transited-check flag is set.
</p>
<p>
By default the KDC will check the transited field of a
ticket-granting-ticket against the policy of the local realm before
it will issue derivative tickets based on the ticket-granting
ticket. If this flag is set in the request, checking of the
transited field is disabled. Tickets issued without the performance
of this check will be noted by the reset (0) value of the
TRANSITED-POLICY-CHECKED flag, indicating to the application server
that the tranisted field must be checked locally. KDCs are
encouraged but not required to honor the DISABLE-TRANSITED-CHECK
option.
</p>
<p>
This flag is new since RFC 1510</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff disable-transited-check flag is set
  in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-renewable-ok-p"></a><h3>shishi_kdcreq_renewable_ok_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_renewable_ok_p        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option renewable-ok flag is set.
</p>
<p>
The RENEWABLE-OK option indicates that a renewable ticket will be
acceptable if a ticket with the requested life cannot otherwise be
provided. If a ticket with the requested life cannot be provided,
then a renewable ticket may be issued with a renew-till equal to
the requested endtime. The value of the renew-till field may still
be limited by local limits, or limits selected by the individual
principal or server.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff renewable-ok flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-enc-tkt-in-skey-p"></a><h3>shishi_kdcreq_enc_tkt_in_skey_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_enc_tkt_in_skey_p     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option enc-tkt-in-skey flag is set.
</p>
<p>
This option is used only by the ticket-granting service. The
ENC-TKT-IN-SKEY option indicates that the ticket for the end server
is to be encrypted in the session key from the additional
ticket-granting ticket provided.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff enc-tkt-in-skey flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-renew-p"></a><h3>shishi_kdcreq_renew_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_renew_p               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option renew flag is set.
</p>
<p>
This option is used only by the ticket-granting service. The RENEW
option indicates that the present request is for a renewal. The
ticket provided is encrypted in the secret key for the server on
which it is valid. This option will only be honored if the ticket
to be renewed has its RENEWABLE flag set and if the time in its
renew-till field has not passed. The ticket to be renewed is passed
in the padata field as part of the authentication header.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff renew flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-validate-p"></a><h3>shishi_kdcreq_validate_p ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_validate_p            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Determine if KDC-Option validate flag is set.
</p>
<p>
This option is used only by the ticket-granting service. The
VALIDATE option indicates that the request is to validate a
postdated ticket. It will only be honored if the ticket presented
is postdated, presently has its INVALID flag set, and would be
otherwise usable at this time. A ticket cannot be validated before
its starttime. The ticket presented for validation is encrypted in
the key of the server for which it is valid and is passed in the
padata field as part of the authentication header.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to get kdc-options field from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns non-0 iff validate flag is set in KDC-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-options-set"></a><h3>shishi_kdcreq_options_set ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_options_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t options);</pre>
<p>
Set options in KDC-REQ.  Note that this reset any already existing
flags.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set etype field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> integer with flags to store in KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-options-add"></a><h3>shishi_kdcreq_options_add ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_options_add           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         uint32_t option);</pre>
<p>
Add KDC-Option to KDC-REQ.  This preserves all existing options.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ variable to set etype field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>option</code></em> :</span></p></td>
<td> integer with options to add in KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-clear-padata"></a><h3>shishi_kdcreq_clear_padata ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_clear_padata          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>
Remove the padata field from KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to remove PA-DATA from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-get-padata"></a><h3>shishi_kdcreq_get_padata ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_get_padata            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-padata-type" title="enum Shishi_padata_type">Shishi_padata_type</a> padatatype,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Get pre authentication data (PA-DATA) from KDC-REQ.  Pre
authentication data is used to pass various information to KDC,
such as in case of a SHISHI_PA_TGS_REQ padatatype the AP-REQ that
authenticates the user to get the ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to get PA-DATA from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>padatatype</code></em> :</span></p></td>
<td> type of PA-DATA, see Shishi_padata_type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated PA-DATA value.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> size of output array with PA-DATA value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-get-padata-tgs"></a><h3>shishi_kdcreq_get_padata_tgs ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_get_padata_tgs        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);</pre>
<p>
Extract TGS pre-authentication data from KDC-REQ.  The data is an
AP-REQ that authenticates the request.  This function call
<a class="link" href="shishi-shishi.html#shishi-kdcreq-get-padata" title="shishi_kdcreq_get_padata ()"><code class="function">shishi_kdcreq_get_padata()</code></a> with a SHISHI_PA_TGS_REQ padatatype and
DER decode the result (if any).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to get PA-TGS-REQ from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> Output variable with newly allocated AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-add-padata"></a><h3>shishi_kdcreq_add_padata ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_add_padata            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         int padatatype,
                                                         const char *data,
                                                         size_t datalen);</pre>
<p>
Add new pre authentication data (PA-DATA) to KDC-REQ.  This is used
to pass various information to KDC, such as in case of a
SHISHI_PA_TGS_REQ padatatype the AP-REQ that authenticates the user
to get the ticket.  (But also see <a class="link" href="shishi-shishi.html#shishi-kdcreq-add-padata-tgs" title="shishi_kdcreq_add_padata_tgs ()"><code class="function">shishi_kdcreq_add_padata_tgs()</code></a>
which takes an AP-REQ directly.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to add PA-DATA to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>padatatype</code></em> :</span></p></td>
<td> type of PA-DATA, see Shishi_padata_type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with PA-DATA value.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> size of input array with PA-DATA value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-add-padata-tgs"></a><h3>shishi_kdcreq_add_padata_tgs ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_add_padata_tgs        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Add TGS pre-authentication data to KDC-REQ.  The data is an AP-REQ
that authenticates the request.  This functions simply DER encodes
the AP-REQ and calls <a class="link" href="shishi-shishi.html#shishi-kdcreq-add-padata" title="shishi_kdcreq_add_padata ()"><code class="function">shishi_kdcreq_add_padata()</code></a> with a
SHISHI_PA_TGS_REQ padatatype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to add PA-DATA to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to add as PA-DATA.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-add-padata-preauth"></a><h3>shishi_kdcreq_add_padata_preauth ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_add_padata_preauth    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Add pre-authentication data to KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to add pre-authentication data to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> Key used to encrypt pre-auth data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-build"></a><h3>shishi_kdcreq_build ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_build                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-derive-salt"></a><h3>shishi_as_derive_salt ()</h3>
<pre class="programlisting">int                 shishi_as_derive_salt               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         char **salt,
                                                         size_t *saltlen);</pre>
<p>
Derive the salt that should be used when deriving a key via
<a class="link" href="shishi-shishi.html#shishi-string-to-key" title="shishi_string_to_key ()"><code class="function">shishi_string_to_key()</code></a> for an AS exchange.  Currently this searches
for PA-DATA of type SHISHI_PA_PW_SALT in the AS-REP and returns it
if found, otherwise the salt is derived from the client name and
realm in AS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> input AS-REQ variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td> input AS-REP variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>salt</code></em> :</span></p></td>
<td> newly allocated output array with salt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>saltlen</code></em> :</span></p></td>
<td> holds actual size of output array with salt.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgs-process"></a><h3>shishi_tgs_process ()</h3>
<pre class="programlisting">int                 shishi_tgs_process                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> tgsrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> oldenckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>
Process a TGS client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  This function
simply derives the encryption key from the ticket used to construct
the TGS request and calls <a class="link" href="shishi-shishi.html#shishi-kdc-process" title="shishi_kdc_process ()"><code class="function">shishi_kdc_process()</code></a>, which see.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgsreq</code></em> :</span></p></td>
<td> input variable that holds the sent KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tgsrep</code></em> :</span></p></td>
<td> input variable that holds the received KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> input variable with Authenticator from AP-REQ in KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>oldenckdcreppart</code></em> :</span></p></td>
<td> input variable with EncKDCRepPart used in request.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> output variable that holds new EncKDCRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff the TGS client exchange was
successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-process"></a><h3>shishi_as_process ()</h3>
<pre class="programlisting">int                 shishi_as_process                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep,
                                                         const char *string,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>
Process an AS client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  This function
simply derives the encryption key from the password and calls
<a class="link" href="shishi-shishi.html#shishi-kdc-process" title="shishi_kdc_process ()"><code class="function">shishi_kdc_process()</code></a>, which see.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> input variable that holds the sent KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td> input variable that holds the received KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>string</code></em> :</span></p></td>
<td> input variable with zero terminated password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> output variable that holds new EncKDCRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff the AS client exchange was
successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-process"></a><h3>shishi_kdc_process ()</h3>
<pre class="programlisting">int                 shishi_kdc_process                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>
Process a KDC client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  Use
<a class="link" href="shishi-shishi.html#shishi-kdcrep-get-ticket" title="shishi_kdcrep_get_ticket ()"><code class="function">shishi_kdcrep_get_ticket()</code></a> to extract the ticket.  This function
verifies the various conditions that must hold if the response is
to be considered valid, specifically it compares nonces
(<code class="function">shishi_check_nonces()</code>) and if the exchange was a AS exchange, it
also compares cname and crealm (<code class="function">shishi_check_cname()</code> and
<code class="function">shishi_check_crealm()</code>).
</p>
<p>
Usually the <a class="link" href="shishi-shishi.html#shishi-as-process" title="shishi_as_process ()"><code class="function">shishi_as_process()</code></a> and <a class="link" href="shishi-shishi.html#shishi-tgs-process" title="shishi_tgs_process ()"><code class="function">shishi_tgs_process()</code></a> functions
should be used instead, since they simplify the decryption key
computation.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> input variable that holds the sent KDC-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> input variable that holds the received KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input array with key to decrypt encrypted part of KDC-REP with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> kereros key usage value.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> output variable that holds new EncKDCRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff the KDC client exchange was
successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-sendrecv"></a><h3>shishi_kdcreq_sendrecv ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_sendrecv              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcreq-sendrecv-hint"></a><h3>shishi_kdcreq_sendrecv_hint ()</h3>
<pre class="programlisting">int                 shishi_kdcreq_sendrecv_hint         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-copy-crealm"></a><h3>shishi_kdc_copy_crealm ()</h3>
<pre class="programlisting">int                 shishi_kdc_copy_crealm              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>
Set crealm in KDC-REP to value in EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to read crealm from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> EncTicketPart to set crealm in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-check-crealm"></a><h3>shishi_as_check_crealm ()</h3>
<pre class="programlisting">int                 shishi_as_check_crealm              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);</pre>
<p>
Verify that AS-REQ.req-body.realm and AS-REP.crealm fields matches.
This is one of the steps that has to be performed when processing a
AS-REQ and AS-REP exchange, see <a class="link" href="shishi-shishi.html#shishi-kdc-process" title="shishi_kdc_process ()"><code class="function">shishi_kdc_process()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> AS-REQ to compare realm field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td> AS-REP to compare realm field in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
SHISHI_REALM_MISMATCH if the values differ, or an error code.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-copy-cname"></a><h3>shishi_kdc_copy_cname ()</h3>
<pre class="programlisting">int                 shishi_kdc_copy_cname               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>
Set cname in KDC-REP to value in EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REQ to read cname from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> EncTicketPart to set cname in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-as-check-cname"></a><h3>shishi_as_check_cname ()</h3>
<pre class="programlisting">int                 shishi_as_check_cname               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asrep);</pre>
<p>
Verify that AS-REQ.req-body.realm and AS-REP.crealm fields matches.
This is one of the steps that has to be performed when processing a
AS-REQ and AS-REP exchange, see <a class="link" href="shishi-shishi.html#shishi-kdc-process" title="shishi_kdc_process ()"><code class="function">shishi_kdc_process()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asreq</code></em> :</span></p></td>
<td> AS-REQ to compare client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asrep</code></em> :</span></p></td>
<td> AS-REP to compare client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
SHISHI_CNAME_MISMATCH if the values differ, or an error code.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-copy-nonce"></a><h3>shishi_kdc_copy_nonce ()</h3>
<pre class="programlisting">int                 shishi_kdc_copy_nonce               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>
Set nonce in EncKDCRepPart to value in KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to read nonce from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> EncKDCRepPart to set nonce in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-check-nonce"></a><h3>shishi_kdc_check_nonce ()</h3>
<pre class="programlisting">int                 shishi_kdc_check_nonce              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>
Verify that KDC-REQ.req-body.nonce and EncKDCRepPart.nonce fields
matches.  This is one of the steps that has to be performed when
processing a KDC-REQ and KDC-REP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcreq</code></em> :</span></p></td>
<td> KDC-REQ to compare nonce field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> Encrypted KDC-REP part to compare nonce field in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
SHISHI_NONCE_LENGTH_MISMATCH if the nonces have different lengths
(usually indicates that buggy server truncated nonce to 4 bytes),
SHISHI_NONCE_MISMATCH if the values differ, or an error code.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asrep"></a><h3>shishi_asrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asrep                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new AS-REP, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AS-REP or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-tgsrep"></a><h3>shishi_tgsrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_tgsrep                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new TGS-REP, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the TGS-REP or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-save"></a><h3>shishi_kdcrep_save ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_save                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);</pre>
<p>
Print  DER encoding of KDC-REP to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-print"></a><h3>shishi_kdcrep_print ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_print                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);</pre>
<p>
Print ASCII armored DER encoding of KDC-REP to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-to-file"></a><h3>shishi_kdcrep_to_file ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_to_file               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write KDC-REP to file in specified TYPE.  The file will be truncated
if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-parse"></a><h3>shishi_kdcrep_parse ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_parse                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);</pre>
<p>
Read ASCII armored DER encoded KDC-REP from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-read"></a><h3>shishi_kdcrep_read ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_read                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep);</pre>
<p>
Read DER encoded KDC-REP from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-from-file"></a><h3>shishi_kdcrep_from_file ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_from_file             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *kdcrep,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read KDC-REP from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> output variable with newly allocated KDC-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-clear-padata"></a><h3>shishi_kdcrep_clear_padata ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_clear_padata          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep);</pre>
<p>
Remove the padata field from KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to remove PA-DATA from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-get-enc-part-etype"></a><h3>shishi_kdcrep_get_enc_part_etype ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_get_enc_part_etype    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int32_t *etype);</pre>
<p>
Extract KDC-REP.enc-part.etype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP variable to get value from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output variable that holds the value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-add-enc-part"></a><h3>shishi_kdcrep_add_enc_part ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_add_enc_part          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart);</pre>
<p>
Encrypts DER encoded EncKDCRepPart using key and stores it in the
KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to add enc-part field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key used to encrypt enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> key usage to use, normally SHISHI_KEYUSAGE_ENCASREPPART,
           SHISHI_KEYUSAGE_ENCTGSREPPART_SESSION_KEY or
           SHISHI_KEYUSAGE_ENCTGSREPPART_AUTHENTICATOR_KEY.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> EncKDCRepPart to add.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-get-ticket"></a><h3>shishi_kdcrep_get_ticket ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_get_ticket            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);</pre>
<p>
Extract ticket from KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP variable to get ticket from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> output variable to hold extracted ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-set-ticket"></a><h3>shishi_kdcrep_set_ticket ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_set_ticket            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);</pre>
<p>
Copy ticket into KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to add ticket field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input ticket to copy into KDC-REP ticket field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-crealm-set"></a><h3>shishi_kdcrep_crealm_set ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_crealm_set            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *crealm);</pre>
<p>
Set the client realm field in the KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> Kdcrep variable to set realm field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealm</code></em> :</span></p></td>
<td> input array with name of realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-cname-set"></a><h3>shishi_kdcrep_cname_set ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_cname_set             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);</pre>
<p>
Set the server name field in the KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> Kdcrep variable to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-client-set"></a><h3>shishi_kdcrep_client_set ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_client_set            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *client);</pre>
<p>
Set the client name field in the KDC-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> Kdcrep variable to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> zero-terminated string with principal name on RFC 1964 form.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-crealmserver-set"></a><h3>shishi_kdcrep_crealmserver_set ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_crealmserver_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         const char *crealm,
                                                         const char *client);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-set-enc-part"></a><h3>shishi_kdcrep_set_enc_part ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_set_enc_part          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);</pre>
<p>
Set the encrypted enc-part field in the KDC-REP.  The encrypted
data is usually created by calling <a class="link" href="shishi-shishi.html#shishi-encrypt" title="shishi_encrypt ()"><code class="function">shishi_encrypt()</code></a> on the DER
encoded enc-part.  To save time, you may want to use
<a class="link" href="shishi-shishi.html#shishi-kdcrep-add-enc-part" title="shishi_kdcrep_add_enc_part ()"><code class="function">shishi_kdcrep_add_enc_part()</code></a> instead, which calculates the
encrypted data and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td> KDC-REP to add enc-part field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type used to encrypt enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kvno</code></em> :</span></p></td>
<td> key version number.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buf</code></em> :</span></p></td>
<td> input array with encrypted enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buflen</code></em> :</span></p></td>
<td> size of input array with encrypted enc-part.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdcrep-decrypt"></a><h3>shishi_kdcrep_decrypt ()</h3>
<pre class="programlisting">int                 shishi_kdcrep_decrypt               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> kdcrep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *enckdcreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kdcrep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart"></a><h3>shishi_enckdcreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_enckdcreppart                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encasreppart"></a><h3>shishi_encasreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_encasreppart                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-get-key"></a><h3>shishi_enckdcreppart_get_key ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_get_key        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Extract the key to use with the ticket sent in the KDC-REP
associated with the EncKDCRepPart input variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> newly allocated encryption key handle.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-key-set"></a><h3>shishi_enckdcreppart_key_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_key_set        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Set the EncKDCRepPart.key field to key type and value of supplied
key.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key handle with information to store in enckdcreppart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-nonce-set"></a><h3>shishi_enckdcreppart_nonce_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_nonce_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         uint32_t nonce);</pre>
<p>
Set the EncKDCRepPart.nonce field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>nonce</code></em> :</span></p></td>
<td> nonce to set in EncKDCRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-flags-set"></a><h3>shishi_enckdcreppart_flags_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_flags_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         int flags);</pre>
<p>
Set the EncKDCRepPart.flags field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> flags to set in EncKDCRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-authtime-set"></a><h3>shishi_enckdcreppart_authtime_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_authtime_set   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *authtime);</pre>
<p>
Set the EncTicketPart.authtime to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtime</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-starttime-set"></a><h3>shishi_enckdcreppart_starttime_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_starttime_set  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *starttime);</pre>
<p>
Set the EncTicketPart.starttime to supplied value.  Use a NULL
value for <em class="parameter"><code>starttime</code></em> to remove the field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>starttime</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-endtime-set"></a><h3>shishi_enckdcreppart_endtime_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_endtime_set    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *endtime);</pre>
<p>
Set the EncTicketPart.endtime to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>endtime</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-renew-till-set"></a><h3>shishi_enckdcreppart_renew_till_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_renew_till_set (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *renew_till);</pre>
<p>
Set the EncTicketPart.renew-till to supplied value.  Use a NULL
value for <em class="parameter"><code>renew_till</code></em> to remove the field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>renew_till</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-srealm-set"></a><h3>shishi_enckdcreppart_srealm_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_srealm_set     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *srealm);</pre>
<p>
Set the server realm field in the EncKDCRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> EncKDCRepPart variable to set realm field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srealm</code></em> :</span></p></td>
<td> input array with name of realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-sname-set"></a><h3>shishi_enckdcreppart_sname_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_sname_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         char *sname[]);</pre>
<p>
Set the server name field in the EncKDCRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> EncKDCRepPart variable to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-server-set"></a><h3>shishi_enckdcreppart_server_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_server_set     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *server);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-srealmserver-set"></a><h3>shishi_enckdcreppart_srealmserver_set ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_srealmserver_set
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         const char *srealm,
                                                         const char *server);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srealm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-enckdcreppart-populate-encticketpart"></a><h3>shishi_enckdcreppart_populate_encticketpart ()</h3>
<pre class="programlisting">int                 shishi_enckdcreppart_populate_encticketpart
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> enckdcreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>
Set the flags, authtime, starttime, endtime, renew-till and caddr
fields of the EncKDCRepPart to the corresponding values in the
EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>enckdcreppart</code></em> :</span></p></td>
<td> input EncKDCRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror"></a><h3>shishi_krberror ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_krberror                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new KRB-ERROR, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the KRB-ERROR or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-print"></a><h3>shishi_krberror_print ()</h3>
<pre class="programlisting">int                 shishi_krberror_print               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Print ASCII armored DER encoding of KRB-ERROR to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-save"></a><h3>shishi_krberror_save ()</h3>
<pre class="programlisting">int                 shishi_krberror_save                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Save DER encoding of KRB-ERROR to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-to-file"></a><h3>shishi_krberror_to_file ()</h3>
<pre class="programlisting">int                 shishi_krberror_to_file             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write KRB-ERROR to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-parse"></a><h3>shishi_krberror_parse ()</h3>
<pre class="programlisting">int                 shishi_krberror_parse               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror);</pre>
<p>
Read ASCII armored DER encoded KRB-ERROR from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> output variable with newly allocated KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-read"></a><h3>shishi_krberror_read ()</h3>
<pre class="programlisting">int                 shishi_krberror_read                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror);</pre>
<p>
Read DER encoded KRB-ERROR from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> output variable with newly allocated KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-from-file"></a><h3>shishi_krberror_from_file ()</h3>
<pre class="programlisting">int                 shishi_krberror_from_file           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *krberror,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read KRB-ERROR from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> output variable with newly allocated KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-build"></a><h3>shishi_krberror_build ()</h3>
<pre class="programlisting">int                 shishi_krberror_build               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Finish KRB-ERROR, called before e.g. shishi_krberror_der.  This
function removes empty but OPTIONAL fields (such as cname), and</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-der"></a><h3>shishi_krberror_der ()</h3>
<pre class="programlisting">int                 shishi_krberror_der                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode KRB-ERROR.  The caller must deallocate the OUT buffer.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-crealm"></a><h3>shishi_krberror_crealm ()</h3>
<pre class="programlisting">int                 shishi_krberror_crealm              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>
Extract client realm from KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> output array with newly allocated name of realm in KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td> size of output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-crealm"></a><h3>shishi_krberror_remove_crealm ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_crealm       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove client realm field in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-crealm"></a><h3>shishi_krberror_set_crealm ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_crealm          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *crealm);</pre>
<p>
Set realm field in krberror to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealm</code></em> :</span></p></td>
<td> input array with realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-client"></a><h3>shishi_krberror_client ()</h3>
<pre class="programlisting">int                 shishi_krberror_client              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Return client principal name in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-cname"></a><h3>shishi_krberror_set_cname ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_cname           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *cname[]);</pre>
<p>
Set principal field in krberror to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-cname"></a><h3>shishi_krberror_remove_cname ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_cname        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove client realm field in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-client-set"></a><h3>shishi_krberror_client_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_client_set          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *client);</pre>
<p>
Set the client name field in the Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> zero-terminated string with principal name on RFC 1964 form.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-realm"></a><h3>shishi_krberror_realm ()</h3>
<pre class="programlisting">int                 shishi_krberror_realm               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **realm,
                                                         size_t *realmlen);</pre>
<p>
Extract (server) realm from KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> output array with newly allocated name of realm in KRB-ERROR.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realmlen</code></em> :</span></p></td>
<td> size of output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-realm"></a><h3>shishi_krberror_set_realm ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_realm           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *realm);</pre>
<p>
Set (server) realm field in krberror to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> input array with (server) realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-server"></a><h3>shishi_krberror_server ()</h3>
<pre class="programlisting">int                 shishi_krberror_server              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **server,
                                                         size_t *serverlen);</pre>
<p>
Return server principal name in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  server name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>serverlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>serverlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>server</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>server</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-sname"></a><h3>shishi_krberror_remove_sname ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_sname        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove server name field in KRB-ERROR.  (Since it is not marked
OPTIONAL in the ASN.1 profile, what is done is to set the name-type
to UNKNOWN and make sure the name-string sequence is empty.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-sname"></a><h3>shishi_krberror_set_sname ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_sname           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *sname[]);</pre>
<p>
Set principal field in krberror to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sname</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-server-set"></a><h3>shishi_krberror_server_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_server_set          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *server);</pre>
<p>
Set the server name field in the Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror to set server name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> zero-terminated string with principal name on RFC 1964 form.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-ctime"></a><h3>shishi_krberror_ctime ()</h3>
<pre class="programlisting">int                 shishi_krberror_ctime               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **t);</pre>
<p>
Extract client time from KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> newly allocated zero-terminated output array with client time.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-ctime-set"></a><h3>shishi_krberror_ctime_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_ctime_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *t);</pre>
<p>
Store client time in Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> string with generalized time value to store in Krberror.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-ctime"></a><h3>shishi_krberror_remove_ctime ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_ctime        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove client time field in Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-cusec"></a><h3>shishi_krberror_cusec ()</h3>
<pre class="programlisting">int                 shishi_krberror_cusec               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t *cusec);</pre>
<p>
Extract client microseconds field from Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> output integer with client microseconds field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-cusec-set"></a><h3>shishi_krberror_cusec_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_cusec_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t cusec);</pre>
<p>
Set the cusec field in the Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> client microseconds to set in krberror, 0-999999.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-cusec"></a><h3>shishi_krberror_remove_cusec ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_cusec        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove client usec field in Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-stime"></a><h3>shishi_krberror_stime ()</h3>
<pre class="programlisting">int                 shishi_krberror_stime               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **t);</pre>
<p>
Extract server time from KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror to set client name field in.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> newly allocated zero-terminated output array with server time.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-stime-set"></a><h3>shishi_krberror_stime_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_stime_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *t);</pre>
<p>
Store server time in Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> string with generalized time value to store in Krberror.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-susec"></a><h3>shishi_krberror_susec ()</h3>
<pre class="programlisting">int                 shishi_krberror_susec               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t *susec);</pre>
<p>
Extract server microseconds field from Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> Krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>susec</code></em> :</span></p></td>
<td> output integer with server microseconds field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-susec-set"></a><h3>shishi_krberror_susec_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_susec_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         uint32_t susec);</pre>
<p>
Set the susec field in the Krberror.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>susec</code></em> :</span></p></td>
<td> server microseconds to set in krberror, 0-999999.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-errorcode-set"></a><h3>shishi_krberror_errorcode_set ()</h3>
<pre class="programlisting">int                 shishi_krberror_errorcode_set       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int errorcode);</pre>
<p>
Set the error-code field to a new error code.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code to set.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>errorcode</code></em> :</span></p></td>
<td> new error code to set in krberror.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-etext"></a><h3>shishi_krberror_etext ()</h3>
<pre class="programlisting">int                 shishi_krberror_etext               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **etext,
                                                         size_t *etextlen);</pre>
<p>
Extract additional error text from server (possibly empty).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etext</code></em> :</span></p></td>
<td> output array with newly allocated error text.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etextlen</code></em> :</span></p></td>
<td> output length of error text.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-etext"></a><h3>shishi_krberror_set_etext ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_etext           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *etext);</pre>
<p>
Set error text (e-text) field in KRB-ERROR to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etext</code></em> :</span></p></td>
<td> input array with error text to set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-etext"></a><h3>shishi_krberror_remove_etext ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_etext        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove error text (e-text) field in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-edata"></a><h3>shishi_krberror_edata ()</h3>
<pre class="programlisting">int                 shishi_krberror_edata               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         char **edata,
                                                         size_t *edatalen);</pre>
<p>
Extract additional error data from server (possibly empty).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>edata</code></em> :</span></p></td>
<td> output array with newly allocated error data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>edatalen</code></em> :</span></p></td>
<td> output length of error data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-set-edata"></a><h3>shishi_krberror_set_edata ()</h3>
<pre class="programlisting">int                 shishi_krberror_set_edata           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         const char *edata);</pre>
<p>
Set error text (e-data) field in KRB-ERROR to specified value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>edata</code></em> :</span></p></td>
<td> input array with error text to set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-remove-edata"></a><h3>shishi_krberror_remove_edata ()</h3>
<pre class="programlisting">int                 shishi_krberror_remove_edata        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Remove error text (e-data) field in KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> krberror as allocated by <a class="link" href="shishi-shishi.html#shishi-krberror" title="shishi_krberror ()"><code class="function">shishi_krberror()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-errorcode"></a><h3>shishi_krberror_errorcode ()</h3>
<pre class="programlisting">int                 shishi_krberror_errorcode           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         int *errorcode);</pre>
<p>
Extract error code from KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>errorcode</code></em> :</span></p></td>
<td> output integer KRB-ERROR error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-errorcode-fast"></a><h3>shishi_krberror_errorcode_fast ()</h3>
<pre class="programlisting">int                 shishi_krberror_errorcode_fast      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Get error code from KRB-ERROR, without error checking.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return error code (see <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode" title="shishi_krberror_errorcode ()"><code class="function">shishi_krberror_errorcode()</code></a>)
              directly, or -1 on error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-pretty-print"></a><h3>shishi_krberror_pretty_print ()</h3>
<pre class="programlisting">int                 shishi_krberror_pretty_print        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Print KRB-ERROR error condition and some explanatory text to file
descriptor.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle opened for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-errorcode-message"></a><h3>shishi_krberror_errorcode_message ()</h3>
<pre class="programlisting">const char*         shishi_krberror_errorcode_message   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int errorcode);</pre>
<p>
Get human readable string describing KRB-ERROR code.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>errorcode</code></em> :</span></p></td>
<td> integer KRB-ERROR error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return a string describing error code.  This function
              will always return a string even if the error code
              isn't known.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-message"></a><h3>shishi_krberror_message ()</h3>
<pre class="programlisting">const char*         shishi_krberror_message             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror);</pre>
<p>
Extract error code (see <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode-fast" title="shishi_krberror_errorcode_fast ()"><code class="function">shishi_krberror_errorcode_fast()</code></a>) and
return error message (see <a class="link" href="shishi-shishi.html#shishi-krberror-errorcode-message" title="shishi_krberror_errorcode_message ()"><code class="function">shishi_krberror_errorcode_message()</code></a>).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return a string describing error code.  This function
              will always return a string even if the error code
              isn't known.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-krberror-methoddata"></a><h3>shishi_krberror_methoddata ()</h3>
<pre class="programlisting">int                 shishi_krberror_methoddata          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> krberror,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *methoddata);</pre>
<p>
Extract METHOD-DATA ASN.1 object from the e-data field.  The e-data
field will only contain a METHOD-DATA if the krberror error code is
<code class="literal">SHISHI_KDC_ERR_PREAUTH_REQUIRED</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>krberror</code></em> :</span></p></td>
<td> KRB-ERROR structure with error code.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>methoddata</code></em> :</span></p></td>
<td> output ASN.1 METHOD-DATA.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-generalize-time"></a><h3>shishi_generalize_time ()</h3>
<pre class="programlisting">const char*         shishi_generalize_time              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         time_t t);</pre>
<p>
Convert C time to KerberosTime.  The string must not be deallocate
by caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> C time to convert.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return a KerberosTime time string corresponding to C time t.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-generalize-now"></a><h3>shishi_generalize_now ()</h3>
<pre class="programlisting">const char*         shishi_generalize_now               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Convert current time to KerberosTime.  The string must not be
deallocate by caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return a KerberosTime time string corresponding to
  current time.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-generalize-ctime"></a><h3>shishi_generalize_ctime ()</h3>
<pre class="programlisting">time_t              shishi_generalize_ctime             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *t);</pre>
<p>
Convert KerberosTime to C time.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> KerberosTime to convert.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns C time corresponding to KerberosTime t.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-time"></a><h3>shishi_time ()</h3>
<pre class="programlisting">int                 shishi_time                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **t);</pre>
<p>
Extract time from ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 node to get time from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> Name of field in ASN.1 node to get time from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> newly allocated output array with zero terminated time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ctime"></a><h3>shishi_ctime ()</h3>
<pre class="programlisting">int                 shishi_ctime                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         time_t *t);</pre>
<p>
Extract time from ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 variable to read field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>node</code></em> to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> pointer to time field to set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
  SHISHI_ASN1_NO_ELEMENT if the element do not exist,
  SHISHI_ASN1_NO_VALUE if the field has no value, ot
  SHISHI_ASN1_ERROR otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-randomize"></a><h3>shishi_randomize ()</h3>
<pre class="programlisting">int                 shishi_randomize                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int strong,
                                                         void *data,
                                                         size_t datalen);</pre>
<p>
Store cryptographically random data of given size in the provided
buffer.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>strong</code></em> :</span></p></td>
<td> 0 iff operation should not block, non-0 for very strong randomness.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> output array to be filled with random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> size of output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-crc"></a><h3>shishi_crc ()</h3>
<pre class="programlisting">int                 shishi_crc                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[4]);</pre>
<p>
Compute checksum of data using CRC32 modified according to RFC
1510.  The <em class="parameter"><code>out</code></em> buffer must be deallocated by the caller.
</p>
<p>
The modifications compared to standard CRC32 is that no initial and
final XOR is performed, and that the output is returned in
LSB-first order.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with checksum of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-md4"></a><h3>shishi_md4 ()</h3>
<pre class="programlisting">int                 shishi_md4                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[16]);</pre>
<p>
Compute hash of data using MD4.  The <em class="parameter"><code>out</code></em> buffer must be
deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with hash of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-md5"></a><h3>shishi_md5 ()</h3>
<pre class="programlisting">int                 shishi_md5                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[16]);</pre>
<p>
Compute hash of data using MD5.  The <em class="parameter"><code>out</code></em> buffer must be
deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with hash of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hmac-md5"></a><h3>shishi_hmac_md5 ()</h3>
<pre class="programlisting">int                 shishi_hmac_md5                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *outhash[16]);</pre>
<p>
Compute keyed checksum of data using HMAC-MD5.  The <em class="parameter"><code>outhash</code></em> buffer
must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keylen</code></em> :</span></p></td>
<td> length of input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outhash</code></em> :</span></p></td>
<td> newly allocated character array with keyed hash of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hmac-sha1"></a><h3>shishi_hmac_sha1 ()</h3>
<pre class="programlisting">int                 shishi_hmac_sha1                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *outhash[20]);</pre>
<p>
Compute keyed checksum of data using HMAC-SHA1.  The <em class="parameter"><code>outhash</code></em>
buffer must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keylen</code></em> :</span></p></td>
<td> length of input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outhash</code></em> :</span></p></td>
<td> newly allocated character array with keyed hash of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-des-cbc-mac"></a><h3>shishi_des_cbc_mac ()</h3>
<pre class="programlisting">int                 shishi_des_cbc_mac                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char key[8],
                                                         const char iv[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out[8]);</pre>
<p>
Computed keyed checksum of data using DES-CBC-MAC.  The <em class="parameter"><code>out</code></em> buffer
must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input character array with initialization vector to use, can be NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to hash.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with keyed hash of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-arcfour"></a><h3>shishi_arcfour ()</h3>
<pre class="programlisting">int                 shishi_arcfour                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char iv[258],
                                                         char *ivout[258],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);</pre>
<p>
Encrypt or decrypt data (depending on <em class="parameter"><code>decryptp</code></em>) using ARCFOUR.
The <em class="parameter"><code>out</code></em> buffer must be deallocated by the caller.
</p>
<p>
The "initialization vector" used here is the concatenation of the
sbox and i and j, and is thus always of size 256 + 1 + 1.  This is
a slight abuse of terminology, and assumes you know what you are
doing.  Don't use it if you can avoid to.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decryptp</code></em> :</span></p></td>
<td> 0 to indicate encryption, non-0 to indicate decryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keylen</code></em> :</span></p></td>
<td> length of input key array.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input character array with initialization vector to use, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output character array with updated initialization vector, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with encrypted/decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-des"></a><h3>shishi_des ()</h3>
<pre class="programlisting">int                 shishi_des                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char key[8],
                                                         const char iv[8],
                                                         char *ivout[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);</pre>
<p>
Encrypt or decrypt data (depending on <em class="parameter"><code>decryptp</code></em>) using DES in CBC
mode.  The <em class="parameter"><code>out</code></em> buffer must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decryptp</code></em> :</span></p></td>
<td> 0 to indicate encryption, non-0 to indicate decryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input character array with initialization vector to use, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output character array with updated initialization vector, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with encrypted/decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-3des"></a><h3>shishi_3des ()</h3>
<pre class="programlisting">int                 shishi_3des                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char key[24],
                                                         const char iv[8],
                                                         char *ivout[8],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);</pre>
<p>
Encrypt or decrypt data (depending on <em class="parameter"><code>decryptp</code></em>) using 3DES in CBC
mode.  The <em class="parameter"><code>out</code></em> buffer must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decryptp</code></em> :</span></p></td>
<td> 0 to indicate encryption, non-0 to indicate decryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input character array with initialization vector to use, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output character array with updated initialization vector, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with encrypted/decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aes-cts"></a><h3>shishi_aes_cts ()</h3>
<pre class="programlisting">int                 shishi_aes_cts                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int decryptp,
                                                         const char *key,
                                                         size_t keylen,
                                                         const char iv[16],
                                                         char *ivout[16],
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out);</pre>
<p>
Encrypt or decrypt data (depending on <em class="parameter"><code>decryptp</code></em>) using AES in
CBC-CTS mode.  The length of the key, <em class="parameter"><code>keylen</code></em>, decide if AES 128 or
AES 256 should be used.  The <em class="parameter"><code>out</code></em> buffer must be deallocated by the
caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decryptp</code></em> :</span></p></td>
<td> 0 to indicate encryption, non-0 to indicate decryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keylen</code></em> :</span></p></td>
<td> length of input character array with key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input character array with initialization vector to use, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output character array with updated initialization vector, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> length of input character array of data to encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> newly allocated character array with encrypted/decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-supported-p"></a><h3>shishi_cipher_supported_p ()</h3>
<pre class="programlisting">int                 shishi_cipher_supported_p           (int type);</pre>
<p>
Find out if cipher is supported.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return 0 iff cipher is unsupported.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-name"></a><h3>shishi_cipher_name ()</h3>
<pre class="programlisting">const char*         shishi_cipher_name                  (int type);</pre>
<p>
Read humanly readable string for cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return name of encryption type,
e.g. "des3-cbc-sha1-kd", as defined in the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-blocksize"></a><h3>shishi_cipher_blocksize ()</h3>
<pre class="programlisting">int                 shishi_cipher_blocksize             (int type);</pre>
<p>
Get block size for cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return block size for encryption type, as defined in
the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-confoundersize"></a><h3>shishi_cipher_confoundersize ()</h3>
<pre class="programlisting">int                 shishi_cipher_confoundersize        (int type);</pre>
<p>
Get length of confounder for cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the size of the confounder (random data) for
encryption type, as defined in the standards, or (size_t)-1 on
error (e.g., unsupported encryption type).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-keylen"></a><h3>shishi_cipher_keylen ()</h3>
<pre class="programlisting">size_t              shishi_cipher_keylen                (int type);</pre>
<p>
Get key length for cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return length of key used for the encryption type, as
defined in the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-randomlen"></a><h3>shishi_cipher_randomlen ()</h3>
<pre class="programlisting">size_t              shishi_cipher_randomlen             (int type);</pre>
<p>
Get length of random data for cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return length of random used for the encryption type,
as defined in the standards, or (size_t)-1 on error (e.g.,
unsupported encryption type).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-defaultcksumtype"></a><h3>shishi_cipher_defaultcksumtype ()</h3>
<pre class="programlisting">int                 shishi_cipher_defaultcksumtype      (int32_t type);</pre>
<p>
Get the default checksum associated with cipher.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return associated checksum mechanism for the
encryption type, as defined in the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-cipher-parse"></a><h3>shishi_cipher_parse ()</h3>
<pre class="programlisting">int                 shishi_cipher_parse                 (const char *cipher);</pre>
<p>
Get cipher number by parsing string.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>cipher</code></em> :</span></p></td>
<td> name of encryption type, e.g. "des3-cbc-sha1-kd".
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return encryption type corresponding to a string.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-checksum-supported-p"></a><h3>shishi_checksum_supported_p ()</h3>
<pre class="programlisting">int                 shishi_checksum_supported_p         (int32_t type);</pre>
<p>
Find out whether checksum is supported.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> checksum type, see Shishi_cksumtype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return 0 iff checksum is unsupported.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-checksum-name"></a><h3>shishi_checksum_name ()</h3>
<pre class="programlisting">const char*         shishi_checksum_name                (int32_t type);</pre>
<p>
Get name of checksum.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> checksum type, see Shishi_cksumtype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return name of checksum type,
e.g. "hmac-sha1-96-aes256", as defined in the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-checksum-cksumlen"></a><h3>shishi_checksum_cksumlen ()</h3>
<pre class="programlisting">size_t              shishi_checksum_cksumlen            (int32_t type);</pre>
<p>
Get length of checksum output.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> checksum type, see Shishi_cksumtype.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return length of checksum used for the checksum type,
as defined in the standards.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-checksum-parse"></a><h3>shishi_checksum_parse ()</h3>
<pre class="programlisting">int                 shishi_checksum_parse               (const char *checksum);</pre>
<p>
Get checksum number by parsing a string.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>checksum</code></em> :</span></p></td>
<td> name of checksum type, e.g. "hmac-sha1-96-aes256".
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return checksum type, see Shishi_cksumtype,
corresponding to a string.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-string-to-key"></a><h3>shishi_string_to_key ()</h3>
<pre class="programlisting">int                 shishi_string_to_key                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t keytype,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *salt,
                                                         size_t saltlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *outkey);</pre>
<p>
Derive key from a string (password) and salt (commonly
concatenation of realm and principal) for specified key type, and
set the type and value in the given key to the computed values.
The parameter value is specific for each keytype, and can be set if
the parameter information is not available.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keytype</code></em> :</span></p></td>
<td> cryptographic encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em> :</span></p></td>
<td> input array with password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>passwordlen</code></em> :</span></p></td>
<td> length of input array with password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>salt</code></em> :</span></p></td>
<td> input array with salt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>saltlen</code></em> :</span></p></td>
<td> length of input array with salt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>parameter</code></em> :</span></p></td>
<td> input array with opaque encryption type specific information.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkey</code></em> :</span></p></td>
<td> allocated key handle that will contain new key.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-random-to-key"></a><h3>shishi_random_to_key ()</h3>
<pre class="programlisting">int                 shishi_random_to_key                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t keytype,
                                                         const char *rnd,
                                                         size_t rndlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *outkey);</pre>
<p>
Derive key from random data for specified key type, and set the
type and value in the given key to the computed values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keytype</code></em> :</span></p></td>
<td> cryptographic encryption type, see Shishi_etype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>rnd</code></em> :</span></p></td>
<td> input array with random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>rndlen</code></em> :</span></p></td>
<td> length of input array with random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkey</code></em> :</span></p></td>
<td> allocated key handle that will contain new key.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt-ivupdate-etype"></a><h3>shishi_encrypt_ivupdate_etype ()</h3>
<pre class="programlisting">int                 shishi_encrypt_ivupdate_etype       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  If IVOUT or
IVOUTLEN is NULL, the updated IV is not saved anywhere.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output array with newly allocated updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivoutlen</code></em> :</span></p></td>
<td> size of output array with updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt-iv-etype"></a><h3>shishi_encrypt_iv_etype ()</h3>
<pre class="programlisting">int                 shishi_encrypt_iv_etype             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  The next IV is
lost, see shishi_encrypt_ivupdate_etype if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt-etype"></a><h3>shishi_encrypt_etype ()</h3>
<pre class="programlisting">int                 shishi_encrypt_etype                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  The default IV
is used, see shishi_encrypt_iv_etype if you need to alter it. The
next IV is lost, see shishi_encrypt_ivupdate_etype if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt-ivupdate"></a><h3>shishi_encrypt_ivupdate ()</h3>
<pre class="programlisting">int                 shishi_encrypt_ivupdate             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  If IVOUT or IVOUTLEN is NULL, the updated IV is not
saved anywhere.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output array with newly allocated updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivoutlen</code></em> :</span></p></td>
<td> size of output array with updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt-iv"></a><h3>shishi_encrypt_iv ()</h3>
<pre class="programlisting">int                 shishi_encrypt_iv                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The next IV is lost, see shishi_encrypt_ivupdate if
you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encrypt"></a><h3>shishi_encrypt ()</h3>
<pre class="programlisting">int                 shishi_encrypt                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypts data using specified key.  The key actually used is
derived using the key usage.  If key usage is 0, no key derivation
is used.  The OUT buffer must be deallocated by the caller.  The
default IV is used, see shishi_encrypt_iv if you need to alter it.
The next IV is lost, see shishi_encrypt_ivupdate if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is encrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt-ivupdate-etype"></a><h3>shishi_decrypt_ivupdate_etype ()</h3>
<pre class="programlisting">int                 shishi_decrypt_ivupdate_etype       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  If IVOUT or
IVOUTLEN is NULL, the updated IV is not saved anywhere.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output array with newly allocated updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivoutlen</code></em> :</span></p></td>
<td> size of output array with updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt-iv-etype"></a><h3>shishi_decrypt_iv_etype ()</h3>
<pre class="programlisting">int                 shishi_decrypt_iv_etype             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  The next IV is
lost, see shishi_decrypt_ivupdate_etype if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt-etype"></a><h3>shishi_decrypt_etype ()</h3>
<pre class="programlisting">int                 shishi_decrypt_etype                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data as per encryption method using specified key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The default IV is used, see shishi_decrypt_iv_etype
if you need to alter it.  The next IV is lost, see
shishi_decrypt_ivupdate_etype if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt-ivupdate"></a><h3>shishi_decrypt_ivupdate ()</h3>
<pre class="programlisting">int                 shishi_decrypt_ivupdate             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         char **ivout,
                                                         size_t *ivoutlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  If IVOUT or IVOUTLEN is NULL, the updated IV is not
saved anywhere.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivout</code></em> :</span></p></td>
<td> output array with newly allocated updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivoutlen</code></em> :</span></p></td>
<td> size of output array with updated initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt-iv"></a><h3>shishi_decrypt_iv ()</h3>
<pre class="programlisting">int                 shishi_decrypt_iv                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *iv,
                                                         size_t ivlen,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The next IV is lost, see
shishi_decrypt_ivupdate_etype if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-decrypt"></a><h3>shishi_decrypt ()</h3>
<pre class="programlisting">int                 shishi_decrypt                      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypts data specified key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used.
The OUT buffer must be deallocated by the caller.  The default IV
is used, see shishi_decrypt_iv if you need to alter it.  The next
IV is lost, see shishi_decrypt_ivupdate if you need it.
</p>
<p>
Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to decrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is decrypting.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-checksum"></a><h3>shishi_checksum ()</h3>
<pre class="programlisting">int                 shishi_checksum                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t cksumtype,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Integrity protect data using key, possibly altered by supplied key
usage.  If key usage is 0, no key derivation is used.  The OUT
buffer must be deallocated by the caller.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to compute checksum with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is used for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> the checksum algorithm to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to integrity protect.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to integrity protect.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated integrity protected data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with length of output array with checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-verify"></a><h3>shishi_verify ()</h3>
<pre class="programlisting">int                 shishi_verify                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int cksumtype,
                                                         const char *in,
                                                         size_t inlen,
                                                         const char *cksum,
                                                         size_t cksumlen);</pre>
<p>
Verify checksum of data using key, possibly altered by supplied key
usage.  If key usage is 0, no key derivation is used.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to verify checksum with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key is used for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> the checksum algorithm to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data that was integrity protected.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data that was integrity protected.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksum</code></em> :</span></p></td>
<td> input array with alleged checksum of data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumlen</code></em> :</span></p></td>
<td> size of input array with alleged checksum of data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-dk"></a><h3>shishi_dk ()</h3>
<pre class="programlisting">int                 shishi_dk                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *prfconstant,
                                                         size_t prfconstantlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *derivedkey);</pre>
<p>
Derive a key from a key and a constant thusly:
DK(KEY, PRFCONSTANT) = SHISHI_RANDOM-TO-KEY(SHISHI_DR(KEY, PRFCONSTANT)).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input cryptographic key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>prfconstant</code></em> :</span></p></td>
<td> input array with the constant string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>prfconstantlen</code></em> :</span></p></td>
<td> size of input array with the constant string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derivedkey</code></em> :</span></p></td>
<td> pointer to derived key (allocated by caller).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-dr"></a><h3>shishi_dr ()</h3>
<pre class="programlisting">int                 shishi_dr                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *prfconstant,
                                                         size_t prfconstantlen,
                                                         char *derivedrandom,
                                                         size_t derivedrandomlen);</pre>
<p>
Derive "random" data from a key and a constant thusly:
DR(KEY, PRFCONSTANT) = TRUNCATE(DERIVEDRANDOMLEN,
                                SHISHI_ENCRYPT(KEY, PRFCONSTANT)).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> input array with cryptographic key to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>prfconstant</code></em> :</span></p></td>
<td> input array with the constant string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>prfconstantlen</code></em> :</span></p></td>
<td> size of input array with the constant string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derivedrandom</code></em> :</span></p></td>
<td> output array with derived random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derivedrandomlen</code></em> :</span></p></td>
<td> size of output array with derived random data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-n-fold"></a><h3>shishi_n_fold ()</h3>
<pre class="programlisting">int                 shishi_n_fold                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *in,
                                                         size_t inlen,
                                                         char *out,
                                                         size_t outlen);</pre>
<p>
Fold data into a fixed length output array, with the intent to give
each input bit approximately equal weight in determining the value
of each output bit.
</p>
<p>
The algorithm is from "A Better Key Schedule For DES-like Ciphers"
by Uri Blumenthal and Steven M. Bellovin,
http://www.research.att.com/~smb/papers/ides.pdf, although the
sample vectors provided by the paper are incorrect.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt ("M").
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> size of output array ("N").
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-pbkdf2-sha1"></a><h3>shishi_pbkdf2_sha1 ()</h3>
<pre class="programlisting">int                 shishi_pbkdf2_sha1                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *P,
                                                         size_t Plen,
                                                         const char *S,
                                                         size_t Slen,
                                                         unsigned int c,
                                                         unsigned int dkLen,
                                                         char *DK);</pre>
<p>
Derive key using the PBKDF2 defined in PKCS5.  PBKDF2 applies a
pseudorandom function to derive keys. The length of the derived key
is essentially unbounded. (However, the maximum effective search
space for the derived key may be limited by the structure of the
underlying pseudorandom function, which is this function is always
SHA1.)</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>P</code></em> :</span></p></td>
<td> input password, an octet string
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>Plen</code></em> :</span></p></td>
<td> length of password, an octet string
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>S</code></em> :</span></p></td>
<td> input salt, an octet string
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>Slen</code></em> :</span></p></td>
<td> length of salt, an octet string
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>c</code></em> :</span></p></td>
<td> iteration count, a positive integer
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>dkLen</code></em> :</span></p></td>
<td> intended length in octets of the derived key, a positive integer,
  at most (2^32 - 1) * hLen.  The DK array must have room for this many
  characters.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>DK</code></em> :</span></p></td>
<td> output derived key, a dkLen-octet string
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-crypto"></a><h3>shishi_crypto ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a>*      shishi_crypto                       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         int32_t etype,
                                                         const char *iv,
                                                         size_t ivlen);</pre>
<p>
Initialize a crypto context.  This store a key, keyusage,
encryption type and initialization vector in a "context", and the
caller can then use this context to perform encryption via
<a class="link" href="shishi-shishi.html#shishi-crypto-encrypt" title="shishi_crypto_encrypt ()"><code class="function">shishi_crypto_encrypt()</code></a> and decryption via <a class="link" href="shishi-shishi.html#shishi-crypto-encrypt" title="shishi_crypto_encrypt ()"><code class="function">shishi_crypto_encrypt()</code></a>
without supplying all those details again.  The functions also
takes care of propagating the IV between calls.
</p>
<p>
When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code class="function">shishi_crypto_done()</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to encrypt with.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> integer specifying what this key will encrypt/decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> integer specifying what cipher to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>iv</code></em> :</span></p></td>
<td> input array with initialization vector
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ivlen</code></em> :</span></p></td>
<td> size of input array with initialization vector.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return a newly allocated crypto context.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-crypto-close"></a><h3>shishi_crypto_close ()</h3>
<pre class="programlisting">void                shishi_crypto_close                 (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx);</pre>
<p>
Deallocate resources associated with the crypto context.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>ctx</code></em> :</span></p></td>
<td> crypto context as returned by <a class="link" href="shishi-shishi.html#shishi-crypto" title="shishi_crypto ()"><code class="function">shishi_crypto()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-crypto-encrypt"></a><h3>shishi_crypto_encrypt ()</h3>
<pre class="programlisting">int                 shishi_crypto_encrypt               (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Encrypt data, using information (e.g., key and initialization
vector) from context.  The IV is updated inside the context after
this call.
</p>
<p>
When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code class="function">shishi_crypto_done()</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ctx</code></em> :</span></p></td>
<td> crypto context as returned by <a class="link" href="shishi-shishi.html#shishi-crypto" title="shishi_crypto ()"><code class="function">shishi_crypto()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to encrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated encrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-crypto-decrypt"></a><h3>shishi_crypto_decrypt ()</h3>
<pre class="programlisting">int                 shishi_crypto_decrypt               (<a class="link" href="shishi-shishi.html#Shishi-crypto" title="Shishi_crypto">Shishi_crypto</a> *ctx,
                                                         const char *in,
                                                         size_t inlen,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Decrypt data, using information (e.g., key and initialization
vector) from context.  The IV is updated inside the context after
this call.
</p>
<p>
When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code class="function">shishi_crypto_done()</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ctx</code></em> :</span></p></td>
<td> crypto context as returned by <a class="link" href="shishi-shishi.html#shishi-crypto" title="shishi_crypto ()"><code class="function">shishi_crypto()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>in</code></em> :</span></p></td>
<td> input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td> size of input array with data to decrypt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated decrypted data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> output variable with size of newly allocated output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-check-version"></a><h3>shishi_check_version ()</h3>
<pre class="programlisting">const char*         shishi_check_version                (const char *req_version);</pre>
<p>
Check that the the version of the library is at minimum the one
given as a string in <em class="parameter"><code>req_version</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>req_version</code></em> :</span></p></td>
<td> version string to compare with, or NULL
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> the actual version string of the library; NULL if the
  condition is not met.  If <code class="literal">NULL</code> is passed to this function no
  check is done and only the version string is returned.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-prompt-password-func"></a><h3>shishi_prompt_password_func ()</h3>
<pre class="programlisting">int                 (*shishi_prompt_password_func)      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char **s,
                                                         const char *format,
                                                         va_list ap);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>s</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-prompt-password-callback-set"></a><h3>shishi_prompt_password_callback_set ()</h3>
<pre class="programlisting">void                shishi_prompt_password_callback_set (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()">shishi_prompt_password_func</a> cb);</pre>
<p>
Set a callback function that will be used by
<a class="link" href="shishi-shishi.html#shishi-prompt-password" title="shishi_prompt_password ()"><code class="function">shishi_prompt_password()</code></a> to query the user for a password.  The
function pointer can be retrieved using
<a class="link" href="shishi-shishi.html#shishi-prompt-password-callback-get" title="shishi_prompt_password_callback_get ()"><code class="function">shishi_prompt_password_callback_get()</code></a>.
</p>
<p>
The <em class="parameter"><code>cb</code></em> function should follow the <a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()"><code class="literal">shishi_prompt_password_func</code></a> prototype:
</p>
<p>
int prompt_password (Shishi * <em class="parameter"><code>handle</code></em>, char **<em class="parameter"><code>s</code></em>,
const char *<em class="parameter"><code>format</code></em>, va_list <em class="parameter"><code>ap</code></em>);
</p>
<p>
If the function returns 0, the <em class="parameter"><code>s</code></em> variable should contain a newly
allocated string with the password read from the user.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cb</code></em> :</span></p></td>
<td> function pointer to application password callback, a
  <a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()"><span class="type">shishi_prompt_password_func</span></a> type.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-prompt-password-callback-get"></a><h3>shishi_prompt_password_callback_get ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()">shishi_prompt_password_func</a> shishi_prompt_password_callback_get
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get the application password prompt function callback as set by
<a class="link" href="shishi-shishi.html#shishi-prompt-password-callback-set" title="shishi_prompt_password_callback_set ()"><code class="function">shishi_prompt_password_callback_set()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the callback, a <a class="link" href="shishi-shishi.html#shishi-prompt-password-func" title="shishi_prompt_password_func ()"><span class="type">shishi_prompt_password_func</span></a> type,
  or <code class="literal">NULL</code>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-prompt-password"></a><h3>shishi_prompt_password ()</h3>
<pre class="programlisting">int                 shishi_prompt_password              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char **s,
                                                         const char *format,
                                                         ...);</pre>
<p>
Format and print a prompt, and read a password from user.  The
password is possibly converted (e.g., converted from Latin-1 to
UTF-8, or processed using Stringprep profile) following any
"stringprocess" keywords in configuration files.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>s</code></em> :</span></p></td>
<td> pointer to newly allocated output string with read password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em> :</span></p></td>
<td> printf(3) style format string.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>...</code></em> :</span></p></td>
<td> printf(3) style arguments.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-number-of-elements"></a><h3>shishi_asn1_number_of_elements ()</h3>
<pre class="programlisting">int                 shishi_asn1_number_of_elements      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         size_t *n);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>n</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-empty-p"></a><h3>shishi_asn1_empty_p ()</h3>
<pre class="programlisting">int                 shishi_asn1_empty_p                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read"></a><h3>shishi_asn1_read ()</h3>
<pre class="programlisting">int                 shishi_asn1_read                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **data,
                                                         size_t *datalen);</pre>
<p>
Extract data stored in a ASN.1 field into a newly allocated buffer.
The buffer will always be zero terminated, even though <em class="parameter"><code>datalen</code></em>
will not include the added zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 variable to read field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>node</code></em> to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> newly allocated output buffer that will hold ASN.1 field data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> actual size of output buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
  SHISHI_ASN1_NO_ELEMENT if the element do not exist,
  SHISHI_ASN1_NO_VALUE if the field has no value, ot
  SHISHI_ASN1_ERROR otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-inline"></a><h3>shishi_asn1_read_inline ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_inline             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char *data,
                                                         size_t *datalen);</pre>
<p>
Extract data stored in a ASN.1 field into a fixed size buffer
allocated by caller.
</p>
<p>
Note that since it is difficult to predict the length of the field,
it is often better to use <a class="link" href="shishi-shishi.html#shishi-asn1-read" title="shishi_asn1_read ()"><code class="function">shishi_asn1_read()</code></a> instead.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 variable to read field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>node</code></em> to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> pre-allocated output buffer that will hold ASN.1 field data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> on input, maximum size of output buffer,
            on output, actual size of output buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
  SHISHI_ASN1_NO_ELEMENT if the element do not exist,
  SHISHI_ASN1_NO_VALUE if the field has no value, ot
  SHISHI_ASN1_ERROR otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-integer"></a><h3>shishi_asn1_read_integer ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_integer            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int *i);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>i</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-int32"></a><h3>shishi_asn1_read_int32 ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_int32              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int32_t *i);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>i</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-uint32"></a><h3>shishi_asn1_read_uint32 ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_uint32             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t *i);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>i</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-bitstring"></a><h3>shishi_asn1_read_bitstring ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_bitstring          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t *flags);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-read-optional"></a><h3>shishi_asn1_read_optional ()</h3>
<pre class="programlisting">int                 shishi_asn1_read_optional           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **data,
                                                         size_t *datalen);</pre>
<p>
Extract data stored in a ASN.1 field into a newly allocated buffer.
If the field does not exist (i.e., SHISHI_ASN1_NO_ELEMENT), this
function set datalen to 0 and succeeds.  Can be useful to read
ASN.1 fields which are marked OPTIONAL in the grammar, if you want
to avoid special error handling in your code.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 variable to read field from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>node</code></em> to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> newly allocated output buffer that will hold ASN.1 field data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td> actual size of output buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful,
  SHISHI_ASN1_NO_VALUE if the field has no value, ot
  SHISHI_ASN1_ERROR otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-write"></a><h3>shishi_asn1_write ()</h3>
<pre class="programlisting">int                 shishi_asn1_write                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         const char *data,
                                                         size_t datalen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>datalen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-write-integer"></a><h3>shishi_asn1_write_integer ()</h3>
<pre class="programlisting">int                 shishi_asn1_write_integer           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int n);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>n</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-write-int32"></a><h3>shishi_asn1_write_int32 ()</h3>
<pre class="programlisting">int                 shishi_asn1_write_int32             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int32_t n);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>n</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-write-uint32"></a><h3>shishi_asn1_write_uint32 ()</h3>
<pre class="programlisting">int                 shishi_asn1_write_uint32            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t n);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>n</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-write-bitstring"></a><h3>shishi_asn1_write_bitstring ()</h3>
<pre class="programlisting">int                 shishi_asn1_write_bitstring         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         uint32_t flags);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-done"></a><h3>shishi_asn1_done ()</h3>
<pre class="programlisting">void                shishi_asn1_done                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node);</pre>
<p>
Deallocate resources associated with ASN.1 structure.  Note that
the node must not be used after this call.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 node to dellocate.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-pa-enc-ts-enc"></a><h3>shishi_asn1_pa_enc_ts_enc ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_pa_enc_ts_enc           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for PA-ENC-TS-ENC.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-encrypteddata"></a><h3>shishi_asn1_encrypteddata ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_encrypteddata           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for EncryptedData</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-padata"></a><h3>shishi_asn1_padata ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_padata                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for PA-DATA.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-methoddata"></a><h3>shishi_asn1_methoddata ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_methoddata              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for METHOD-DATA.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-etype-info"></a><h3>shishi_asn1_etype_info ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_etype_info              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for ETYPE-INFO.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-etype-info2"></a><h3>shishi_asn1_etype_info2 ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_etype_info2             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for ETYPE-INFO2.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-asreq"></a><h3>shishi_asn1_asreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_asreq                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for AS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-asrep"></a><h3>shishi_asn1_asrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_asrep                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for AS-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-tgsreq"></a><h3>shishi_asn1_tgsreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_tgsreq                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for TGS-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-tgsrep"></a><h3>shishi_asn1_tgsrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_tgsrep                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for TGS-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-apreq"></a><h3>shishi_asn1_apreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_apreq                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-aprep"></a><h3>shishi_asn1_aprep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_aprep                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for AP-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-ticket"></a><h3>shishi_asn1_ticket ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_ticket                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-encapreppart"></a><h3>shishi_asn1_encapreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_encapreppart            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for AP-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-encticketpart"></a><h3>shishi_asn1_encticketpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_encticketpart           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-authenticator"></a><h3>shishi_asn1_authenticator ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_authenticator           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-enckdcreppart"></a><h3>shishi_asn1_enckdcreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_enckdcreppart           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for EncKDCRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-encasreppart"></a><h3>shishi_asn1_encasreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_encasreppart            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for EncASRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-krberror"></a><h3>shishi_asn1_krberror ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_krberror                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for KRB-ERROR.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-krbsafe"></a><h3>shishi_asn1_krbsafe ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_krbsafe                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for KRB-SAFE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-priv"></a><h3>shishi_asn1_priv ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_priv                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for KRB-PRIV.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-encprivpart"></a><h3>shishi_asn1_encprivpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_asn1_encprivpart             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Create new ASN.1 structure for EncKrbPrivPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-to-der"></a><h3>shishi_asn1_to_der ()</h3>
<pre class="programlisting">int                 shishi_asn1_to_der                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         char **der,
                                                         size_t *len);</pre>
<p>
Extract newly allocated DER representation of specified ASN.1 data.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 data to convert to DER.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> output array that holds DER encoding of <em class="parameter"><code>node</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> output variable with length of <em class="parameter"><code>der</code></em> output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful, or SHISHI_ASN1_ERROR
  if DER encoding fails (common reasons for this is that the ASN.1
  is missing required values).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-to-der-field"></a><h3>shishi_asn1_to_der_field ()</h3>
<pre class="programlisting">int                 shishi_asn1_to_der_field            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         char **der,
                                                         size_t *len);</pre>
<p>
Extract newly allocated DER representation of specified ASN.1 field.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 data that have field to extract.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> name of field in <em class="parameter"><code>node</code></em> to extract.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> output array that holds DER encoding of <em class="parameter"><code>field</code></em> in <em class="parameter"><code>node</code></em>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> output variable with length of <em class="parameter"><code>der</code></em> output array.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful, or SHISHI_ASN1_ERROR
  if DER encoding fails (common reasons for this is that the ASN.1
  is missing required values).
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-msgtype"></a><h3>shishi_asn1_msgtype ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-msgtype" title="enum Shishi_msgtype">Shishi_msgtype</a>      shishi_asn1_msgtype                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node);</pre>
<p>
Determine msg-type of ASN.1 type of a packet. Currently this uses
the msg-type field instead of the APPLICATION tag, but this may be
changed in the future.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 type to get msg type for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns msg-type of ASN.1 type, 0 on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der-msgtype"></a><h3>shishi_der_msgtype ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-msgtype" title="enum Shishi_msgtype">Shishi_msgtype</a>      shishi_der_msgtype                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Determine msg-type of DER coded data of a packet.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns msg-type of DER data, 0 on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-asn1-print"></a><h3>shishi_asn1_print ()</h3>
<pre class="programlisting">void                shishi_asn1_print                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         FILE *fh);</pre>
<p>
Print ASN.1 structure in human readable form, typically for
debugging purposes.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> ASN.1 data that have field to extract.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file descriptor to print to, e.g. stdout.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1"></a><h3>shishi_der2asn1 ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Convert arbitrary DER data of a packet to a ASN.1 type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns newly allocate ASN.1 corresponding to DER
  data, or <code class="literal">NULL</code> on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-padata"></a><h3>shishi_der2asn1_padata ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_padata              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of PA-DATA and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-methoddata"></a><h3>shishi_der2asn1_methoddata ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_methoddata          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of METHOD-DATA and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-etype-info"></a><h3>shishi_der2asn1_etype_info ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_etype_info          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of ETYPE-INFO and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-etype-info2"></a><h3>shishi_der2asn1_etype_info2 ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_etype_info2         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of ETYPE-INFO2 and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-ticket"></a><h3>shishi_der2asn1_ticket ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_ticket              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of Ticket and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-encticketpart"></a><h3>shishi_der2asn1_encticketpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_encticketpart       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncTicketPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-asreq"></a><h3>shishi_der2asn1_asreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_asreq               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of AS-REQ and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-tgsreq"></a><h3>shishi_der2asn1_tgsreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_tgsreq              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of TGS-REQ and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-asrep"></a><h3>shishi_der2asn1_asrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_asrep               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of AS-REP and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-tgsrep"></a><h3>shishi_der2asn1_tgsrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_tgsrep              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of TGS-REP and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-kdcrep"></a><h3>shishi_der2asn1_kdcrep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_kdcrep              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of KDC-REP and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-kdcreq"></a><h3>shishi_der2asn1_kdcreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_kdcreq              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of AS-REQ, TGS-REQ or KDC-REQ and create a
ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-apreq"></a><h3>shishi_der2asn1_apreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_apreq               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of AP-REQ and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-aprep"></a><h3>shishi_der2asn1_aprep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_aprep               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of AP-REP and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-authenticator"></a><h3>shishi_der2asn1_authenticator ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_authenticator       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of Authenticator and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-krberror"></a><h3>shishi_der2asn1_krberror ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_krberror            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of KRB-ERROR and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-krbsafe"></a><h3>shishi_der2asn1_krbsafe ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_krbsafe             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of KRB-SAFE and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-priv"></a><h3>shishi_der2asn1_priv ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_priv                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of KRB-PRIV and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-encasreppart"></a><h3>shishi_der2asn1_encasreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_encasreppart        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncASRepPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-enctgsreppart"></a><h3>shishi_der2asn1_enctgsreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_enctgsreppart       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncTGSRepPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-enckdcreppart"></a><h3>shishi_der2asn1_enckdcreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_enckdcreppart       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncKDCRepPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-encapreppart"></a><h3>shishi_der2asn1_encapreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_encapreppart        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncAPRepPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-der2asn1-encprivpart"></a><h3>shishi_der2asn1_encprivpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_der2asn1_encprivpart         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *der,
                                                         size_t derlen);</pre>
<p>
Decode DER encoding of EncKrbPrivPart and create a ASN.1 structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input character array with DER encoding.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns ASN.1 structure corresponding to DER data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap"></a><h3>shishi_ap ()</h3>
<pre class="programlisting">int                 shishi_ap                           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap);</pre>
<p>
Create a new AP exchange with a random subkey of the default
encryption type from configuration.  Note that there is no
guarantee that the receiver will understand that key type, you
should probably use <a class="link" href="shishi-shishi.html#shishi-ap-etype" title="shishi_ap_etype ()"><code class="function">shishi_ap_etype()</code></a> or <a class="link" href="shishi-shishi.html#shishi-ap-nosubkey" title="shishi_ap_nosubkey ()"><code class="function">shishi_ap_nosubkey()</code></a>
instead.  In the future, this function will likely behave as
<a class="link" href="shishi-shishi.html#shishi-ap-nosubkey" title="shishi_ap_nosubkey ()"><code class="function">shishi_ap_nosubkey()</code></a> and <a class="link" href="shishi-shishi.html#shishi-ap-nosubkey" title="shishi_ap_nosubkey ()"><code class="function">shishi_ap_nosubkey()</code></a> will be removed.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-etype"></a><h3>shishi_ap_etype ()</h3>
<pre class="programlisting">int                 shishi_ap_etype                     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         int etype);</pre>
<p>
Create a new AP exchange with a random subkey of indicated
encryption type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type of newly generated random subkey.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-nosubkey"></a><h3>shishi_ap_nosubkey ()</h3>
<pre class="programlisting">int                 shishi_ap_nosubkey                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap);</pre>
<p>
Create a new AP exchange without subkey in authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-done"></a><h3>shishi_ap_done ()</h3>
<pre class="programlisting">void                shishi_ap_done                      (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Deallocate resources associated with AP exchange.  This should be
called by the application when it no longer need to utilize the AP
exchange handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-set-tktoptions"></a><h3>shishi_ap_set_tktoptions ()</h3>
<pre class="programlisting">int                 shishi_ap_set_tktoptions            (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options);</pre>
<p>
Set the ticket (see <a class="link" href="shishi-shishi.html#shishi-ap-tkt-set" title="shishi_ap_tkt_set ()"><code class="function">shishi_ap_tkt_set()</code></a>) and set the AP-REQ
apoptions (see <a class="link" href="shishi-shishi.html#shishi-apreq-options-set" title="shishi_apreq_options_set ()"><code class="function">shishi_apreq_options_set()</code></a>).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tktoptions"></a><h3>shishi_ap_tktoptions ()</h3>
<pre class="programlisting">int                 shishi_ap_tktoptions                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options);</pre>
<p>
Create a new AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()"><code class="function">shishi_ap()</code></a>, and set the ticket and
AP-REQ apoptions using <code class="function">shishi_ap_set_tktoption()</code>.  A random session
key is added to the authenticator, using the same keytype as the
ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-etype-tktoptionsdata"></a><h3>shishi_ap_etype_tktoptionsdata ()</h3>
<pre class="programlisting">int                 shishi_ap_etype_tktoptionsdata      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         int32_t etype,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);</pre>
<p>
Create a new AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()"><code class="function">shishi_ap()</code></a>, and set the ticket,
AP-REQ apoptions and the Authenticator checksum data using
<a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsdata" title="shishi_ap_set_tktoptionsdata ()"><code class="function">shishi_ap_set_tktoptionsdata()</code></a>. A random session key is added to
the authenticator, using the same keytype as the ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type of newly generated random subkey.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> length of input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-set-tktoptionsdata"></a><h3>shishi_ap_set_tktoptionsdata ()</h3>
<pre class="programlisting">int                 shishi_ap_set_tktoptionsdata        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);</pre>
<p>
Set the ticket (see <a class="link" href="shishi-shishi.html#shishi-ap-tkt-set" title="shishi_ap_tkt_set ()"><code class="function">shishi_ap_tkt_set()</code></a>) and set the AP-REQ
apoptions (see <a class="link" href="shishi-shishi.html#shishi-apreq-options-set" title="shishi_apreq_options_set ()"><code class="function">shishi_apreq_options_set()</code></a>) and set the
Authenticator checksum data.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> length of input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tktoptionsdata"></a><h3>shishi_ap_tktoptionsdata ()</h3>
<pre class="programlisting">int                 shishi_ap_tktoptionsdata            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         const char *data,
                                                         size_t len);</pre>
<p>
Create a new AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()"><code class="function">shishi_ap()</code></a>, and set the ticket,
AP-REQ apoptions and the Authenticator checksum data using
<a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsdata" title="shishi_ap_set_tktoptionsdata ()"><code class="function">shishi_ap_set_tktoptionsdata()</code></a>. A random session key is added to
the authenticator, using the same keytype as the ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> length of input array with data to checksum in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-set-tktoptionsraw"></a><h3>shishi_ap_set_tktoptionsraw ()</h3>
<pre class="programlisting">int                 shishi_ap_set_tktoptionsraw         (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         int32_t cksumtype,
                                                         const char *data,
                                                         size_t len);</pre>
<p>
Set the ticket (see <a class="link" href="shishi-shishi.html#shishi-ap-tkt-set" title="shishi_ap_tkt_set ()"><code class="function">shishi_ap_tkt_set()</code></a>) and set the AP-REQ
apoptions (see <a class="link" href="shishi-shishi.html#shishi-apreq-options-set" title="shishi_apreq_options_set ()"><code class="function">shishi_apreq_options_set()</code></a>) and set the raw
Authenticator checksum data.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> authenticator checksum type to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to store in checksum field in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> length of input array with data to store in checksum field in
  Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tktoptionsraw"></a><h3>shishi_ap_tktoptionsraw ()</h3>
<pre class="programlisting">int                 shishi_ap_tktoptionsraw             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         int32_t cksumtype,
                                                         const char *data,
                                                         size_t len);</pre>
<p>
Create a new AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()"><code class="function">shishi_ap()</code></a>, and set the ticket,
AP-REQ apoptions and the raw Authenticator checksum data field
using <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsraw" title="shishi_ap_set_tktoptionsraw ()"><code class="function">shishi_ap_set_tktoptionsraw()</code></a>.  A random session key is added
to the authenticator, using the same keytype as the ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> authenticator checksum type to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> input array with data to store in checksum field in Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> length of input array with data to store in checksum field in
  Authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-set-tktoptionsasn1usage"></a><h3>shishi_ap_set_tktoptionsasn1usage ()</h3>
<pre class="programlisting">int                 shishi_ap_set_tktoptionsasn1usage   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int authenticatorcksumkeyusage,
                                                         int authenticatorkeyusage);</pre>
<p>
Set ticket, options and authenticator checksum data using
<a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsdata" title="shishi_ap_set_tktoptionsdata ()"><code class="function">shishi_ap_set_tktoptionsdata()</code></a>.  The authenticator checksum data is
the DER encoding of the ASN.1 field provided.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> input ASN.1 structure to store as authenticator checksum data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> field in ASN.1 structure to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumkeyusage</code></em> :</span></p></td>
<td> key usage for checksum in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorkeyusage</code></em> :</span></p></td>
<td> key usage for authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tktoptionsasn1usage"></a><h3>shishi_ap_tktoptionsasn1usage ()</h3>
<pre class="programlisting">int                 shishi_ap_tktoptionsasn1usage       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> **ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         int options,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> node,
                                                         const char *field,
                                                         int authenticatorcksumkeyusage,
                                                         int authenticatorkeyusage);</pre>
<p>
Create a new AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap" title="shishi_ap ()"><code class="function">shishi_ap()</code></a>, and set ticket, options
and authenticator checksum data from the DER encoding of the ASN.1
field using <a class="link" href="shishi-shishi.html#shishi-ap-set-tktoptionsasn1usage" title="shishi_ap_set_tktoptionsasn1usage ()"><code class="function">shishi_ap_set_tktoptionsasn1usage()</code></a>.  A random session
key is added to the authenticator, using the same keytype as the
ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> pointer to new structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> AP-REQ options to set in newly created AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>node</code></em> :</span></p></td>
<td> input ASN.1 structure to store as authenticator checksum data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>field</code></em> :</span></p></td>
<td> field in ASN.1 structure to use.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumkeyusage</code></em> :</span></p></td>
<td> key usage for checksum in authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorkeyusage</code></em> :</span></p></td>
<td> key usage for authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tkt"></a><h3>shishi_ap_tkt ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a>*         shishi_ap_tkt                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get Ticket from AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ticket from the AP exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-tkt-set"></a><h3>shishi_ap_tkt_set ()</h3>
<pre class="programlisting">void                shishi_ap_tkt_set                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt);</pre>
<p>
Set the Ticket in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> ticket to store in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-cksumdata"></a><h3>shishi_ap_authenticator_cksumdata ()</h3>
<pre class="programlisting">int                 shishi_ap_authenticator_cksumdata   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *out,
                                                         size_t *len);</pre>
<p>
Get checksum data from Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array that holds authenticator checksum data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> on input, maximum length of output array that holds
      authenticator checksum data, on output actual length of
      output array that holds authenticator checksum data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK if successful, or
SHISHI_TOO_SMALL_BUFFER if buffer provided was too small.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-cksumdata-set"></a><h3>shishi_ap_authenticator_cksumdata_set ()</h3>
<pre class="programlisting">void                shishi_ap_authenticator_cksumdata_set
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         const char *authenticatorcksumdata,
                                                         size_t authenticatorcksumdatalen);</pre>
<p>
Set the Authenticator Checksum Data in the AP exchange.  This is
the data that will be checksumed, and the checksum placed in the
checksum field.  It is not the actual checksum field.  See also
shishi_ap_authenticator_cksumraw_set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumdata</code></em> :</span></p></td>
<td> input array with data to compute checksum
  on and store in Authenticator in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumdatalen</code></em> :</span></p></td>
<td> length of input array with data to
  compute checksum on and store in Authenticator in AP-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-cksumraw-set"></a><h3>shishi_ap_authenticator_cksumraw_set ()</h3>
<pre class="programlisting">void                shishi_ap_authenticator_cksumraw_set
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         int32_t authenticatorcksumtype,
                                                         const char *authenticatorcksumraw,
                                                         size_t authenticatorcksumrawlen);</pre>
<p>
Set the Authenticator Checksum Data in the AP exchange.  This is
the actual checksum field, not data to compute checksum on and then
store in the checksum field.  See also
shishi_ap_authenticator_cksumdata_set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumtype</code></em> :</span></p></td>
<td> authenticator checksum type to set in AP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumraw</code></em> :</span></p></td>
<td> input array with authenticator checksum
  field value to set in Authenticator in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticatorcksumrawlen</code></em> :</span></p></td>
<td> length of input array with
  authenticator checksum field value to set in Authenticator in AP-REQ.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-cksumtype"></a><h3>shishi_ap_authenticator_cksumtype ()</h3>
<pre class="programlisting">int32_t             shishi_ap_authenticator_cksumtype   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get the Authenticator Checksum Type in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return the authenticator checksum type.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-cksumtype-set"></a><h3>shishi_ap_authenticator_cksumtype_set ()</h3>
<pre class="programlisting">void                shishi_ap_authenticator_cksumtype_set
                                                        (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         int32_t cksumtype);</pre>
<p>
Set the Authenticator Checksum Type in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> authenticator checksum type to set in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator"></a><h3>shishi_ap_authenticator ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_ap_authenticator             (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get ASN.1 Authenticator structure from AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the Authenticator from the AP exchange, or
              NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-authenticator-set"></a><h3>shishi_ap_authenticator_set ()</h3>
<pre class="programlisting">void                shishi_ap_authenticator_set         (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Set the Authenticator in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator to store in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req"></a><h3>shishi_ap_req ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_ap_req                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get ASN.1 AP-REQ structure from AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AP-REQ from the AP exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-set"></a><h3>shishi_ap_req_set ()</h3>
<pre class="programlisting">void                shishi_ap_req_set                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Set the AP-REQ in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> apreq to store in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-der"></a><h3>shishi_ap_req_der ()</h3>
<pre class="programlisting">int                 shishi_ap_req_der                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Build AP-REQ using <a class="link" href="shishi-shishi.html#shishi-ap-req-build" title="shishi_ap_req_build ()"><code class="function">shishi_ap_req_build()</code></a> and DER encode it.  <em class="parameter"><code>out</code></em>
is allocated by this function, and it is the responsibility of
caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> pointer to output array with der encoding of AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> pointer to length of output array with der encoding of AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-der-set"></a><h3>shishi_ap_req_der_set ()</h3>
<pre class="programlisting">int                 shishi_ap_req_der_set               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode AP-REQ and set it AP exchange.  If decoding fails, the
AP-REQ in the AP exchange is lost.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-build"></a><h3>shishi_ap_req_build ()</h3>
<pre class="programlisting">int                 shishi_ap_req_build                 (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Checksum data in authenticator and add ticket and authenticator to
AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-asn1"></a><h3>shishi_ap_req_asn1 ()</h3>
<pre class="programlisting">int                 shishi_ap_req_asn1                  (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);</pre>
<p>
Build AP-REQ using <a class="link" href="shishi-shishi.html#shishi-ap-req-build" title="shishi_ap_req_build ()"><code class="function">shishi_ap_req_build()</code></a> and return it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> output AP-REQ variable.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-key"></a><h3>shishi_ap_key ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_ap_key                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Extract the application key from AP.  If subkeys are used, it is
taken from the Authenticator, otherwise the session key is used.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return application key from AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-decode"></a><h3>shishi_ap_req_decode ()</h3>
<pre class="programlisting">int                 shishi_ap_req_decode                (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Decode ticket in AP-REQ and set the Ticket fields in the AP
exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-process"></a><h3>shishi_ap_req_process ()</h3>
<pre class="programlisting">int                 shishi_ap_req_process               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Decrypt ticket in AP-REQ using supplied key and decrypt
Authenticator in AP-REQ using key in decrypted ticket, and on
success set the Ticket and Authenticator fields in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> cryptographic key used to decrypt ticket in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-req-process-keyusage"></a><h3>shishi_ap_req_process_keyusage ()</h3>
<pre class="programlisting">int                 shishi_ap_req_process_keyusage      (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int32_t keyusage);</pre>
<p>
Decrypt ticket in AP-REQ using supplied key and decrypt
Authenticator in AP-REQ using key in decrypted ticket, and on
success set the Ticket and Authenticator fields in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> cryptographic key used to decrypt ticket in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> key usage to use during decryption, for normal
  AP-REQ's this is normally SHISHI_KEYUSAGE_APREQ_AUTHENTICATOR,
  for AP-REQ's part of TGS-REQ's, this is normally
  SHISHI_KEYUSAGE_TGSREQ_APREQ_AUTHENTICATOR.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep"></a><h3>shishi_ap_rep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_ap_rep                       (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get ASN.1 AP-REP structure from AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AP-REP from the AP exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-set"></a><h3>shishi_ap_rep_set ()</h3>
<pre class="programlisting">void                shishi_ap_rep_set                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);</pre>
<p>
Set the AP-REP in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> aprep to store in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-der"></a><h3>shishi_ap_rep_der ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_der                   (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
Build AP-REP using <a class="link" href="shishi-shishi.html#shishi-ap-rep-build" title="shishi_ap_rep_build ()"><code class="function">shishi_ap_rep_build()</code></a> and DER encode it.  <em class="parameter"><code>out</code></em>
is allocated by this function, and it is the responsibility of
caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-der-set"></a><h3>shishi_ap_rep_der_set ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_der_set               (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode AP-REP and set it AP exchange.  If decoding fails, the
AP-REP in the AP exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-verify"></a><h3>shishi_ap_rep_verify ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_verify                (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Verify AP-REP compared to Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-verify-der"></a><h3>shishi_ap_rep_verify_der ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_verify_der            (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode AP-REP and set it in AP exchange using
<a class="link" href="shishi-shishi.html#shishi-ap-rep-der-set" title="shishi_ap_rep_der_set ()"><code class="function">shishi_ap_rep_der_set()</code></a> and verify it using <a class="link" href="shishi-shishi.html#shishi-ap-rep-verify" title="shishi_ap_rep_verify ()"><code class="function">shishi_ap_rep_verify()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-verify-asn1"></a><h3>shishi_ap_rep_verify_asn1 ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_verify_asn1           (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);</pre>
<p>
Set the AP-REP in the AP exchange using <a class="link" href="shishi-shishi.html#shishi-ap-rep-set" title="shishi_ap_rep_set ()"><code class="function">shishi_ap_rep_set()</code></a> and
verify it using <a class="link" href="shishi-shishi.html#shishi-ap-rep-verify" title="shishi_ap_rep_verify ()"><code class="function">shishi_ap_rep_verify()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> input AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-asn1"></a><h3>shishi_ap_rep_asn1 ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_asn1                  (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);</pre>
<p>
Build AP-REP using <a class="link" href="shishi-shishi.html#shishi-ap-rep-build" title="shishi_ap_rep_build ()"><code class="function">shishi_ap_rep_build()</code></a> and return it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> output AP-REP variable.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-rep-build"></a><h3>shishi_ap_rep_build ()</h3>
<pre class="programlisting">int                 shishi_ap_rep_build                 (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Checksum data in authenticator and add ticket and authenticator to
AP-REP.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-encapreppart"></a><h3>shishi_ap_encapreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_ap_encapreppart              (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap);</pre>
<p>
Get ASN.1 EncAPRepPart structure from AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the EncAPREPPart from the AP exchange, or
              NULL if not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-encapreppart-set"></a><h3>shishi_ap_encapreppart_set ()</h3>
<pre class="programlisting">void                shishi_ap_encapreppart_set          (<a class="link" href="shishi-shishi.html#Shishi-ap" title="Shishi_ap">Shishi_ap</a> *ap,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>
Set the EncAPRepPart in the AP exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>ap</code></em> :</span></p></td>
<td> structure that holds information about AP exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart to store in AP.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-option2string"></a><h3>shishi_ap_option2string ()</h3>
<pre class="programlisting">const char*         shishi_ap_option2string             (<a class="link" href="shishi-shishi.html#Shishi-apoptions" title="enum Shishi_apoptions">Shishi_apoptions</a> option);</pre>
<p>
Convert AP-Option type to AP-Option name string.  Note that <em class="parameter"><code>option</code></em>
must be just one of the AP-Option types, it cannot be an binary
ORed indicating several AP-Options.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>option</code></em> :</span></p></td>
<td> enumerated AP-Option type, see Shishi_apoptions.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns static string with name of AP-Option that
  must not be deallocated, or "unknown" if AP-Option was not understood.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-ap-string2option"></a><h3>shishi_ap_string2option ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-apoptions" title="enum Shishi_apoptions">Shishi_apoptions</a>    shishi_ap_string2option             (const char *str);</pre>
<p>
Convert AP-Option name to AP-Option type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>str</code></em> :</span></p></td>
<td> zero terminated character array with name of AP-Option,
  e.g. "use-session-key".
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns enumerated type member corresponding to AP-Option,
  or 0 if string was not understood.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-principal"></a><h3>shishi_key_principal ()</h3>
<pre class="programlisting">const char*         shishi_key_principal                (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Get the principal part of the key owner principal name, i.e.,
except the realm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the principal owning the key.  (Not a copy of
it, so don't modify or deallocate it.)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-principal-set"></a><h3>shishi_key_principal_set ()</h3>
<pre class="programlisting">void                shishi_key_principal_set            (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *principal);</pre>
<p>
Set the principal owning the key. The string is copied into the
key, so you can dispose of the variable immediately after calling
this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td> string with new principal name.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-realm"></a><h3>shishi_key_realm ()</h3>
<pre class="programlisting">const char*         shishi_key_realm                    (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Get the realm part of the key owner principal name.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the realm for the principal owning the key.
(Not a copy of it, so don't modify or deallocate it.)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-realm-set"></a><h3>shishi_key_realm_set ()</h3>
<pre class="programlisting">void                shishi_key_realm_set                (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *realm);</pre>
<p>
Set the realm for the principal owning the key. The string is
copied into the key, so you can dispose of the variable immediately
after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> string with new realm name.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-type"></a><h3>shishi_key_type ()</h3>
<pre class="programlisting">int                 shishi_key_type                     (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Get key type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the type of key as an integer as described in
the standard.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-type-set"></a><h3>shishi_key_type_set ()</h3>
<pre class="programlisting">void                shishi_key_type_set                 (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int32_t type);</pre>
<p>
Set the type of key in key structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type to set in key.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-value"></a><h3>shishi_key_value ()</h3>
<pre class="programlisting">const char*         shishi_key_value                    (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Get the raw key bytes.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key value as a pointer which is valid
throughout the lifetime of the key structure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-value-set"></a><h3>shishi_key_value_set ()</h3>
<pre class="programlisting">void                shishi_key_value_set                (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         const char *value);</pre>
<p>
Set the key value and length in key structure.  The value is copied
into the key (in other words, you can deallocate <em class="parameter"><code>value</code></em> right after
calling this function without modifying the value inside the key).</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>value</code></em> :</span></p></td>
<td> input array with key data.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-name"></a><h3>shishi_key_name ()</h3>
<pre class="programlisting">const char*         shishi_key_name                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Calls shishi_cipher_name for key type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return name of key.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-length"></a><h3>shishi_key_length ()</h3>
<pre class="programlisting">size_t              shishi_key_length                   (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Calls shishi_cipher_keylen for key type.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the length of the key value.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-version"></a><h3>shishi_key_version ()</h3>
<pre class="programlisting">uint32_t            shishi_key_version                  (const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Get the "kvno" (key version) of key.  It will be UINT32_MAX if the
key is not long-lived.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the version of key ("kvno").
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-version-set"></a><h3>shishi_key_version_set ()</h3>
<pre class="programlisting">void                shishi_key_version_set              (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         uint32_t kvno);</pre>
<p>
Set the version of key ("kvno") in key structure.  Use UINT32_MAX
for non-ptermanent keys.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> structure that holds key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kvno</code></em> :</span></p></td>
<td> new version integer.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key"></a><h3>shishi_key ()</h3>
<pre class="programlisting">int                 shishi_key                          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Create a new Key information structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-done"></a><h3>shishi_key_done ()</h3>
<pre class="programlisting">void                shishi_key_done                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Deallocates key information structure.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> pointer to structure that holds key information.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-copy"></a><h3>shishi_key_copy ()</h3>
<pre class="programlisting">void                shishi_key_copy                     (<a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *dstkey,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *srckey);</pre>
<p>
Copies source key into existing allocated destination key.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>dstkey</code></em> :</span></p></td>
<td> structure that holds destination key information
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srckey</code></em> :</span></p></td>
<td> structure that holds source key information
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-print"></a><h3>shishi_key_print ()</h3>
<pre class="programlisting">int                 shishi_key_print                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Print an ASCII representation of a key structure to file
descriptor.  Example output:
</p>
<p>
-----BEGIN SHISHI KEY-----
Keytype: 18 (aes256-cts-hmac-sha1-96)
Principal: host/latte.josefsson.org
Realm: JOSEFSSON.ORG
Key-Version-Number: 1
</p>
<p>
P1QdeW/oSiag/bTyVEBAY2msiGSTmgLXlopuCKoppDs=
-----END SHISHI KEY-----</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle opened for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-to-file"></a><h3>shishi_key_to_file ()</h3>
<pre class="programlisting">int                 shishi_key_to_file                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Print an ASCII representation of a key structure to a file.  The
file is appended to if it exists.  See <a class="link" href="shishi-shishi.html#shishi-key-print" title="shishi_key_print ()"><code class="function">shishi_key_print()</code></a> for
format of output.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> filename to append key to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-parse"></a><h3>shishi_key_parse ()</h3>
<pre class="programlisting">int                 shishi_key_parse                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-random"></a><h3>shishi_key_random ()</h3>
<pre class="programlisting">int                 shishi_key_random                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Create a new Key information structure for the key type and some
random data.  KEY contains a newly allocated structure only if this
function is successful.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-from-value"></a><h3>shishi_key_from_value ()</h3>
<pre class="programlisting">int                 shishi_key_from_value               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *value,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Create a new Key information structure, and set the key type and
key value. KEY contains a newly allocated structure only if this
function is successful.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>value</code></em> :</span></p></td>
<td> input array with key value, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-from-base64"></a><h3>shishi_key_from_base64 ()</h3>
<pre class="programlisting">int                 shishi_key_from_base64              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *value,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Create a new Key information structure, and set the key type and
key value. KEY contains a newly allocated structure only if this
function is successful.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>value</code></em> :</span></p></td>
<td> input string with base64 encoded key value, or NULL.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_INVALID_KEY if the base64 encoded key
              length doesn't match the key type, and SHISHI_OK on
              success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-from-random"></a><h3>shishi_key_from_random ()</h3>
<pre class="programlisting">int                 shishi_key_from_random              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *rnd,
                                                         size_t rndlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);</pre>
<p>
Create a new Key information structure, and set the key type and
key value using <a class="link" href="shishi-shishi.html#shishi-random-to-key" title="shishi_random_to_key ()"><code class="function">shishi_random_to_key()</code></a>.  KEY contains a newly
allocated structure only if this function is successful.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>rnd</code></em> :</span></p></td>
<td> random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>rndlen</code></em> :</span></p></td>
<td> length of random data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkey</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-from-string"></a><h3>shishi_key_from_string ()</h3>
<pre class="programlisting">int                 shishi_key_from_string              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *salt,
                                                         size_t saltlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);</pre>
<p>
Create a new Key information structure, and set the key type and
key value using <a class="link" href="shishi-shishi.html#shishi-string-to-key" title="shishi_string_to_key ()"><code class="function">shishi_string_to_key()</code></a>.  KEY contains a newly
allocated structure only if this function is successful.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em> :</span></p></td>
<td> input array containing password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>passwordlen</code></em> :</span></p></td>
<td> length of input array containing password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>salt</code></em> :</span></p></td>
<td> input array containing salt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>saltlen</code></em> :</span></p></td>
<td> length of input array containing salt.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>parameter</code></em> :</span></p></td>
<td> input array with opaque encryption type specific information.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkey</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-key-from-name"></a><h3>shishi_key_from_name ()</h3>
<pre class="programlisting">int                 shishi_key_from_name                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         int32_t type,
                                                         const char *name,
                                                         const char *password,
                                                         size_t passwordlen,
                                                         const char *parameter,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **outkey);</pre>
<p>
Create a new Key information structure, and derive the key from
principal name and password using <a class="link" href="shishi-shishi.html#shishi-key-from-name" title="shishi_key_from_name ()"><code class="function">shishi_key_from_name()</code></a>.  The salt
is derived from the principal name by concatenating the decoded
realm and principal.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>type</code></em> :</span></p></td>
<td> type of key.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name</code></em> :</span></p></td>
<td> principal name of user.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em> :</span></p></td>
<td> input array containing password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>passwordlen</code></em> :</span></p></td>
<td> length of input array containing password.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>parameter</code></em> :</span></p></td>
<td> input array with opaque encryption type specific information.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkey</code></em> :</span></p></td>
<td> pointer to structure that will hold newly created key information
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys"></a><h3>shishi_keys ()</h3>
<pre class="programlisting">int                 shishi_keys                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **keys);</pre>
<p>
Get a new key set handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> output pointer to newly allocated keys handle.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-done"></a><h3>shishi_keys_done ()</h3>
<pre class="programlisting">void                shishi_keys_done                    (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **keys);</pre>
<p>
Deallocates all resources associated with key set.  The key set
handle must not be used in calls to other shishi_keys_*() functions
after this.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()"><code class="function">shishi_keys()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-size"></a><h3>shishi_keys_size ()</h3>
<pre class="programlisting">int                 shishi_keys_size                    (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);</pre>
<p>
Get size of key set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()"><code class="function">shishi_keys()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns number of keys stored in key set.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-nth"></a><h3>shishi_keys_nth ()</h3>
<pre class="programlisting">const <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*   shishi_keys_nth                     (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         int keyno);</pre>
<p>
Get the n:th ticket in key set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()"><code class="function">shishi_keys()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyno</code></em> :</span></p></td>
<td> integer indicating requested key in key set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns a key handle to the keyno:th key in the key
  set, or NULL if <em class="parameter"><code>keys</code></em> is invalid or <em class="parameter"><code>keyno</code></em> is out of bounds.  The
  first key is <em class="parameter"><code>keyno</code></em> 0, the second key <em class="parameter"><code>keyno</code></em> 1, and so on.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-remove"></a><h3>shishi_keys_remove ()</h3>
<pre class="programlisting">void                shishi_keys_remove                  (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         int keyno);</pre>
<p>
Remove a key, indexed by <em class="parameter"><code>keyno</code></em>, in given key set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()"><code class="function">shishi_keys()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyno</code></em> :</span></p></td>
<td> key number of key in the set to remove.  The first
  key is key number 0.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-add"></a><h3>shishi_keys_add ()</h3>
<pre class="programlisting">int                 shishi_keys_add                     (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Add a key to the key set.  A deep copy of the key is stored, so
changing <em class="parameter"><code>key</code></em>, or deallocating it, will not modify the value stored
in the key set.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set handle as allocated by <a class="link" href="shishi-shishi.html#shishi-keys" title="shishi_keys ()"><code class="function">shishi_keys()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to be added to key set.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-add-keytab-mem"></a><h3>shishi_keys_add_keytab_mem ()</h3>
<pre class="programlisting">int                 shishi_keys_add_keytab_mem          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);</pre>
<p>
Read keys from a MIT keytab data structure, and add them to the key
set.
</p>
<p>
The format of keytab's is proprietary, and this function support
the 0x0501 and 0x0502 formats.  See the section The MIT Kerberos
Keytab Binary File Format in the Shishi manual for a description of
the reverse-engineered format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> constant memory buffer with keytab of <em class="parameter"><code>len</code></em> size.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> size of memory buffer with keytab data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> allocated key set to store keys in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_KEYTAB_ERROR</code> if the data does not
  represent a valid keytab structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-add-keytab-file"></a><h3>shishi_keys_add_keytab_file ()</h3>
<pre class="programlisting">int                 shishi_keys_add_keytab_file         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);</pre>
<p>
Read keys from a MIT keytab data structure from a file, and add the
keys to the key set.
</p>
<p>
The format of keytab's is proprietary, and this function support
the 0x0501 and 0x0502 formats.  See the section The MIT Kerberos
Keytab Binary File Format in the Shishi manual for a description of
the reverse-engineered format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> name of file to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> allocated key set to store keys in.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_IO_ERROR</code> if the file cannot be read,
  <code class="literal">SHISHI_KEYTAB_ERROR</code> if the data cannot be parsed as a valid keytab
  structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-from-keytab-mem"></a><h3>shishi_keys_from_keytab_mem ()</h3>
<pre class="programlisting">int                 shishi_keys_from_keytab_mem         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *data,
                                                         size_t len,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **outkeys);</pre>
<p>
Create a new key set populated with keys from a MIT keytab data
structure read from a memory block.
</p>
<p>
The format of keytab's is proprietary, and this function support
the 0x0501 and 0x0502 formats.  See the section The MIT Kerberos
Keytab Binary File Format in the Shishi manual for a description of
the reverse-engineered format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em> :</span></p></td>
<td> constant memory buffer with keytab of <em class="parameter"><code>len</code></em> size.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>len</code></em> :</span></p></td>
<td> size of memory buffer with keytab data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkeys</code></em> :</span></p></td>
<td> pointer to key set that will be allocated and populated,
  must be deallocated by caller on succes.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_KEYTAB_ERROR</code> if the data does not
  represent a valid keytab structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-from-keytab-file"></a><h3>shishi_keys_from_keytab_file ()</h3>
<pre class="programlisting">int                 shishi_keys_from_keytab_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> **outkeys);</pre>
<p>
Create a new key set populated with keys from a MIT keytab data
structure read from a file.
</p>
<p>
The format of keytab's is proprietary, and this function support
the 0x0501 and 0x0502 formats.  See the section The MIT Kerberos
Keytab Binary File Format in the Shishi manual for a description of
the reverse-engineered format.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> name of file to read.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outkeys</code></em> :</span></p></td>
<td> pointer to key set that will be allocated and populated,
  must be deallocated by caller on succes.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_IO_ERROR</code> if the file cannot be read,
  <code class="literal">SHISHI_KEYTAB_ERROR</code> if the data cannot be parsed as a valid keytab
  structure, and <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-print"></a><h3>shishi_keys_print ()</h3>
<pre class="programlisting">int                 shishi_keys_print                   (<a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys,
                                                         FILE *fh);</pre>
<p>
Print all keys in set using shishi_key_print.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> key set to print.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle, open for writing, to print keys to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-to-file"></a><h3>shishi_keys_to_file ()</h3>
<pre class="programlisting">int                 shishi_keys_to_file                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         <a class="link" href="shishi-shishi.html#Shishi-keys" title="Shishi_keys">Shishi_keys</a> *keys);</pre>
<p>
Print an ASCII representation of a key structure to a file, for
each key in the key set.  The file is appended to if it exists.
See <a class="link" href="shishi-shishi.html#shishi-key-print" title="shishi_key_print ()"><code class="function">shishi_key_print()</code></a> for the format of the output.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> filename to append key to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keys</code></em> :</span></p></td>
<td> set of keys to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-for-serverrealm-in-file"></a><h3>shishi_keys_for_serverrealm_in_file ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_keys_for_serverrealm_in_file (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *server,
                                                         const char *realm);</pre>
<p>
Get keys that match specified <em class="parameter"><code>server</code></em> and <em class="parameter"><code>realm</code></em> from the key set
file <em class="parameter"><code>filename</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> file to read keys from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> realm of server to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for specific server and realm, read
  from the indicated file, or NULL if no key could be found or an
  error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-for-server-in-file"></a><h3>shishi_keys_for_server_in_file ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_keys_for_server_in_file      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *server);</pre>
<p>
Get key for specified <em class="parameter"><code>server</code></em> from <em class="parameter"><code>filename</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> file to read keys from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for specific server, read from the
  indicated file, or NULL if no key could be found or an error
  encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-keys-for-localservicerealm-in-file"></a><h3>shishi_keys_for_localservicerealm_in_file ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_keys_for_localservicerealm_in_file
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *filename,
                                                         const char *service,
                                                         const char *realm);</pre>
<p>
Get key for specified <em class="parameter"><code>service</code></em> and <em class="parameter"><code>realm</code></em> from <em class="parameter"><code>filename</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> file to read keys from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td> service to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> realm of server to get key for, or NULL for default realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for the server
"SERVICE/HOSTNAME<em class="parameter"><code>REALM</code></em>" (where HOSTNAME is the current system's
hostname), read from the default host keys file (see
<a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()"><code class="function">shishi_hostkeys_default_file()</code></a>), or NULL if no key could be found
or an error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-default-file"></a><h3>shishi_hostkeys_default_file ()</h3>
<pre class="programlisting">const char*         shishi_hostkeys_default_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get file name of default host key file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default host key filename used in the
library.  (Not a copy of it, so don't modify or deallocate it.)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-default-file-set"></a><h3>shishi_hostkeys_default_file_set ()</h3>
<pre class="programlisting">void                shishi_hostkeys_default_file_set    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *hostkeysfile);</pre>
<p>
Set the default host key filename used in the library.  The
string is copied into the library, so you can dispose of the
variable immediately after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hostkeysfile</code></em> :</span></p></td>
<td> string with new default hostkeys file name, or
               NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-for-server"></a><h3>shishi_hostkeys_for_server ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_hostkeys_for_server          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *server);</pre>
<p>
Get host key for <em class="parameter"><code>server</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get key for
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for specific server, read from the
default host keys file (see <a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()"><code class="function">shishi_hostkeys_default_file()</code></a>), or
NULL if no key could be found or an error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-for-serverrealm"></a><h3>shishi_hostkeys_for_serverrealm ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_hostkeys_for_serverrealm     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *server,
                                                         const char *realm);</pre>
<p>
Get host key for <em class="parameter"><code>server</code></em> in <em class="parameter"><code>realm</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> server name to get key for
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> realm of server to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for specific server and realm, read
from the default host keys file (see
<a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()"><code class="function">shishi_hostkeys_default_file()</code></a>), or NULL if no key could be found
or an error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-for-localservicerealm"></a><h3>shishi_hostkeys_for_localservicerealm ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_hostkeys_for_localservicerealm
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service,
                                                         const char *realm);</pre>
<p>
Get host key for <em class="parameter"><code>service</code></em> on current host in <em class="parameter"><code>realm</code></em>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td> service to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> realm of server to get key for, or NULL for default realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for the server
"SERVICE/HOSTNAME<em class="parameter"><code>REALM</code></em>" (where HOSTNAME is the current system's
hostname), read from the default host keys file (see
<a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()"><code class="function">shishi_hostkeys_default_file()</code></a>), or NULL if no key could be found
or an error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-hostkeys-for-localservice"></a><h3>shishi_hostkeys_for_localservice ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_hostkeys_for_localservice    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *service);</pre>
<p>
Get host key for <em class="parameter"><code>service</code></em> on current host in default realm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>service</code></em> :</span></p></td>
<td> service to get key for.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key for the server "SERVICE/HOSTNAME"
(where HOSTNAME is the current system's hostname), read from the
default host keys file (see <a class="link" href="shishi-shishi.html#shishi-hostkeys-default-file" title="shishi_hostkeys_default_file ()"><code class="function">shishi_hostkeys_default_file()</code></a>), or
NULL if no key could be found or an error encountered.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart"></a><h3>shishi_encapreppart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_encapreppart                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new EncAPRepPart, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the encapreppart or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-time-copy"></a><h3>shishi_encapreppart_time_copy ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_time_copy       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Copy time fields from Authenticator into EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> Authenticator to copy time fields from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-ctime"></a><h3>shishi_encapreppart_ctime ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_ctime           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         char **t);</pre>
<p>
Extract client time from EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> newly allocated zero-terminated character array with client time.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-ctime-set"></a><h3>shishi_encapreppart_ctime_set ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_ctime_set       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         const char *t);</pre>
<p>
Store client time in EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>t</code></em> :</span></p></td>
<td> string with generalized time value to store in EncAPRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-cusec-get"></a><h3>shishi_encapreppart_cusec_get ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_cusec_get       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t *cusec);</pre>
<p>
Extract client microseconds field from EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> output integer with client microseconds field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-cusec-set"></a><h3>shishi_encapreppart_cusec_set ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_cusec_set       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t cusec);</pre>
<p>
Set the cusec field in the Authenticator.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cusec</code></em> :</span></p></td>
<td> client microseconds to set in authenticator, 0-999999.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-print"></a><h3>shishi_encapreppart_print ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_print           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>
Print ASCII armored DER encoding of EncAPRepPart to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-save"></a><h3>shishi_encapreppart_save ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_save            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>
Save DER encoding of EncAPRepPart to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-to-file"></a><h3>shishi_encapreppart_to_file ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_to_file         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write EncAPRepPart to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-read"></a><h3>shishi_encapreppart_read ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_read            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);</pre>
<p>
Read DER encoded EncAPRepPart from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> output variable with newly allocated EncAPRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-parse"></a><h3>shishi_encapreppart_parse ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_parse           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);</pre>
<p>
Read ASCII armored DER encoded EncAPRepPart from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> output variable with newly allocated EncAPRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-from-file"></a><h3>shishi_encapreppart_from_file ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_from_file       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read EncAPRepPart from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> output variable with newly allocated EncAPRepPart.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-get-key"></a><h3>shishi_encapreppart_get_key ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_get_key         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Extract the subkey from the encrypted AP-REP part.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> input EncAPRepPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> newly allocated key.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-seqnumber-get"></a><h3>shishi_encapreppart_seqnumber_get ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_seqnumber_get   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t *seqnumber);</pre>
<p>
Extract sequence number field from EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> EncAPRepPart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>seqnumber</code></em> :</span></p></td>
<td> output integer with sequence number field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-seqnumber-remove"></a><h3>shishi_encapreppart_seqnumber_remove ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_seqnumber_remove
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>
Remove sequence number field in EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> encapreppart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encapreppart-seqnumber-set"></a><h3>shishi_encapreppart_seqnumber_set ()</h3>
<pre class="programlisting">int                 shishi_encapreppart_seqnumber_set   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         uint32_t seqnumber);</pre>
<p>
Store sequence number field in EncAPRepPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td> encapreppart as allocated by <a class="link" href="shishi-shishi.html#shishi-encapreppart" title="shishi_encapreppart ()"><code class="function">shishi_encapreppart()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>seqnumber</code></em> :</span></p></td>
<td> integer with sequence number field to store in encapreppart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns <code class="literal">SHISHI_OK</code> iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq"></a><h3>shishi_apreq ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_apreq                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new AP-REQ, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the AP-REQ or NULL on failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-parse"></a><h3>shishi_apreq_parse ()</h3>
<pre class="programlisting">int                 shishi_apreq_parse                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);</pre>
<p>
Read ASCII armored DER encoded AP-REQ from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-from-file"></a><h3>shishi_apreq_from_file ()</h3>
<pre class="programlisting">int                 shishi_apreq_from_file              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read AP-REQ from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-print"></a><h3>shishi_apreq_print ()</h3>
<pre class="programlisting">int                 shishi_apreq_print                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Print ASCII armored DER encoding of AP-REQ to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-to-file"></a><h3>shishi_apreq_to_file ()</h3>
<pre class="programlisting">int                 shishi_apreq_to_file                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write AP-REQ to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-read"></a><h3>shishi_apreq_read ()</h3>
<pre class="programlisting">int                 shishi_apreq_read                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *apreq);</pre>
<p>
Read DER encoded AP-REQ from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-save"></a><h3>shishi_apreq_save ()</h3>
<pre class="programlisting">int                 shishi_apreq_save                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Save DER encoding of AP-REQ to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-set-ticket"></a><h3>shishi_apreq_set_ticket ()</h3>
<pre class="programlisting">int                 shishi_apreq_set_ticket             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> ticket);</pre>
<p>
Copy ticket into AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to add ticket field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> input ticket to copy into AP-REQ ticket field.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-set-authenticator"></a><h3>shishi_apreq_set_authenticator ()</h3>
<pre class="programlisting">int                 shishi_apreq_set_authenticator      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int32_t etype,
                                                         uint32_t kvno,
                                                         const char *buf,
                                                         size_t buflen);</pre>
<p>
Set the encrypted authenticator field in the AP-REP.  The encrypted
data is usually created by calling <a class="link" href="shishi-shishi.html#shishi-encrypt" title="shishi_encrypt ()"><code class="function">shishi_encrypt()</code></a> on the DER
encoded authenticator.  To save time, you may want to use
<a class="link" href="shishi-shishi.html#shishi-apreq-add-authenticator" title="shishi_apreq_add_authenticator ()"><code class="function">shishi_apreq_add_authenticator()</code></a> instead, which calculates the
encrypted data and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to add authenticator field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> encryption type used to encrypt authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>kvno</code></em> :</span></p></td>
<td> version of the key used to encrypt authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buf</code></em> :</span></p></td>
<td> input array with encrypted authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buflen</code></em> :</span></p></td>
<td> size of input array with encrypted authenticator.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK on success.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-add-authenticator"></a><h3>shishi_apreq_add_authenticator ()</h3>
<pre class="programlisting">int                 shishi_apreq_add_authenticator      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator);</pre>
<p>
Encrypts DER encoded authenticator using key and store it in the
AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to add authenticator field to.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to to use for encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td> cryptographic key usage value to use in encryption.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td> authenticator as allocated by <a class="link" href="shishi-shishi.html#shishi-authenticator" title="shishi_authenticator ()"><code class="function">shishi_authenticator()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-options"></a><h3>shishi_apreq_options ()</h3>
<pre class="programlisting">int                 shishi_apreq_options                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t *flags);</pre>
<p>
Extract the AP-Options from AP-REQ into output integer.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ to get options from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> Output integer containing options from AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-use-session-key-p"></a><h3>shishi_apreq_use_session_key_p ()</h3>
<pre class="programlisting">int                 shishi_apreq_use_session_key_p      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Return non-0 iff the "Use session key" option is set in the AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ as allocated by <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()"><code class="function">shishi_apreq()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-mutual-required-p"></a><h3>shishi_apreq_mutual_required_p ()</h3>
<pre class="programlisting">int                 shishi_apreq_mutual_required_p      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq);</pre>
<p>
Return non-0 iff the "Mutual required" option is set in the AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ as allocated by <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()"><code class="function">shishi_apreq()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-options-set"></a><h3>shishi_apreq_options_set ()</h3>
<pre class="programlisting">int                 shishi_apreq_options_set            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t options);</pre>
<p>
Set the AP-Options in AP-REQ to indicate integer.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ as allocated by <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()"><code class="function">shishi_apreq()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>options</code></em> :</span></p></td>
<td> Options to set in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-options-add"></a><h3>shishi_apreq_options_add ()</h3>
<pre class="programlisting">int                 shishi_apreq_options_add            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t option);</pre>
<p>
Add the AP-Options in AP-REQ.  Options not set in input parameter
<em class="parameter"><code>option</code></em> are preserved in the AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ as allocated by <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()"><code class="function">shishi_apreq()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>option</code></em> :</span></p></td>
<td> Options to add in AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-options-remove"></a><h3>shishi_apreq_options_remove ()</h3>
<pre class="programlisting">int                 shishi_apreq_options_remove         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         uint32_t option);</pre>
<p>
Remove the AP-Options from AP-REQ.  Options not set in input
parameter <em class="parameter"><code>option</code></em> are preserved in the AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ as allocated by <a class="link" href="shishi-shishi.html#shishi-apreq" title="shishi_apreq ()"><code class="function">shishi_apreq()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>option</code></em> :</span></p></td>
<td> Options to remove from AP-REQ.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-get-ticket"></a><h3>shishi_apreq_get_ticket ()</h3>
<pre class="programlisting">int                 shishi_apreq_get_ticket             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *ticket);</pre>
<p>
Extract ticket from AP-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ variable to get ticket from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ticket</code></em> :</span></p></td>
<td> output variable to hold extracted ticket.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-get-authenticator-etype"></a><h3>shishi_apreq_get_authenticator_etype ()</h3>
<pre class="programlisting">int                 shishi_apreq_get_authenticator_etype
                                                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         int32_t *etype);</pre>
<p>
Extract AP-REQ.authenticator.etype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td> AP-REQ variable to get value from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output variable that holds the value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-apreq-decrypt"></a><h3>shishi_apreq_decrypt ()</h3>
<pre class="programlisting">int                 shishi_apreq_decrypt                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> apreq,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *authenticator);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>apreq</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep"></a><h3>shishi_aprep ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_aprep                        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
This function creates a new AP-REP, populated with some default
values.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the authenticator or NULL on
failure.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-print"></a><h3>shishi_aprep_print ()</h3>
<pre class="programlisting">int                 shishi_aprep_print                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);</pre>
<p>
Print ASCII armored DER encoding of AP-REP to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> AP-REP to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-save"></a><h3>shishi_aprep_save ()</h3>
<pre class="programlisting">int                 shishi_aprep_save                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep);</pre>
<p>
Save DER encoding of AP-REP to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> AP-REP to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-to-file"></a><h3>shishi_aprep_to_file ()</h3>
<pre class="programlisting">int                 shishi_aprep_to_file                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write AP-REP to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> AP-REP to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-read"></a><h3>shishi_aprep_read ()</h3>
<pre class="programlisting">int                 shishi_aprep_read                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);</pre>
<p>
Read DER encoded AP-REP from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-parse"></a><h3>shishi_aprep_parse ()</h3>
<pre class="programlisting">int                 shishi_aprep_parse                  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep);</pre>
<p>
Read ASCII armored DER encoded AP-REP from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-from-file"></a><h3>shishi_aprep_from_file ()</h3>
<pre class="programlisting">int                 shishi_aprep_from_file              (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *aprep,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read AP-REP from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> output variable with newly allocated AP-REP.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-decrypt"></a><h3>shishi_aprep_decrypt ()</h3>
<pre class="programlisting">int                 shishi_aprep_decrypt                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key,
                                                         int keyusage,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *encapreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyusage</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-verify"></a><h3>shishi_aprep_verify ()</h3>
<pre class="programlisting">int                 shishi_aprep_verify                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-enc-part-set"></a><h3>shishi_aprep_enc_part_set ()</h3>
<pre class="programlisting">int                 shishi_aprep_enc_part_set           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int etype,
                                                         const char *buf,
                                                         size_t buflen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buf</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>buflen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-enc-part-add"></a><h3>shishi_aprep_enc_part_add ()</h3>
<pre class="programlisting">int                 shishi_aprep_enc_part_add           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-enc-part-make"></a><h3>shishi_aprep_enc_part_make ()</h3>
<pre class="programlisting">int                 shishi_aprep_enc_part_make          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encapreppart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> authenticator,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encapreppart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticator</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-aprep-get-enc-part-etype"></a><h3>shishi_aprep_get_enc_part_etype ()</h3>
<pre class="programlisting">int                 shishi_aprep_get_enc_part_etype     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> aprep,
                                                         int32_t *etype);</pre>
<p>
Extract AP-REP.enc-part.etype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>aprep</code></em> :</span></p></td>
<td> AP-REP variable to get value from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output variable that holds the value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-sendrecv"></a><h3>shishi_kdc_sendrecv ()</h3>
<pre class="programlisting">int                 shishi_kdc_sendrecv                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         const char *indata,
                                                         size_t inlen,
                                                         char **outdata,
                                                         size_t *outlen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>indata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outdata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-kdc-sendrecv-hint"></a><h3>shishi_kdc_sendrecv_hint ()</h3>
<pre class="programlisting">int                 shishi_kdc_sendrecv_hint            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         char *realm,
                                                         const char *indata,
                                                         size_t inlen,
                                                         char **outdata,
                                                         size_t *outlen,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkts-hint" title="Shishi_tkts_hint">Shishi_tkts_hint</a> *hint);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>indata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>inlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outdata</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hint</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart"></a><h3>shishi_encticketpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_encticketpart                (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-key-set"></a><h3>shishi_encticketpart_key_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_key_set        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Set the EncTicketPart.key field to key type and value of supplied
key.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key handle with information to store in encticketpart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-get-key"></a><h3>shishi_encticketpart_get_key ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_get_key        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> **key);</pre>
<p>
Extract the session key in the Ticket.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> newly allocated key.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-crealm"></a><h3>shishi_encticketpart_crealm ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_crealm         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **crealm,
                                                         size_t *crealmlen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealm</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crealmlen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-crealm-set"></a><h3>shishi_encticketpart_crealm_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_crealm_set     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *realm);</pre>
<p>
Set the realm field in the KDC-REQ.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>realm</code></em> :</span></p></td>
<td> input array with name of realm.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-client"></a><h3>shishi_encticketpart_client ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_client         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Represent client principal name in EncTicketPart as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <em class="parameter"><code>clientlen</code></em> does not include the terminating zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> EncTicketPart variable to get client name from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-clientrealm"></a><h3>shishi_encticketpart_clientrealm ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_clientrealm    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char **client,
                                                         size_t *clientlen);</pre>
<p>
Convert cname and realm fields from EncTicketPart to printable
principal name format.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <em class="parameter"><code>clientlen</code></em> does not include the terminating
zero.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> EncTicketPart variable to get client name and realm from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>client</code></em> :</span></p></td>
<td> pointer to newly allocated zero terminated string containing
  principal name and realm.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>clientlen</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>clientlen</code></em> :</span></p></td>
<td> pointer to length of <em class="parameter"><code>client</code></em> on output, excluding terminating
  zero.  May be <code class="literal">NULL</code> (to only populate <em class="parameter"><code>client</code></em>).
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-cname-set"></a><h3>shishi_encticketpart_cname_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_cname_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         <a class="link" href="shishi-shishi.html#Shishi-name-type" title="enum Shishi_name_type">Shishi_name_type</a> name_type,
                                                         const char *principal);</pre>
<p>
Set the client name field in the EncTicketPart.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>name_type</code></em> :</span></p></td>
<td> type of principial, see Shishi_name_type, usually
            SHISHI_NT_UNKNOWN.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td> input array with principal name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-print"></a><h3>shishi_encticketpart_print ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_print          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-flags-set"></a><h3>shishi_encticketpart_flags_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_flags_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         int flags);</pre>
<p>
Set the EncTicketPart.flags to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td> flags to set in encticketpart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-transited-set"></a><h3>shishi_encticketpart_transited_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_transited_set  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         int32_t trtype,
                                                         const char *trdata,
                                                         size_t trdatalen);</pre>
<p>
Set the EncTicketPart.transited field to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>trtype</code></em> :</span></p></td>
<td> transitedencoding type, e.g. SHISHI_TR_DOMAIN_X500_COMPRESS.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>trdata</code></em> :</span></p></td>
<td> actual transited realm data.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>trdatalen</code></em> :</span></p></td>
<td> length of actual transited realm data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-authtime-set"></a><h3>shishi_encticketpart_authtime_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_authtime_set   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *authtime);</pre>
<p>
Set the EncTicketPart.authtime to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtime</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-endtime-set"></a><h3>shishi_encticketpart_endtime_set ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_endtime_set    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         const char *endtime);</pre>
<p>
Set the EncTicketPart.endtime to supplied value.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td> input EncTicketPart variable.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>endtime</code></em> :</span></p></td>
<td> character buffer containing a generalized time string.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff succesful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-authtime"></a><h3>shishi_encticketpart_authtime ()</h3>
<pre class="programlisting">int                 shishi_encticketpart_authtime       (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart,
                                                         char *authtime,
                                                         size_t *authtimelen);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtime</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authtimelen</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encticketpart-authctime"></a><h3>shishi_encticketpart_authctime ()</h3>
<pre class="programlisting">time_t              shishi_encticketpart_authctime      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encticketpart);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encticketpart</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe"></a><h3>shishi_safe ()</h3>
<pre class="programlisting">int                 shishi_safe                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> **safe);</pre>
<p>
Create a new SAFE exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> pointer to new structure that holds information about SAFE exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-done"></a><h3>shishi_safe_done ()</h3>
<pre class="programlisting">void                shishi_safe_done                    (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);</pre>
<p>
Deallocate resources associated with SAFE exchange.  This should be
called by the application when it no longer need to utilize the
SAFE exchange handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> structure that holds information about SAFE exchange
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-key"></a><h3>shishi_safe_key ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_safe_key                     (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);</pre>
<p>
Get key structured from SAFE exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> structure that holds information about SAFE exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key used in the SAFE exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-key-set"></a><h3>shishi_safe_key_set ()</h3>
<pre class="programlisting">void                shishi_safe_key_set                 (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Set the Key in the SAFE exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> structure that holds information about SAFE exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to store in SAFE.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-safe"></a><h3>shishi_safe_safe ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_safe_safe                    (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe);</pre>
<p>
Get ASN.1 SAFE structured from SAFE exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> structure that holds information about SAFE exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ASN.1 safe in the SAFE exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-safe-set"></a><h3>shishi_safe_safe_set ()</h3>
<pre class="programlisting">void                shishi_safe_safe_set                (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1safe);</pre>
<p>
Set the KRB-SAFE in the SAFE exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> structure that holds information about SAFE exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asn1safe</code></em> :</span></p></td>
<td> KRB-SAFE to store in SAFE exchange.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-safe-der"></a><h3>shishi_safe_safe_der ()</h3>
<pre class="programlisting">int                 shishi_safe_safe_der                (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode SAFE structure.  Typically <a class="link" href="shishi-shishi.html#shishi-safe-build" title="shishi_safe_build ()"><code class="function">shishi_safe_build()</code></a> is used
to build the SAFE structure first.  <em class="parameter"><code>out</code></em> is allocated by this
function, and it is the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-safe-der-set"></a><h3>shishi_safe_safe_der_set ()</h3>
<pre class="programlisting">int                 shishi_safe_safe_der_set            (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode KRB-SAFE and set it SAFE exchange.  If decoding fails, the
KRB-SAFE in the SAFE exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded KRB-SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded KRB-SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-print"></a><h3>shishi_safe_print ()</h3>
<pre class="programlisting">int                 shishi_safe_print                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe);</pre>
<p>
Print ASCII armored DER encoding of SAFE to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> SAFE to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-save"></a><h3>shishi_safe_save ()</h3>
<pre class="programlisting">int                 shishi_safe_save                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe);</pre>
<p>
Save DER encoding of SAFE to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> SAFE to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-to-file"></a><h3>shishi_safe_to_file ()</h3>
<pre class="programlisting">int                 shishi_safe_to_file                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write SAFE to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> SAFE to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-parse"></a><h3>shishi_safe_parse ()</h3>
<pre class="programlisting">int                 shishi_safe_parse                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe);</pre>
<p>
Read ASCII armored DER encoded SAFE from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> output variable with newly allocated SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-read"></a><h3>shishi_safe_read ()</h3>
<pre class="programlisting">int                 shishi_safe_read                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe);</pre>
<p>
Read DER encoded SAFE from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> output variable with newly allocated SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-from-file"></a><h3>shishi_safe_from_file ()</h3>
<pre class="programlisting">int                 shishi_safe_from_file               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *safe,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read SAFE from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> output variable with newly allocated SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-cksum"></a><h3>shishi_safe_cksum ()</h3>
<pre class="programlisting">int                 shishi_safe_cksum                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int32_t *cksumtype,
                                                         char **cksum,
                                                         size_t *cksumlen);</pre>
<p>
Read checksum value from KRB-SAFE.  <em class="parameter"><code>cksum</code></em> is allocated by this
function, and it is the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> output checksum type.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksum</code></em> :</span></p></td>
<td> output array with newly allocated checksum data from SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumlen</code></em> :</span></p></td>
<td> output size of output checksum data buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-set-cksum"></a><h3>shishi_safe_set_cksum ()</h3>
<pre class="programlisting">int                 shishi_safe_set_cksum               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         int32_t cksumtype,
                                                         const char *cksum,
                                                         size_t cksumlen);</pre>
<p>
Store checksum value in SAFE.  A checksum is usually created by
calling <a class="link" href="shishi-shishi.html#shishi-checksum" title="shishi_checksum ()"><code class="function">shishi_checksum()</code></a> on some application specific data using
the key from the ticket that is being used.  To save time, you may
want to use <a class="link" href="shishi-shishi.html#shishi-safe-build" title="shishi_safe_build ()"><code class="function">shishi_safe_build()</code></a> instead, which calculates the
checksum and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumtype</code></em> :</span></p></td>
<td> input checksum type to store in SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksum</code></em> :</span></p></td>
<td> input checksum data to store in SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cksumlen</code></em> :</span></p></td>
<td> size of input checksum data to store in SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-user-data"></a><h3>shishi_safe_user_data ()</h3>
<pre class="programlisting">int                 shishi_safe_user_data               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         char **userdata,
                                                         size_t *userdatalen);</pre>
<p>
Read user data value from KRB-SAFE.  <em class="parameter"><code>userdata</code></em> is allocated by this
function, and it is the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em> :</span></p></td>
<td> output array with newly allocated user data from KRB-SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdatalen</code></em> :</span></p></td>
<td> output size of output user data buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-set-user-data"></a><h3>shishi_safe_set_user_data ()</h3>
<pre class="programlisting">int                 shishi_safe_set_user_data           (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> safe,
                                                         const char *userdata,
                                                         size_t userdatalen);</pre>
<p>
Set the application data in SAFE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em> :</span></p></td>
<td> input user application to store in SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdatalen</code></em> :</span></p></td>
<td> size of input user application to store in SAFE.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-build"></a><h3>shishi_safe_build ()</h3>
<pre class="programlisting">int                 shishi_safe_build                   (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Build checksum and set it in KRB-SAFE.  Note that this follows RFC
1510bis and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key for session, used to compute checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-safe-verify"></a><h3>shishi_safe_verify ()</h3>
<pre class="programlisting">int                 shishi_safe_verify                  (<a class="link" href="shishi-shishi.html#Shishi-safe" title="Shishi_safe">Shishi_safe</a> *safe,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Verify checksum in KRB-SAFE.  Note that this follows RFC 1510bis
and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>safe</code></em> :</span></p></td>
<td> safe as allocated by <a class="link" href="shishi-shishi.html#shishi-safe" title="shishi_safe ()"><code class="function">shishi_safe()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key for session, used to verify checksum.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful,
  SHISHI_SAFE_BAD_KEYTYPE if an incompatible key type is used, or
  SHISHI_SAFE_VERIFY_FAILED if the actual verification failed.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv"></a><h3>shishi_priv ()</h3>
<pre class="programlisting">int                 shishi_priv                         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> **priv);</pre>
<p>
Create a new PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> pointer to new structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-done"></a><h3>shishi_priv_done ()</h3>
<pre class="programlisting">void                shishi_priv_done                    (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);</pre>
<p>
Deallocate resources associated with PRIV exchange.  This should be
called by the application when it no longer need to utilize the
PRIV exchange handle.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-key"></a><h3>shishi_priv_key ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a>*         shishi_priv_key                     (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);</pre>
<p>
Get key from PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the key used in the PRIV exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-key-set"></a><h3>shishi_priv_key_set ()</h3>
<pre class="programlisting">void                shishi_priv_key_set                 (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Set the Key in the PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to store in PRIV.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-priv"></a><h3>shishi_priv_priv ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_priv_priv                    (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);</pre>
<p>
Get ASN.1 PRIV structure in PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ASN.1 priv in the PRIV exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-priv-set"></a><h3>shishi_priv_priv_set ()</h3>
<pre class="programlisting">void                shishi_priv_priv_set                (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1priv);</pre>
<p>
Set the KRB-PRIV in the PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asn1priv</code></em> :</span></p></td>
<td> KRB-PRIV to store in PRIV exchange.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-priv-der"></a><h3>shishi_priv_priv_der ()</h3>
<pre class="programlisting">int                 shishi_priv_priv_der                (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode PRIV structure.  Typically <a class="link" href="shishi-shishi.html#shishi-priv-build" title="shishi_priv_build ()"><code class="function">shishi_priv_build()</code></a> is used
to build the PRIV structure first.  <em class="parameter"><code>out</code></em> is allocated by this
function, and it is the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-priv-der-set"></a><h3>shishi_priv_priv_der_set ()</h3>
<pre class="programlisting">int                 shishi_priv_priv_der_set            (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode KRB-PRIV and set it PRIV exchange.  If decoding fails, the
KRB-PRIV in the PRIV exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded KRB-PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded KRB-PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-encprivpart"></a><h3>shishi_priv_encprivpart ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a>         shishi_priv_encprivpart             (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv);</pre>
<p>
Get ASN.1 EncPrivPart structure from PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the ASN.1 encprivpart in the PRIV exchange, or NULL if
              not yet set or an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-encprivpart-set"></a><h3>shishi_priv_encprivpart_set ()</h3>
<pre class="programlisting">void                shishi_priv_encprivpart_set         (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> asn1encprivpart);</pre>
<p>
Set the ENCPRIVPART in the PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> structure that holds information about PRIV exchange
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>asn1encprivpart</code></em> :</span></p></td>
<td> ENCPRIVPART to store in PRIV exchange.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-encprivpart-der"></a><h3>shishi_priv_encprivpart_der ()</h3>
<pre class="programlisting">int                 shishi_priv_encprivpart_der         (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char **out,
                                                         size_t *outlen);</pre>
<p>
DER encode ENCPRIVPART structure.  Typically
<code class="function">shishi_encprivpart_build()</code> is used to build the ENCPRIVPART
structure first.  <em class="parameter"><code>out</code></em> is allocated by this function, and it is the
responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em> :</span></p></td>
<td> output array with newly allocated DER encoding of ENCPRIVPART.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>outlen</code></em> :</span></p></td>
<td> length of output array with DER encoding of ENCPRIVPART.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-encprivpart-der-set"></a><h3>shishi_priv_encprivpart_der_set ()</h3>
<pre class="programlisting">int                 shishi_priv_encprivpart_der_set     (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         char *der,
                                                         size_t derlen);</pre>
<p>
DER decode ENCPRIVPART and set it PRIV exchange.  If decoding
fails, the ENCPRIVPART in the PRIV exchange remains.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>der</code></em> :</span></p></td>
<td> input array with DER encoded ENCPRIVPART.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>derlen</code></em> :</span></p></td>
<td> length of input array with DER encoded ENCPRIVPART.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-print"></a><h3>shishi_priv_print ()</h3>
<pre class="programlisting">int                 shishi_priv_print                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv);</pre>
<p>
Print ASCII armored DER encoding of PRIV to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> PRIV to print.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-save"></a><h3>shishi_priv_save ()</h3>
<pre class="programlisting">int                 shishi_priv_save                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv);</pre>
<p>
Save DER encoding of PRIV to file.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for writing.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> PRIV to save.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-to-file"></a><h3>shishi_priv_to_file ()</h3>
<pre class="programlisting">int                 shishi_priv_to_file                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Write PRIV to file in specified TYPE.  The file will be
truncated if it exists.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> PRIV to save.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be written,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to write to.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-parse"></a><h3>shishi_priv_parse ()</h3>
<pre class="programlisting">int                 shishi_priv_parse                   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv);</pre>
<p>
Read ASCII armored DER encoded PRIV from file and populate given
variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> output variable with newly allocated PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-read"></a><h3>shishi_priv_read ()</h3>
<pre class="programlisting">int                 shishi_priv_read                    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         FILE *fh,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv);</pre>
<p>
Read DER encoded PRIV from file and populate given variable.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fh</code></em> :</span></p></td>
<td> file handle open for reading.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> output variable with newly allocated PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-from-file"></a><h3>shishi_priv_from_file ()</h3>
<pre class="programlisting">int                 shishi_priv_from_file               (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> *priv,
                                                         int filetype,
                                                         const char *filename);</pre>
<p>
Read PRIV from file in specified TYPE.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> output variable with newly allocated PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filetype</code></em> :</span></p></td>
<td> input variable specifying type of file to be read,
           see Shishi_filetype.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>filename</code></em> :</span></p></td>
<td> input variable with filename to read from.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-enc-part-etype"></a><h3>shishi_priv_enc_part_etype ()</h3>
<pre class="programlisting">int                 shishi_priv_enc_part_etype          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int32_t *etype);</pre>
<p>
Extract PRIV.enc-part.etype.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> PRIV variable to get value from.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> output variable that holds the value.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-set-enc-part"></a><h3>shishi_priv_set_enc_part ()</h3>
<pre class="programlisting">int                 shishi_priv_set_enc_part            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> priv,
                                                         int32_t etype,
                                                         const char *encpart,
                                                         size_t encpartlen);</pre>
<p>
Store encrypted data in PRIV.  The encrypted data is usually
created by calling <a class="link" href="shishi-shishi.html#shishi-encrypt" title="shishi_encrypt ()"><code class="function">shishi_encrypt()</code></a> on some application specific
data using the key from the ticket that is being used.  To save
time, you may want to use <a class="link" href="shishi-shishi.html#shishi-priv-build" title="shishi_priv_build ()"><code class="function">shishi_priv_build()</code></a> instead, which
encryptes the data and calls this function in one step.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>etype</code></em> :</span></p></td>
<td> input encryption type to store in PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encpart</code></em> :</span></p></td>
<td> input encrypted data to store in PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encpartlen</code></em> :</span></p></td>
<td> size of input encrypted data to store in PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encprivpart-user-data"></a><h3>shishi_encprivpart_user_data ()</h3>
<pre class="programlisting">int                 shishi_encprivpart_user_data        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encprivpart,
                                                         char **userdata,
                                                         size_t *userdatalen);</pre>
<p>
Read user data value from KRB-PRIV.  <em class="parameter"><code>userdata</code></em> is allocated by this
function, and it is the responsibility of caller to deallocate it.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encprivpart</code></em> :</span></p></td>
<td> encprivpart as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em> :</span></p></td>
<td> output array with newly allocated user data from KRB-PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdatalen</code></em> :</span></p></td>
<td> output size of output user data buffer.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-encprivpart-set-user-data"></a><h3>shishi_encprivpart_set_user_data ()</h3>
<pre class="programlisting">int                 shishi_encprivpart_set_user_data    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-asn1" title="Shishi_asn1">Shishi_asn1</a> encprivpart,
                                                         const char *userdata,
                                                         size_t userdatalen);</pre>
<p>
Set the application data in PRIV.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>encprivpart</code></em> :</span></p></td>
<td> encprivpart as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em> :</span></p></td>
<td> input user application to store in PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdatalen</code></em> :</span></p></td>
<td> size of input user application to store in PRIV.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-build"></a><h3>shishi_priv_build ()</h3>
<pre class="programlisting">int                 shishi_priv_build                   (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Build checksum and set it in KRB-PRIV.  Note that this follows RFC
1510bis and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key for session, used to encrypt data.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-priv-process"></a><h3>shishi_priv_process ()</h3>
<pre class="programlisting">int                 shishi_priv_process                 (<a class="link" href="shishi-shishi.html#Shishi-priv" title="Shishi_priv">Shishi_priv</a> *priv,
                                                         <a class="link" href="shishi-shishi.html#Shishi-key" title="Shishi_key">Shishi_key</a> *key);</pre>
<p>
Decrypt encrypted data in KRB-PRIV and set the EncPrivPart in the
PRIV exchange.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>priv</code></em> :</span></p></td>
<td> priv as allocated by <a class="link" href="shishi-shishi.html#shishi-priv" title="shishi_priv ()"><code class="function">shishi_priv()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em> :</span></p></td>
<td> key to use to decrypt EncPrivPart.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns SHISHI_OK iff successful,
  SHISHI_PRIV_BAD_KEYTYPE if an incompatible key type is used, or
  SHISHI_CRYPTO_ERROR if the actual decryption failed.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authorized-p"></a><h3>shishi_authorized_p ()</h3>
<pre class="programlisting">int                 shishi_authorized_p                 (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         <a class="link" href="shishi-shishi.html#Shishi-tkt" title="Shishi_tkt">Shishi_tkt</a> *tkt,
                                                         const char *authzname);</pre>
<p>
Simplistic authorization of <em class="parameter"><code>authzname</code></em> against encrypted client
principal name inside ticket.  Currently this function only compare
the principal name with <em class="parameter"><code>authzname</code></em> using <code class="function">strcmp()</code>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> shishi handle as allocated by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>tkt</code></em> :</span></p></td>
<td> input variable with ticket info.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authzname</code></em> :</span></p></td>
<td> authorization name.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns 1 if authzname is authorized for services by
  authenticated client principal, or 0 otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authorization-parse"></a><h3>shishi_authorization_parse ()</h3>
<pre class="programlisting">int                 shishi_authorization_parse          (const char *authorization);</pre>
<p>
Parse authorization type name.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>authorization</code></em> :</span></p></td>
<td> name of authorization type, e.g. "basic".
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Return authorization type corresponding to a string.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authorize-strcmp"></a><h3>shishi_authorize_strcmp ()</h3>
<pre class="programlisting">int                 shishi_authorize_strcmp             (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal,
                                                         const char *authzname);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authzname</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-authorize-k5login"></a><h3>shishi_authorize_k5login ()</h3>
<pre class="programlisting">int                 shishi_authorize_k5login            (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *principal,
                                                         const char *authzname);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>principal</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authzname</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509ca-default-file-guess"></a><h3>shishi_x509ca_default_file_guess ()</h3>
<pre class="programlisting">char*               shishi_x509ca_default_file_guess    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Guesses the default X.509 CA certificate filename; it is
$HOME/.shishi/client.ca.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns default X.509 client certificate filename as
  a string that has to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509ca-default-file-set"></a><h3>shishi_x509ca_default_file_set ()</h3>
<pre class="programlisting">void                shishi_x509ca_default_file_set      (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509cafile);</pre>
<p>
Set the default X.509 CA certificate filename used in the library.
The certificate is used during TLS connections with the KDC to
authenticate the KDC.  The string is copied into the library, so
you can dispose of the variable immediately after calling this
function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>x509cafile</code></em> :</span></p></td>
<td> string with new default x509 client certificate file name,
  or NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509ca-default-file"></a><h3>shishi_x509ca_default_file ()</h3>
<pre class="programlisting">const char*         shishi_x509ca_default_file          (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename for default X.509 CA certificate.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default X.509 CA certificate filename
  used in the library.  The certificate is used during TLS
  connections with the KDC to authenticate the KDC.  The string is
  not a copy, so don't modify or deallocate it.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509cert-default-file-guess"></a><h3>shishi_x509cert_default_file_guess ()</h3>
<pre class="programlisting">char*               shishi_x509cert_default_file_guess  (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Guesses the default X.509 client certificate filename; it is
$HOME/.shishi/client.certs.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns default X.509 client certificate filename as
  a string that has to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509cert-default-file-set"></a><h3>shishi_x509cert_default_file_set ()</h3>
<pre class="programlisting">void                shishi_x509cert_default_file_set    (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509certfile);</pre>
<p>
Set the default X.509 client certificate filename used in the
library.  The certificate is used during TLS connections with the
KDC to authenticate the client.  The string is copied into the
library, so you can dispose of the variable immediately after
calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>x509certfile</code></em> :</span></p></td>
<td> string with new default x509 client certificate file name,
  or NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509cert-default-file"></a><h3>shishi_x509cert_default_file ()</h3>
<pre class="programlisting">const char*         shishi_x509cert_default_file        (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename for default X.509 certificate.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default X.509 client certificate filename
  used in the library.  The certificate is used during TLS
  connections with the KDC to authenticate the client.  The string is
  not a copy, so don't modify or deallocate it.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509key-default-file-guess"></a><h3>shishi_x509key_default_file_guess ()</h3>
<pre class="programlisting">char*               shishi_x509key_default_file_guess   (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Guesses the default X.509 client key filename; it is
$HOME/.shishi/client.key.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns default X.509 client key filename as
  a string that has to be deallocated with <code class="function">free()</code> by the caller.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509key-default-file-set"></a><h3>shishi_x509key_default_file_set ()</h3>
<pre class="programlisting">void                shishi_x509key_default_file_set     (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle,
                                                         const char *x509keyfile);</pre>
<p>
Set the default X.509 client key filename used in the library.  The
key is used during TLS connections with the KDC to authenticate the
client.  The string is copied into the library, so you can dispose
of the variable immediately after calling this function.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>x509keyfile</code></em> :</span></p></td>
<td> string with new default x509 client key file name, or
  NULL to reset to default.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-x509key-default-file"></a><h3>shishi_x509key_default_file ()</h3>
<pre class="programlisting">const char*         shishi_x509key_default_file         (<a class="link" href="shishi-shishi.html#Shishi" title="Shishi">Shishi</a> *handle);</pre>
<p>
Get filename for default X.509 key.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>handle</code></em> :</span></p></td>
<td> Shishi library handle create by <a class="link" href="shishi-shishi.html#shishi-init" title="shishi_init ()"><code class="function">shishi_init()</code></a>.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns the default X.509 client key filename
  used in the library.  The key is used during TLS
  connections with the KDC to authenticate the client.  The string is
  not a copy, so don't modify or deallocate it.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-get-date"></a><h3>shishi_get_date ()</h3>
<pre class="programlisting">time_t              shishi_get_date                     (const char *p,
                                                         const time_t *now);</pre>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>p</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>now</code></em> :</span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>


</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-xalloc-die"></a><h3>shishi_xalloc_die ()</h3>
<pre class="programlisting">void                shishi_xalloc_die                   (void);</pre>
<p>

</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-resolv"></a><h3>shishi_resolv ()</h3>
<pre class="programlisting"><a class="link" href="shishi-shishi.html#Shishi-dns" title="Shishi_dns">Shishi_dns</a>          shishi_resolv                       (const char *zone,
                                                         uint16_t querytype);</pre>
<p>
Query DNS resolver for data of type <em class="parameter"><code>querytype</code></em> at owner name <em class="parameter"><code>zone</code></em>.
Currently TXT and SRV types are supported.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>zone</code></em> :</span></p></td>
<td> owner name of data, e.g. "EXAMPLE.ORG"
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>querytype</code></em> :</span></p></td>
<td> type of data to query for, e.g., SHISHI_DNS_TXT.
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> Returns linked list of DNS records, or NULL if query
  failed.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="shishi-resolv-free"></a><h3>shishi_resolv_free ()</h3>
<pre class="programlisting">void                shishi_resolv_free                  (<a class="link" href="shishi-shishi.html#Shishi-dns" title="Shishi_dns">Shishi_dns</a> rrs);</pre>
<p>
Deallocate list of DNS RR as returned by <a class="link" href="shishi-shishi.html#shishi-resolv" title="shishi_resolv ()"><code class="function">shishi_resolv()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>rrs</code></em> :</span></p></td>
<td> list of DNS RR as returned by <a class="link" href="shishi-shishi.html#shishi-resolv" title="shishi_resolv ()"><code class="function">shishi_resolv()</code></a>.
</td>
</tr></tbody>
</table></div>
</div>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.10</div>
</body>
</html>
