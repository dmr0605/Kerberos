<html lang="en">
<head>
<title>Shishi</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Shishi">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual is last updated 4 March 2009 for version
0.0.39 of Shishi.

Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009 Simon Josefsson.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover Texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled "GNU Free Documentation License".
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
body { 
	margin: 2%;
	padding: 0 5%;
	background: #ffffff;
}
h1,h2,h3,h4,h5 {
    font-weight: bold;
    padding: 5px 5px 5px 5px;
    background-color: #c2e0ff;
    color: #336699;
}
h1 {
    padding: 2em 2em 2em 5%;
    color: white;
    background: #336699;
    text-align: center;
    letter-spacing: 3px;
}
h2 { text-decoration: underline; }
pre {
  margin: 0 5%;
  padding: 0.5em;
}
pre.example {
  border: solid 1px;
  background: #eeeeff;
  padding-bottom: 1em;
}
pre.verbatim {
  border: solid 1px gray;
  background: white;
  padding-bottom: 1em;
}
div.node {
  margin: 0 -5% 0 -2%;
  padding: 0.5em 0.5em;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  font-weight: bold;
}
dd, li {
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
--></style>
</head>
<body>
<h1 class="settitle">Shishi</h1>
   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Shishi</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<ul>
<li><a href="#Getting-Started">1.1 Getting Started</a>
<li><a href="#Features-and-Status">1.2 Features and Status</a>
<li><a href="#Overview">1.3 Overview</a>
<li><a href="#Cryptographic-Overview">1.4 Cryptographic Overview</a>
<li><a href="#Supported-Platforms">1.5 Supported Platforms</a>
<li><a href="#Getting-help">1.6 Getting help</a>
<li><a href="#Commercial-Support">1.7 Commercial Support</a>
<li><a href="#Downloading-and-Installing">1.8 Downloading and Installing</a>
<li><a href="#Bug-Reports">1.9 Bug Reports</a>
<li><a href="#Contributing">1.10 Contributing</a>
</li></ul>
<li><a name="toc_User-Manual" href="#User-Manual">2 User Manual</a>
<ul>
<li><a href="#User-Manual">2.1 Proxiable and Proxy Tickets</a>
<li><a href="#User-Manual">2.2 Forwardable and Forwarded Tickets</a>
</li></ul>
<li><a name="toc_Administration-Manual" href="#Administration-Manual">3 Administration Manual</a>
<ul>
<li><a href="#Introduction-to-Shisa">3.1 Introduction to Shisa</a>
<li><a href="#Configuring-Shisa">3.2 Configuring Shisa</a>
<li><a href="#Using-Shisa">3.3 Using Shisa</a>
<li><a href="#Starting-Shishid">3.4 Starting Shishid</a>
<li><a href="#Configuring-DNS-for-KDC">3.5 Configuring DNS for KDC</a>
<ul>
<li><a href="#Configuring-DNS-for-KDC">3.5.1 DNS vs. Kerberos - Case Sensitivity of Realm Names</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.2 Overview - KDC location information</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.3 Example - KDC location information</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.4 Security considerations</a>
</li></ul>
<li><a href="#Kerberos-via-TLS">3.6 Kerberos via TLS</a>
<ul>
<li><a href="#Kerberos-via-TLS">3.6.1 Setting up TLS resume</a>
<li><a href="#Kerberos-via-TLS">3.6.2 Setting up Anonymous TLS</a>
<li><a href="#Kerberos-via-TLS">3.6.3 Setting up X.509 authenticated TLS</a>
<ul>
<li><a href="#Kerberos-via-TLS">3.6.3.1 Create a Kerberos Certificate Authority</a>
<li><a href="#Kerberos-via-TLS">3.6.3.2 Create a Kerberos KDC Certificate</a>
<li><a href="#Kerberos-via-TLS">3.6.3.3 Create a Kerberos Client Certificate</a>
<li><a href="#Kerberos-via-TLS">3.6.3.4 Starting KDC with X.509 authentication support</a>
</li></ul>
</li></ul>
<li><a href="#Multiple-servers">3.7 Multiple servers</a>
<li><a href="#Developer-information">3.8 Developer information</a>
</li></ul>
<li><a name="toc_Reference-Manual" href="#Reference-Manual">4 Reference Manual</a>
<ul>
<li><a href="#Environmental-Assumptions">4.1 Environmental Assumptions</a>
<li><a href="#Glossary-of-terms">4.2 Glossary of terms</a>
<li><a href="#Realm-and-Principal-Naming">4.3 Realm and Principal Naming</a>
<ul>
<li><a href="#Realm-and-Principal-Naming">4.3.1 Realm Names</a>
<li><a href="#Realm-and-Principal-Naming">4.3.2 Principal Names</a>
<ul>
<li><a href="#Realm-and-Principal-Naming">4.3.2.1 Name of server principals</a>
<li><a href="#Realm-and-Principal-Naming">4.3.2.2 Name of the TGS</a>
</li></ul>
<li><a href="#Realm-and-Principal-Naming">4.3.3 Choosing a principal with which to communicate</a>
<li><a href="#Realm-and-Principal-Naming">4.3.4 Principal Name Form</a>
</li></ul>
<li><a href="#Shishi-Configuration">4.4 Shishi Configuration</a>
<ul>
<li><a href="#Shishi-Configuration">4.4.1 &lsquo;<samp><span class="samp">default-realm</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.2 &lsquo;<samp><span class="samp">default-principal</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.3 &lsquo;<samp><span class="samp">client-kdc-etypes</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.4 &lsquo;<samp><span class="samp">verbose</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-asn1</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-noise</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto-noise</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.5 &lsquo;<samp><span class="samp">realm-kdc</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.6 &lsquo;<samp><span class="samp">server-realm</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.7 &lsquo;<samp><span class="samp">kdc-timeout</span></samp>&rsquo;, &lsquo;<samp><span class="samp">kdc-retries</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.8 &lsquo;<samp><span class="samp">stringprocess</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.9 &lsquo;<samp><span class="samp">ticket-life</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.10 &lsquo;<samp><span class="samp">renew-life</span></samp>&rsquo;</a>
</li></ul>
<li><a href="#Shisa-Configuration">4.5 Shisa Configuration</a>
<ul>
<li><a href="#Shisa-Configuration">4.5.1 &lsquo;<samp><span class="samp">db</span></samp>&rsquo;</a>
</li></ul>
<li><a href="#Parameters-for-shishi">4.6 Parameters for shishi</a>
<li><a href="#Parameters-for-shishid">4.7 Parameters for shishid</a>
<li><a href="#Parameters-for-shisa">4.8 Parameters for shisa</a>
<li><a href="#Environment-variables">4.9 Environment variables</a>
<li><a href="#Date-input-formats">4.10 Date input formats</a>
<ul>
<li><a href="#General-date-syntax">4.10.1 General date syntax</a>
<li><a href="#Calendar-date-items">4.10.2 Calendar date items</a>
<li><a href="#Time-of-day-items">4.10.3 Time of day items</a>
<li><a href="#Time-zone-items">4.10.4 Time zone items</a>
<li><a href="#Day-of-week-items">4.10.5 Day of week items</a>
<li><a href="#Relative-items-in-date-strings">4.10.6 Relative items in date strings</a>
<li><a href="#Pure-numbers-in-date-strings">4.10.7 Pure numbers in date strings</a>
<li><a href="#Seconds-since-the-Epoch">4.10.8 Seconds since the Epoch</a>
<li><a href="#Specifying-time-zone-rules">4.10.9 Specifying time zone rules</a>
<li><a href="#Authors-of-get_005fdate">4.10.10 Authors of <code>get_date</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Programming-Manual" href="#Programming-Manual">5 Programming Manual</a>
<ul>
<li><a href="#Preparation">5.1 Preparation</a>
<ul>
<li><a href="#Header">5.1.1 Header</a>
<li><a href="#Initialization">5.1.2 Initialization</a>
<li><a href="#Version-Check">5.1.3 Version Check</a>
<li><a href="#Building-the-source">5.1.4 Building the source</a>
<li><a href="#Autoconf-tests">5.1.5 Autoconf tests</a>
<ul>
<li><a href="#Autoconf-tests">5.1.5.1 Autoconf test via &lsquo;<samp><span class="samp">pkg-config</span></samp>&rsquo;</a>
<li><a href="#Autoconf-tests">5.1.5.2 Standalone Autoconf test using Libtool</a>
<li><a href="#Autoconf-tests">5.1.5.3 Standalone Autoconf test</a>
</li></ul>
</li></ul>
<li><a href="#Initialization-Functions">5.2 Initialization Functions</a>
<li><a href="#Ticket-Set-Functions">5.3 Ticket Set Functions</a>
<li><a href="#AP_002dREQ-and-AP_002dREP-Functions">5.4 AP-REQ and AP-REP Functions</a>
<li><a href="#SAFE-and-PRIV-Functions">5.5 SAFE and PRIV Functions</a>
<li><a href="#Ticket-Functions">5.6 Ticket Functions</a>
<li><a href="#AS-Functions">5.7 AS Functions</a>
<li><a href="#TGS-Functions">5.8 TGS Functions</a>
<li><a href="#Ticket-_0028ASN_002e1_0029-Functions">5.9 Ticket (ASN.1) Functions</a>
<li><a href="#AS_002fTGS-Functions">5.10 AS/TGS Functions</a>
<li><a href="#Authenticator-Functions">5.11 Authenticator Functions</a>
<li><a href="#KRB_002dERROR-Functions">5.12 KRB-ERROR Functions</a>
<li><a href="#Cryptographic-Functions">5.13 Cryptographic Functions</a>
<li><a href="#X_002e509-Functions">5.14 X.509 Functions</a>
<li><a href="#Utility-Functions">5.15 Utility Functions</a>
<li><a href="#ASN_002e1-Functions">5.16 ASN.1 Functions</a>
<li><a href="#Error-Handling">5.17 Error Handling</a>
<ul>
<li><a href="#Error-Values">5.17.1 Error Values</a>
<li><a href="#Error-Functions">5.17.2 Error Functions</a>
</li></ul>
<li><a href="#Examples">5.18 Examples</a>
<li><a href="#Kerberos-Database-Functions">5.19 Kerberos Database Functions</a>
<li><a href="#Generic-Security-Service">5.20 Generic Security Service</a>
</li></ul>
<li><a name="toc_Acknowledgements" href="#Acknowledgements">6 Acknowledgements</a>
<li><a name="toc_Criticism-of-Kerberos" href="#Criticism-of-Kerberos">Appendix A Criticism of Kerberos</a>
<li><a name="toc_Protocol-Extensions" href="#Protocol-Extensions">Appendix B Protocol Extensions</a>
<ul>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1 STARTTLS protected KDC exchanges</a>
<ul>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.1 TCP/IP transport with TLS upgrade (STARTTLS)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.2 Extensible typed hole based on reserved high bit</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.3 STARTTLS requested by client (extension mode 1)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.4 STARTTLS request accepted by server (extension mode 2)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.5 Proceeding after successful TLS negotiation</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.6 Proceeding after failed TLS negotiation</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.7 Interaction with KDC addresses in DNS</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.8 Using TLS authentication logic in Kerberos</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.9 Security considerations</a>
</li></ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2 Telnet encryption with AES-CCM</a>
<ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.1 Command Names and Codes</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.2 Command Meanings</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.3 Implementation Rules</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.4 Integration with the AUTHENTICATION telnet option</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5 Security Considerations</a>
<ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5.1 Telnet Encryption Protocol Security Considerations</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5.2 AES-CCM Security Considerations</a>
</li></ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.6 Acknowledgments</a>
</li></ul>
<li><a href="#Kerberized-rsh-and-rlogin">B.3 Kerberized rsh and rlogin</a>
<ul>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.1 Establish connection</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.2 Kerberos identification</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.3 Kerberos authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.4 Extended authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.5 Window size</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.6 End of authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.7 Encryption</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.8 KCMDV0.3</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.9 MIT/Heimdal authorization</a>
</li></ul>
<li><a href="#Key-as-initialization-vector">B.4 Key as initialization vector</a>
<li><a href="#The-Keytab-Binary-File-Format">B.5 The Keytab Binary File Format</a>
<li><a href="#The-Credential-Cache-Binary-File-Format">B.6 The Credential Cache Binary File Format</a>
</li></ul>
<li><a name="toc_Copying-Information" href="#Copying-Information">Appendix C Copying Information</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">C.1 GNU Free Documentation License</a>
<li><a href="#GNU-GPL">C.2 GNU General Public License</a>
</li></ul>
<li><a name="toc_Function-and-Data-Index" href="#Function-and-Data-Index">Function and Data Index</a>
<li><a name="toc_Concept-Index" href="#Concept-Index">Concept Index</a>
</li></ul>
</div>



<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">Shishi</h2>

<p>This manual is last updated 4 March 2009 for version
0.0.39 of Shishi.

   <p>Copyright &copy; 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009 Simon Josefsson.

   <blockquote>
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled &ldquo;GNU Free
Documentation License&rdquo;. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>:                 How to use this manual. 
<li><a accesskey="2" href="#User-Manual">User Manual</a>:                  Using Shishi as end-user. 
<li><a accesskey="3" href="#Administration-Manual">Administration Manual</a>:        Administrating server aspects of Shishi. 
<li><a accesskey="4" href="#Reference-Manual">Reference Manual</a>:             Detailed description of config files, etc. 
<li><a accesskey="5" href="#Programming-Manual">Programming Manual</a>:           Calling Shishi from a programming language. 
<li><a accesskey="6" href="#Acknowledgements">Acknowledgements</a>:             Whom to blame.

</li></ul>
<p>Appendices

</p>
<ul class="menu">
<li><a accesskey="7" href="#Criticism-of-Kerberos">Criticism of Kerberos</a>:        Why you maybe shouldn't use Kerberos. 
<li><a accesskey="8" href="#Protocol-Extensions">Protocol Extensions</a>:          Description of protocol extensions used. 
<li><a accesskey="9" href="#Copying-Information">Copying Information</a>:          How you can copy and share Shishi.

</li></ul>
<p>Indices

</p>
<ul class="menu">
<li><a href="#Function-and-Data-Index">Function and Data Index</a>:      Index of functions, variables and data types. 
<li><a href="#Concept-Index">Concept Index</a>:                Index of concepts and programs. 
</ul>

<!-- ********************************************************** -->
<!-- ********************  Introduction  ********************** -->
<!-- ********************************************************** -->
<div class="node">
<a name="Introduction"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#User-Manual">User Manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Introduction</h2>

<p>Shishi is an implementation of the Kerberos 5 network authentication
system, as specified in RFC 4120.  Shishi can be used to authenticate
users in distributed systems.

   <p>Shishi contains a library ('libshishi') that can be used by
application developers to add support for Kerberos 5.  Shishi contains
a command line utility ('shishi') that is used by users to acquire and
manage tickets (and more).  The server side, a Key Distribution
Center, is implemented by 'shishid'.  Of course, a manual documenting
usage aspects as well as the programming API is included.

   <p>Shishi currently supports AS/TGS exchanges for acquiring tickets,
pre-authentication, the AP exchange for performing client and server
authentication, and SAFE/PRIV for integrity/privacy protected
application data exchanges.

   <p>Shishi is internationalized; error and status messages can be
translated into the users' language; user name and passwords can be
converted into any available character set (normally including
ISO-8859-1 and UTF-8) and also be processed using an experimental
Stringprep profile.

   <p>Most, if not all, of the widely used encryption and checksum types are
supported, such as 3DES, AES, ARCFOUR and HMAC-SHA1.

   <p>Shishi is developed for the GNU/Linux system, but runs on over 20
platforms including most major Unix platforms and Windows, and many
kind of devices including iPAQ handhelds and S/390 mainframes.

   <p>Shishi is free software licensed under the GNU General Public License
version 3.0 or later.

<ul class="menu">
<li><a accesskey="1" href="#Getting-Started">Getting Started</a>
<li><a accesskey="2" href="#Features-and-Status">Features and Status</a>
<li><a accesskey="3" href="#Overview">Overview</a>
<li><a accesskey="4" href="#Cryptographic-Overview">Cryptographic Overview</a>
<li><a accesskey="5" href="#Supported-Platforms">Supported Platforms</a>
<li><a accesskey="6" href="#Getting-help">Getting help</a>
<li><a accesskey="7" href="#Commercial-Support">Commercial Support</a>
<li><a accesskey="8" href="#Downloading-and-Installing">Downloading and Installing</a>
<li><a accesskey="9" href="#Bug-Reports">Bug Reports</a>
<li><a href="#Contributing">Contributing</a>
</ul>

<div class="node">
<a name="Getting-Started"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Features-and-Status">Features and Status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.1 Getting Started</h3>

<p>This manual documents the Shishi application and library programming
interface.  All commands, functions and data types provided by Shishi
are explained.

   <p>The reader is assumed to possess basic familiarity with network
security and the Kerberos 5 security system.

   <p>This manual can be used in several ways.  If read from the beginning
to the end, it gives a good introduction into the library and how it
can be used in an application.  Forward references are included where
necessary.  Later on, the manual can be used as a reference manual to
get just the information needed about any particular interface of the
library.  Experienced programmers might want to start looking at the
examples at the end of the manual, and then only read up those parts
of the interface which are unclear.

<div class="node">
<a name="Features-and-Status"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Overview">Overview</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-Started">Getting Started</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.2 Features and Status</h3>

<p>Shishi might have a couple of advantages over other packages doing a
similar job.

     <dl>
<dt>It's Free Software<dd>Anybody can use, modify, and redistribute it under the terms of the GNU
General Public License version 3.0 (see <a href="#GNU-GPL">GNU GPL</a>) or later.

     <br><dt>It's thread-safe<dd>The library uses no global variables.

     <br><dt>It's internationalized<dd>It handles non-ASCII username and passwords and user visible strings
used in the library (error messages) can be translated into the users'
language.

     <br><dt>It's portable<dd>It should work on all Unix like operating systems, including Windows.

   </dl>

   <p>Shishi is far from feature complete, it is not even a full RFC 1510
implementation yet.  However, some basic functionality is implemented. 
A few implemented feature are mentioned below.

     <ul>
<li>Initial authentication (AS) from raw key or password. 
This step is typically used to acquire a ticket granting ticket and,
less commonly, a server ticket.

     <li>Subsequent authentication (TGS). 
This step is typically used to acquire a server ticket, by
authenticating yourself using the ticket granting ticket.

     <li>Client-Server authentication (AP). 
This step is used by clients and servers to prove to each other who
they are, using negotiated tickets.

     <li>Integrity protected communication (SAFE). 
This step is used by clients and servers to exchange integrity
protected data with each other.  The key is typically agreed on using
the Client-Server authentication step.

     <li>Ticket cache, supporting multiple principals and realms. 
As tickets have a life time of typically several hours, they are
managed in disk files.  There can be multiple ticket caches, and each
ticket cache can store tickets for multiple clients (users), servers,
encryption types, etc.  Functionality is provided for locating the
proper ticket for every use.

     <li>Most standard cryptographic primitives. 
The believed most secure algorithms are supported
(see <a href="#Cryptographic-Overview">Cryptographic Overview</a>).

     <li>Telnet client and server. 
This is used to remotely login to other machines, after authenticating
yourself with a ticket.

     <li>PAM module. 
This is used to login locally on a machine.

     <li>KDC addresses located using DNS SRV RRs.

     <li>Modularized low-level crypto interface. 
Currently Gnulib and Libgcrypt are supported.  If you wish to add
support for another low-level cryptographic library, you only have to
implement a few APIs for DES, AES, MD5, SHA1, HMAC, etc. Look at
<samp><span class="file">gl/gc-gnulib.c</span></samp> or <samp><span class="file">gl/gc-libgcrypt.c</span></samp> as a starting
pointer.

   </ul>

   <p>The following table summarize what the current objectives are (i.e.,
the todo list) and an estimate on how long it will take to implement
the feature, including some reasonable startup-time to get familiar
with Shishi in general.  If you like to start working on anything,
please let me know so work duplication can be avoided.

     <ul>
<li>Parse <samp><span class="file">/etc/krb5.keytab</span></samp> to extract keys to use for telnetd etc (week)

     <li>Cross-realm support (week).

     <li>PKINIT (use libksba, weeks)

     <li>Finish GSSAPI support via GSSLib (weeks)
Shishi will not support GSSLib natively, but a separate project
&ldquo;GSSLib&rdquo; is under way to produce a generic GSS implementation, and
it will use Shishi to implement the Kerberos 5 mechanism.

     <li>Port to cyclone (cyclone need to mature first)

     <li>Modularize ASN.1 library so it can be replaced (days). 
Almost done, all ASN.1 functionality is found in lib/asn1.c, although
the interface is rather libtasn1 centric.

     <li>KDC (initiated, weeks)

     <li>LDAP backend for Shisa.

     <li>Set/Change password protocol (weeks?)

     <li>Port applications to use Shishi (indefinite)

     <li>Finish server-realm stuff

     <li>Improve documentation

     <li>Improve internationalization

     <li>Add AP-REQ replay cache (week).

     <li>Study benefits by introducing a PA-TGS-REP. 
This would provide mutual authentication of the KDC in a way that is
easier to analyze.  Currently the mutual authentication property is
only implicit from successful decryption of the KDC-REP and the 4 byte
nonce.

     <li>GUI applet for managing tickets. 
This is supported via the ticket-applet, of which a Shishi port is
published on the Shishi home page.

     <li>Authorization library (months?) 
The shishi_authorized_p() is not a good solution, better would be to
have a generic and flexible authorization library.  Possibly based on
S-EXP's in tickets?  Should support non-Kerberos uses as well, of
course.

     <li>Proof read manual.

     <li>X.500 support, including DOMAIN-X500-COMPRESS. 
I will accept patches that implement this, if it causes minimal
changes to the current code.

   </ul>

<div class="node">
<a name="Overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cryptographic-Overview">Cryptographic Overview</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features-and-Status">Features and Status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.3 Overview</h3>

<p>This section describes RFC 1510 from a protocol point of
view<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>.

   <p>Kerberos provides a means of verifying the identities of principals,
(e.g., a workstation user or a network server) on an open
(unprotected) network.  This is accomplished without relying on
authentication by the host operating system, without basing trust on
host addresses, without requiring physical security of all the hosts
on the network, and under the assumption that packets traveling along
the network can be read, modified, and inserted at will. (Note,
however, that many applications use Kerberos' functions only upon the
initiation of a stream-based network connection, and assume the
absence of any "hijackers" who might subvert such a connection.  Such
use implicitly trusts the host addresses involved.)  Kerberos performs
authentication under these conditions as a trusted third- party
authentication service by using conventional cryptography, i.e.,
shared secret key.  (shared secret key - Secret and private are often
used interchangeably in the literature.  In our usage, it takes two
(or more) to share a secret, thus a shared DES key is a secret key. 
Something is only private when no one but its owner knows it.  Thus,
in public key cryptosystems, one has a public and a private key.)

   <p>The authentication process proceeds as follows: A client sends a
request to the authentication server (AS) requesting "credentials" for
a given server.  The AS responds with these credentials, encrypted in
the client's key.  The credentials consist of 1) a "ticket" for the
server and 2) a temporary encryption key (often called a "session
key").  The client transmits the ticket (which contains the client's
identity and a copy of the session key, all encrypted in the server's
key) to the server.  The session key (now shared by the client and
server) is used to authenticate the client, and may optionally be used
to authenticate the server.  It may also be used to encrypt further
communication between the two parties or to exchange a separate
sub-session key to be used to encrypt further communication.

   <p>The implementation consists of one or more authentication servers
running on physically secure hosts.  The authentication servers
maintain a database of principals (i.e., users and servers) and their
secret keys. Code libraries provide encryption and implement the
Kerberos protocol.  In order to add authentication to its
transactions, a typical network application adds one or two calls to
the Kerberos library, which results in the transmission of the
necessary messages to achieve authentication.

   <p>The Kerberos protocol consists of several sub-protocols (or
exchanges).  There are two methods by which a client can ask a
Kerberos server for credentials.  In the first approach, the client
sends a cleartext request for a ticket for the desired server to the
AS. The reply is sent encrypted in the client's secret key. Usually
this request is for a ticket-granting ticket (TGT) which can later be
used with the ticket-granting server (TGS).  In the second method, the
client sends a request to the TGS.  The client sends the TGT to the
TGS in the same manner as if it were contacting any other application
server which requires Kerberos credentials.  The reply is encrypted in
the session key from the TGT.

   <p>Once obtained, credentials may be used to verify the identity of the
principals in a transaction, to ensure the integrity of messages
exchanged between them, or to preserve privacy of the messages.  The
application is free to choose whatever protection may be necessary.

   <p>To verify the identities of the principals in a transaction, the
client transmits the ticket to the server.  Since the ticket is sent
"in the clear" (parts of it are encrypted, but this encryption doesn't
thwart replay) and might be intercepted and reused by an attacker,
additional information is sent to prove that the message was
originated by the principal to whom the ticket was issued.  This
information (called the authenticator) is encrypted in the session
key, and includes a timestamp.  The timestamp proves that the message
was recently generated and is not a replay.  Encrypting the
authenticator in the session key proves that it was generated by a
party possessing the session key.  Since no one except the requesting
principal and the server know the session key (it is never sent over
the network in the clear) this guarantees the identity of the client.

   <p>The integrity of the messages exchanged between principals can also be
guaranteed using the session key (passed in the ticket and contained
in the credentials).  This approach provides detection of both replay
attacks and message stream modification attacks.  It is accomplished
by generating and transmitting a collision-proof checksum (elsewhere
called a hash or digest function) of the client's message, keyed with
the session key.  Privacy and integrity of the messages exchanged
between principals can be secured by encrypting the data to be passed
using the session key passed in the ticket, and contained in the
credentials.

<div class="node">
<a name="Cryptographic-Overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Supported-Platforms">Supported Platforms</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Overview">Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.4 Cryptographic Overview</h3>

<p>Shishi implements several of the standard cryptographic primitives. 
In this section we give the names of the supported encryption suites,
and some notes about them, and their associated checksum suite.

   <p>Statements such as &ldquo;it is weak&rdquo; should be read as meaning that there
is no credible security analysis of the mechanism available, and/or
that should an attack be published publicly, few people would likely
be surprised.  Also keep in mind that the key size mentioned is the
actual key size, not the effective key space as far as a brute force
attack is concerned.

   <p>As you may infer from the descriptions, there is currently no
encryption algorithm and only one checksum algorithm that inspire
great confidence in its design.  Hopefully this will change over time.

   <p><a name="index-DES-1"></a><a name="index-g_t3DES-2"></a><a name="index-AES-3"></a><a name="index-ARCFOUR-4"></a>
     <dl>
<dt><code>NULL</code><dd>
<code>NULL</code> is a dummy encryption suite for debugging.  Encryption and
decryption are identity functions.  No integrity protection.  It is
weak.  It is associated with the <code>NULL</code> checksum.

     <br><dt><code>arcfour-hmac</code><dt><code>arcfour-hmac-exp</code><dd>
<code>arcfour-hmac-*</code> are a proprietary stream cipher with 56 bit
(<code>arcfour-hmac-exp</code>) or 128 bit (<code>arcfour-hmac</code>) keys, used
in a proprietary way described in an expired IETF draft
<samp><span class="file">draft-brezak-win2k-krb-rc4-hmac-04.txt</span></samp>.  Deriving keys from
passwords is supported, and is done by computing a message digest
(MD4) of a 16-bit Unicode representation of the ASCII password, with
no salt.  Data is integrity protected with a keyed hash (HMAC-MD5),
where the key is derived from the base key in a creative way.  It is
weak.  It is associated with the <code>arcfour-hmac-md5</code> checksum.

     <br><dt><code>des-cbc-none</code><dd>
<code>des-cbc-none</code> is DES encryption and decryption with 56 bit keys
and 8 byte blocks in CBC mode, using a zero IV.  The keys can be
derived from passwords by an obscure application specific algorithm. 
It is weak, because it offers no integrity protection.  This is
typically only used by RFC 1964 GSS-API implementations (which try to
protect integrity using an ad-hoc solution).  It is associated with
the <code>NULL</code> checksum.

     <br><dt><code>des-cbc-crc</code><dd>
<code>des-cbc-crc</code> is DES encryption and decryption with 56 bit keys
and 8 byte blocks in CBC mode, using the key as IV (see <a href="#Key-as-initialization-vector">Key as initialization vector</a>).  The keys can be derived from passwords by an
obscure application specific algorithm.  Data is integrity protected
with an unkeyed but encrypted <code>CRC32</code>-like checksum.  It is
weak. It is associated with the <code>rsa-md5-des</code> checksum.

     <br><dt><code>des-cbc-md4</code><dd>
<code>des-cbc-md4</code> is DES encryption and decryption with 56 bit keys
and 8 byte blocks in CBC mode, using a zero IV.  The keys can be
derived from passwords by an obscure application specific algorithm. 
Data is integrity protected with an unkeyed but encrypted MD4 hash. 
It is weak. It is associated with the <code>rsa-md4-des</code> checksum.

     <br><dt><code>des-cbc-md5</code><dd>
<code>des-cbc-md5</code> is DES encryption and decryption with 56 bit keys
and 8 byte blocks in CBC mode, using a zero IV.  The keys can be
derived from passwords by an obscure application specific algorithm. 
Data is integrity protected with an unkeyed but encrypted MD5 hash. 
It is weak.  It is associated with the <code>rsa-md5-des</code> checksum. 
This is the strongest RFC 1510 interoperable encryption mechanism.

     <br><dt><code>des3-cbc-none</code><dd>
<code>des3-cbc-none</code> is DES encryption and decryption with three 56
bit keys (effective key size 112 bits) and 8 byte blocks in CBC mode. 
The keys can be derived from passwords by the same algorithm as
<code>des3-cbc-sha1-kd</code>.  It is weak, because it offers no integrity
protection.  This is typically only used by GSS-API implementations
(which try to protect integrity using an ad-hoc solution) for
interoperability with some existing Kerberos GSS implementations.  It
is associated with the <code>NULL</code> checksum.

     <br><dt><code>des3-cbc-sha1-kd</code><dd>
<code>des3-cbc-sha1-kd</code> is DES encryption and decryption with three 56
bit keys (effective key size 112 bits) and 8 byte blocks in CBC mode. 
The keys can be derived from passwords by a algorithm based on the
paper "A Better Key Schedule For DES-like Ciphers"
<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a> by
Uri Blumenthal and Steven M. Bellovin (it is not clear if the
algorithm, and the way it is used, is used by any other protocols,
although it seems unlikely).  Data is integrity protected with a keyed
SHA1 hash in HMAC mode.  It has no security proof, but is assumed to
provide adequate security in the sense that knowledge on how to crack
it is not known to the public.  Note that the key derivation function
is not widely used outside of Kerberos, hence not widely studied.  It
is associated with the <code>hmac-sha1-des3-kd</code> checksum.

     <br><dt><code>aes128-cts-hmac-sha1-96</code><dt><code>aes256-cts-hmac-sha1-96</code><dd>
<code>aes128-cts-hmac-sha1-96</code> and <code>aes256-cts-hmac-sha1-96</code> is
AES encryption and decryption with 128 bit and 256 bit key,
respectively, and 16 byte blocks in CBC mode with Cipher Text
Stealing.  Cipher Text Stealing means data length of encrypted data is
preserved (pure CBC add up to 7 pad characters).  The keys can be
derived from passwords with RSA Laboratories PKCS#5 Password Based Key
Derivation Function
2<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>,
which is allegedly provably secure in a random oracle model.  Data is
integrity protected with a keyed SHA1 hash, in HMAC mode, truncated to
96 bits.  There is no security proof, but the schemes are assumed to
provide adequate security in the sense that knowledge on how to crack
them is not known to the public.  Note that AES has yet to receive the
test of time, and the AES cipher encryption mode (CBC with Ciphertext
Stealing, and a non-standard IV output) is not widely standardized
(hence not widely studied).  It is associated with the
<code>hmac-sha1-96-aes128</code> and <code>hmac-sha1-96-aes256</code> checksums,
respectively.

   </dl>

   <p>The protocol do not include any way to negotiate which checksum
mechanisms to use, so in most cases the associated checksum will be
used.  However, checksum mechanisms can be used with other encryption
mechanisms, as long as they are compatible in terms of key format etc. 
Here are the names of the supported checksum mechanisms, with some
notes on their status and the compatible encryption mechanisms.  They
are ordered by increased security as perceived by the author.

     <dl>
<dt><code>NULL</code><dd>
<code>NULL</code> is a dummy checksum suite for debugging.  It provides no
integrity.  It is weak.  It is compatible with the <code>NULL</code>
encryption mechanism.

     <br><dt><code>arcfour-hmac-md5</code><dd>
<code>arcfour-hmac-md5</code> is a keyed HMAC-MD5 checksum computed on a MD5
message digest, in turn computed on a four byte message type indicator
concatenated with the application data.  (The <code>arcfour</code>
designation is thus somewhat misleading, but since this checksum
mechanism is described in the same document as the <code>arcfour</code>
encryption mechanisms, it is not a completely unnatural designation.) 
It is weak.  It is compatible with all encryption mechanisms.

     <br><dt><code>rsa-md4</code><dd>
<code>rsa-md4</code> is a unkeyed MD4 hash computed over the message.  It is
weak, because it is unkeyed.  However applications can, with care, use
it non-weak ways (e.g., by including the hash in other messages that
are protected by other means).  It is compatible with all encryption
mechanisms.

     <br><dt><code>rsa-md4-des</code><dd>
<code>rsa-md4-des</code> is a DES CBC encryption of one block of random data
and a unkeyed MD4 hash computed over the random data and the message
to integrity protect.  The key used is derived from the base protocol
key by XOR with a constant.  It is weak. It is compatible with the
<code>des-cbc-crc</code>, <code>des-cbc-md4</code>, <code>des-cbc-md5</code> encryption
mechanisms.

     <br><dt><code>rsa-md5</code><dd>
<code>rsa-md5</code> is a unkeyed MD5 hash computed over the message.  It is
weak, because it is unkeyed.  However applications can, with care, use
it non-weak ways (e.g., by including the hash in other messages that
are protected by other means).  It is compatible with all encryption
mechanisms.

     <br><dt><code>rsa-md5-des</code><dd>
<code>rsa-md5-des</code> is a DES CBC encryption of one block of random data
and a unkeyed MD5 hash computed over the random data and the message
to integrity protect.  The key used is derived from the base protocol
key by XOR with a constant.  It is weak.  It is compatible with the
<code>des-cbc-crc</code>, <code>des-cbc-md4</code>, <code>des-cbc-md5</code> encryption
mechanisms.

     <br><dt><code>hmac-sha1-des3-kd</code><dd>
<code>hmac-sha1-des3-kd</code> is a keyed SHA1 hash in HMAC mode computed
over the message.  The key is derived from the base protocol by the
simplified key derivation function (similar to the password key
derivation functions of <code>des3-cbc-sha1-kd</code>, which does not appear
to be widely used outside Kerberos and hence not widely studied).  It
has no security proof, but is assumed to provide good security.  The
weakest part is likely the proprietary key derivation function.  It is
compatible with the <code>des3-cbc-sha1-kd</code> encryption mechanism.

     <br><dt><code>hmac-sha1-96-aes128</code><dt><code>hmac-sha1-96-aes256</code><dd>
<code>hmac-sha1-96-aes*</code> are keyed SHA1 hashes in HMAC mode computed
over the message and then truncated to 96 bits.  The key is derived
from the base protocol by the simplified key derivation function
(similar to the password key derivation functions of
<code>aes*-cts-hmac-sha1-96</code>, i.e., PKCS#5).  It has no security
proof, but is assumed to provide good security.  It is compatible with
the <code>aes*-cts-hmac-sha1-96</code> encryption mechanisms.

   </dl>

   <p>Several of the cipher suites have long names that can be hard to
memorize.  For your convenience, the following short-hand aliases
exists.  They can be used wherever the full encryption names are used.

     <dl>
<dt><code>arcfour</code><dd>
Alias for <code>arcfour-hmac</code>.

     <br><dt><code>des-crc</code><dd>
Alias for <code>des-cbc-crc</code>.

     <br><dt><code>des-md4</code><dd>
Alias for <code>des-cbc-md4</code>.

     <br><dt><code>des-md5</code><dt><code>des</code><dd>
Alias for <code>des-cbc-md5</code>.

     <br><dt><code>des3</code><dt><code>3des</code><dd>
Alias for <code>des3-cbc-sha1-kd</code>.

     <br><dt><code>aes128</code><dd>
Alias for <code>aes128-cts-hmac-sha1-96</code>.

     <br><dt><code>aes</code><dt><code>aes256</code><dd>
Alias for <code>aes256-cts-hmac-sha1-96</code>.

   </dl>

<div class="node">
<a name="Supported-Platforms"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-help">Getting help</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cryptographic-Overview">Cryptographic Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.5 Supported Platforms</h3>

<p>Shishi has at some point in time been tested on the following
platforms.  Online build reports for each platforms and Shishi version
is available at <a href="http://autobuild.josefsson.org/shishi/">http://autobuild.josefsson.org/shishi/</a>.

     <ol type=1 start=1>

     <li>Debian GNU/Linux 3.0 (Woody)
<a name="index-Debian-5"></a>
GCC 2.95.4 and GNU Make. This is the main development platform. 
<code>alphaev67-unknown-linux-gnu</code>, <code>alphaev6-unknown-linux-gnu</code>,
<code>arm-unknown-linux-gnu</code>, <code>armv4l-unknown-linux-gnu</code>,
<code>hppa-unknown-linux-gnu</code>, <code>hppa64-unknown-linux-gnu</code>,
<code>i686-pc-linux-gnu</code>, <code>ia64-unknown-linux-gnu</code>,
<code>m68k-unknown-linux-gnu</code>, <code>mips-unknown-linux-gnu</code>,
<code>mipsel-unknown-linux-gnu</code>, <code>powerpc-unknown-linux-gnu</code>,
<code>s390-ibm-linux-gnu</code>, <code>sparc-unknown-linux-gnu</code>,
<code>sparc64-unknown-linux-gnu</code>.

     <li>Debian GNU/Linux 2.1
<a name="index-Debian-6"></a>
GCC 2.95.4 and GNU Make. <code>armv4l-unknown-linux-gnu</code>.

     <li>Tru64 UNIX
<a name="index-Tru64-7"></a>
Tru64 UNIX C compiler and Tru64 Make. <code>alphaev67-dec-osf5.1</code>,
<code>alphaev68-dec-osf5.1</code>.

     <li>SuSE Linux 7.1
<a name="index-SuSE-8"></a>
GCC 2.96 and GNU Make. <code>alphaev6-unknown-linux-gnu</code>,
<code>alphaev67-unknown-linux-gnu</code>.

     <li>SuSE Linux 7.2a
<a name="index-SuSE-Linux-9"></a>
GCC 3.0 and GNU Make. <code>ia64-unknown-linux-gnu</code>.

     <li>SuSE Linux
<a name="index-SuSE-Linux-10"></a>
GCC 3.2.2 and GNU Make.  <code>x86_64-unknown-linux-gnu</code> (AMD64
Opteron &ldquo;Melody&rdquo;).

     <li>RedHat Linux 7.2
<a name="index-RedHat-11"></a>
GCC 2.96 and GNU Make. <code>alphaev6-unknown-linux-gnu</code>,
<code>alphaev67-unknown-linux-gnu</code>, <code>ia64-unknown-linux-gnu</code>.

     <li>RedHat Linux 8.0
<a name="index-RedHat-12"></a>
GCC 3.2 and GNU Make. <code>i686-pc-linux-gnu</code>.

     <li>RedHat Advanced Server 2.1
<a name="index-RedHat-Advanced-Server-13"></a>
GCC 2.96 and GNU Make. <code>i686-pc-linux-gnu</code>.

     <li>Slackware Linux 8.0.01
<a name="index-RedHat-14"></a>
GCC 2.95.3 and GNU Make. <code>i686-pc-linux-gnu</code>.

     <li>Mandrake Linux 9.0
<a name="index-Mandrake-15"></a>
GCC 3.2 and GNU Make. <code>i686-pc-linux-gnu</code>.

     <li>IRIX 6.5
<a name="index-IRIX-16"></a>
MIPS C compiler, IRIX Make. <code>mips-sgi-irix6.5</code>.

     <li>AIX 4.3.2
<a name="index-AIX-17"></a>
IBM C for AIX compiler, AIX Make.  <code>rs6000-ibm-aix4.3.2.0</code>.

     <!-- @item Microsoft Windows 2000 (Cygwin) -->
     <!-- @cindex Windows -->
     <!-- GCC 3.2, GNU make. @code{i686-pc-cygwin}. -->
     <li>HP-UX 11
<a name="index-HP_002dUX-18"></a>
HP-UX C compiler and HP Make. <code>ia64-hp-hpux11.22</code>,
<code>hppa2.0w-hp-hpux11.11</code>.

     <li>SUN Solaris 2.8
<a name="index-Solaris-19"></a>
Sun WorkShop Compiler C 6.0 and SUN Make. <code>sparc-sun-solaris2.8</code>.

     <li>NetBSD 1.6
<a name="index-NetBSD-20"></a>
GCC 2.95.3 and GNU Make. <code>alpha-unknown-netbsd1.6</code>,
<code>i386-unknown-netbsdelf1.6</code>.

     <li>OpenBSD 3.1 and 3.2
<a name="index-OpenBSD-21"></a>
GCC 2.95.3 and GNU Make. <code>alpha-unknown-openbsd3.1</code>,
<code>i386-unknown-openbsd3.1</code>.

     <li>FreeBSD 4.7 and 4.8
<a name="index-FreeBSD-22"></a>
GCC 2.95.4 and GNU Make. <code>alpha-unknown-freebsd4.7</code>,
<code>alpha-unknown-freebsd4.8</code>, <code>i386-unknown-freebsd4.7</code>,
<code>i386-unknown-freebsd4.8</code>.

     <li>MacOS X 10.2 Server Edition
<a name="index-MacOS-X-23"></a>
GCC 3.1 and GNU Make. <code>powerpc-apple-darwin6.5</code>.

     <li>Cross compiled to uClinux/uClibc on Motorola Coldfire. 
<a name="index-Motorola-Coldfire-24"></a><a name="index-uClinux-25"></a><a name="index-uClibc-26"></a>
GCC 3.4 and GNU Make <code>m68k-uclinux-elf</code>.

        </ol>

   <p>If you use Shishi on, or port Shishi to, a new platform please report
it to the author (see <a href="#Bug-Reports">Bug Reports</a>).

<div class="node">
<a name="Getting-help"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Commercial-Support">Commercial Support</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Supported-Platforms">Supported Platforms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.6 Getting help</h3>

<p>A mailing list where users of Shishi may help each other exists, and
you can reach it by sending e-mail to <a href="mailto:help-shishi@gnu.org">help-shishi@gnu.org</a>. 
Archives of the mailing list discussions, and an interface to manage
subscriptions, is available through the World Wide Web at
<a href="http://lists.gnu.org/mailman/listinfo/help-shishi">http://lists.gnu.org/mailman/listinfo/help-shishi</a>.

<div class="node">
<a name="Commercial-Support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Downloading-and-Installing">Downloading and Installing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-help">Getting help</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.7 Commercial Support</h3>

<p>Commercial support is available for users of Shishi.  The kind of
support that can be purchased may include:

     <ul>
<li>Implement new features. 
Such as support for some optional part of the Kerberos standards,
e.g. PKINIT, hardware token authentication.

     <li>Port Shishi to new platforms. 
This could include porting Shishi to an embedded platforms that may
need memory or size optimization.

     <li>Integrate Kerberos 5 support in your existing project.

     <li>System design of components related to Kerberos 5.

   </ul>

   <p>If you are interested, please write to:

<pre class="verbatim">Simon Josefsson Datakonsult
Hagagatan 24
113 47 Stockholm
Sweden

E-mail: simon@josefsson.org
</pre>

   <p>If your company provide support related to Shishi and would like to be
mentioned here, contact the author (see <a href="#Bug-Reports">Bug Reports</a>).

<div class="node">
<a name="Downloading-and-Installing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bug-Reports">Bug Reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Commercial-Support">Commercial Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.8 Downloading and Installing</h3>

<p><a name="index-Installation-27"></a><a name="index-Download-28"></a>
The package can be downloaded from several places, including:

   <p><a href="ftp://alpha.gnu.org/pub/gnu/shishi/">ftp://alpha.gnu.org/pub/gnu/shishi/</a>

   <p>The latest version is stored in a file, e.g.,
&lsquo;<samp><span class="samp">shishi-0.0.39.tar.gz</span></samp>&rsquo; where the &lsquo;<samp><span class="samp">0.0.39</span></samp>&rsquo;
indicate the highest version number.

   <p>The package is then extracted, configured and built like many other
packages that use Autoconf.  For detailed information on configuring
and building it, refer to the <samp><span class="file">INSTALL</span></samp> file that is part of the
distribution archive.

   <p>Here is an example terminal session that download, configure, build
and install the package.  You will need a few basic tools, such as
&lsquo;<samp><span class="samp">sh</span></samp>&rsquo;, &lsquo;<samp><span class="samp">make</span></samp>&rsquo; and &lsquo;<samp><span class="samp">cc</span></samp>&rsquo;.

<pre class="example">     $ wget -q ftp://alpha.gnu.org/pub/gnu/shishi/shishi-0.0.39.tar.gz
     $ tar xfz shishi-0.0.39.tar.gz
     $ cd shishi-0.0.39/
     $ ./configure
     ...
     $ make
     ...
     $ make install
     ...
</pre>
   <p>After this you should be prepared to continue with the user,
administration or programming manual, depending on how you want to use
Shishi.

   <p>A few <code>configure</code> options may be relevant, summarized in the
table.

     <dl>
<dt><code>--disable-des</code><dt><code>--disable-3des</code><dt><code>--disable-aes</code><dt><code>--disable-md</code><dt><code>--disable-null</code><dt><code>--disable-arcfour</code><dd>Disable a cryptographic algorithm at compile time.  Usually it is
better to disable algorithms during run-time with the configuration
file, but this allows you to reduce the code size slightly.

     <br><dt><code>--disable-starttls</code><dd>Disable the experimental TLS support for KDC connections.  If you do
not use a Shishi KDC, this support is of no use so you could safely
disable it.

     <br><dt><code>--without-stringprep</code><dd>Disable internationalized string processing.

   </dl>

   <p>For the complete list, refer to the output from <code>configure
--help</code>.

<div class="node">
<a name="Bug-Reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Contributing">Contributing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Downloading-and-Installing">Downloading and Installing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.9 Bug Reports</h3>

<p><a name="index-Reporting-Bugs-29"></a>
If you think you have found a bug in Shishi, please investigate it and
report it.

     <ul>
<li>Please make sure that the bug is really in Shishi, and
preferably also check that it hasn't already been fixed in the latest
version.

     <li>You have to send us a test case that makes it possible for us to
reproduce the bug.

     <li>You also have to explain what is wrong; if you get a crash, or
if the results printed are not good and in that case, in what way. 
Make sure that the bug report includes all information you would need
to fix this kind of bug for someone else.

   </ul>

   <p>Please make an effort to produce a self-contained report, with
something definite that can be tested or debugged.  Vague queries or
piecemeal messages are difficult to act on and don't help the
development effort.

   <p>If your bug report is good, we will do our best to help you to get a
corrected version of the software; if the bug report is poor, we won't
do anything about it (apart from asking you to send better bug
reports).

   <p>If you think something in this manual is unclear, or downright
incorrect, or if the language needs to be improved, please also send a
note.

   <p>Send your bug report to:

<div align="center">&lsquo;<samp><span class="samp">bug-shishi@josefsson.org</span></samp>&rsquo;</div>

<div class="node">
<a name="Contributing"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bug-Reports">Bug Reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.10 Contributing</h3>

<p><a name="index-Contributing-30"></a><a name="index-Hacking-31"></a>
If you want to submit a patch for inclusion &ndash; from solve a typo you
discovered, up to adding support for a new feature &ndash; you should
submit it as a bug report (see <a href="#Bug-Reports">Bug Reports</a>).  There are some
things that you can do to increase the chances for it to be included
in the official package.

   <p>Unless your patch is very small (say, under 10 lines) we require that
you assign the copyright of your work to the Free Software Foundation. 
This is to protect the freedom of the project.  If you have not
already signed papers, we will send you the necessary information when
you submit your contribution.

   <p>For contributions that doesn't consist of actual programming code, the
only guidelines are common sense.  Use it.

   <p>For code contributions, a number of style guides will help you:

     <ul>
<li>Coding Style. 
Follow the GNU Standards document (see <a href="standards.html#Top">GNU Coding Standards</a>).

     <p>If you normally code using another coding standard, there is no
problem, but you should use &lsquo;<samp><span class="samp">indent</span></samp>&rsquo; to reformat the code
(see <a href="indent.html#Top">GNU Indent</a>) before submitting your work.

     <li>Use the unified diff format &lsquo;<samp><span class="samp">diff -u</span></samp>&rsquo;.

     <li>Return errors. 
The only valid reason for ever aborting the execution of the program
is due to memory allocation errors, but for that you should call
&lsquo;<samp><span class="samp">shishi_xalloc_die</span></samp>&rsquo; to allow the application to recover if it
wants to.

     <li>Design with thread safety in mind. 
Don't use global variables.  Don't even write to per-handle global
variables unless the documented behaviour of the function you write is
to write to the per-handle global variable.

     <li>Avoid using the C math library. 
It causes problems for embedded implementations, and in most
situations it is very easy to avoid using it.

     <li>Document your functions. 
Use comments before each function headers, that, if properly
formatted, are extracted into Texinfo manuals and GTK-DOC web pages.

     <li>Supply a ChangeLog and NEWS entries, where appropriate.

   </ul>

<!-- ********************************************************** -->
<!-- ********************  User Manual  ********************** -->
<!-- ********************************************************** -->
<div class="node">
<a name="User-Manual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Administration-Manual">Administration Manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 User Manual</h2>

<p><a name="index-End_002duser-Shishi-usage-32"></a>
Usually Shishi interacts with you to get some initial authentication
information like a password, and then contacts a server to receive a
so called ticket granting ticket.  From now on, you rarely interacts
with Shishi directly.  Applications that needs security services
instruct the Shishi library to use the ticket granting ticket to get
new tickets for various servers.  An example could be if you log on to
a host remotely via &lsquo;<samp><span class="samp">telnet</span></samp>&rsquo;.  The host usually requires
authentication before permitting you in.  The &lsquo;<samp><span class="samp">telnet</span></samp>&rsquo; client
uses the ticket granting ticket to get a ticket for the server, and
then use this ticket to authenticate you against the server (typically
the server is also authenticated to you).  You perform the initial
authentication by typing <samp><span class="command">shishi</span></samp> at the prompt.  Sometimes it
is necessary to supply options telling Shishi what your principal name
(user name in the Kerberos realm) or realm is.  In the example, I
specify the client name <code>simon@JOSEFSSON.ORG</code>.

<pre class="example">     $ shishi simon@JOSEFSSON.ORG
     Enter password for `simon@JOSEFSSON.ORG':
     simon@JOSEFSSON.ORG:
     Authtime:       Fri Aug 15 04:44:49 2003
     Endtime:        Fri Aug 15 05:01:29 2003
     Server:         krbtgt/JOSEFSSON.ORG key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   INITIAL (512)
     $
</pre>
   <p>As you can see, Shishi also prints a short description of the ticket
received.

   <p>A logical next step is to display all tickets you have received (by
the way, the tickets are usually stored as text in
<samp><span class="file">~/.shishi/tickets</span></samp>).  This is achieved by typing <samp><span class="command">shishi
--list</span></samp>.

<pre class="example">     $ shishi --list
     Tickets in `/home/jas/.shishi/tickets':
     
     jas@JOSEFSSON.ORG:
     Authtime:       Fri Aug 15 04:49:46 2003
     Endtime:        Fri Aug 15 05:06:26 2003
     Server:         krbtgt/JOSEFSSON.ORG key des-cbc-md5 (3)
     Ticket key:     des-cbc-md5 (3) protected by des-cbc-md5 (3)
     Ticket flags:   INITIAL (512)
     
     jas@JOSEFSSON.ORG:
     Authtime:       Fri Aug 15 04:49:46 2003
     Starttime:      Fri Aug 15 04:49:49 2003
     Endtime:        Fri Aug 15 05:06:26 2003
     Server:         host/latte.josefsson.org key des-cbc-md5 (3)
     Ticket key:     des-cbc-md5 (3) protected by des-cbc-md5 (3)
     
     2 tickets found.
     $
</pre>
   <p>As you can see, I had a ticket for the server
&lsquo;<samp><span class="samp">host/latte.josefsson.org</span></samp>&rsquo; which was generated by
&lsquo;<samp><span class="samp">telnet</span></samp>&rsquo;:ing to that host.

   <p>If, for some reason, you want to manually get a ticket for a specific
server, you can use the <samp><span class="command">shishi --server-name</span></samp> command. 
Normally, however, the application that uses Shishi will take care of
getting a ticket for the appropriate server, so you normally wouldn't
need this command.

<pre class="example">     $ shishi --server-name=user/billg --encryption-type=des-cbc-md4
     jas@JOSEFSSON.ORG:
     Authtime:       Fri Aug 15 04:49:46 2003
     Starttime:      Fri Aug 15 04:54:33 2003
     Endtime:        Fri Aug 15 05:06:26 2003
     Server:         user/billg key des-cbc-md4 (2)
     Ticket key:     des-cbc-md4 (2) protected by des-cbc-md5 (3)
     $
</pre>
   <p>As you can see, I acquired a ticket for &lsquo;<samp><span class="samp">user/billg</span></samp>&rsquo; with a
&lsquo;<samp><span class="samp">des-cbc-md4</span></samp>&rsquo; (see <a href="#Cryptographic-Overview">Cryptographic Overview</a>) encryption key
specified with the &lsquo;<samp><span class="samp">--encryption-type</span></samp>&rsquo; parameter.

   <p>To wrap up this introduction, lets see how you can remove tickets. 
You may want to do this if you leave your terminal for lunch or
similar, and don't want someone to be able to copy the file and then
use your credentials.  Note that this only destroy the tickets
locally, it does not contact any server and tell it that these
credentials are no longer valid.  So if someone stole your ticket
file, you must contact your administrator and have them reset your
account, simply using this parameter is not sufficient.

<pre class="example">     $ shishi --server-name=imap/latte.josefsson.org --destroy
     1 ticket removed.
     $ shishi --server-name=foobar --destroy
     No tickets removed.
     $ shishi --destroy
     3 tickets removed.
     $
</pre>
   <p>Since the &lsquo;<samp><span class="samp">--server-name</span></samp>&rsquo; parameter takes a long to type, it is
possible to type the server name directly, after the client name.  The
following example demonstrate a AS-REQ followed by a TGS-REQ for a
specific server (assuming you did not have any tickets from the
start).

<pre class="example">     $ src/shishi simon@latte.josefsson.org imap/latte.josefsson.org
     Enter password for `simon@latte.josefsson.org':
     simon@latte.josefsson.org:
     Acquired:       Wed Aug 27 17:21:06 2003
     Expires:        Wed Aug 27 17:37:46 2003
     Server:         imap/latte.josefsson.org key aes256-cts-hmac-sha1-96 (18)
     Ticket key:     aes256-cts-hmac-sha1-96 (18) protected by aes256-cts-hmac-sha1-96 (18)
     Ticket flags:   FORWARDED PROXIABLE (12)
     $
</pre>
   <p>Refer to the reference manual for all available parameters
(see <a href="#Parameters-for-shishi">Parameters for shishi</a>).  The rest of this section contains
description of more specialized usage modes that can be ignored by
most users.

<h3 class="section">2.1 Proxiable and Proxy Tickets</h3>

<p>At times it may be necessary for a principal to allow a service to
perform an operation on its behalf. The service must be able to take
on the identity of the client, but only for a particular purpose. A
principal can allow a service to take on the principal's identity for
a particular purpose by granting it a proxy.

   <p>The process of granting a proxy using the proxy and proxiable flags is
used to provide credentials for use with specific services. Though
conceptually also a proxy, users wishing to delegate their identity in
a form usable for all purpose MUST use the ticket forwarding mechanism
described in the next section to forward a ticket-granting ticket.

   <p>The PROXIABLE flag in a ticket is normally only interpreted by the
ticket-granting service. It can be ignored by application servers. 
When set, this flag tells the ticket-granting server that it is OK to
issue a new ticket (but not a ticket-granting ticket) with a different
network address based on this ticket. This flag is set if requested by
the client on initial authentication. By default, the client will
request that it be set when requesting a ticket-granting ticket, and
reset when requesting any other ticket.

   <p>This flag allows a client to pass a proxy to a server to perform a
remote request on its behalf (e.g. a print service client can give the
print server a proxy to access the client's files on a particular file
server in order to satisfy a print request).

   <p>In order to complicate the use of stolen credentials, Kerberos tickets
are usually valid from only those network addresses specifically
included in the ticket[4]. When granting a proxy, the client MUST
specify the new network address from which the proxy is to be used, or
indicate that the proxy is to be issued for use from any address.

   <p>The PROXY flag is set in a ticket by the TGS when it issues a proxy
ticket.  Application servers MAY check this flag and at their option
they MAY require additional authentication from the agent presenting
the proxy in order to provide an audit trail.

   <p>Here is how you would acquire a PROXY ticket for the service
&lsquo;<samp><span class="samp">imap/latte.josefsson.org</span></samp>&rsquo;:

<pre class="example">     $ shishi jas@JOSEFSSON.ORG imap/latte.josefsson.org --proxy
     Enter password for `jas@JOSEFSSON.ORG':
     libshishi: warning: KDC bug: Reply encrypted using wrong key.
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:02:35 2003
     Starttime:      Mon Sep  8 20:02:36 2003
     Endtime:        Tue Sep  9 04:02:35 2003
     Server:         imap/latte.josefsson.org key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   PROXY (16)
     $
</pre>
   <p>As you noticed, this asked for your password.  The reason is that
proxy tickets must be acquired using a proxiable ticket granting
ticket, which was not present.  If you often need to get proxy
tickets, you may acquire a proxiable ticket granting ticket from the
start:

<pre class="example">     $ shishi --proxiable
     Enter password for `jas@JOSEFSSON.ORG':
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:04:27 2003
     Endtime:        Tue Sep  9 04:04:27 2003
     Server:         krbtgt/JOSEFSSON.ORG key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   PROXIABLE INITIAL (520)
</pre>
   <p>Then you should be able to acquire proxy tickets based on that ticket
granting ticket, as follows:

<pre class="example">     $ shishi jas@JOSEFSSON.ORG imap/latte.josefsson.org --proxy
     libshishi: warning: KDC bug: Reply encrypted using wrong key.
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:04:27 2003
     Starttime:      Mon Sep  8 20:04:32 2003
     Endtime:        Tue Sep  9 04:04:27 2003
     Server:         imap/latte.josefsson.org key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   PROXY (16)
     $
</pre>
   <h3 class="section">2.2 Forwardable and Forwarded Tickets</h3>

<p>Authentication forwarding is an instance of a proxy where the service
that is granted is complete use of the client's identity. An example
where it might be used is when a user logs in to a remote system and
wants authentication to work from that system as if the login were
local.

   <p>The FORWARDABLE flag in a ticket is normally only interpreted by the
ticket-granting service. It can be ignored by application servers. 
The FORWARDABLE flag has an interpretation similar to that of the
PROXIABLE flag, except ticket-granting tickets may also be issued with
different network addresses. This flag is reset by default, but users
MAY request that it be set by setting the FORWARDABLE option in the AS
request when they request their initial ticket-granting ticket.

   <p>This flag allows for authentication forwarding without requiring the
user to enter a password again. If the flag is not set, then
authentication forwarding is not permitted, but the same result can
still be achieved if the user engages in the AS exchange specifying
the requested network addresses and supplies a password.

   <p>The FORWARDED flag is set by the TGS when a client presents a ticket
with the FORWARDABLE flag set and requests a forwarded ticket by
specifying the FORWARDED KDC option and supplying a set of addresses
for the new ticket. It is also set in all tickets issued based on
tickets with the FORWARDED flag set. Application servers may choose to
process FORWARDED tickets differently than non-FORWARDED tickets.

   <p>If addressless tickets are forwarded from one system to another,
clients SHOULD still use this option to obtain a new TGT in order to
have different session keys on the different systems.

   <p>Here is how you would acquire a FORWARDED ticket for the service
&lsquo;<samp><span class="samp">host/latte.josefsson.org</span></samp>&rsquo;:

<pre class="example">     $ shishi jas@JOSEFSSON.ORG host/latte.josefsson.org --forwarded
     Enter password for `jas@JOSEFSSON.ORG':
     libshishi: warning: KDC bug: Reply encrypted using wrong key.
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:07:11 2003
     Starttime:      Mon Sep  8 20:07:12 2003
     Endtime:        Tue Sep  9 04:07:11 2003
     Server:         host/latte.josefsson.org key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   FORWARDED (4)
     $
</pre>
   <p>As you noticed, this asked for your password.  The reason is that
forwarded tickets must be acquired using a forwardable ticket granting
ticket, which was not present.  If you often need to get forwarded
tickets, you may acquire a forwardable ticket granting ticket from the
start:

<pre class="example">     $ shishi --forwardable
     Enter password for `jas@JOSEFSSON.ORG':
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:08:53 2003
     Endtime:        Tue Sep  9 04:08:53 2003
     Server:         krbtgt/JOSEFSSON.ORG key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   FORWARDABLE INITIAL (514)
     $
</pre>
   <p>Then you should be able to acquire forwarded tickets based on that
ticket granting ticket, as follows:

<pre class="example">     $ shishi jas@JOSEFSSON.ORG host/latte.josefsson.org --forwarded
     libshishi: warning: KDC bug: Reply encrypted using wrong key.
     jas@JOSEFSSON.ORG:
     Authtime:       Mon Sep  8 20:08:53 2003
     Starttime:      Mon Sep  8 20:08:57 2003
     Endtime:        Tue Sep  9 04:08:53 2003
     Server:         host/latte.josefsson.org key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by des3-cbc-sha1-kd (16)
     Ticket flags:   FORWARDED (4)
     $
</pre>
   <!-- ********************************************************** -->
<!-- ****************  Administration Manual  ***************** -->
<!-- ********************************************************** -->
<div class="node">
<a name="Administration-Manual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Reference-Manual">Reference Manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#User-Manual">User Manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Administration Manual</h2>

<p>Here you will learn how to set up, run and maintain the Shishi
Kerberos server.  Kerberos is incompatible with the standard Unix
<samp><span class="file">/etc/passwd</span></samp> password database<a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a>, therefor the first
step will be to create a Kerberos user database.  Shishi's user
database system is called Shisa.  Once Shisa is configured, you can
then start the server and begin issuing Kerberos tickets to your
users.  The Shishi server is called <samp><span class="file">shishid</span></samp>.  After getting the
server up and running, we discuss how you can set up multiple Kerberos
servers, to increase availability or offer load-balancing.  Finally,
we include some information intended for developers, that will enable
you to customize Shisa to use an external user database, such as a
<acronym>LDAP</acronym> server or <acronym>SQL</acronym> database.

<ul class="menu">
<li><a accesskey="1" href="#Introduction-to-Shisa">Introduction to Shisa</a>:        Explanation of the Shishi user database. 
<li><a accesskey="2" href="#Configuring-Shisa">Configuring Shisa</a>:            Define the user database in Shisa. 
<li><a accesskey="3" href="#Using-Shisa">Using Shisa</a>:                  How to add realms and principals to database. 
<li><a accesskey="4" href="#Starting-Shishid">Starting Shishid</a>:             Issue Kerberos tickets to your users. 
<li><a accesskey="5" href="#Configuring-DNS-for-KDC">Configuring DNS for KDC</a>:      Placing the KDC address in DNS is useful. 
<li><a accesskey="6" href="#Kerberos-via-TLS">Kerberos via TLS</a>:             How to setup Shishi to use TLS. 
<li><a accesskey="7" href="#Multiple-servers">Multiple servers</a>:             High availability and load-balancing. 
<li><a accesskey="8" href="#Developer-information">Developer information</a>:        Writing your own Shisa database backend. 
</ul>

<div class="node">
<a name="Introduction-to-Shisa"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Configuring-Shisa">Configuring Shisa</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.1 Introduction to Shisa</h3>

<p>The user database part of Shishi is called Shisa.  The Shisa library
is independent of the core Shishi library.  Shisa is responsible for
storing the name of your realms, the name of your principals (users),
accounting information for the users (i.e., when each account start to
be valid and when it expire), and the cryptographic keys each user
have.  Some Kerberos internal data can also be stored, such as the key
version number, the last dates for when various ticket requests were
made, the cryptographic salt, string-to-key parameters and password
for each user.  Not all information need to be stored.  For example,
in some situations it is prudent to leave the password field empty, so
that somebody who manage to steal the user database will only be able
to compromise your system, and not other systems were your user may
have re-used the same password.  On the other hand, you may already
store the password in your customized database, in which case being
able to change it via the Shisa interface can be useful.

   <p>Shisa is a small (a few thousand lines of <acronym>C</acronym> code) standalone
library.  Shisa does not depend on the Shishi library.  Because a user
database with passwords may be useful for other applications as well
(e.g., <acronym>GNU</acronym> <acronym>SASL</acronym>), it may be separated into its own
project later on.  You should keep this in mind, so that you don't
consider writing a Shisa backend for your own database a purely Shishi
specific project.  You may, for example, chose to use the Shisa
interface in your own applications to have a simple interface to your
user database.  Your experience and feedback is appreciated if you
chose to explore this.

   <p>Note that the Shisa database does not expose everything you may want
to know about a user, such as its full human name, telephone number or
even the user's login account name or home directory.  It only store
what is needed to authenticate a peer claiming to be an entity.  Thus
it does not make sense to replace your current user database or
<samp><span class="file">/etc/passwd</span></samp> with data derived from the Shisa database. 
Instead, it is intended that you write a Shisa backend that export
<i>some</i> of the information stored in your user database.  You may be
able to replace some existing functionality, such as the password
field in <samp><span class="file">/etc/passwd</span></samp> with a Kerberos PAM module, but there is
no requirement for doing so.

<div class="node">
<a name="Configuring-Shisa"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Using-Shisa">Using Shisa</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction-to-Shisa">Introduction to Shisa</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.2 Configuring Shisa</h3>

<p>The configuration file for Shisa is typically stored in
<samp><span class="file">/usr/local/etc/shishi/shisa.conf</span></samp>.  You do not have to configure
this file, the defaults should be acceptable to first-time users.  The
file is used to define where you user database reside, and some
options such as making the database read-only or whether errors
detected when accessing the database should be ignored.  (The latter
may be useful if the server is a remote <acronym>LDAP</acronym> server that may
be unavailable, and you want to fail over to a local copy of the
database.)

   <p>The default will store the user database using directories and files,
rooted by default in <samp><span class="file">/usr/local/var/shishi</span></samp>.  You may use
standard file permission settings to control access to the directory
hierarchy.  It is strongly recommended to restrict access to the
directory.  Storing the directory on local storage (i.e., hard disk or
removal media) is recommended.  We discourage placing the database on
a network file system, but realize it can be useful in some situations
(see <a href="#Multiple-servers">Multiple servers</a>).

   <p>See the reference manual (see <a href="#Shisa-Configuration">Shisa Configuration</a>) for the details
of the configuration file.  Again, you are not expected to need to
modify anything unless you are an experienced Shishi administrator.

<div class="node">
<a name="Using-Shisa"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Starting-Shishid">Starting Shishid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuring-Shisa">Configuring Shisa</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.3 Using Shisa</h3>

<p>There is a command line interface to the Shisa library, aptly named
<samp><span class="file">shisa</span></samp>.  You will use this tool to add, remove and change
information stored in the database about realms, principals and keys. 
The tool can also be used to &ldquo;dump&rdquo; all information in the database,
for backup or debugging purposes.  (Currently the output format cannot
be read by any tool, but functionality to do this will be added in the
future, possibly as a read-only file-based Shisa database backend.)

   <p>The reference manual (see <a href="#Parameters-for-shisa">Parameters for shisa</a>) explains all
parameters, but here we will give you a walk-through of the typical
uses of the tool.

   <p>Installing Shishi usually create a realm with two principals; one
ticket granting ticket for the realm, and one host key for the server. 
This is what you typically need to get started, but it doesn't serve
our purposes.  So we start by removing the principals and the realm. 
To do that, we need to figure out the name of the realm.  The
&lsquo;<samp><span class="samp">--list</span></samp>&rsquo; or &lsquo;<samp><span class="samp">--dump</span></samp>&rsquo; parameters can be used for this.  (Most
&ldquo;long&rdquo; parameters, like &lsquo;<samp><span class="samp">--dump</span></samp>&rsquo;, have shorter names as well,
in this case &lsquo;<samp><span class="samp">-d</span></samp>&rsquo;, <a href="#Parameters-for-shisa">Parameters for shisa</a>).

<pre class="example">     jas@latte:~$ shisa -d
     latte
             krbtgt/latte
                     Account is enabled.
                     Current key version 0 (0x0).
                     Key 0 (0x0).
                             Etype aes256-cts-hmac-sha1-96 (0x12, 18).
                             Salt lattekrbtgt/latte.
             host/latte
                     Account is enabled.
                     Current key version 0 (0x0).
                     Key 0 (0x0).
                             Etype aes256-cts-hmac-sha1-96 (0x12, 18).
                             Salt lattehost/latte.
     jas@latte:~$
</pre>
   <p>The realm names are printed at column 0, the principal names are
indented with one &lsquo;<samp><span class="samp">TAB</span></samp>&rsquo; character (aka &lsquo;<samp><span class="samp">\t</span></samp>&rsquo; or ASCII 0x09
Horizontal Tabulation), and the information about each principal are
indented with two &lsquo;<samp><span class="samp">TAB</span></samp>&rsquo; characters.  The above output means that
there is one realm &lsquo;<samp><span class="samp">latte</span></samp>&rsquo; with two principals;
&lsquo;<samp><span class="samp">krbtgt/latte</span></samp>&rsquo; (which is used to authenticate Kerberos ticket
requests) and &lsquo;<samp><span class="samp">host/latte</span></samp>&rsquo; (used to authenticate host-based
applications like Telnet).  They were created during &lsquo;<samp><span class="samp">make
install</span></samp>&rsquo; on a host called &lsquo;<samp><span class="samp">latte</span></samp>&rsquo;.

   <p>If the installation did not create a default database for you, you
might get an error similar to the following.

<pre class="example">     jas@latte:~$ shisa -d
     shisa: Cannot initialize `file' database backend.
     Location `/usr/local/var/shishi' and options `N/A'.
     shisa: Initialization failed:
     Shisa database could not be opened.
     jas@latte:~$
</pre>
   <p>This indicate the database do not exist.  For a file database, you can
create it by simply creating the directory, as follows.  Note the
access permission change with &lsquo;<samp><span class="samp">chmod</span></samp>&rsquo;.  Typically the &lsquo;<samp><span class="samp">root</span></samp>&rsquo;
user would own the files, but as these examples demonstrate, setting
up a Kerberos server does not require root access.  Indeed, it may be
prudent to run all Shishi applications as a special non-&lsquo;<samp><span class="samp">root</span></samp>&rsquo;
user, and have all Shishi related files owned by that user, so that
any security vulnerabilities does not lead to a system compromise. 
(However, if the user database is stolen, system compromises of other
systems may be possible if you use, e.g., Kerberos Telnet.)

<pre class="example">     jas@latte:~$ mkdir /usr/local/var/shishi
     jas@latte:~$ chmod go-rwx /usr/local/var/shishi
</pre>
   <p>Back to the first example, where you have a realm &lsquo;<samp><span class="samp">latte</span></samp>&rsquo; with
some principals.  We want to remove the realm to demonstrate how you
create the realm from scratch.  (Of course, you can have more than one
realm in the database, but for this example we assume you want to set
up a realm named the same as Shishi guessed you would name it, so the
existing realm need to be removed first.)  The &lsquo;<samp><span class="samp">--remove</span></samp>&rsquo; (short
form &lsquo;<samp><span class="samp">-r</span></samp>&rsquo;) parameter is used for this purpose, as follows.

<pre class="example">     jas@latte:~$ shisa -r latte host/latte
     Removing principal `host/latte@latte'...
     Removing principal `host/latte@latte'...done
     jas@latte:~$ shisa -r latte krbtgt/latte
     Removing principal `krbtgt/latte@latte'...
     Removing principal `krbtgt/latte@latte'...done
     jas@latte:~$ shisa -r latte
     Removing realm `latte'...
     Removing realm `latte'...done
     jas@latte:~$
</pre>
   <p>You may be asking yourself &ldquo;What if the realm has many more
principals?&rdquo;.  If you fear manual labor (or a small &lsquo;<samp><span class="samp">sed</span></samp>&rsquo;
script, recall the format of &lsquo;<samp><span class="samp">--list</span></samp>&rsquo;?), don't worry, there is a
&lsquo;<samp><span class="samp">--force</span></samp>&rsquo; (short form &lsquo;<samp><span class="samp">-f</span></samp>&rsquo;) flag.  Use with care.  Here is a
faster way to do the above:

<pre class="example">     jas@latte:~$ shisa -r latte -f
     Removing principal `krbtgt/latte@latte'...
     Removing principal `krbtgt/latte@latte'...done
     Removing principal `host/latte@latte'...
     Removing principal `host/latte@latte'...done
     Removing realm `latte'...
     Removing realm `latte'...done
     jas@latte:~$
</pre>
   <p>You should now have a working, but empty, Shisa database.  Let's set
up the realm manually, step by step.  The first step is to decide on
name for your realm.  The full story is explained elsewhere
(see <a href="#Realm-and-Principal-Naming">Realm and Principal Naming</a>) but the short story is to take
your <acronym>DNS</acronym> domain name and translate it to upper case.  For
example, if your organization uses <code>example.org</code> it is a good
idea to use <code>EXAMPLE.ORG</code> as the name of your Kerberos realm. 
We'll use <code>EXAMPLE.ORG</code> as the realm name in these examples. 
Let's create the realm.

<pre class="example">     jas@latte:~$ shisa -a EXAMPLE.ORG
     Adding realm `EXAMPLE.ORG'...
     Adding realm `EXAMPLE.ORG'...done
     jas@latte:~$
</pre>
   <p>Currently, there are no properties associated with entire realms.  In
the future, it may be possible to set a default realm-wide password
expiry policy or similar.  Each realm normally have one principal that
is used for authenticating against the &ldquo;ticket granting service&rdquo; on
the Kerberos server with a ticket instead of using the password.  This
is used by the user when she acquire a ticket for servers.  This
principal must look like &lsquo;<samp><span class="samp">krbtgt/REALM</span></samp>&rsquo; (see <a href="#krbtgt">Name of the TGS</a>).  Let's create it.

<pre class="example">     jas@latte:~$ shisa -a EXAMPLE.ORG krbtgt/EXAMPLE.ORG
     Adding principal `krbtgt/EXAMPLE.ORG@EXAMPLE.ORG'...
     Adding principal `krbtgt/EXAMPLE.ORG@EXAMPLE.ORG'...done
     jas@latte:~$
</pre>
   <p>Now that wasn't difficult, although not very satisfying either.  What
does adding a principal mean?  The name is created, obviously, but it
also mean setting a few values in the database.  Let's view the entry
to find out which values.

<pre class="example">     jas@latte:~$ shisa -d
     EXAMPLE.ORG
             krbtgt/EXAMPLE.ORG
                     Account is enabled.
                     Current key version 0 (0x0).
                     Key 0 (0x0).
                             Etype aes256-cts-hmac-sha1-96 (0x12, 18).
                             Salt EXAMPLE.ORGkrbtgt/EXAMPLE.ORG.
     jas@latte:~$
</pre>
   <p>To use host based security services like <acronym>SSH</acronym> or Telnet with
Kerberos, each host must have a key shared between the host and the
KDC.  The key is typically stored in
<samp><span class="file">/usr/local/etc/shishi/shishi.keys</span></samp>.  We assume your server is
called &lsquo;<samp><span class="samp">mail.example.org</span></samp>&rsquo; and create the principal.  To
illustrate a new parameter, we also set the specific algorithm to use
by using the &lsquo;<samp><span class="samp">--encryption-type</span></samp>&rsquo; (short form &lsquo;<samp><span class="samp">-E</span></samp>&rsquo;)
parameter.

<pre class="example">     jas@latte:~$ shisa -a EXAMPLE.ORG host/mail.example.org -E des3
     Adding principal `host/mail.example.org@EXAMPLE.ORG'...
     Adding principal `host/mail.example.org@EXAMPLE.ORG'...done
     jas@latte:~$
</pre>
   <p>To export the key, there is another Shisa parameter &lsquo;<samp><span class="samp">--keys</span></samp>&rsquo; that
will print the key in a format that is recognized by Shishi.  Let's
use it to print the host key.

<pre class="example">     jas@latte:~$ shisa -d --keys EXAMPLE.ORG host/mail.example.org
     EXAMPLE.ORG
             host/mail.example.org
                     Account is enabled.
                     Current key version 0 (0x0).
                     Key 0 (0x0).
                             Etype des3-cbc-sha1-kd (0x10, 16).
     -----BEGIN SHISHI KEY-----
     Keytype: 16 (des3-cbc-sha1-kd)
     Principal: host/mail.example.org
     Realm: EXAMPLE.ORG
     
     iQdA8hxdvOUHZNliZJv7noM02rXHV8gq
     -----END SHISHI KEY-----
                             Salt EXAMPLE.ORGhost/mail.example.org.
     jas@latte:~$
</pre>
   <p>So to set up the host, simply redirect output to the host key file.

<pre class="example">     jas@latte:~$ shisa -d --keys EXAMPLE.ORG \
          host/mail.example.org &gt; /usr/local/etc/shishi/shishi.keys
     jas@latte:~$
</pre>
   <p>The next logical step is to create a principal for some user, so you
can use your password to get a Ticket Granting Ticket via the
Authentication Service (AS) from the KDC, and then use the Ticket
Granting Service (TGS) from the KDC to get a ticket for a specific
host, and then send that ticket to the host to authenticate yourself. 
Creating this end-user principle is slightly different from the
earlier steps, because you want the key to be derived from a password
instead of being a random key.  The &lsquo;<samp><span class="samp">--password</span></samp>&rsquo; parameter
indicate this.  This make the tool ask you for the password.

<pre class="example">     jas@latte:~$ shisa -a EXAMPLE.ORG simon --password
     Password for `simon@EXAMPLE.ORG':
     Adding principal `simon@EXAMPLE.ORG'...
     Adding principal `simon@EXAMPLE.ORG'...done
     jas@latte:~$
</pre>
   <p>The only special thing about this principal now is that it has a
<code>password</code> field set in the database.

<pre class="example">     jas@latte:~$ shisa -d EXAMPLE.ORG simon --keys
     EXAMPLE.ORG
             simon
                     Account is enabled.
                     Current key version 0 (0x0).
                     Key 0 (0x0).
                             Etype aes256-cts-hmac-sha1-96 (0x12, 18).
     -----BEGIN SHISHI KEY-----
     Keytype: 18 (aes256-cts-hmac-sha1-96)
     Principal: simon
     Realm: EXAMPLE.ORG
     
     Ja7ciNtrAI3gtodLaVDQ5zhcH58ffk0kS5tGAM7ILvM=
     -----END SHISHI KEY-----
                             Salt EXAMPLE.ORGsimon.
                             Password foo.
     jas@latte:~$
</pre>
   <p>You should now be ready to start the KDC, which is explained in the
next section (see <a href="#Starting-Shishid">Starting Shishid</a>), and get tickets as explained
earlier (see <a href="#User-Manual">User Manual</a>).

<div class="node">
<a name="Starting-Shishid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Configuring-DNS-for-KDC">Configuring DNS for KDC</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Shisa">Using Shisa</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.4 Starting Shishid</h3>

<p>The Shishi server, or Key Distribution Center (KDC), is called
Shishid.  Shishid is responsible for listening on UDP and TCP ports
for Kerberos requests.  Currently it can handle initial ticket
requests (Authentication Service, or AS), typically authenticated with
keys derived from passwords, and subsequent ticket requests (Ticket
Granting Service, or TGS), typically authenticated with the key
acquired during an AS exchange.

   <p>Currently there is very little configuration available, the only
variables are which ports the server should listen on and an optional
user name to <code>setuid</code> into after successfully listening to the
ports.

   <p>By default, Shishid listens on the &lsquo;<samp><span class="samp">kerberos</span></samp>&rsquo; service port
(typically translated to 88 via <samp><span class="file">/etc/services</span></samp>) on the UDP and
TCP protocols via IPv4 and (if your machine support it) IPv6 on all
interfaces on your machine.  Here is a typical startup.

<pre class="example">     latte:/home/jas/src/shishi# /usr/local/sbin/shishid
     Initializing GNUTLS...
     Initializing GNUTLS...done
     Listening on IPv4:*:kerberos/udp...done
     Listening on IPv4:*:kerberos/tcp...done
     Listening on IPv6:*:kerberos/udp...failed
     socket: Address family not supported by protocol
     Listening on IPv6:*:kerberos/tcp...failed
     socket: Address family not supported by protocol
     Listening on 2 ports...
</pre>
   <p>Running as root is not recommended.  Any security problem in shishid
and your host may be compromised.  Therefor, we recommend using the
&lsquo;<samp><span class="samp">--setuid</span></samp>&rsquo; parameter, as follows.

<pre class="example">     latte:/home/jas/src/shishi# /usr/local/sbin/shishid --setuid=jas
     Initializing GNUTLS...
     Initializing GNUTLS...done
     Listening on IPv4:*:kerberos/udp...done
     Listening on IPv4:*:kerberos/tcp...done
     Listening on IPv6:*:kerberos/udp...failed
     socket: Address family not supported by protocol
     Listening on IPv6:*:kerberos/tcp...failed
     socket: Address family not supported by protocol
     Listening on 2 ports...
     User identity set to `jas' (22541)...
</pre>
   <p>An alternative is to run shishid on an alternative port as a
non-privileged user.  To continue the example of setting up the
<code>EXAMPLE.ORG</code> realm as a non-privileged user from the preceding
section, we start the server listen on port 4711 via UDP on IPv4.

<pre class="example">     jas@latte:~$ /usr/local/sbin/shishid -l IPv4:*:4711/udp
     Initializing GNUTLS...
     Initializing GNUTLS...done
     Listening on *:4711/tcp...
     Listening on 1 ports...
     shishid: Starting (GNUTLS `1.0.4')
     shishid: Listening on *:4711/tcp socket 4
</pre>
   <p>If you have set up the Shisa database as in the previous example, you
can now acquire tickets as follows.

<pre class="example">     jas@latte:~$ shishi -o 'realm-kdc=EXAMPLE.ORG,localhost:4711' \
        simon@EXAMPLE.ORG
     Enter password for `simon@EXAMPLE.ORG':
     simon@EXAMPLE.ORG:
     Authtime:       Fri Dec 12 01:41:01 2003
     Endtime:        Fri Dec 12 01:57:41 2003
     Server:         krbtgt/EXAMPLE.ORG key aes256-cts-hmac-sha1-96 (18)
     Ticket key:     aes256-cts-hmac-sha1-96 (18) protected by aes256-cts-hmac-sha1-96 (18)
     Ticket flags:   FORWARDED PROXIABLE RENEWABLE INITIAL (12)
     jas@latte:~$
</pre>
   <p>The output from Shishid on a successful invocation would look like:

<pre class="example">     shishid: Has 131 bytes from *:4711/udp on socket 4
     shishid: Processing 131 from *:4711/udp on socket 4
     shishid: Trying AS-REQ
     shishid: AS-REQ from simon@EXAMPLE.ORG for krbtgt/EXAMPLE.ORG@EXAMPLE.ORG
     shishid: Matching client etype 18 against user key etype 18
     shishid: Have 511 bytes for *:4711/udp on socket 4
     shishid: Sending 511 bytes to *:4711/udp socket 4 via UDP
     shishid: Listening on *:4711/udp socket 4
</pre>
   <p>You may use the '-v' parameter for Shishid and Shishi to generate more
debugging information.

   <p>To illustrate what an application, such as the Shishi patched versions
of <acronym>GNU</acronym> lsh or Telnet from <acronym>GNU</acronym> InetUtils, would do
when contacting the host &lsquo;<samp><span class="samp">mail.example.org</span></samp>&rsquo; we illustrate using
the TGS service as well.

<pre class="example">     jas@latte:~$ shishi -o 'realm-kdc=EXAMPLE.ORG,localhost:4711' \
        simon@EXAMPLE.ORG host/mail.example.org
     simon@EXAMPLE.ORG:
     Authtime:       Fri Dec 12 01:46:54 2003
     Endtime:        Fri Dec 12 02:03:34 2003
     Server:         host/mail.example.org key des3-cbc-sha1-kd (16)
     Ticket key:     des3-cbc-sha1-kd (16) protected by aes256-cts-hmac-sha1-96 (18)
     Ticket flags:   FORWARDED PROXIABLE (45398796)
     jas@latte:~$
</pre>
   <p>This conclude our walk-through of setting up a new Kerberos realm
using Shishi.  It is quite likely that one or more steps failed, and
if so we encourage you to debug it and submit a patch, or at least
report it as a problem.  Heck, even letting us know if you got this
far would be of interest.  See <a href="#Bug-Reports">Bug Reports</a>.

<div class="node">
<a name="Configuring-DNS-for-KDC"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Kerberos-via-TLS">Kerberos via TLS</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Starting-Shishid">Starting Shishid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.5 Configuring DNS for KDC</h3>

<p>Making sure the configuration files on all hosts running Shishi
clients include the addresses of your server is tedious.  If the
configuration files do not mention the KDC address for a realm, Shishi
will try to look up the information from DNS.  In order for Shishi to
find that information, you need to add the information to DNS.  For
this to work well, you need to set up a DNS zone with the same name as
your Kerberos realm.  The easiest is if you own the publicly visible
DNS name, such as &lsquo;<samp><span class="samp">example.org</span></samp>&rsquo; if your realm is
&lsquo;<samp><span class="samp">EXAMPLE.ORG</span></samp>&rsquo;, but you can set up an internal DNS server with the
information for your realm only.  If this is done, you do not need to
keep configuration files updated for the KDC addressing information.

<h4 class="subsection">3.5.1 DNS vs. Kerberos - Case Sensitivity of Realm Names</h4>

<p>In Kerberos, realm names are case sensitive.  While it is strongly
encouraged that all realm names be all upper case this recommendation
has not been adopted by all sites.  Some sites use all lower case
names and other use mixed case.  DNS on the other hand is case
insensitive for queries but is case preserving for responses to TXT
queries.  Since "MYREALM", "myrealm", and "MyRealm" are all different
it is necessary that only one of the possible combinations of upper
and lower case characters be used.  This restriction may be lifted in
the future as the DNS naming scheme is expanded to support non-ASCII
names.

<h4 class="subsection">3.5.2 Overview - KDC location information</h4>

<p>KDC location information is to be stored using the DNS SRV RR [RFC
2052].  The format of this RR is as follows:

   <p>Service.Proto.Realm TTL Class SRV Priority Weight Port Target

   <p>The Service name for Kerberos is always "_kerberos".

   <p>The Proto can be either "_udp", "_tcp", or "_tls._tcp".  If these SRV
records are to be used, a "_udp" record MUST be included.  If the
Kerberos implementation supports TCP transport, a "_tcp" record MUST
be included.  When using "_tcp" with "_kerberos", this indicates a
"raw" TCP connection without any additional encapsulation.  A
"_tls._tcp" record MUST be specified for all Kerberos implementations
that support communication with the KDC across TCP sockets
encapsulated using TLS [RFC2246] (see <a href="#STARTTLS-protected-KDC-exchanges">STARTTLS protected KDC exchanges</a>).

   <p>The Realm is the Kerberos realm that this record corresponds to.

   <p>TTL, Class, SRV, Priority, Weight, and Target have the standard
meaning as defined in RFC 2052.

   <p>As per RFC 2052 the Port number should be the value assigned to
"kerberos" by the Internet Assigned Number Authority (88).

<h4 class="subsection">3.5.3 Example - KDC location information</h4>

<p>These are DNS records for a Kerberos realm ASDF.COM.  It has two
Kerberos servers, kdc1.asdf.com and kdc2.asdf.com.  Queries should be
directed to kdc1.asdf.com first as per the specified priority. 
Weights are not used in these records.

<pre class="example">     _kerberos._udp.ASDF.COM.        IN      SRV     0 0 88 kdc1.asdf.com.
     _kerberos._udp.ASDF.COM.        IN      SRV     1 0 88 kdc2.asdf.com.
     _kerberos._tcp.ASDF.COM.        IN      SRV     0 0 88 kdc1.asdf.com.
     _kerberos._tcp.ASDF.COM.        IN      SRV     1 0 88 kdc2.asdf.com.
     _kerberos._tls._tcp.ASDF.COM.   IN      SRV     0 0 88 kdc1.asdf.com.
     _kerberos._tls._tcp.ASDF.COM.   IN      SRV     1 0 88 kdc2.asdf.com.
</pre>
   <h4 class="subsection">3.5.4 Security considerations</h4>

<p>As DNS is deployed today, it is an unsecure service.  Thus the infor-
mation returned by it cannot be trusted.

   <p>Current practice for REALM to KDC mapping is to use hostnames to
indicate KDC hosts (stored in some implementation-dependent location,
but generally a local config file).  These hostnames are vulnerable
to the standard set of DNS attacks (denial of service, spoofed
entries, etc).  The design of the Kerberos protocol limits attacks of
this sort to denial of service.  However, the use of SRV records does
not change this attack in any way.  They have the same vulnerabilities
that already exist in the common practice of using hostnames for
KDC locations.

   <p>Implementations SHOULD provide a way of specifying this information
locally without the use of DNS.  However, to make this feature
worthwhile a lack of any configuration information on a client should
be interpretted as permission to use DNS.

<div class="node">
<a name="Kerberos-via-TLS"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multiple-servers">Multiple servers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuring-DNS-for-KDC">Configuring DNS for KDC</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.6 Kerberos via TLS</h3>

<p><a name="index-GNUTLS-33"></a><a name="index-TLS-34"></a><a name="index-STARTTLS-35"></a>
If Shishi is built with support for GNUTLS, the messages exchanged
between clients and Shishid can be protected with TLS.  TLS is only
available over TCP connections.  A full discussion of the features TLS
have is out of scope here, but in short it means the communication is
integrity and privacy protected, and that users can use OpenPGP, X.509
or SRP (i.e., any mechanism supported by TLS) to authenticate
themselves to the Kerberos server.  For details on the implementation,
See <a href="#STARTTLS-protected-KDC-exchanges">STARTTLS protected KDC exchanges</a>.

<h4 class="subsection">3.6.1 Setting up TLS resume</h4>

<p><a name="index-tls-resume-36"></a>
Resuming earlier TLS session is supported and enabled by default. 
This improves the speed of the TLS handshake, because results from
earlier negotiations can be re-used.  Currently the TLS resume
database is stored in memory (in constract to storing it on disk), in
both the client and in the server.  Because the server typically runs
for a long time, this is not a problem for that side.  The client is
typically not a long-running process though; the client usually is
invoked as part of applications like &lsquo;<samp><span class="samp">telnet</span></samp>&rsquo; or &lsquo;<samp><span class="samp">login</span></samp>&rsquo;. 
However, because each use of the client library typically result in a
ticket, which is stored on disk and re-used by later processes, this
is likely not a serious problem because the number of different
tickets required by a user is usually quite small.  For the client,
TLS resume is typically only useful when you perform an initial
authentication (using a password) followed by a ticket request for a
service, in the same process.

   <p>You can configure the server, &lsquo;<samp><span class="samp">shishid</span></samp>&rsquo; to never use TLS resume,
or to increase or decrease the number of distinct TLS connections that
can be resumed before they are garbage collected, see the
&lsquo;<samp><span class="samp">--resume-limit</span></samp>&rsquo; parameter (see <a href="#Parameters-for-shishid">Parameters for shishid</a>).

<h4 class="subsection">3.6.2 Setting up Anonymous TLS</h4>

<p><a name="index-anonymous-tls-37"></a><a name="index-Diffie-Hellman-key-exchange-38"></a>
Anonymous TLS is the simplest to set up and use.  In fact, only the
client need to be informed that your KDC support TLS.  This can be
done in the configuration file with the &lsquo;<samp><span class="samp">/tls</span></samp>&rsquo; parameter for
&lsquo;<samp><span class="samp">kdc-realm</span></samp>&rsquo; (see <a href="#realm_002dkdc">Shishi Configuration</a>), or by
placing the KDC address in DNS using the &lsquo;<samp><span class="samp">_tls</span></samp>&rsquo; SRV record
(see <a href="#Configuring-DNS-for-KDC">Configuring DNS for KDC</a>).

   <p>Let's start Shishid, listening on a TCP socket.  TLS require TCP.  TCP
sockets are automatically upgraded to TLS if the client request it.

<pre class="example">     jas@latte:~$ /usr/local/sbin/shishid -l IPv4:*:4711/tcp
     Initializing GNUTLS...done
     Listening on IPv4:*:4711/tcp...
     Listening on 1 ports...
     shishid: Starting (GNUTLS `1.0.4')
     shishid: Listening on IPv4:*:4711/tcp socket 4
</pre>
   <p>Let's use the client to talk with it, using TLS.

<pre class="example">     jas@latte:~$ shishi -o 'realm-kdc=EXAMPLE.ORG,localhost:4711/tls \
         simon@EXAMPLE.ORG
     Enter password for `simon@EXAMPLE.ORG':
     simon@EXAMPLE.ORG:
     Authtime:       Tue Dec 16 05:20:47 2003
     Endtime:        Tue Dec 16 05:37:27 2003
     Server:         krbtgt/EXAMPLE.ORG key aes256-cts-hmac-sha1-96 (18)
     Ticket key:     aes256-cts-hmac-sha1-96 (18) protected by aes256-cts-hmac-sha1-96 (18)
     Ticket flags:   FORWARDED PROXIABLE (12)
     jas@latte:~$
</pre>
   <p>On success, the server will print the following debug information.

<pre class="example">     shishid: Accepted socket 6 from socket 4 as IPv4:*:4711/tcp peer 127.0.0.1
     shishid: Listening on IPv4:*:4711/tcp socket 4
     shishid: Listening on IPv4:*:4711/tcp peer 127.0.0.1 socket 6
     shishid: Has 4 bytes from IPv4:*:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Trying STARTTLS
     shishid: TLS handshake negotiated protocol `TLS 1.0', key exchange `Anon DH', certficate type `X.509', cipher `AES 256 CBC', mac `SHA', compression `NULL', session not resumed
     shishid: TLS anonymous authentication with 1024 bit Diffie-Hellman
     shishid: Listening on IPv4:*:4711/tcp socket 4
     shishid: Listening on IPv4:*:4711/tcp peer 127.0.0.1 socket 6
     shishid: Has 131 bytes from IPv4:*:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Processing 131 from IPv4:*:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Trying AS-REQ
     shishid: AS-REQ from simon@EXAMPLE.ORG for krbtgt/EXAMPLE.ORG@EXAMPLE.ORG
     shishid: Matching client etype 18 against user key etype 18
     shishid: Have 511 bytes for IPv4:*:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Sending 511 bytes to IPv4:*:4711/tcp peer 127.0.0.1 socket 6 via TLS
     shishid: Listening on IPv4:*:4711/tcp socket 4
     shishid: Listening on IPv4:*:4711/tcp peer 127.0.0.1 socket 6
     shishid: Peer IPv4:*:4711/tcp peer 127.0.0.1 disconnected on socket 6
     shishid: Closing IPv4:*:4711/tcp peer 127.0.0.1 socket 6
     shishid: Listening on IPv4:*:4711/tcp socket 4
</pre>
   <h4 class="subsection">3.6.3 Setting up X.509 authenticated TLS</h4>

<p><a name="index-X_002e509-authentication-39"></a><a name="index-authenticated-tls-40"></a><a name="index-client-authentication-41"></a><a name="index-server-authentication-42"></a><a name="index-certificate-authority-_0028_0040acronym_007bCA_007d_0029-43"></a>
Setting up X.509 authentication is slightly more complicated than
anonymous authentication.  You need a X.509 certificate authority
(<acronym>CA</acronym>) that can generate certificates for your Kerberos server
and Kerberos clients.  It is often easiest to setup the <acronym>CA</acronym>
yourself.  Managing a <acronym>CA</acronym> can be a daunting task, and we only
give the bare essentials to get things up and running.  We suggest
that you study the relevant literature.  As a first step beyond this
introduction, you may wish to explore more secure forms of key storage
than storing them unencrypted on disk.

   <p>The following three sections describe how you create the <acronym>CA</acronym>,
KDC certificate, and client certificates.  You can use any tool you
like for this task, as long as they generate X.509 (PKIX) certificates
in PEM format and RSA keys in PKCS#1 format.  Here we use
<samp><span class="file">certtool</span></samp> that come with <acronym>GNUTLS</acronym>, which is widely
available.  We conclude by discussing how you use these certificates
in the KDC and in the Shishi client.

<h5 class="subsubsection">3.6.3.1 Create a Kerberos Certificate Authority</h5>

<p>First create a <acronym>CA</acronym> key.

<pre class="example">     jas@latte:~$ certtool --generate-privkey \
        --outfile /usr/local/etc/shishi/shishi.key
     Generating a private key...
     Generating a 1024 bit RSA private key...
     jas@latte:~$
</pre>
   <p>Then create the <acronym>CA</acronym> certificate.  Use whatever details you
prefer.

<pre class="example">     jas@latte:~$ certtool --generate-self-signed \
        --load-privkey /usr/local/etc/shishi/shishi.key \
        --outfile /usr/local/etc/shishi/shishi.cert
     Generating a self signed certificate...
     Please enter the details of the certificate's distinguished name. \
     Just press enter to ignore a field.
     Country name (2 chars): SE
     Organization name: Shishi Example CA
     Organizational unit name:
     Locality name:
     State or province name:
     Common name: CA
     This field should not be used in new certificates.
     E-mail:
     Enter the certificate's serial number (decimal): 0
     
     
     Activation/Expiration time.
     The generated certificate will expire in (days): 180
     
     
     Extensions.
     Does the certificate belong to an authority? (Y/N): y
     Is this a web server certificate? (Y/N): n
     Enter the e-mail of the subject of the certificate:
     
     
     X.509 certificate info:
     
     Version: 3
     Serial Number (hex): 00
     Validity:
             Not Before: Sun Dec 21 10:59:00 2003
             Not After: Fri Jun 18 11:59:00 2004
     Subject: C=SE,O=Shishi Example CA,CN=CA
     Subject Public Key Info:
             Public Key Algorithm: RSA
     
     X.509 Extensions:
             Basic Constraints: (critical)
                     CA:TRUE
     
     Is the above information ok? (Y/N): y
     
     
     Signing certificate...
     jas@latte:~$
</pre>
   <h5 class="subsubsection">3.6.3.2 Create a Kerberos KDC Certificate</h5>

<p>First create the key for the KDC.

<pre class="example">     jas@latte:~$ certtool --generate-privkey \
        --outfile /usr/local/etc/shishi/shishid.key
     Generating a private key...
     Generating a 1024 bit RSA private key...
     jas@latte:~$
</pre>
   <p>Then create actual KDC certificate, signed by the <acronym>CA</acronym>
certificate created in the previous step.

<pre class="example">     jas@latte:~$ certtool --generate-certificate \
        --load-ca-certificate /usr/local/etc/shishi/shishi.cert \
        --load-ca-privkey /usr/local/etc/shishi/shishi.key \
        --load-privkey /usr/local/etc/shishi/shishid.key \
        --outfile /usr/local/etc/shishi/shishid.cert
     Generating a signed certificate...
     Loading CA's private key...
     Loading CA's certificate...
     Please enter the details of the certificate's distinguished name. \
     Just press enter to ignore a field.
     Country name (2 chars): SE
     Organization name: Shishi Example KDC
     Organizational unit name:
     Locality name:
     State or province name:
     Common name: KDC
     This field should not be used in new certificates.
     E-mail:
     Enter the certificate's serial number (decimal): 0
     
     
     Activation/Expiration time.
     The generated certificate will expire in (days): 180
     
     
     Extensions.
     Does the certificate belong to an authority? (Y/N): n
     Is this a web server certificate? (Y/N): n
     Enter the e-mail of the subject of the certificate:
     
     
     X.509 certificate info:
     
     Version: 3
     Serial Number (hex): 00
     Validity:
             Not Before: Sun Dec 21 11:02:00 2003
             Not After: Fri Jun 18 12:02:00 2004
     Subject: C=SE,O=Shishi Example KDC,CN=KDC
     Subject Public Key Info:
             Public Key Algorithm: RSA
     
     X.509 Extensions:
             Basic Constraints: (critical)
                     CA:FALSE
     
     Is the above information ok? (Y/N): y
     
     
     Signing certificate...
     jas@latte:~$
</pre>
   <h5 class="subsubsection">3.6.3.3 Create a Kerberos Client Certificate</h5>

<p>First create the key for the client.

<pre class="example">     jas@latte:~$ certtool --generate-privkey \
        --outfile ~/.shishi/client.key
     Generating a private key...
     Generating a 1024 bit RSA private key...
     jas@latte:~$
</pre>
   <p>Then create the client certificate, signed by the <acronym>CA</acronym>.  An
alternative would be to have the KDC sign the client certificates.

<pre class="example">     jas@latte:~$ certtool --generate-certificate \
        --load-ca-certificate /usr/local/etc/shishi/shishi.cert \
        --load-ca-privkey /usr/local/etc/shishi/shishi.key \
        --load-privkey ~/.shishi/client.key \
        --outfile ~/.shishi/client.certs
     Generating a signed certificate...
     Loading CA's private key...
     Loading CA's certificate...
     Please enter the details of the certificate's distinguished name. \
     Just press enter to ignore a field.
     Country name (2 chars): SE
     Organization name: Shishi Example Client
     Organizational unit name:
     Locality name:
     State or province name:
     Common name: Client
     This field should not be used in new certificates.
     E-mail:
     Enter the certificate's serial number (decimal): 0
     
     
     Activation/Expiration time.
     The generated certificate will expire in (days): 180
     
     
     Extensions.
     Does the certificate belong to an authority? (Y/N): n
     Is this a web server certificate? (Y/N): n
     Enter the e-mail of the subject of the certificate:
     
     
     X.509 certificate info:
     
     Version: 3
     Serial Number (hex): 00
     Validity:
             Not Before: Sun Dec 21 11:04:00 2003
             Not After: Fri Jun 18 12:04:00 2004
     Subject: C=SE,O=Shishi Example Client,CN=Client
     Subject Public Key Info:
             Public Key Algorithm: RSA
     
     X.509 Extensions:
             Basic Constraints: (critical)
                     CA:FALSE
     
     Is the above information ok? (Y/N): y
     
     
     Signing certificate...
     jas@latte:~$
</pre>
   <h5 class="subsubsection">3.6.3.4 Starting KDC with X.509 authentication support</h5>

<p>The KDC need the <acronym>CA</acronym> certificate (to verify client
certificates) and the server certificate and key (to authenticate
itself to the clients).  See elsewhere (see <a href="#Parameters-for-shishid">Parameters for shishid</a>) for the entire description of the parameters.

<pre class="example">     jas@latte:~$ shishid -l *:4711/tcp \
        --x509cafile /usr/local/etc/shishi/shishi.cert \
        --x509certfile /usr/local/etc/shishi/shishid.cert \
        --x509keyfile /usr/local/etc/shishi/shishid.key
     Initializing GNUTLS...
     Parsed 1 CAs...
     Loaded server certificate/key...
     Generating Diffie-Hellman parameters...
     Initializing GNUTLS...done
     Listening on *:4711/tcp...
     Listening on 1 ports...
     shishid: Starting (GNUTLS `1.0.4')
     shishid: Listening on *:4711/tcp socket 4
</pre>
   <p>Then acquire tickets as usual.  In case you wonder how shishi finds
the client certificate and key, the filenames used above when
generating the client certificates happen to be the default filenames
for these files.  So it pick them up automatically.

<pre class="example">     jas@latte:~$ shishi -o 'realm-kdc=EXAMPLE.ORG,localhost:4711/tls' \
        simon@EXAMPLE.ORG
     Enter password for `simon@EXAMPLE.ORG':
     simon@EXAMPLE.ORG:
     Authtime:       Sun Dec 21 11:15:47 2003
     Endtime:        Sun Dec 21 11:32:27 2003
     Server:         krbtgt/EXAMPLE.ORG key aes256-cts-hmac-sha1-96 (18)
     Ticket key:     aes256-cts-hmac-sha1-96 (18) protected by aes256-cts-hmac-sha1-96 (18)
     Ticket flags:   FORWARDED PROXIABLE RENEWABLE HWAUTHENT TRANSITEDPOLICYCHECKED OKASDELEGATE (12)
     jas@latte:~$
</pre>
   <p>Here is what the server would print.

<pre class="example">     shishid: Accepted socket 6 from socket 4 as *:4711/tcp peer 127.0.0.1
     shishid: Listening on *:4711/tcp socket 4
     shishid: Listening on *:4711/tcp peer 127.0.0.1 socket 6
     shishid: Has 4 bytes from *:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Trying STARTTLS
     shishid: TLS handshake negotiated protocol `TLS 1.0', key exchange `RSA', certficate type `X.509', cipher `AES 256 CBC', mac `SHA', compression `NULL', session not resumed
     shishid: TLS client certificate `C=SE,O=Shishi Example Client,CN=Client', issued by `C=SE,O=Shishi Example CA,CN=CA', serial number `00', MD5 fingerprint `a5:d3:1f:58:76:e3:58:cd:2d:eb:f7:45:a2:4b:52:f9:', activated `Sun Dec 21 11:04:00 2003', expires `Fri Jun 18 12:04:00 2004', version #3, key RSA modulus 1024 bits, currently EXPIRED
     shishid: Listening on *:4711/tcp socket 4
     shishid: Listening on *:4711/tcp peer 127.0.0.1 socket 6
     shishid: Has 131 bytes from *:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Processing 131 from *:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Trying AS-REQ
     shishid: AS-REQ from simon@EXAMPLE.ORG for krbtgt/EXAMPLE.ORG@EXAMPLE.ORG
     shishid: Matching client etype 18 against user key etype 18
     shishid: Have 511 bytes for *:4711/tcp peer 127.0.0.1 on socket 6
     shishid: Sending 511 bytes to *:4711/tcp peer 127.0.0.1 socket 6 via TLS
     shishid: Listening on *:4711/tcp socket 4
     shishid: Listening on *:4711/tcp peer 127.0.0.1 socket 6
     shishid: Peer *:4711/tcp peer 127.0.0.1 disconnected on socket 6
     shishid: Closing *:4711/tcp peer 127.0.0.1 socket 6
     shishid: Listening on *:4711/tcp socket 4
</pre>
   <div class="node">
<a name="Multiple-servers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Developer-information">Developer information</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Kerberos-via-TLS">Kerberos via TLS</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.7 Multiple servers</h3>

<p><a name="index-remote-databases-44"></a><a name="index-LDAP-45"></a><a name="index-SQL-46"></a>
<a name="index-NFS-47"></a><a name="index-IPSEC-48"></a><a name="index-rsync-49"></a>Setting up multiple servers is as easy as replicating the user
database.  Since the default &lsquo;<samp><span class="samp">file</span></samp>&rsquo; user database is stored in
the normal file system, you can use any common tools to replicate a
file system.  Network file system like <acronym>NFS</acronym> (properly secured
by, e.g., a point-to-point symmetrically encrypted <acronym>IPSEC</acronym>
connection) and file synchronizing tools like &lsquo;<samp><span class="samp">rsync</span></samp>&rsquo; are typical
choices.

   <p><a name="index-master-server-50"></a><a name="index-secondary-server-51"></a>The secondary server should be configured just like the master server. 
If you use the &lsquo;<samp><span class="samp">file</span></samp>&rsquo; database over <acronym>NFS</acronym> you do not have
to make any modifications.  If you use, e.g., a cron job to
&lsquo;<samp><span class="samp">rsync</span></samp>&rsquo; the directory every hour or so, you may want to add a
&lsquo;<samp><span class="samp">--read-only</span></samp>&rsquo; flag to the Shisa &lsquo;<samp><span class="samp">db</span></samp>&rsquo; definition
(see <a href="#Shisa-Configuration">Shisa Configuration</a>).  That way, nobody will be lured into
creating or changing information in the database on the secondary
server, which only would be overwritten during the next
synchronization.

<pre class="example">     db --read-only file /usr/local/var/backup-shishi
</pre>
   <p><a name="index-concurrent-writers-52"></a>The &lsquo;<samp><span class="samp">file</span></samp>&rsquo; database is designed so it doesn't require file
locking in the file system, which may be unreliable in some network
file systems or implementations.  It is also designed so that multiple
concurrent readers and writers may access the database without causing
corruption.

   <p><strong>Warning:</strong> The last paragraph is currently not completely
accurate.  There may be race conditions with concurrent writers.  None
should cause infinite loops or data loss.  However, unexpected results
might occur if two writers try to update information about a principal
simultaneous.

   <p>If you use a remote <acronym>LDAP</acronym> server or <acronym>SQL</acronym> database to
store the user database, and access it via a Shisa backend, you have
make sure your Shisa backend handle concurrent writers properly.  If
you use a modern <acronym>SQL</acronym> database, this probably is not a
concern.  If it is a problem, you may be able to work around it by
implementing some kind of synchronization or semaphore mechanism.  If
all else sounds too complicated, you can set up the secondary servers
as &lsquo;<samp><span class="samp">--read-only</span></samp>&rsquo; servers, although you will lose some
functionality (like changing passwords via the secondary server, or
updating timestamps when the last ticket request occurred).

   <p>One function that is of particular use for users with remote databases
(be it <acronym>LDAP</acronym> or <acronym>SQL</acronym>) is the &ldquo;database override&rdquo;
feature.  Using this you can have the security critical principals
(such as the ticket granting ticket) stored on local file system
storage, but use the remote database for user principals.  Of course,
you must keep the local file system storage synchronized between all
servers, as before.  Here is an example configuration.

<pre class="example">     db --read-only file /var/local/master
     db ldap kdc.example.org ca=/etc/shisa/kdc-ca.pem
</pre>
   <p>This instruct the Shisa library to access the two databases
sequentially, for each query using the first database that know about
the requested principal.  If you put the &lsquo;<samp><span class="samp">krbtgt/REALM</span></samp>&rsquo; principal
in the local &lsquo;<samp><span class="samp">file</span></samp>&rsquo; database, this will override the
<acronym>LDAP</acronym> interface.  Naturally, you can have as many &lsquo;<samp><span class="samp">db</span></samp>&rsquo;
definition lines as you wish.

   <p><a name="index-High-Availability-53"></a>Users with remote databases can also investigate a so called <i>High
Availability</i> mode.  This is useful if you wish to have your Kerberos
servers be able to continue to operate even when the remote database
is offline.  This is achieved via the &lsquo;<samp><span class="samp">--ignore-errors</span></samp>&rsquo; flag in
the database definition.  Here is a sample configuration.

<pre class="example">     db --ignore-errors ldap kdc.example.org ca=/etc/shisa/kdc-ca.pem
     db --read-only file /var/cache/ldap-copy
</pre>
   <p>This instruct the Shisa library to try the <acronym>LDAP</acronym> backend
first, but if it fails, instead of returning an error, continue to try
the operation on a read only local &lsquo;<samp><span class="samp">file</span></samp>&rsquo; based database.  Of
course, write requests will still fail, but it may be better than
halting the server completely.  To make this work, you first need to
set up a cron job on a, say, hourly basis, to make a copy of the
remote database and store it in the local file database.  That way,
when the remote server goes away, fairly current information will
still be available locally.

   <p><a name="index-fail-over-54"></a>If you also wish to experiment with read-write fail over, here is an
idea for the configuration.

<pre class="example">     db --ignore-errors ldap kdc.example.org ca=/etc/shisa/kdc-ca.pem
     db --ignore-errors --read-only file /var/cache/ldap-copy
     db file /var/cache/local-updates
</pre>
   <p>This is similar to the previous, but it will ignore errors reading and
writing from the first two databases, ultimately causing write
attempts to end up in the final &lsquo;<samp><span class="samp">file</span></samp>&rsquo; based database.  Of
course, you would need to create tools to feed back any local updates
made while the remote server was down.  It may also be necessary to
create a special backend for this purpose, which can auto create
principals that are used.

   <p>We finish with an example that demonstrate all the ideas presented.

<pre class="example">     db --read-only file /var/local/master
     db --ignore-errors ldap kdc.example.org ca=/etc/shisa/kdc-ca.pem
     db --ignore-errors --read-only file /var/cache/ldap-copy
     db file /var/cache/local-updates
</pre>
   <div class="node">
<a name="Developer-information"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multiple-servers">Multiple servers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Administration-Manual">Administration Manual</a>

</div>

<h3 class="section">3.8 Developer information</h3>

<p>The Programming API for Shisa is described below (see <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a>); this section is about extending Shisa, and
consequently Shishi, to use your own user database system.  You may
want to store your Kerberos user information on an LDAP database
server, for example.

   <p>Adding a new backend is straight forward.  You need to implement the
backend API function set, add the list of API functions to
<samp><span class="file">db/db.c</span></samp> and possibly also add any library dependencies to the
Makefile.

   <p>The simplest way to write a new backend is to start from the existing
&lsquo;<samp><span class="samp">file</span></samp>&rsquo; based database, in <samp><span class="file">db/file.c</span></samp>, and modify the entry
points as needed.

   <p>Note that the current backend API will likely change before it is
frozen.  We may describe it in detail here when it has matured. 
However, currently it is similar to the external Shisa API
(see <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a>).

   <p>There should be no need to modify anything else in the Shisa library,
and certainly not in the Shishi library or the <samp><span class="file">shishid</span></samp> server.

   <p>Naturally, we would appreciate if you would send us your new backend,
if you believe it is generally useful (see <a href="#Bug-Reports">Bug Reports</a>).

<!-- ********************************************************** -->
<!-- ****************  Reference Manual  ********************** -->
<!-- ********************************************************** -->
<div class="node">
<a name="Reference-Manual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Programming-Manual">Programming Manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Administration-Manual">Administration Manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 Reference Manual</h2>

<p>This chapter discuss the underlying assumptions of Kerberos, contain a
glossary to Kerberos concepts, give you background information on
choosing realm and principal names, and describe all parameters and
configuration file syntaxes for the Shishi tools.

<ul class="menu">
<li><a accesskey="1" href="#Environmental-Assumptions">Environmental Assumptions</a>:    Kerberos 5 assumptions about your system. 
<li><a accesskey="2" href="#Glossary-of-terms">Glossary of terms</a>:            Glossary of Kerberos related terminology. 
<li><a accesskey="3" href="#Realm-and-Principal-Naming">Realm and Principal Naming</a>:   How to name your realm and principals. 
<li><a accesskey="4" href="#Shishi-Configuration">Shishi Configuration</a>:         Explains the Core Shishi configuration file. 
<li><a accesskey="5" href="#Shisa-Configuration">Shisa Configuration</a>:          Explains the Shisa database definition file. 
<li><a accesskey="6" href="#Parameters-for-shishi">Parameters for shishi</a>:        Command line parameters for 'shishi'. 
<li><a accesskey="7" href="#Parameters-for-shishid">Parameters for shishid</a>:       Command line parameters for 'shishid'. 
<li><a accesskey="8" href="#Parameters-for-shisa">Parameters for shisa</a>:         Command line parameters for 'shisa'. 
<li><a accesskey="9" href="#Environment-variables">Environment variables</a>:        Overriding compile-time defaults at run-time. 
<li><a href="#Date-input-formats">Date input formats</a>:           Details of the understood date formats. 
</ul>

<div class="node">
<a name="Environmental-Assumptions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Glossary-of-terms">Glossary of terms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.1 Environmental Assumptions</h3>

<p>Kerberos imposes a few assumptions on the environment in which it can
properly function:

     <ul>
<li>"Denial of service" attacks are not solved with Kerberos. There
are places in the protocols where an intruder can prevent an
application from participating in the proper authentication steps. 
Detection and solution of such attacks (some of which can appear
to be not-uncommon "normal" failure modes for the system) is
usually best left to the human administrators and users. 
<li>Principals MUST keep their secret keys secret. If an intruder
somehow steals a principal's key, it will be able to masquerade as
that principal or impersonate any server to the legitimate
principal. 
<li>"Password guessing" attacks are not solved by Kerberos. If a user
chooses a poor password, it is possible for an attacker to
successfully mount an offline dictionary attack by repeatedly
attempting to decrypt, with successive entries from a dictionary,
messages obtained which are encrypted under a key derived from the
user's password. 
<li>Each host on the network MUST have a clock which is "loosely
synchronized" to the time of the other hosts; this synchronization
is used to reduce the bookkeeping needs of application servers
when they do replay detection. The degree of "looseness" can be
configured on a per-server basis, but is typically on the order of
5 minutes. If the clocks are synchronized over the network, the
clock synchronization protocol MUST itself be secured from network
attackers. 
<li>Principal identifiers are not recycled on a short-term basis. A
typical mode of access control will use access control lists
(ACLs) to grant permissions to particular principals. If a stale
ACL entry remains for a deleted principal and the principal
identifier is reused, the new principal will inherit rights
specified in the stale ACL entry. By not re-using principal
identifiers, the danger of inadvertent access is removed. 
</ul>

<div class="node">
<a name="Glossary-of-terms"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Realm-and-Principal-Naming">Realm and Principal Naming</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Environmental-Assumptions">Environmental Assumptions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.2 Glossary of terms</h3>

     <dl>
<dt>Authentication<dd><a name="index-Authentication-55"></a>Verifying the claimed identity of a principal.

     <br><dt>Authentication header<dd><a name="index-Authentication-header-56"></a>A record containing a Ticket and an Authenticator to be presented
to a server as part of the authentication process.

     <br><dt>Authentication path<dd><a name="index-Authentication-path-57"></a>A sequence of intermediate realms transited in the authentication
process when communicating from one realm to another.

     <br><dt>Authenticator<dd><a name="index-Authenticator-58"></a>A record containing information that can be shown to have been
recently generated using the session key known only by the client
and server.

     <br><dt>Authorization<dd><a name="index-Authorization-59"></a>The process of determining whether a client may use a service,
which objects the client is allowed to access, and the type of
access allowed for each.

     <br><dt>Capability<dd><a name="index-Capability-60"></a>A token that grants the bearer permission to access an object or
service. In Kerberos, this might be a ticket whose use is
restricted by the contents of the authorization data field, but
which lists no network addresses, together with the session key
necessary to use the ticket.

     <br><dt>Ciphertext<dd><a name="index-Ciphertext-61"></a>The output of an encryption function. Encryption transforms
plaintext into ciphertext.

     <br><dt>Client<dd><a name="index-Client-62"></a>A process that makes use of a network service on behalf of a user. 
Note that in some cases a Server may itself be a client of some
other server (e.g. a print server may be a client of a file
server).

     <br><dt>Credentials<dd><a name="index-Credentials-63"></a>A ticket plus the secret session key necessary to successfully use
that ticket in an authentication exchange.

     <br><dt>Encryption Type (etype)<dd><a name="index-Encryption-Type-_0028etype_0029-64"></a>When associated with encrypted data, an encryption type identifies
the algorithm used to encrypt the data and is used to select the
appropriate algorithm for decrypting the data.  Encryption type
tags are communicated in other messages to enumerate algorithms
that are desired, supported, preferred, or allowed to be used for
encryption of data between parties.  This preference is combined
with local information and policy to select an algorithm to be
used.

     <br><dt>KDC<dd><a name="index-KDC-65"></a>Key Distribution Center, a network service that supplies tickets
and temporary session keys; or an instance of that service or the
host on which it runs. The KDC services both initial ticket and
ticket-granting ticket requests. The initial ticket portion is
sometimes referred to as the Authentication Server (or service). 
The ticket-granting ticket portion is sometimes referred to as the
ticket-granting server (or service).

     <br><dt>Kerberos<dd><a name="index-Kerberos-66"></a>The name given to the Project Athena's authentication service, the
protocol used by that service, or the code used to implement the
authentication service.  The name is adopted from the three-headed
dog which guards Hades.

     <br><dt>Key Version Number (kvno)<dd><a name="index-Key-Version-Number-_0028kvno_0029-67"></a>A tag associated with encrypted data identifies which key was used
for encryption when a long lived key associated with a principal
changes over time.  It is used during the transition to a new key
so that the party decrypting a message can tell whether the data
was encrypted using the old or the new key.

     <br><dt>Plaintext<dd><a name="index-Plaintext-68"></a>The input to an encryption function or the output of a decryption
function. Decryption transforms ciphertext into plaintext.

     <br><dt>Principal<dd><a name="index-Principal-69"></a>A named client or server entity that participates in a network
communication, with one name that is considered canonical.

     <br><dt>Principal identifier<dd><a name="index-Principal-identifier-70"></a>The canonical name used to uniquely identify each different
principal.

     <br><dt>Seal<dd><a name="index-Seal-71"></a>To encipher a record containing several fields in such a way that
the fields cannot be individually replaced without either
knowledge of the encryption key or leaving evidence of tampering.

     <br><dt>Secret key<dd><a name="index-Secret-key-72"></a>An encryption key shared by a principal and the KDC, distributed
outside the bounds of the system, with a long lifetime. In the
case of a human user's principal, the secret key MAY be derived
from a password.

     <br><dt>Server<dd><a name="index-Server-73"></a>A particular Principal which provides a resource to network
clients.  The server is sometimes referred to as the Application
Server.

     <br><dt>Service<dd><a name="index-Service-74"></a>A resource provided to network clients; often provided by more
than one server (for example, remote file service).

     <br><dt>Session key<dd><a name="index-Session-key-75"></a>A temporary encryption key used between two principals, with a
lifetime limited to the duration of a single login "session".  In
the Kerberos system, a session key is generated by the KDC.  The
session key is distinct from the sub-session key, described next..

     <br><dt>Sub-session key<dd><a name="index-Sub_002dsession-key-76"></a>A temporary encryption key used between two principals, selected
and exchanged by the principals using the session key, and with a
lifetime limited to the duration of a single association. The sub-
session key is also referred to as the subkey.

     <br><dt>Ticket<dd><a name="index-Ticket-77"></a><a name="index-Kerberos-Ticket-78"></a>A record that helps a client authenticate itself to a server; it
contains the client's identity, a session key, a timestamp, and
other information, all sealed using the server's secret key. It
only serves to authenticate a client when presented along with a
fresh Authenticator. 
</dl>

<div class="node">
<a name="Realm-and-Principal-Naming"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Shishi-Configuration">Shishi Configuration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Glossary-of-terms">Glossary of terms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.3 Realm and Principal Naming</h3>

<p>This section contains the discussion on naming realms and principals
from the Kerberos specification.

<h4 class="subsection">4.3.1 Realm Names</h4>

<p>Although realm names are encoded as GeneralStrings and although a
realm can technically select any name it chooses, interoperability
across realm boundaries requires agreement on how realm names are to
be assigned, and what information they imply.

   <p>To enforce these conventions, each realm MUST conform to the
conventions itself, and it MUST require that any realms with which
inter-realm keys are shared also conform to the conventions and
require the same from its neighbors.

   <p>Kerberos realm names are case sensitive. Realm names that differ only
in the case of the characters are not equivalent. There are presently
three styles of realm names: domain, X500, and other. Examples of
each style follow:

<pre class="example">          domain:   ATHENA.MIT.EDU
            X500:   C=US/O=OSF
           other:   NAMETYPE:rest/of.name=without-restrictions
</pre>
   <p>Domain syle realm names MUST look like domain names: they consist of
components separated by periods (.) and they contain neither colons
(:) nor slashes (/). Though domain names themselves are case
insensitive, in order for realms to match, the case must match as
well. When establishing a new realm name based on an internet domain
name it is recommended by convention that the characters be converted
to upper case.

   <p>X.500 names contain an equal (=) and cannot contain a colon (:)
before the equal. The realm names for X.500 names will be string
representations of the names with components separated by slashes. 
Leading and trailing slashes will not be included. Note that the
slash separator is consistent with Kerberos implementations based on
RFC1510, but it is different from the separator recommended in
RFC2253.

   <p>Names that fall into the other category MUST begin with a prefix that
contains no equal (=) or period (.) and the prefix MUST be followed
by a colon (:) and the rest of the name. All prefixes must be
assigned before they may be used. Presently none are assigned.

   <p>The reserved category includes strings which do not fall into the
first three categories. All names in this category are reserved. It
is unlikely that names will be assigned to this category unless there
is a very strong argument for not using the 'other' category.

   <p>These rules guarantee that there will be no conflicts between the
various name styles. The following additional constraints apply to
the assignment of realm names in the domain and X.500 categories: the
name of a realm for the domain or X.500 formats must either be used
by the organization owning (to whom it was assigned) an Internet
domain name or X.500 name, or in the case that no such names are
registered, authority to use a realm name MAY be derived from the
authority of the parent realm. For example, if there is no domain
name for E40.MIT.EDU, then the administrator of the MIT.EDU realm can
authorize the creation of a realm with that name.

   <p>This is acceptable because the organization to which the parent is
assigned is presumably the organization authorized to assign names to
its children in the X.500 and domain name systems as well. If the
parent assigns a realm name without also registering it in the domain
name or X.500 hierarchy, it is the parent's responsibility to make
sure that there will not in the future exist a name identical to the
realm name of the child unless it is assigned to the same entity as
the realm name.

<h4 class="subsection">4.3.2 Principal Names</h4>

<p>As was the case for realm names, conventions are needed to ensure
that all agree on what information is implied by a principal name. 
The name-type field that is part of the principal name indicates the
kind of information implied by the name. The name-type SHOULD be
treated only as a hint to interpreting the meaning of a name. It is
not significant when checking for equivalence. Principal names that
differ only in the name-type identify the same principal. The name
type does not partition the name space. Ignoring the name type, no
two names can be the same (i.e. at least one of the components, or
the realm, MUST be different). The following name types are defined:

<pre class="example">     name-type      value   meaning
     
     NT-UNKNOWN        0  Name type not known
     NT-PRINCIPAL      1  Just the name of the principal as in DCE, or for users
     NT-SRV-INST       2  Service and other unique instance (krbtgt)
     NT-SRV-HST        3  Service with host name as instance (telnet, rcommands)
     NT-SRV-XHST       4  Service with host as remaining components
     NT-UID            5  Unique ID
     NT-X500-PRINCIPAL 6  Encoded X.509 Distingished name [RFC 2253]
     NT-SMTP-NAME      7  Name in form of SMTP email name (e.g. user@foo.com)
     NT-ENTERPRISE    10   Enterprise name - may be mapped to principal name
</pre>
   <p>When a name implies no information other than its uniqueness at a
particular time the name type PRINCIPAL SHOULD be used. The principal
name type SHOULD be used for users, and it might also be used for a
unique server. If the name is a unique machine generated ID that is
guaranteed never to be reassigned then the name type of UID SHOULD be
used (note that it is generally a bad idea to reassign names of any
type since stale entries might remain in access control lists).

   <p>If the first component of a name identifies a service and the
remaining components identify an instance of the service in a server
specified manner, then the name type of SRV-INST SHOULD be used. An
example of this name type is the Kerberos ticket-granting service
whose name has a first component of krbtgt and a second component
identifying the realm for which the ticket is valid.

   <p>If the first component of a name identifies a service and there is a
single component following the service name identifying the instance
as the host on which the server is running, then the name type SRV-
HST SHOULD be used. This type is typically used for Internet services
such as telnet and the Berkeley R commands. If the separate
components of the host name appear as successive components following
the name of the service, then the name type SRV-XHST SHOULD be used. 
This type might be used to identify servers on hosts with X.500 names
where the slash (/) might otherwise be ambiguous.

   <p>A name type of NT-X500-PRINCIPAL SHOULD be used when a name from an
X.509 certificate is translated into a Kerberos name. The encoding of
the X.509 name as a Kerberos principal shall conform to the encoding
rules specified in RFC 2253.

   <p>A name type of SMTP allows a name to be of a form that resembles a
SMTP email name. This name, including an "@" and a domain name, is
used as the one component of the principal name.

   <p>A name type of UNKNOWN SHOULD be used when the form of the name is
not known. When comparing names, a name of type UNKNOWN will match
principals authenticated with names of any type. A principal
authenticated with a name of type UNKNOWN, however, will only match
other names of type UNKNOWN.

   <p>Names of any type with an initial component of 'krbtgt' are reserved
for the Kerberos ticket granting service. See <a href="#krbtgt">Name of the TGS</a>, for the form of such names.

<h5 class="subsubsection">4.3.2.1 Name of server principals</h5>

<p>The principal identifier for a server on a host will generally be
composed of two parts: (1) the realm of the KDC with which the server
is registered, and (2) a two-component name of type NT-SRV-HST if the
host name is an Internet domain name or a multi-component name of
type NT-SRV-XHST if the name of the host is of a form such as X.500
that allows slash (/) separators. The first component of the two- or
multi-component name will identify the service and the latter
components will identify the host. Where the name of the host is not
case sensitive (for example, with Internet domain names) the name of
the host MUST be lower case. If specified by the application protocol
for services such as telnet and the Berkeley R commands which run
with system privileges, the first component MAY be the string 'host'
instead of a service specific identifier.

<h5 class="subsubsection">4.3.2.2 Name of the TGS</h5>

<p><a name="krbtgt"></a>The principal identifier of the ticket-granting service shall be
composed of three parts: (1) the realm of the KDC issuing the TGS
ticket (2) a two-part name of type NT-SRV-INST, with the first part
"krbtgt" and the second part the name of the realm which will accept
the ticket-granting ticket. For example, a ticket-granting ticket
issued by the ATHENA.MIT.EDU realm to be used to get tickets from the
ATHENA.MIT.EDU KDC has a principal identifier of "ATHENA.MIT.EDU"
(realm), ("krbtgt", "ATHENA.MIT.EDU") (name). A ticket-granting
ticket issued by the ATHENA.MIT.EDU realm to be used to get tickets
from the MIT.EDU realm has a principal identifier of "ATHENA.MIT.EDU"
(realm), ("krbtgt", "MIT.EDU") (name).

<h4 class="subsection">4.3.3 Choosing a principal with which to communicate</h4>

<p>The Kerberos protocol provides the means for verifying (subject to
the assumptions in <a href="#Environmental-Assumptions">Environmental Assumptions</a>) that the entity with which one communicates
is the same entity that was registered with the KDC using the claimed
identity (principal name). It is still necessary to determine whether
that identity corresponds to the entity with which one intends to
communicate.

   <p>When appropriate data has been exchanged in advance, this
determination may be performed syntactically by the application based
on the application protocol specification, information provided by
the user, and configuration files. For example, the server principal
name (including realm) for a telnet server might be derived from the
user specified host name (from the telnet command line), the "host/"
prefix specified in the application protocol specification, and a
mapping to a Kerberos realm derived syntactically from the domain
part of the specified hostname and information from the local
Kerberos realms database.

   <p>One can also rely on trusted third parties to make this
determination, but only when the data obtained from the third party
is suitably integrity protected while resident on the third party
server and when transmitted.  Thus, for example, one should not rely
on an unprotected domain name system record to map a host alias to
the primary name of a server, accepting the primary name as the party
one intends to contact, since an attacker can modify the mapping and
impersonate the party with which one intended to communicate.

   <p>Implementations of Kerberos and protocols based on Kerberos MUST NOT
use insecure DNS queries to canonicalize the hostname components of
the service principal names.  In an environment without secure name
service, application authors MAY append a statically configured
domain name to unqualified hostnames before passing the name to the
security mechanisms, but should do no more than that.  Secure name
service facilities, if available, might be trusted for hostname
canonicalization, but such canonicalization by the client SHOULD NOT
be required by KDC implementations.

   <p>Implementation note: Many current implementations do some degree of
canonicalization of the provided service name, often using DNS even
though it creates security problems. However there is no consistency
among implementations about whether the service name is case folded
to lower case or whether reverse resolution is used. To maximize
interoperability and security, applications SHOULD provide security
mechanisms with names which result from folding the user-entered name
to lower case, without performing any other modifications or
canonicalization.

<h4 class="subsection">4.3.4 Principal Name Form</h4>

<p>Principal names consist of a sequence of strings, which is often
tedious to parse.  Therefor, Shishi often uses a &ldquo;printed&rdquo; form of
principal which embed the entire principal name string sequence, and
optionally also the realm, into one string.  The format is taken from
the Kerberos 5 <acronym>GSS-API</acronym> mechanism (<acronym>RFC</acronym> 1964).

   <p>The elements included within this name representation are as follows,
proceeding from the beginning of the string:

     <ol type=1 start=1>
<li>One or more principal name components; if more than one
principal name component is included, the components are
separated by `/`.  Arbitrary octets may be included within
principal name components, with the following constraints and
special considerations:
          <ol type=a start=1>
<li>Any occurrence of the characters `@` or `/` within a
name component must be immediately preceded by the `\`
quoting character, to prevent interpretation as a component
or realm separator. 
<li>The ASCII newline, tab, backspace, and null characters
may occur directly within the component or may be
represented, respectively, by `\n`, `\t`, `\b`, or `\0`. 
<li>If the `\` quoting character occurs outside the contexts
described in (1a) and (1b) above, the following character is
interpreted literally.  As a special case, this allows the
doubled representation `\\` to represent a single occurrence
of the quoting character. 
<li>An occurrence of the `\` quoting character as the last
character of a component is illegal.
          </ol>
<li>Optionally, a `@` character, signifying that a realm name
immediately follows. If no realm name element is included, the
local realm name is assumed.  The `/` , `:`, and null characters
may not occur within a realm name; the `@`, newline, tab, and
backspace characters may be included using the quoting
conventions described in (1a), (1b), and (1c) above.
        </ol>

<div class="node">
<a name="Shishi-Configuration"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Shisa-Configuration">Shisa Configuration</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Realm-and-Principal-Naming">Realm and Principal Naming</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.4 Shishi Configuration</h3>

<p><a name="index-configuration-file-79"></a>
The valid configuration file tokens are described here.  The user
configuration file is typically located in
<samp><span class="file">~/.shishi/shishi.conf</span></samp> (compare &lsquo;<samp><span class="samp">shishi
--configuration-file</span></samp>&rsquo;) and the system configuration is typically
located in <samp><span class="file">/usr/local/etc/shishi/shishi.conf</span></samp> (compare
&lsquo;<samp><span class="samp">shishi --system-configuration-file</span></samp>&rsquo;).  If the first non white
space character of a line is a '#', the line is ignored.  Empty lines
are also ignored.

   <p>All tokens are valid in both the system and the user configuration
files, and have the same meaning.  However, as the system file is
supposed to apply to all users on a system, it would not make sense to
use some tokens in that file.  For example, the
&lsquo;<samp><span class="samp">default-principal</span></samp>&rsquo; is rarely useful in a system configuration
file.

<h4 class="subsection">4.4.1 &lsquo;<samp><span class="samp">default-realm</span></samp>&rsquo;</h4>

<p>Specify the default realm, by default the hostname of the host is
used.  E.g.,

<pre class="example">     default-realm JOSEFSSON.ORG
</pre>
   <h4 class="subsection">4.4.2 &lsquo;<samp><span class="samp">default-principal</span></samp>&rsquo;</h4>

<p>Specify the default principal, by default the login username is
used. E.g.,

<pre class="example">     default-principal jas
</pre>
   <h4 class="subsection">4.4.3 &lsquo;<samp><span class="samp">client-kdc-etypes</span></samp>&rsquo;</h4>

<p>Specify which encryption types client asks server to respond in during
AS/TGS exchanges. List valid encryption types, in preference order. 
Supported algorithms include aes256-cts-hmac-sha1-96,
aes128-cts-hmac-sha1-96, des3-cbc-sha1-kd, des-cbc-md5, des-cbc-md4,
des-cbc-crc and null.  This option also indicates which encryption
types are accepted by the client when receiving the response.  Note
that the preference order is not cryptographically protected, so a man
in the middle can modify the order without being detected.  Thus, only
specify encryption types you trust completely here. The default only
includes aes256-cts-hmac-sha1-96, as suggested by RFC1510bis.  E.g.,

<pre class="example">     client-kdc-etypes=aes256-cts-hmac-sha1-96 des3-cbc-sha1-kd des-cbc-md5
</pre>
   <h4 class="subsection">4.4.4 &lsquo;<samp><span class="samp">verbose</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-asn1</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-noise</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto-noise</span></samp>&rsquo;</h4>

<p>Enable verbose library messages.  E.g.,

<pre class="example">     verbose
     verbose-noise
</pre>
   <h4 class="subsection">4.4.5 &lsquo;<samp><span class="samp">realm-kdc</span></samp>&rsquo;</h4>

<p><a name="realm_002dkdc"></a>Specify KDC addresses for realms.  Value is
&lsquo;<samp><span class="samp">REALM,KDCADDRESS[/PROTOCOL][,KDCADDRESS[/PROTOCOL]...]</span></samp>&rsquo;.

   <p>KDCADDRESS is the hostname or IP address of KDC.

   <p>Optional PROTOCOL is udp for UDP, tcp for TCP, and TLS for TLS
connections.  By default UDP is tried first, and TCP used as a
fallback if the KRB_ERR_RESPONSE_TOO_BIG error is received.

   <p>If not specified, Shishi tries to locate the KDC using SRV RRs,
which is recommended.  This option should normally only be
used during experiments, or to access badly maintained realms.

<pre class="example">     realm-kdc=JOSEFSSON.ORG,ristretto.josefsson.org
</pre>
   <h4 class="subsection">4.4.6 &lsquo;<samp><span class="samp">server-realm</span></samp>&rsquo;</h4>

<p>Specify realm for servers. Value is
&lsquo;<samp><span class="samp">REALM,SERVERREGEXP[,SERVERREGEXP...]</span></samp>&rsquo;.

   <p>SERVERREGEXP is a regular expression matching servers in the realm. 
The first match is used.  E.g.,

<pre class="example">     server-realm=JOSEFSSON.ORG,.josefsson.org
</pre>
   <p>Note: currently not used.

<h4 class="subsection">4.4.7 &lsquo;<samp><span class="samp">kdc-timeout</span></samp>&rsquo;, &lsquo;<samp><span class="samp">kdc-retries</span></samp>&rsquo;</h4>

<p>How long shishi waits for a response from a KDC before continuing to
next KDC for realm.  The default is 5 seconds.  E.g.,

<pre class="example">     kdc-timeout=10
</pre>
   <p>How many times shishi sends a request to a KDC before giving up.  The
default is 3 times.  E.g.,

<pre class="example">     kdc-retries=5
</pre>
   <h4 class="subsection">4.4.8 &lsquo;<samp><span class="samp">stringprocess</span></samp>&rsquo;</h4>

<p>How username and passwords entered from the terminal, or taken from
the command line, are processed.

   <p>"none": no processing is used.

   <p>"stringprep": convert from locale charset to UTF-8 and process using
              experimental RFC 1510 stringprep profile.

   <p>It can also be a string indicating a character set supported by
iconv via libstringprep, in which case data is converted from locale
charset into the indicated character set. E.g., UTF-8, ISO-8859-1,
KOI-8, EBCDIC-IS-FRISS are supported on GNU systems.  On some systems
you can use "locale -m" to list available character sets.  By default,
the "none" setting is used which is consistent with RFC 1510 that is
silent on the issue.  In practice, however, converting to UTF-8
improves interoperability.

   <p>E.g.,

<pre class="example">     stringprocess=UTF-8
</pre>
   <h4 class="subsection">4.4.9 &lsquo;<samp><span class="samp">ticket-life</span></samp>&rsquo;</h4>

<p>Specify default ticket life time.

   <p>The string can be in almost any common format.  It can contain month
names, time zones, `am' and `pm', `yesterday', `ago', `next', etc. 
See <a href="#Date-input-formats">Date input formats</a>, for the long story.

   <p>As an extra feature, if the time specified by your string correspond
to a time during the last 24 hours, an extra day is added to it.  This
allows you to specify relative times such as "17:00" to always mean
the next 17:00, even if your system clock happens to be 17:30.

   <p>The default is 8 hours.

   <p>E.g.,

<pre class="example">     #ticket-life=8 hours
     #ticket-life=1 day
     ticket-life=17:00
</pre>
   <h4 class="subsection">4.4.10 &lsquo;<samp><span class="samp">renew-life</span></samp>&rsquo;</h4>

<p>Specify how long a renewable ticket should remain renewable.

   <p>See ticket-life for the syntax.  The extra feature that handles
negative values within the last 2 hours is not active here.

   <p>The default is 7 days.

   <p>E.g.,

<pre class="example">     #renew-life=1 week
     #renew-life=friday 17:00
     renew-life=sunday
</pre>
   <div class="node">
<a name="Shisa-Configuration"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameters-for-shishi">Parameters for shishi</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Shishi-Configuration">Shishi Configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.5 Shisa Configuration</h3>

<p><a name="index-database-definition-80"></a><a name="index-specifying-user-database-81"></a><a name="index-user-database-definition-82"></a>
The configuration file for Shisa is typically stored in
<samp><span class="file">/usr/local/etc/shishi/shisa.conf</span></samp>.  If the first non white space
character of a line is a '#', the line is ignored.  Empty lines are
also ignored.

<h4 class="subsection">4.5.1 &lsquo;<samp><span class="samp">db</span></samp>&rsquo;</h4>

<p>Currently the only configuration options available is the <code>db</code>
token that define the databases to use.  The syntax is:

<pre class="example">     db [OPTIONS] &lt;TYPE&gt; [LOCATION] [PARAMETERS ...]
</pre>
   <p>Specify the data sources for Kerberos 5 data.  Multiple entries,
even of the same data source type, are allowed.  The data sources
are accessed in the same sequence as they are defined here.  If an
entry is found in one data source, it will be used for the
operations, without searching the remaining data sources.  Valid
OPTIONS include:

<pre class="example">     --read-only       No data is written to this data source.
     --ignore-errors   Ignore failures in this backend.
</pre>
   <p>The default (when the configuration file is empty) uses one "file"
data source (see below), but for a larger installation you may want to
combine several data sources.  Here is an example.

<pre class="example">     db --read-only file /var/local/master
     db --ignore-errors ldap kdc.example.org ca=/etc/shisa/kdc-ca.pem
     db --read-only file /var/cache/ldap-copy
</pre>
   <p>This demonstrate how you can store critical principals on local disk
(the first entry, /var/local/master) that will always be found without
looking in the LDAP directory.  The critical principals could be,
e.g., krbtgt/EXAMPLE.ORG.  The second entry denote a LDAP server that
could hold user principals.  As you can see, Shisa will not let the
caller know about errors with the LDAP source (they will be logged,
however).  Instead, if for instance the LDAP server has crashed, Shisa
would continue and read from the /var/cache/ldap-copy file source. 
That file source may have been set up to contain a copy of the data in
the LDAP server, perhaps made on an hourly basis, so that your server
will be able to serve recent data even in case of a crash.  Any
updates or passwords change requests will however not be possible
while the LDAP server is inaccessible, to reduce the problem of
synchronizing data back into the LDAP server once it is online again.

   <p>Currently only the "file" data source is supported, and denote a
data source that use the standard file system for storage.

   <p>Valid syntaxes for the "file" database:

<pre class="example">     db file PATH
</pre>
   <p>Examples:

<pre class="example">     db file /var/shishi
     db file /usr/share/shishi read-only
</pre>
   <p>If no &lsquo;<samp><span class="samp">db</span></samp>&rsquo; tokens are present, the default will be:

<pre class="example">     db file /usr/local/var/shishi
</pre>
   <div class="node">
<a name="Parameters-for-shishi"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameters-for-shishid">Parameters for shishid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Shisa-Configuration">Shisa Configuration</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.6 Parameters for shishi</h3>

<p>If no command is given, Shishi try to make sure you have a ticket
granting ticket for the default realm, and then display it.

   <p>Mandatory arguments to long options are mandatory for short options
too.

<pre class="example">     Usage: shishi [OPTIONS]... [CLIENT [SERVER]]...
     
       -h, --help                              Print help and exit
       -V, --version                           Print version and exit
     
     Commands:
       -d, --destroy                           Destroy tickets in local cache,
                                                 limited by any --client-name or
                                                 --server-name.  (default=off)
       -l, --list                              List tickets in local cache, limited
                                                 by any --client-name and
                                                 --server-name.  (default=off)
       -r, --renew                             Renew ticket.  Use --server-name to
                                                 specify ticket, default is the
                                                 most recent renewable ticket
                                                 granting ticket for the default
                                                 realm.  (default=off)
     
     Flags:
           --forwardable                       Get a forwardable ticket, i.e., one
                                                 that can be used to get forwarded
                                                 tickets.  (default=off)
           --forwarded                         Get a forwarded ticket.  (default=
                                                 off)
           --proxiable                         Get a proxiable ticket, i.e., one
                                                 that can be used to get proxy
                                                 tickets.  (default=off)
           --proxy                             Get a proxy ticket.  (default=off)
           --renewable                         Get a renewable ticket.  (default=
                                                 off)
     
     Options:
           --client-name=NAME                  Client name. Default is login
                                                 username.
       -E, --encryption-type=ETYPE,[ETYPE...]  Encryption types to use.  ETYPE is
                                                 either registered name or integer.
                                                  Valid values include 'aes128',
                                                 'aes256', 'aes' (same as
                                                 'aes256'), '3des', 'des-md5',
                                                 'des-md4', 'des-crc', 'des' (same
                                                 as 'des-md5'), and 'arcfour'.
       -e, --endtime=STRING                    Specify when ticket validity should
                                                 expire.  The time syntax may be
                                                 relative (to the start time), such
                                                 as '20 hours', or absolute, such
                                                 as '2001-02-03 04:05:06 CET'. The
                                                 default is 8 hours after the start
                                                 time.
           --realm=STRING                      Set default realm.
           --renew-till=STRING                 Specify renewable life of ticket.
                                                 Implies --renewable.  Accepts same
                                                 time syntax as --endtime.  If
                                                 --renewable is specified, the
                                                 default is 1 week after the start
                                                 time.
           --server-name=NAME                  Server name. Default is
                                                 'krbtgt/REALM' where REALM is
                                                 client realm.
       -s, --starttime=STRING                  Specify when ticket should start to
                                                 be valid.  Accepts same time
                                                 syntax as --endtime. The default
                                                 is to become valid immediately.
           --ticket-granter=NAME               Service name in ticket to use for
                                                 authenticating request. Only for
                                                 TGS. Defaults to
                                                 'krbtgt/REALM@REALM' where REALM
                                                 is client realm.
     
     Other options:
           --configuration-file=FILE           Read user configuration from FILE.
       -c, --ticket-file=FILE                  Read tickets from FILE.
       -o, --library-options=STRING            Parse STRING as a configuration file
                                                 statement.
       -q, --quiet                             Don't produce any diagnostic output.
                                                   (default=off)
           --system-configuration-file=FILE    Read system configuration from FILE.
           --ticket-write-file=FILE            Write tickets from FILE.  Default is
                                                 to write them back to where they
                                                 were read from.
       -v, --verbose                           Produce verbose output.
                                                   (default=off)
</pre>
   <div class="node">
<a name="Parameters-for-shishid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameters-for-shisa">Parameters for shisa</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parameters-for-shishi">Parameters for shishi</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.7 Parameters for shishid</h3>

<p>If no parameters are specified, &lsquo;<samp><span class="samp">shishid</span></samp>&rsquo; listens on the defaults
interfaces and answers incoming requests using the keys in the default
key file.

   <p>Mandatory arguments to long options are mandatory for short options
too.

<pre class="example">     Usage: shishid [OPTIONS]...
     
       -h, --help                            Print help and exit
       -V, --version                         Print version and exit
     
     Commands:
       -l, --listen=[FAMILY:]ADDR:PORT/TYPE  Sockets to listen for queries on.
                                               Family is `IPv4' or `IPv6', if
                                               absent the family is decided by
                                               gethostbyname(ADDR). An address of
                                               `*' indicates all addresses on the
                                               local host. The default is
                                               `IPv4:*:kerberos/udp,
                                               IPv4:*:kerberos/tcp,
                                               IPv6:*:kerberos/udp,
                                               IPv6:*:kerberos/tcp'.
       -u, --setuid=NAME                     After binding socket, set user
                                               identity.
     
     TLS settings:
           --x509cafile=FILE                 X.509 certificate authorities used to
                                               verify client certificates, in PEM
                                               format.
           --x509certfile=FILE               X.509 server certificate, in PEM
                                               format.
           --x509crlfile=FILE                X.509 certificate revocation list to
                                               check for revoked client
                                               certificates, in PEM format.
           --x509keyfile=FILE                X.509 server certificate key, in PEM
                                               format.
            --resume-limit=SHORT             Keep track of up to this many TLS
                                              sessions for resume purposes (0 to
                                              disable TLS resume).  (default=`50')
     
     Other options:
       -c, --configuration-file=FILE         Use specified configuration file.
       -v, --verbose                         Produce verbose output.
                                                 (default=off)
       -q, --quiet                           Don't produce any diagnostic output.
                                                 (default=off)
</pre>
   <div class="node">
<a name="Parameters-for-shisa"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Environment-variables">Environment variables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parameters-for-shishid">Parameters for shishid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.8 Parameters for shisa</h3>

<p>The purpose of &lsquo;<samp><span class="samp">shisa</span></samp>&rsquo; is to manipulate information stored in the
Kerberos 5 database used by Shishi.

   <p>Mandatory arguments to long options are mandatory for short options
too.

<pre class="example">     Usage: shisa [OPTIONS]... [REALM [PRINCIPAL]]...
     
       -h, --help                         Print help and exit
       -V, --version                      Print version and exit
     
     Operations:
       -a, --add                          Add realm or principal to database.
       -d, --dump                         Dump entries in database.
       -n, --key-add                      Add new key to a principal in database.
           --key-remove                   Remove a key from a principal in
                                            database.
       -l, --list                         List entries in database.
       -m, --modify                       Modify principal entry in database.
       -r, --remove                       Remove realm or principal from database.
     
     Parameters:
       -f, --force                        Allow removal of non-empty realms.
                                              (default=off)
           --enabled                      Only dump or list enabled principals.
                                              (default=off)
           --disabled                     Only dump or list disabled principals.
                                              (default=off)
           --keys                         Print cryptographic key and password in
                                            hostkey format.  (default=off)
     
     Values:
       -E, --encryption-type=STRING       Override default key encryption type.
                                            Valid values include 'aes128',
                                            'aes256', 'aes' (same as 'aes256'),
                                            '3des', 'des-md5', 'des-md4',
                                            'des-crc', 'des' (same as 'des-md5'),
                                            and 'arcfour'.
           --key-version=NUMBER           Version of key.
           --password[=STRING]            Derive key from this password.
           --random                       Use a random key.  (default)
           --salt=STRING                  Use specified salt for deriving key.
                                            Defaults to concatenation of realm and
                                            (unwrapped) principal name.
           --string-to-key-parameter=HEX  Encryption algorithm specific parameter
                                            for password derivation.  Currently
                                            only the AES algorithm can utilize
                                            this, where it is interpreted as the
                                            iteration count of the PKCS#5 PBKDF2
                                            key deriver.
     
     Other options:
       -c, --configuration-file=FILE      Use specified configuration file.
       -o, --library-options=STRING       Parse string as configuration file
                                            statement.
       -v, --verbose                      Produce verbose output.
                                              (default=off)
       -q, --quiet                        Don't produce any diagnostic output.
                                              (default=off)
</pre>
   <div class="node">
<a name="Environment-variables"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Date-input-formats">Date input formats</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parameters-for-shisa">Parameters for shisa</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.9 Environment variables</h3>

<p>A few of the compile-time defaults may be overridden at run-time by
using environment variables.  The following variables are supported.

     <ul>
<li><samp><span class="env">SHISHI_CONFIG</span></samp>
Specify the location of the default system configuration file.  Used
by the Shishi library.  If not specified, the default is specified at
compile-time and is usually <samp><span class="file">$prefix/etc/shishi.conf</span></samp>.

     <li><samp><span class="env">SHISHI_HOME</span></samp>
Specify the user specific directory for configuration files, ticket
cache, etc.  Used by the Shishi library.  If not specified, it is
computed as <code>$HOME/.shishi</code>.

     <li><samp><span class="env">SHISHI_USER</span></samp>
Specify the default principal user name.  Used by the Shishi library. 
If not specified, it is taken from the environment variable
<samp><span class="env">USER</span></samp>.

     <li><samp><span class="env">SHISHI_TICKETS</span></samp>
Specify the file name of the ticket cache.  Used by the Shishi
library.  If not specified, it will be <code>$SHISHI_HOME/tickets</code>, or
<code>$HOME/.shishi/tickets</code> if <code>$SHISHI_HOME</code> is not specified.

   </ul>

<!-- GNU date syntax documentation -->
<!-- Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, -->
<!-- 2003, 2004, 2005, 2006 Free Software Foundation, Inc. -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the GNU Free Documentation License, Version 1.3 or -->
<!-- any later version published by the Free Software Foundation; with no -->
<!-- Invariant Sections, with no Front-Cover Texts, and with no Back-Cover -->
<!-- Texts.  A copy of the license is included in the ``GNU Free -->
<!-- Documentation License'' file as part of this distribution. -->
<div class="node">
<a name="Date-input-formats"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Environment-variables">Environment variables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Reference-Manual">Reference Manual</a>

</div>

<h3 class="section">4.10 Date input formats</h3>

<p><a name="index-date-input-formats-83"></a><a name="index-get_005fdate-84"></a>
First, a quote:

   <blockquote>
Our units of temporal measurement, from seconds on up to months, are so
complicated, asymmetrical and disjunctive so as to make coherent mental
reckoning in time all but impossible.  Indeed, had some tyrannical god
contrived to enslave our minds to time, to make it all but impossible
for us to escape subjection to sodden routines and unpleasant surprises,
he could hardly have done better than handing down our present system. 
It is like a set of trapezoidal building blocks, with no vertical or
horizontal surfaces, like a language in which the simplest thought
demands ornate constructions, useless particles and lengthy
circumlocutions.  Unlike the more successful patterns of language and
science, which enable us to face experience boldly or at least
level-headedly, our system of temporal calculation silently and
persistently encourages our terror of time.

<small class="dots">...</small><p>It is as though architects had to measure length in feet, width
in meters and height in ells; as though basic instruction manuals
demanded a knowledge of five different languages.  It is no wonder then
that we often look into our own immediate past or future, last Tuesday
or a week from Sunday, with feelings of helpless confusion.  <small class="dots">...</small>

   <p>&mdash; Robert Grudin, <cite>Time and the Art of Living</cite>. 
</blockquote>

   <p>This section describes the textual date representations that <span class="sc">gnu</span>
programs accept.  These are the strings you, as a user, can supply as
arguments to the various programs.  The C interface (via the
<code>get_date</code> function) is not described here.

<ul class="menu">
<li><a accesskey="1" href="#General-date-syntax">General date syntax</a>:             Common rules. 
<li><a accesskey="2" href="#Calendar-date-items">Calendar date items</a>:             19 Dec 1994. 
<li><a accesskey="3" href="#Time-of-day-items">Time of day items</a>:               9:20pm. 
<li><a accesskey="4" href="#Time-zone-items">Time zone items</a>:                 <span class="sc">est</span>, <span class="sc">pdt</span>, <span class="sc">gmt</span>. 
<li><a accesskey="5" href="#Day-of-week-items">Day of week items</a>:               Monday and others. 
<li><a accesskey="6" href="#Relative-items-in-date-strings">Relative items in date strings</a>:  next tuesday, 2 years ago. 
<li><a accesskey="7" href="#Pure-numbers-in-date-strings">Pure numbers in date strings</a>:    19931219, 1440. 
<li><a accesskey="8" href="#Seconds-since-the-Epoch">Seconds since the Epoch</a>:         @1078100502. 
<li><a accesskey="9" href="#Specifying-time-zone-rules">Specifying time zone rules</a>:      TZ="America/New_York", TZ="UTC0". 
<li><a href="#Authors-of-get_005fdate">Authors of get_date</a>:             Bellovin, Eggert, Salz, Berets, et al. 
</ul>

<div class="node">
<a name="General-date-syntax"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Calendar-date-items">Calendar date items</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.1 General date syntax</h4>

<p><a name="index-general-date-syntax-85"></a>
<a name="index-items-in-date-strings-86"></a>A <dfn>date</dfn> is a string, possibly empty, containing many items
separated by whitespace.  The whitespace may be omitted when no
ambiguity arises.  The empty string means the beginning of today (i.e.,
midnight).  Order of the items is immaterial.  A date string may contain
many flavors of items:

     <ul>
<li>calendar date items
<li>time of day items
<li>time zone items
<li>day of the week items
<li>relative items
<li>pure numbers. 
</ul>

<p class="noindent">We describe each of these item types in turn, below.

   <p><a name="index-numbers_002c-written_002dout-87"></a><a name="index-ordinal-numbers-88"></a><a name="index-first-_0040r_007bin-date-strings_007d-89"></a><a name="index-next-_0040r_007bin-date-strings_007d-90"></a><a name="index-last-_0040r_007bin-date-strings_007d-91"></a>A few ordinal numbers may be written out in words in some contexts.  This is
most useful for specifying day of the week items or relative items (see
below).  Among the most commonly used ordinal numbers, the word
&lsquo;<samp><span class="samp">last</span></samp>&rsquo; stands for -1, &lsquo;<samp><span class="samp">this</span></samp>&rsquo; stands for 0, and
&lsquo;<samp><span class="samp">first</span></samp>&rsquo; and &lsquo;<samp><span class="samp">next</span></samp>&rsquo; both stand for 1.  Because the word
&lsquo;<samp><span class="samp">second</span></samp>&rsquo; stands for the unit of time there is no way to write the
ordinal number 2, but for convenience &lsquo;<samp><span class="samp">third</span></samp>&rsquo; stands for 3,
&lsquo;<samp><span class="samp">fourth</span></samp>&rsquo; for 4, &lsquo;<samp><span class="samp">fifth</span></samp>&rsquo; for 5,
&lsquo;<samp><span class="samp">sixth</span></samp>&rsquo; for 6, &lsquo;<samp><span class="samp">seventh</span></samp>&rsquo; for 7, &lsquo;<samp><span class="samp">eighth</span></samp>&rsquo; for 8,
&lsquo;<samp><span class="samp">ninth</span></samp>&rsquo; for 9, &lsquo;<samp><span class="samp">tenth</span></samp>&rsquo; for 10, &lsquo;<samp><span class="samp">eleventh</span></samp>&rsquo; for 11 and
&lsquo;<samp><span class="samp">twelfth</span></samp>&rsquo; for 12.

   <p><a name="index-months_002c-written_002dout-92"></a>When a month is written this way, it is still considered to be written
numerically, instead of being &ldquo;spelled in full&rdquo;; this changes the
allowed strings.

   <p><a name="index-language_002c-in-dates-93"></a>In the current implementation, only English is supported for words and
abbreviations like &lsquo;<samp><span class="samp">AM</span></samp>&rsquo;, &lsquo;<samp><span class="samp">DST</span></samp>&rsquo;, &lsquo;<samp><span class="samp">EST</span></samp>&rsquo;, &lsquo;<samp><span class="samp">first</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">January</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Sunday</span></samp>&rsquo;, &lsquo;<samp><span class="samp">tomorrow</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">year</span></samp>&rsquo;.

   <p><a name="index-language_002c-in-dates-94"></a><a name="index-time-zone-item-95"></a>The output of the <samp><span class="command">date</span></samp> command
is not always acceptable as a date string,
not only because of the language problem, but also because there is no
standard meaning for time zone items like &lsquo;<samp><span class="samp">IST</span></samp>&rsquo;.  When using
<samp><span class="command">date</span></samp> to generate a date string intended to be parsed later,
specify a date format that is independent of language and that does not
use time zone items other than &lsquo;<samp><span class="samp">UTC</span></samp>&rsquo; and &lsquo;<samp><span class="samp">Z</span></samp>&rsquo;.  Here are some
ways to do this:

<pre class="example">     $ LC_ALL=C TZ=UTC0 date
     Mon Mar  1 00:21:42 UTC 2004
     $ TZ=UTC0 date +'%Y-%m-%d %H:%M:%SZ'
     2004-03-01 00:21:42Z
     $ date --iso-8601=ns | tr T ' '  # --iso-8601 is a GNU extension.
     2004-02-29 16:21:42,692722128-0800
     $ date --rfc-2822  # a GNU extension
     Sun, 29 Feb 2004 16:21:42 -0800
     $ date +'%Y-%m-%d %H:%M:%S %z'  # %z is a GNU extension.
     2004-02-29 16:21:42 -0800
     $ date +'@%s.%N'  # %s and %N are GNU extensions.
     @1078100502.692722128
</pre>
   <p><a name="index-case_002c-ignored-in-dates-96"></a><a name="index-comments_002c-in-dates-97"></a>Alphabetic case is completely ignored in dates.  Comments may be introduced
between round parentheses, as long as included parentheses are properly
nested.  Hyphens not followed by a digit are currently ignored.  Leading
zeros on numbers are ignored.

   <p>Invalid dates like &lsquo;<samp><span class="samp">2005-02-29</span></samp>&rsquo; or times like &lsquo;<samp><span class="samp">24:00</span></samp>&rsquo; are
rejected.  In the typical case of a host that does not support leap
seconds, a time like &lsquo;<samp><span class="samp">23:59:60</span></samp>&rsquo; is rejected even if it
corresponds to a valid leap second.

<div class="node">
<a name="Calendar-date-items"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Time-of-day-items">Time of day items</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#General-date-syntax">General date syntax</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.2 Calendar date items</h4>

<p><a name="index-calendar-date-item-98"></a>
A <dfn>calendar date item</dfn> specifies a day of the year.  It is
specified differently, depending on whether the month is specified
numerically or literally.  All these strings specify the same calendar date:

<pre class="example">     1972-09-24     # <span class="sc">iso</span> 8601.
     72-9-24        # Assume 19xx for 69 through 99,
                    # 20xx for 00 through 68.
     72-09-24       # Leading zeros are ignored.
     9/24/72        # Common U.S. writing.
     24 September 1972
     24 Sept 72     # September has a special abbreviation.
     24 Sep 72      # Three-letter abbreviations always allowed.
     Sep 24, 1972
     24-sep-72
     24sep72
</pre>
   <p>The year can also be omitted.  In this case, the last specified year is
used, or the current year if none.  For example:

<pre class="example">     9/24
     sep 24
</pre>
   <p>Here are the rules.

   <p><a name="index-g_t_0040sc_007biso_007d-8601-date-format-99"></a><a name="index-date-format_002c-_0040sc_007biso_007d-8601-100"></a>For numeric months, the <span class="sc">iso</span> 8601 format
&lsquo;<samp><var>year</var><span class="samp">-</span><var>month</var><span class="samp">-</span><var>day</var></samp>&rsquo; is allowed, where <var>year</var> is
any positive number, <var>month</var> is a number between 01 and 12, and
<var>day</var> is a number between 01 and 31.  A leading zero must be present
if a number is less than ten.  If <var>year</var> is 68 or smaller, then 2000
is added to it; otherwise, if <var>year</var> is less than 100,
then 1900 is added to it.  The construct
&lsquo;<samp><var>month</var><span class="samp">/</span><var>day</var><span class="samp">/</span><var>year</var></samp>&rsquo;, popular in the United States,
is accepted.  Also &lsquo;<samp><var>month</var><span class="samp">/</span><var>day</var></samp>&rsquo;, omitting the year.

   <p><a name="index-month-names-in-date-strings-101"></a><a name="index-abbreviations-for-months-102"></a>Literal months may be spelled out in full: &lsquo;<samp><span class="samp">January</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">February</span></samp>&rsquo;, &lsquo;<samp><span class="samp">March</span></samp>&rsquo;, &lsquo;<samp><span class="samp">April</span></samp>&rsquo;, &lsquo;<samp><span class="samp">May</span></samp>&rsquo;, &lsquo;<samp><span class="samp">June</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">July</span></samp>&rsquo;, &lsquo;<samp><span class="samp">August</span></samp>&rsquo;, &lsquo;<samp><span class="samp">September</span></samp>&rsquo;, &lsquo;<samp><span class="samp">October</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">November</span></samp>&rsquo; or &lsquo;<samp><span class="samp">December</span></samp>&rsquo;.  Literal months may be abbreviated
to their first three letters, possibly followed by an abbreviating dot. 
It is also permitted to write &lsquo;<samp><span class="samp">Sept</span></samp>&rsquo; instead of &lsquo;<samp><span class="samp">September</span></samp>&rsquo;.

   <p>When months are written literally, the calendar date may be given as any
of the following:

<pre class="example">     <var>day</var> <var>month</var> <var>year</var>
     <var>day</var> <var>month</var>
     <var>month</var> <var>day</var> <var>year</var>
     <var>day</var>-<var>month</var>-<var>year</var>
</pre>
   <p>Or, omitting the year:

<pre class="example">     <var>month</var> <var>day</var>
</pre>
   <div class="node">
<a name="Time-of-day-items"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Time-zone-items">Time zone items</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calendar-date-items">Calendar date items</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.3 Time of day items</h4>

<p><a name="index-time-of-day-item-103"></a>
A <dfn>time of day item</dfn> in date strings specifies the time on a given
day.  Here are some examples, all of which represent the same time:

<pre class="example">     20:02:00.000000
     20:02
     8:02pm
     20:02-0500      # In <span class="sc">est</span> (U.S. Eastern Standard Time).
</pre>
   <p>More generally, the time of day may be given as
&lsquo;<samp><var>hour</var><span class="samp">:</span><var>minute</var><span class="samp">:</span><var>second</var></samp>&rsquo;, where <var>hour</var> is
a number between 0 and 23, <var>minute</var> is a number between 0 and
59, and <var>second</var> is a number between 0 and 59 possibly followed by
&lsquo;<samp><span class="samp">.</span></samp>&rsquo; or &lsquo;<samp><span class="samp">,</span></samp>&rsquo; and a fraction containing one or more digits. 
Alternatively,
&lsquo;<samp><span class="samp">:</span><var>second</var></samp>&rsquo; can be omitted, in which case it is taken to
be zero.  On the rare hosts that support leap seconds, <var>second</var>
may be 60.

   <p><a name="index-am-_0040r_007bin-date-strings_007d-104"></a><a name="index-pm-_0040r_007bin-date-strings_007d-105"></a><a name="index-midnight-_0040r_007bin-date-strings_007d-106"></a><a name="index-noon-_0040r_007bin-date-strings_007d-107"></a>If the time is followed by &lsquo;<samp><span class="samp">am</span></samp>&rsquo; or &lsquo;<samp><span class="samp">pm</span></samp>&rsquo; (or &lsquo;<samp><span class="samp">a.m.</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">p.m.</span></samp>&rsquo;), <var>hour</var> is restricted to run from 1 to 12, and
&lsquo;<samp><span class="samp">:</span><var>minute</var></samp>&rsquo; may be omitted (taken to be zero).  &lsquo;<samp><span class="samp">am</span></samp>&rsquo;
indicates the first half of the day, &lsquo;<samp><span class="samp">pm</span></samp>&rsquo; indicates the second
half of the day.  In this notation, 12 is the predecessor of 1:
midnight is &lsquo;<samp><span class="samp">12am</span></samp>&rsquo; while noon is &lsquo;<samp><span class="samp">12pm</span></samp>&rsquo;. 
(This is the zero-oriented interpretation of &lsquo;<samp><span class="samp">12am</span></samp>&rsquo; and &lsquo;<samp><span class="samp">12pm</span></samp>&rsquo;,
as opposed to the old tradition derived from Latin
which uses &lsquo;<samp><span class="samp">12m</span></samp>&rsquo; for noon and &lsquo;<samp><span class="samp">12pm</span></samp>&rsquo; for midnight.)

   <p><a name="index-time-zone-correction-108"></a><a name="index-minutes_002c-time-zone-correction-by-109"></a>The time may alternatively be followed by a time zone correction,
expressed as &lsquo;<samp><var>s</var><var>hh</var><var>mm</var></samp>&rsquo;, where <var>s</var> is &lsquo;<samp><span class="samp">+</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">-</span></samp>&rsquo;, <var>hh</var> is a number of zone hours and <var>mm</var> is a number
of zone minutes. 
The zone minutes term, <var>mm</var>, may be omitted, in which case
the one- or two-digit correction is interpreted as a number of hours. 
You can also separate <var>hh</var> from <var>mm</var> with a colon. 
When a time zone correction is given this way, it
forces interpretation of the time relative to
Coordinated Universal Time (<span class="sc">utc</span>), overriding any previous
specification for the time zone or the local time zone.  For example,
&lsquo;<samp><span class="samp">+0530</span></samp>&rsquo; and &lsquo;<samp><span class="samp">+05:30</span></samp>&rsquo; both stand for the time zone 5.5 hours
ahead of <span class="sc">utc</span> (e.g., India). 
This is the best way to
specify a time zone correction by fractional parts of an hour. 
The maximum zone correction is 24 hours.

   <p>Either &lsquo;<samp><span class="samp">am</span></samp>&rsquo;/&lsquo;<samp><span class="samp">pm</span></samp>&rsquo; or a time zone correction may be specified,
but not both.

<div class="node">
<a name="Time-zone-items"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Day-of-week-items">Day of week items</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-of-day-items">Time of day items</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.4 Time zone items</h4>

<p><a name="index-time-zone-item-110"></a>
A <dfn>time zone item</dfn> specifies an international time zone, indicated
by a small set of letters, e.g., &lsquo;<samp><span class="samp">UTC</span></samp>&rsquo; or &lsquo;<samp><span class="samp">Z</span></samp>&rsquo;
for Coordinated Universal
Time.  Any included periods are ignored.  By following a
non-daylight-saving time zone by the string &lsquo;<samp><span class="samp">DST</span></samp>&rsquo; in a separate
word (that is, separated by some white space), the corresponding
daylight saving time zone may be specified. 
Alternatively, a non-daylight-saving time zone can be followed by a
time zone correction, to add the two values.  This is normally done
only for &lsquo;<samp><span class="samp">UTC</span></samp>&rsquo;; for example, &lsquo;<samp><span class="samp">UTC+05:30</span></samp>&rsquo; is equivalent to
&lsquo;<samp><span class="samp">+05:30</span></samp>&rsquo;.

   <p>Time zone items other than &lsquo;<samp><span class="samp">UTC</span></samp>&rsquo; and &lsquo;<samp><span class="samp">Z</span></samp>&rsquo;
are obsolescent and are not recommended, because they
are ambiguous; for example, &lsquo;<samp><span class="samp">EST</span></samp>&rsquo; has a different meaning in
Australia than in the United States.  Instead, it's better to use
unambiguous numeric time zone corrections like &lsquo;<samp><span class="samp">-0500</span></samp>&rsquo;, as
described in the previous section.

   <p>If neither a time zone item nor a time zone correction is supplied,
time stamps are interpreted using the rules of the default time zone
(see <a href="#Specifying-time-zone-rules">Specifying time zone rules</a>).

<div class="node">
<a name="Day-of-week-items"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Relative-items-in-date-strings">Relative items in date strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Time-zone-items">Time zone items</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.5 Day of week items</h4>

<p><a name="index-day-of-week-item-111"></a>
The explicit mention of a day of the week will forward the date
(only if necessary) to reach that day of the week in the future.

   <p>Days of the week may be spelled out in full: &lsquo;<samp><span class="samp">Sunday</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">Monday</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Tuesday</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Wednesday</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Thursday</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">Friday</span></samp>&rsquo; or &lsquo;<samp><span class="samp">Saturday</span></samp>&rsquo;.  Days may be abbreviated to their
first three letters, optionally followed by a period.  The special
abbreviations &lsquo;<samp><span class="samp">Tues</span></samp>&rsquo; for &lsquo;<samp><span class="samp">Tuesday</span></samp>&rsquo;, &lsquo;<samp><span class="samp">Wednes</span></samp>&rsquo; for
&lsquo;<samp><span class="samp">Wednesday</span></samp>&rsquo; and &lsquo;<samp><span class="samp">Thur</span></samp>&rsquo; or &lsquo;<samp><span class="samp">Thurs</span></samp>&rsquo; for &lsquo;<samp><span class="samp">Thursday</span></samp>&rsquo; are
also allowed.

   <p><a name="index-next-_0040var_007bday_007d-112"></a><a name="index-last-_0040var_007bday_007d-113"></a>A number may precede a day of the week item to move forward
supplementary weeks.  It is best used in expression like &lsquo;<samp><span class="samp">third
monday</span></samp>&rsquo;.  In this context, &lsquo;<samp><span class="samp">last </span><var>day</var></samp>&rsquo; or &lsquo;<samp><span class="samp">next
</span><var>day</var></samp>&rsquo; is also acceptable; they move one week before or after
the day that <var>day</var> by itself would represent.

   <p>A comma following a day of the week item is ignored.

<div class="node">
<a name="Relative-items-in-date-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Pure-numbers-in-date-strings">Pure numbers in date strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Day-of-week-items">Day of week items</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.6 Relative items in date strings</h4>

<p><a name="index-relative-items-in-date-strings-114"></a><a name="index-displacement-of-dates-115"></a>
<dfn>Relative items</dfn> adjust a date (or the current date if none) forward
or backward.  The effects of relative items accumulate.  Here are some
examples:

<pre class="example">     1 year
     1 year ago
     3 years
     2 days
</pre>
   <p><a name="index-year-_0040r_007bin-date-strings_007d-116"></a><a name="index-month-_0040r_007bin-date-strings_007d-117"></a><a name="index-fortnight-_0040r_007bin-date-strings_007d-118"></a><a name="index-week-_0040r_007bin-date-strings_007d-119"></a><a name="index-day-_0040r_007bin-date-strings_007d-120"></a><a name="index-hour-_0040r_007bin-date-strings_007d-121"></a><a name="index-minute-_0040r_007bin-date-strings_007d-122"></a>The unit of time displacement may be selected by the string &lsquo;<samp><span class="samp">year</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">month</span></samp>&rsquo; for moving by whole years or months.  These are fuzzy
units, as years and months are not all of equal duration.  More precise
units are &lsquo;<samp><span class="samp">fortnight</span></samp>&rsquo; which is worth 14 days, &lsquo;<samp><span class="samp">week</span></samp>&rsquo; worth 7
days, &lsquo;<samp><span class="samp">day</span></samp>&rsquo; worth 24 hours, &lsquo;<samp><span class="samp">hour</span></samp>&rsquo; worth 60 minutes,
&lsquo;<samp><span class="samp">minute</span></samp>&rsquo; or &lsquo;<samp><span class="samp">min</span></samp>&rsquo; worth 60 seconds, and &lsquo;<samp><span class="samp">second</span></samp>&rsquo; or
&lsquo;<samp><span class="samp">sec</span></samp>&rsquo; worth one second.  An &lsquo;<samp><span class="samp">s</span></samp>&rsquo; suffix on these units is
accepted and ignored.

   <p><a name="index-ago-_0040r_007bin-date-strings_007d-123"></a>The unit of time may be preceded by a multiplier, given as an optionally
signed number.  Unsigned numbers are taken as positively signed.  No
number at all implies 1 for a multiplier.  Following a relative item by
the string &lsquo;<samp><span class="samp">ago</span></samp>&rsquo; is equivalent to preceding the unit by a
multiplier with value -1.

   <p><a name="index-day-_0040r_007bin-date-strings_007d-124"></a><a name="index-tomorrow-_0040r_007bin-date-strings_007d-125"></a><a name="index-yesterday-_0040r_007bin-date-strings_007d-126"></a>The string &lsquo;<samp><span class="samp">tomorrow</span></samp>&rsquo; is worth one day in the future (equivalent
to &lsquo;<samp><span class="samp">day</span></samp>&rsquo;), the string &lsquo;<samp><span class="samp">yesterday</span></samp>&rsquo; is worth
one day in the past (equivalent to &lsquo;<samp><span class="samp">day ago</span></samp>&rsquo;).

   <p><a name="index-now-_0040r_007bin-date-strings_007d-127"></a><a name="index-today-_0040r_007bin-date-strings_007d-128"></a><a name="index-this-_0040r_007bin-date-strings_007d-129"></a>The strings &lsquo;<samp><span class="samp">now</span></samp>&rsquo; or &lsquo;<samp><span class="samp">today</span></samp>&rsquo; are relative items corresponding
to zero-valued time displacement, these strings come from the fact
a zero-valued time displacement represents the current time when not
otherwise changed by previous items.  They may be used to stress other
items, like in &lsquo;<samp><span class="samp">12:00 today</span></samp>&rsquo;.  The string &lsquo;<samp><span class="samp">this</span></samp>&rsquo; also has
the meaning of a zero-valued time displacement, but is preferred in
date strings like &lsquo;<samp><span class="samp">this thursday</span></samp>&rsquo;.

   <p>When a relative item causes the resulting date to cross a boundary
where the clocks were adjusted, typically for daylight saving time,
the resulting date and time are adjusted accordingly.

   <p>The fuzz in units can cause problems with relative items.  For
example, &lsquo;<samp><span class="samp">2003-07-31 -1 month</span></samp>&rsquo; might evaluate to 2003-07-01,
because 2003-06-31 is an invalid date.  To determine the previous
month more reliably, you can ask for the month before the 15th of the
current month.  For example:

<pre class="example">     $ date -R
     Thu, 31 Jul 2003 13:02:39 -0700
     $ date --date='-1 month' +'Last month was %B?'
     Last month was July?
     $ date --date="$(date +%Y-%m-15) -1 month" +'Last month was %B!'
     Last month was June!
</pre>
   <p>Also, take care when manipulating dates around clock changes such as
daylight saving leaps.  In a few cases these have added or subtracted
as much as 24 hours from the clock, so it is often wise to adopt
universal time by setting the <samp><span class="env">TZ</span></samp> environment variable to
&lsquo;<samp><span class="samp">UTC0</span></samp>&rsquo; before embarking on calendrical calculations.

<div class="node">
<a name="Pure-numbers-in-date-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Seconds-since-the-Epoch">Seconds since the Epoch</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Relative-items-in-date-strings">Relative items in date strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.7 Pure numbers in date strings</h4>

<p><a name="index-pure-numbers-in-date-strings-130"></a>
The precise interpretation of a pure decimal number depends
on the context in the date string.

   <p>If the decimal number is of the form <var>yyyy</var><var>mm</var><var>dd</var> and no
other calendar date item (see <a href="#Calendar-date-items">Calendar date items</a>) appears before it
in the date string, then <var>yyyy</var> is read as the year, <var>mm</var> as the
month number and <var>dd</var> as the day of the month, for the specified
calendar date.

   <p>If the decimal number is of the form <var>hh</var><var>mm</var> and no other time
of day item appears before it in the date string, then <var>hh</var> is read
as the hour of the day and <var>mm</var> as the minute of the hour, for the
specified time of day.  <var>mm</var> can also be omitted.

   <p>If both a calendar date and a time of day appear to the left of a number
in the date string, but no relative item, then the number overrides the
year.

<div class="node">
<a name="Seconds-since-the-Epoch"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Specifying-time-zone-rules">Specifying time zone rules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Pure-numbers-in-date-strings">Pure numbers in date strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.8 Seconds since the Epoch</h4>

<p>If you precede a number with &lsquo;<samp><span class="samp">@</span></samp>&rsquo;, it represents an internal time
stamp as a count of seconds.  The number can contain an internal
decimal point (either &lsquo;<samp><span class="samp">.</span></samp>&rsquo; or &lsquo;<samp><span class="samp">,</span></samp>&rsquo;); any excess precision not
supported by the internal representation is truncated toward minus
infinity.  Such a number cannot be combined with any other date
item, as it specifies a complete time stamp.

   <p><a name="index-beginning-of-time_002c-for-_0040acronym_007bPOSIX_007d-131"></a><a name="index-epoch_002c-for-_0040acronym_007bPOSIX_007d-132"></a>Internally, computer times are represented as a count of seconds since
an epoch&mdash;a well-defined point of time.  On <acronym>GNU</acronym> and
<acronym>POSIX</acronym> systems, the epoch is 1970-01-01 00:00:00 <span class="sc">utc</span>, so
&lsquo;<samp><span class="samp">@0</span></samp>&rsquo; represents this time, &lsquo;<samp><span class="samp">@1</span></samp>&rsquo; represents 1970-01-01
00:00:01 <span class="sc">utc</span>, and so forth.  <acronym>GNU</acronym> and most other
<acronym>POSIX</acronym>-compliant systems support such times as an extension
to <acronym>POSIX</acronym>, using negative counts, so that &lsquo;<samp><span class="samp">@-1</span></samp>&rsquo;
represents 1969-12-31 23:59:59 <span class="sc">utc</span>.

   <p>Traditional Unix systems count seconds with 32-bit two's-complement
integers and can represent times from 1901-12-13 20:45:52 through
2038-01-19 03:14:07 <span class="sc">utc</span>.  More modern systems use 64-bit counts
of seconds with nanosecond subcounts, and can represent all the times
in the known lifetime of the universe to a resolution of 1 nanosecond.

   <p>On most hosts, these counts ignore the presence of leap seconds. 
For example, on most hosts &lsquo;<samp><span class="samp">@915148799</span></samp>&rsquo; represents 1998-12-31
23:59:59 <span class="sc">utc</span>, &lsquo;<samp><span class="samp">@915148800</span></samp>&rsquo; represents 1999-01-01 00:00:00
<span class="sc">utc</span>, and there is no way to represent the intervening leap second
1998-12-31 23:59:60 <span class="sc">utc</span>.

<div class="node">
<a name="Specifying-time-zone-rules"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authors-of-get_005fdate">Authors of get_date</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Seconds-since-the-Epoch">Seconds since the Epoch</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.9 Specifying time zone rules</h4>

<p><a name="index-TZ-133"></a>Normally, dates are interpreted using the rules of the current time
zone, which in turn are specified by the <samp><span class="env">TZ</span></samp> environment
variable, or by a system default if <samp><span class="env">TZ</span></samp> is not set.  To specify a
different set of default time zone rules that apply just to one date,
start the date with a string of the form &lsquo;<samp><span class="samp">TZ="</span><var>rule</var><span class="samp">"</span></samp>&rsquo;.  The
two quote characters (&lsquo;<samp><span class="samp">"</span></samp>&rsquo;) must be present in the date, and any
quotes or backslashes within <var>rule</var> must be escaped by a
backslash.

   <p>For example, with the <acronym>GNU</acronym> <samp><span class="command">date</span></samp> command you can
answer the question &ldquo;What time is it in New York when a Paris clock
shows 6:30am on October 31, 2004?&rdquo; by using a date beginning with
&lsquo;<samp><span class="samp">TZ="Europe/Paris"</span></samp>&rsquo; as shown in the following shell transcript:

<pre class="example">     $ export TZ="America/New_York"
     $ date --date='TZ="Europe/Paris" 2004-10-31 06:30'
     Sun Oct 31 01:30:00 EDT 2004
</pre>
   <p>In this example, the <samp><span class="option">--date</span></samp> operand begins with its own
<samp><span class="env">TZ</span></samp> setting, so the rest of that operand is processed according
to &lsquo;<samp><span class="samp">Europe/Paris</span></samp>&rsquo; rules, treating the string &lsquo;<samp><span class="samp">2004-10-31
06:30</span></samp>&rsquo; as if it were in Paris.  However, since the output of the
<samp><span class="command">date</span></samp> command is processed according to the overall time zone
rules, it uses New York time.  (Paris was normally six hours ahead of
New York in 2004, but this example refers to a brief Halloween period
when the gap was five hours.)

   <p>A <samp><span class="env">TZ</span></samp> value is a rule that typically names a location in the
<a href="http://www.twinsun.com/tz/tz-link.htm">&lsquo;<samp><span class="samp">tz</span></samp>&rsquo; database</a>. 
A recent catalog of location names appears in the
<a href="http://twiki.org/cgi-bin/xtra/tzdate">TWiki Date and Time Gateway</a>.  A few non-<acronym>GNU</acronym> hosts require a colon before a
location name in a <samp><span class="env">TZ</span></samp> setting, e.g.,
&lsquo;<samp><span class="samp">TZ=":America/New_York"</span></samp>&rsquo;.

   <p>The &lsquo;<samp><span class="samp">tz</span></samp>&rsquo; database includes a wide variety of locations ranging
from &lsquo;<samp><span class="samp">Arctic/Longyearbyen</span></samp>&rsquo; to &lsquo;<samp><span class="samp">Antarctica/South_Pole</span></samp>&rsquo;, but
if you are at sea and have your own private time zone, or if you are
using a non-<acronym>GNU</acronym> host that does not support the &lsquo;<samp><span class="samp">tz</span></samp>&rsquo;
database, you may need to use a <acronym>POSIX</acronym> rule instead.  Simple
<acronym>POSIX</acronym> rules like &lsquo;<samp><span class="samp">UTC0</span></samp>&rsquo; specify a time zone without
daylight saving time; other rules can specify simple daylight saving
regimes.  See <a href="libc.html#TZ-Variable">Specifying the Time Zone with <code>TZ</code></a>.

<div class="node">
<a name="Authors-of-get_date"></a>
<a name="Authors-of-get_005fdate"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Specifying-time-zone-rules">Specifying time zone rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Date-input-formats">Date input formats</a>

</div>

<h4 class="subsection">4.10.10 Authors of <code>get_date</code></h4>

<p><a name="index-authors-of-_0040code_007bget_005fdate_007d-134"></a>
<a name="index-Bellovin_002c-Steven-M_002e-135"></a><a name="index-Salz_002c-Rich-136"></a><a name="index-Berets_002c-Jim-137"></a><a name="index-MacKenzie_002c-David-138"></a><a name="index-Meyering_002c-Jim-139"></a><a name="index-Eggert_002c-Paul-140"></a><code>get_date</code> was originally implemented by Steven M. Bellovin
(<a href="mailto:smb@research.att.com">smb@research.att.com</a>) while at the University of North Carolina
at Chapel Hill.  The code was later tweaked by a couple of people on
Usenet, then completely overhauled by Rich $alz (<a href="mailto:rsalz@bbn.com">rsalz@bbn.com</a>)
and Jim Berets (<a href="mailto:jberets@bbn.com">jberets@bbn.com</a>) in August, 1990.  Various
revisions for the <span class="sc">gnu</span> system were made by David MacKenzie, Jim Meyering,
Paul Eggert and others.

   <p><a name="index-Pinard_002c-F_002e-141"></a><a name="index-Berry_002c-K_002e-142"></a>This chapter was originally produced by Fran&ccedil;ois Pinard
(<a href="mailto:pinard@iro.umontreal.ca">pinard@iro.umontreal.ca</a>) from the <samp><span class="file">getdate.y</span></samp> source code,
and then edited by K. Berry (<a href="mailto:kb@cs.umb.edu">kb@cs.umb.edu</a>).

<!-- ********************************************************** -->
<!-- ***************  Programming Manual  ********************* -->
<!-- ********************************************************** -->
<div class="node">
<a name="Programming-Manual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Acknowledgements">Acknowledgements</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Reference-Manual">Reference Manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 Programming Manual</h2>

<p><a name="index-Application-Programming-Interface-_0028API_0029-143"></a>
This chapter describes all the publicly available functions in the
library.

<ul class="menu">
<li><a accesskey="1" href="#Preparation">Preparation</a>:                  What you should do before using the library. 
<li><a accesskey="2" href="#Initialization-Functions">Initialization Functions</a>:     Creating library handle, configuration file. 
<li><a accesskey="3" href="#Ticket-Set-Functions">Ticket Set Functions</a>:         High-level ticket management functions. 
<li><a accesskey="4" href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>:  Client/Server authentication functions. 
<li><a accesskey="5" href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a>:      Client/Server session data functions. 
<li><a accesskey="6" href="#Ticket-Functions">Ticket Functions</a>:             Medium-level ticket manipulation functions. 
<li><a accesskey="7" href="#AS-Functions">AS Functions</a>:                 Medium-level initial authentication functions. 
<li><a accesskey="8" href="#TGS-Functions">TGS Functions</a>:                Medium-level authentication functions. 
<li><a accesskey="9" href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a>:     Low-level Ticket functions. 
<li><a href="#AS_002fTGS-Functions">AS/TGS Functions</a>:             Low-level KDC functions; AS and TGS. 
<li><a href="#Authenticator-Functions">Authenticator Functions</a>:      Low-level authenticator functions. 
<li><a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a>:          Low-level KRB-ERROR functions. 
<li><a href="#Cryptographic-Functions">Cryptographic Functions</a>:      Low-level cryptographic functions. 
<li><a href="#X_002e509-Functions">X.509 Functions</a>:              Utility functions for X.509 support. 
<li><a href="#Utility-Functions">Utility Functions</a>:            Utilities for use in the global context. 
<li><a href="#ASN_002e1-Functions">ASN.1 Functions</a>:              Perform low-level ASN.1 manipulations. 
<li><a href="#Error-Handling">Error Handling</a>:               Error codes and such. 
<li><a href="#Examples">Examples</a>:                     Example code. 
<li><a href="#Kerberos-Database-Functions">Kerberos Database Functions</a>:  The Shisa generic database interface. 
<li><a href="#Generic-Security-Service">Generic Security Service</a>:     If you want to use the GSS API instead. 
</ul>

<div class="node">
<a name="Preparation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Initialization-Functions">Initialization Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.1 Preparation</h3>

<p>To use `Libshishi', you have to perform some changes to your sources
and the build system.  The necessary changes are small and explained
in the following sections.  At the end of this chapter, it is
described how the library is initialized, and how the requirements of
the library are verified.

   <p>A faster way to find out how to adapt your application for use with
`Libshishi' may be to look at the examples at the end of this manual
(see <a href="#Examples">Examples</a>).

<ul class="menu">
<li><a accesskey="1" href="#Header">Header</a>
<li><a accesskey="2" href="#Initialization">Initialization</a>
<li><a accesskey="3" href="#Version-Check">Version Check</a>
<li><a accesskey="4" href="#Building-the-source">Building the source</a>
<li><a accesskey="5" href="#Autoconf-tests">Autoconf tests</a>
</ul>

<div class="node">
<a name="Header"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Initialization">Initialization</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">5.1.1 Header</h4>

<p>All interfaces (data types and functions) of the library are defined
in the header file `shishi.h'.  You must include this in all programs
using the library, either directly or through some other header file,
like this:

<pre class="example">     #include &lt;shishi.h&gt;
</pre>
   <p>The name space of `Libshishi' is <code>shishi_*</code> for function names,
<code>Shishi*</code> for data types and <code>SHISHI_*</code> for other symbols.  In
addition the same name prefixes with one prepended underscore are
reserved for internal use and should never be used by an application.

<div class="node">
<a name="Initialization"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Version-Check">Version Check</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Header">Header</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">5.1.2 Initialization</h4>

<p>`Libshishi' must be initialized before it can be used.  The library is
initialized by calling <code>shishi_init</code> (see <a href="#Initialization-Functions">Initialization Functions</a>).  The resources allocated by the initialization process
can be released if the application no longer has a need to call
`Libshishi' functions, this is done by calling <code>shishi_done</code>.

   <p>In order to take advantage of the internationalisation features in
`Libshishi', such as translated error messages, the application must
set the current locale using <code>setlocale</code> before initializing
`Libshishi'.

<div class="node">
<a name="Version-Check"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Building-the-source">Building the source</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Initialization">Initialization</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">5.1.3 Version Check</h4>

<p>It is often desirable to check that the version of `Libshishi' used is
indeed one which fits all requirements.  Even with binary
compatibility new features may have been introduced but due to problem
with the dynamic linker an old version is actually used.  So you may
want to check that the version is okay right after program startup.

<h4 class="subheading">shishi_check_version</h4>

<p><a name="shishi_005fcheck_005fversion"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_check_version</b> (<var>const char * req_version</var>)<var><a name="index-shishi_005fcheck_005fversion-144"></a></var><br>
<blockquote><p><var>req_version</var>: version string to compare with, or NULL

        <p>Check that the the version of the library is at minimum the one
given as a string in <code>req_version</code>.

        <p><strong>Return value:</strong> the actual version string of the library; NULL if the
condition is not met.  If <code>NULL</code> is passed to this function no
check is done and only the version string is returned. 
</p></blockquote></div>

   <p>The normal way to use the function is to put something similar to the
following early in your <code>main</code>:

<pre class="example">       if (!shishi_check_version (SHISHI_VERSION))
         {
           printf ("shishi_check_version failed:\n"
                   "Header file incompatible with shared library.\n");
           exit(1);
         }
</pre>
   <div class="node">
<a name="Building-the-source"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Autoconf-tests">Autoconf tests</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Version-Check">Version Check</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">5.1.4 Building the source</h4>

<p><a name="index-Compiling-your-application-145"></a>
If you want to compile a source file including the `shishi.h' header
file, you must make sure that the compiler can find it in the
directory hierarchy.  This is accomplished by adding the path to the
directory in which the header file is located to the compilers include
file search path (via the <samp><span class="option">-I</span></samp> option).

   <p>However, the path to the include file is determined at the time the
source is configured.  To solve this problem, `Libshishi' uses the
external package <samp><span class="command">pkg-config</span></samp> that knows the path to the
include file and other configuration options.  The options that need
to be added to the compiler invocation at compile time are output by
the <samp><span class="option">--cflags</span></samp> option to <samp><span class="command">pkg-config shishi</span></samp>.  The
following example shows how it can be used at the command line:

<pre class="example">     gcc -c foo.c `pkg-config shishi --cflags`
</pre>
   <p>Adding the output of &lsquo;<samp><span class="samp">pkg-config shishi --cflags</span></samp>&rsquo; to the
compilers command line will ensure that the compiler can find the
`Libshishi' header file.

   <p>A similar problem occurs when linking the program with the library. 
Again, the compiler has to find the library files.  For this to work,
the path to the library files has to be added to the library search path
(via the <samp><span class="option">-L</span></samp> option).  For this, the option <samp><span class="option">--libs</span></samp> to
<samp><span class="command">pkg-config shishi</span></samp> can be used.  For convenience, this option
also outputs all other options that are required to link the program
with the `Libshishi' libararies (in particular, the &lsquo;<samp><span class="samp">-lshishi</span></samp>&rsquo;
option).  The example shows how to link <samp><span class="file">foo.o</span></samp> with the `Libshishi'
library to a program <samp><span class="command">foo</span></samp>.

<pre class="example">     gcc -o foo foo.o `pkg-config shishi --libs`
</pre>
   <p>Of course you can also combine both examples to a single command by
specifying both options to <samp><span class="command">pkg-config</span></samp>:

<pre class="example">     gcc -o foo foo.c `pkg-config shishi --cflags --libs`
</pre>
   <div class="node">
<a name="Autoconf-tests"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Building-the-source">Building the source</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">5.1.5 Autoconf tests</h4>

<p><a name="index-Autoconf-tests-146"></a><a name="index-Configure-tests-147"></a>
If you work on a project that uses Autoconf (see <a href="autoconf.html#Top">GNU Autoconf</a>) to help find installed libraries, the
suggestions in the previous section are not the entire story.  There
are a few methods to detect and incorporate Shishi into your Autoconf
based package.  The preferred approach, is to use Libtool in your
project, and use the normal Autoconf header file and library tests.

<h5 class="subsubsection">5.1.5.1 Autoconf test via &lsquo;<samp><span class="samp">pkg-config</span></samp>&rsquo;</h5>

<p>If your audience is a typical GNU/Linux desktop, you can often assume
they have the &lsquo;<samp><span class="samp">pkg-config</span></samp>&rsquo; tool installed, in which you can use
its Autoconf M4 macro to find and set up your package for use with
Shishi.  The following illustrate this scenario.

<pre class="example">     AC_ARG_ENABLE(kerberos_v5,
     	AC_HELP_STRING([--disable-kerberos_v5],
                            [don't use the KERBEROS_V5 mechanism]),
     	kerberos_v5=$enableval)
     if test "$kerberos_v5" != "no" ; then
     	PKG_CHECK_MODULES(SHISHI, shishi &gt;= 0.0.0,
     			[kerberos_v5=yes],
                             [kerberos_v5=no])
     	if test "$kerberos_v5" != "yes" ; then
     		kerberos_v5=no
     		AC_MSG_WARN([shishi not found, disabling Kerberos 5])
     	else
     		kerberos_v5=yes
     		AC_DEFINE(USE_KERBEROS_V5, 1,
                               [Define to 1 if you want Kerberos 5.])
     	fi
     fi
     AC_MSG_CHECKING([if Kerberos 5 should be used])
     AC_MSG_RESULT($kerberos_v5)
</pre>
   <h5 class="subsubsection">5.1.5.2 Standalone Autoconf test using Libtool</h5>

<p>If your package uses Libtool(see <a href="libtool.html#Top">GNU Libtool</a>), you
can use the normal Autoconf tests to find the Shishi library and rely
on the Libtool dependency tracking to include the proper dependency
libraries (e.g., Libidn).  The following illustrate this scenario.

<pre class="example">     AC_CHECK_HEADER(shishi.h,
     	AC_CHECK_LIB(shishi, shishi_check_version,
     		[kerberos5=yes AC_SUBST(SHISHI_LIBS, -lshishi)],
     		kerberos5=no),
     	kerberos5=no)
     AC_ARG_ENABLE(kerberos5,
     	AC_HELP_STRING([--disable-kerberos5],
                            [disable Kerberos 5 unconditionally]),
     	kerberos5=$enableval)
     if test "$kerberos5" != "no" ; then
     	AC_DEFINE(USE_KERBEROS_V5, 1,
     		  [Define to 1 if you want Kerberos 5.])
     else
     	AC_MSG_WARN([Shishi not found, disabling Kerberos 5])
     fi
     AC_MSG_CHECKING([if Kerberos 5 should be used])
     AC_MSG_RESULT($kerberos5)
</pre>
   <h5 class="subsubsection">5.1.5.3 Standalone Autoconf test</h5>

<p>If your package does not use Libtool, as well as detecting the Shishi
library as in the previous case, you must also detect whatever
dependencies Shishi requires to work (e.g., libidn).  Since the
dependencies are in a state of flux, we do not provide an example and
we do not recommend this approach, unless you are experienced
developer.

<div class="node">
<a name="Initialization-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Ticket-Set-Functions">Ticket Set Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Preparation">Preparation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.2 Initialization Functions</h3>

<h4 class="subheading">shishi</h4>

<p><a name="shishi"></a>

<div class="defun">
&mdash; Function: Shishi * <b>shishi</b> (<var> void</var>)<var><a name="index-shishi-148"></a></var><br>
<blockquote>
        <p>Initializes the Shishi library, and set up, using
<code>shishi_error_set_outputtype()</code>, the library so that future warnings
and informational messages are printed to stderr.  If this function
fails, it may print diagnostic errors to stderr.

        <p><strong>Return value:</strong> Returns Shishi library handle, or <code>NULL</code> on error. 
</p></blockquote></div>

<h4 class="subheading">shishi_server</h4>

<p><a name="shishi_005fserver"></a>

<div class="defun">
&mdash; Function: Shishi * <b>shishi_server</b> (<var> void</var>)<var><a name="index-shishi_005fserver-149"></a></var><br>
<blockquote>
        <p>Initializes the Shishi library, and set up, using
<code>shishi_error_set_outputtype()</code>, the library so that future warnings
and informational messages are printed to the syslog.  If this
function fails, it may print diagnostic errors to the syslog.

        <p><strong>Return value:</strong> Returns Shishi library handle, or <code>NULL</code> on error. 
</p></blockquote></div>

<h4 class="subheading">shishi_done</h4>

<p><a name="shishi_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_done</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fdone-150"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Deallocates the shishi library handle.  The handle must not be used
in any calls to shishi functions after this.

        <p>If there is a default tkts, it is written to the default tkts file
(call <code>shishi_tkts_default_file_set()</code> to change the default tkts
file). If you do not wish to write the default tkts file, close the
default tkts with shishi_tkts_done(handle, NULL) before calling
this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_init</h4>

<p><a name="shishi_005finit"></a>

<div class="defun">
&mdash; Function: int <b>shishi_init</b> (<var>Shishi ** handle</var>)<var><a name="index-shishi_005finit-151"></a></var><br>
<blockquote><p><var>handle</var>: pointer to handle to be created.

        <p>Create a Shishi library handle, using <code>shishi()</code>, and read the system
configuration file, user configuration file and user tickets from
their default locations.  The paths to the system configuration
file is decided at compile time, and is $sysconfdir/shishi.conf. 
The user configuration file is $HOME/.shishi/config, and the user
ticket file is $HOME/.shishi/ticket.

        <p>The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the files.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_init_with_paths</h4>

<p><a name="shishi_005finit_005fwith_005fpaths"></a>

<div class="defun">
&mdash; Function: int <b>shishi_init_with_paths</b> (<var>Shishi ** handle, const char * tktsfile, const char * systemcfgfile, const char * usercfgfile</var>)<var><a name="index-shishi_005finit_005fwith_005fpaths-152"></a></var><br>
<blockquote><p><var>handle</var>: pointer to handle to be created.

        <p><var>tktsfile</var>: Filename of ticket file, or NULL.

        <p><var>systemcfgfile</var>: Filename of system configuration, or NULL.

        <p><var>usercfgfile</var>: Filename of user configuration, or NULL.

        <p>Create a Shishi library handle, using <code>shishi()</code>, and read the system
configuration file, user configuration file, and user tickets from
the specified locations.  If any of <code>usercfgfile</code> or <code>systemcfgfile</code>
is NULL, the file is read from its default location, which for the
system configuration file is decided at compile time, and is
$sysconfdir/shishi.conf, and for the user configuration file is
$HOME/.shishi/config.  If the ticket file is NULL, a ticket file is
not read at all.

        <p>The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the files.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_init_server</h4>

<p><a name="shishi_005finit_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_init_server</b> (<var>Shishi ** handle</var>)<var><a name="index-shishi_005finit_005fserver-153"></a></var><br>
<blockquote><p><var>handle</var>: pointer to handle to be created.

        <p>Create a Shishi library handle, using <code>shishi_server()</code>, and read the
system configuration file.  The paths to the system configuration
file is decided at compile time, and is $sysconfdir/shishi.conf.

        <p>The handle is allocated regardless of return values, except for
SHISHI_HANDLE_ERROR which indicates a problem allocating the
handle.  (The other error conditions comes from reading the file.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_init_server_with_paths</h4>

<p><a name="shishi_005finit_005fserver_005fwith_005fpaths"></a>

<div class="defun">
&mdash; Function: int <b>shishi_init_server_with_paths</b> (<var>Shishi ** handle, const char * systemcfgfile</var>)<var><a name="index-shishi_005finit_005fserver_005fwith_005fpaths-154"></a></var><br>
<blockquote><p><var>handle</var>: pointer to handle to be created.

        <p><var>systemcfgfile</var>: Filename of system configuration, or NULL.

        <p>Create a Shishi library handle, using <code>shishi_server()</code>, and read the
system configuration file from specified location.  The paths to
the system configuration file is decided at compile time, and is
$sysconfdir/shishi.conf.  The handle is allocated regardless of
return values, except for SHISHI_HANDLE_ERROR which indicates a
problem allocating the handle.  (The other error conditions comes
from reading the file.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg</h4>

<p><a name="shishi_005fcfg"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg</b> (<var>Shishi * handle, const char * option</var>)<var><a name="index-shishi_005fcfg-155"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>option</var>: string with shishi library option.

        <p>Configure shishi library with given option.

        <p><strong>Return Value:</strong> Returns SHISHI_OK if option was valid. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_from_file</h4>

<p><a name="shishi_005fcfg_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg_from_file</b> (<var>Shishi * handle, const char * cfg</var>)<var><a name="index-shishi_005fcfg_005ffrom_005ffile-156"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>cfg</var>: filename to read configuration from.

        <p>Configure shishi library using configuration file.

        <p><strong>Return Value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_print</h4>

<p><a name="shishi_005fcfg_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg_print</b> (<var>Shishi * handle, FILE * fh</var>)<var><a name="index-shishi_005fcfg_005fprint-157"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>fh</var>: file descriptor opened for writing.

        <p>Print library configuration status, mostly for debugging purposes.

        <p><strong>Return Value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_default_systemfile</h4>

<p><a name="shishi_005fcfg_005fdefault_005fsystemfile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_cfg_default_systemfile</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fcfg_005fdefault_005fsystemfile-158"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>The system configuration file name is decided at compile-time, but
may be overridden by the environment variable SHISHI_CONFIG.

        <p><strong>Return value:</strong> Return system configuration file name. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_default_userdirectory</h4>

<p><a name="shishi_005fcfg_005fdefault_005fuserdirectory"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_cfg_default_userdirectory</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fcfg_005fdefault_005fuserdirectory-159"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>The default user directory (used for, e.g. Shishi ticket cache) is
normally computed by appending BASE_DIR ("/.shishi") to the content
of the environment variable $HOME, but can be overridden by
specifying the complete path in the environment variable
SHISHI_HOME.

        <p><strong>Return value:</strong> Return directory with configuration files etc. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_userdirectory_file</h4>

<p><a name="shishi_005fcfg_005fuserdirectory_005ffile"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_cfg_userdirectory_file</b> (<var>Shishi * handle, const char * file</var>)<var><a name="index-shishi_005fcfg_005fuserdirectory_005ffile-160"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>file</var>: basename of file to find in user directory.

        <p>Get the full path to specified <code>file</code> in the users' configuration
directory.

        <p><strong>Return value:</strong> Return full path to given relative filename, relative
to the user specific Shishi configuration directory as returned
by <code>shishi_cfg_default_userdirectory()</code> (typically $HOME/.shishi). 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_default_userfile</h4>

<p><a name="shishi_005fcfg_005fdefault_005fuserfile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_cfg_default_userfile</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fcfg_005fdefault_005fuserfile-161"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get filename of default user configuration file, typically
$HOME/shishi.conf.

        <p><strong>Return value:</strong> Return user configuration filename. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_clientkdcetype</h4>

<p><a name="shishi_005fcfg_005fclientkdcetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg_clientkdcetype</b> (<var>Shishi * handle, int32_t ** etypes</var>)<var><a name="index-shishi_005fcfg_005fclientkdcetype-162"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>etypes</var>: output array with encryption types.

        <p>Set the etypes variable to the array of preferred client etypes.

        <p><strong>Return value:</strong> Return the number of encryption types in the array,
0 means none. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_clientkdcetype_fast</h4>

<p><a name="shishi_005fcfg_005fclientkdcetype_005ffast"></a>

<div class="defun">
&mdash; Function: int32_t <b>shishi_cfg_clientkdcetype_fast</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fcfg_005fclientkdcetype_005ffast-163"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Extract the default etype from the list of preferred client etypes.

        <p><strong>Return value:</strong> Return the default encryption types. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_clientkdcetype_set</h4>

<p><a name="shishi_005fcfg_005fclientkdcetype_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg_clientkdcetype_set</b> (<var>Shishi * handle, char * value</var>)<var><a name="index-shishi_005fcfg_005fclientkdcetype_005fset-164"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>value</var>: string with encryption types.

        <p>Set the "client-kdc-etypes" configuration option from given string. 
The string contains encryption types (integer or names) separated
by comma or whitespace, e.g. "aes256-cts-hmac-sha1-96
des3-cbc-sha1-kd des-cbc-md5".

        <p><strong>Return value:</strong> Return SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_cfg_authorizationtype_set</h4>

<p><a name="shishi_005fcfg_005fauthorizationtype_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cfg_authorizationtype_set</b> (<var>Shishi * handle, char * value</var>)<var><a name="index-shishi_005fcfg_005fauthorizationtype_005fset-165"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>value</var>: string with authorization types.

        <p>Set the "authorization-types" configuration option from given string. 
The string contains authorization types (integer or names) separated
by comma or whitespace, e.g. "basic k5login".

        <p><strong>Return value:</strong> Return SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="Ticket-Set-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Initialization-Functions">Initialization Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.3 Ticket Set Functions</h3>

<p>A &ldquo;ticket set&rdquo; is, as the name implies, a collection of tickets. 
Functions are provided to read tickets from file into a ticket set, to
query number of tickets in the set, to extract a given ticket from the
set, to search the ticket set for tickets matching certain criterium,
to write the ticket set to a file, etc.  High level functions for
performing a initial authentication (see <a href="#AS-Functions">AS Functions</a>) or
subsequent authentication (see <a href="#TGS-Functions">TGS Functions</a>) and storing the new
ticket in the ticket set are also provided.

   <p>To manipulate each individual ticket, See <a href="#Ticket-Functions">Ticket Functions</a>.  For
low-level ASN.1 manipulation see See <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a>.

<h4 class="subheading">shishi_tkts_default_file_guess</h4>

<p><a name="shishi_005ftkts_005fdefault_005ffile_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_tkts_default_file_guess</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ftkts_005fdefault_005ffile_005fguess-166"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Guesses the default ticket filename; it is $SHISHI_TICKETS,
$SHISHI_HOME/tickets, or $HOME/.shishi/tickets.

        <p><strong>Return value:</strong> Returns default tkts filename as a string that
has to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_default_file</h4>

<p><a name="shishi_005ftkts_005fdefault_005ffile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_tkts_default_file</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ftkts_005fdefault_005ffile-167"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get filename of default ticket set.

        <p><strong>Return value:</strong> Returns the default ticket set filename used in the
library.  The string is not a copy, so don't modify or deallocate
it. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_default_file_set</h4>

<p><a name="shishi_005ftkts_005fdefault_005ffile_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkts_default_file_set</b> (<var>Shishi * handle, const char * tktsfile</var>)<var><a name="index-shishi_005ftkts_005fdefault_005ffile_005fset-168"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>tktsfile</var>: string with new default tkts file name, or
NULL to reset to default.

        <p>Set the default ticket set filename used in the library.  The
string is copied into the library, so you can dispose of the
variable immediately after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_default</h4>

<p><a name="shishi_005ftkts_005fdefault"></a>

<div class="defun">
&mdash; Function: Shishi_tkts * <b>shishi_tkts_default</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ftkts_005fdefault-169"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get the default ticket set for library handle.

        <p><strong>Return value:</strong> Return the handle global ticket set. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts</h4>

<p><a name="shishi_005ftkts"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts</b> (<var>Shishi * handle, Shishi_tkts ** tkts</var>)<var><a name="index-shishi_005ftkts-170"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>tkts</var>: output pointer to newly allocated tkts handle.

        <p>Get a new ticket set handle.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_done</h4>

<p><a name="shishi_005ftkts_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkts_done</b> (<var>Shishi_tkts ** tkts</var>)<var><a name="index-shishi_005ftkts_005fdone-171"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p>Deallocates all resources associated with ticket set.  The ticket
set handle must not be used in calls to other shishi_tkts_*()
functions after this. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_size</h4>

<p><a name="shishi_005ftkts_005fsize"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_size</b> (<var>Shishi_tkts * tkts</var>)<var><a name="index-shishi_005ftkts_005fsize-172"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p>Get size of ticket set.

        <p><strong>Return value:</strong> Returns number of tickets stored in ticket set. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_nth</h4>

<p><a name="shishi_005ftkts_005fnth"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_nth</b> (<var>Shishi_tkts * tkts, int ticketno</var>)<var><a name="index-shishi_005ftkts_005fnth-173"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>ticketno</var>: integer indicating requested ticket in ticket set.

        <p><strong>Get the n:</strong> th ticket in ticket set.

        <p><strong>Return value:</strong> Returns a ticket handle to the ticketno:th ticket in
the ticket set, or NULL if ticket set is invalid or ticketno is
out of bounds.  The first ticket is ticketno 0, the second
ticketno 1, and so on. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_remove</h4>

<p><a name="shishi_005ftkts_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_remove</b> (<var>Shishi_tkts * tkts, int ticketno</var>)<var><a name="index-shishi_005ftkts_005fremove-174"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>ticketno</var>: ticket number of ticket in the set to remove.  The first
ticket is ticket number 0.

        <p>Remove a ticket, indexed by <code>ticketno</code>, in ticket set.

        <p><strong>Return value:</strong> Returns SHISHI_OK if succesful or if ticketno larger
than size of ticket set. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_add</h4>

<p><a name="shishi_005ftkts_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_add</b> (<var>Shishi_tkts * tkts, Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkts_005fadd-175"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>tkt</var>: ticket to be added to ticket set.

        <p>Add a ticket to the ticket set.  Only the pointer is stored, so if
you modify <code>tkt</code>, the ticket in the ticket set will also be
modified.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_new</h4>

<p><a name="shishi_005ftkts_005fnew"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_new</b> (<var>Shishi_tkts * tkts, Shishi_asn1 ticket, Shishi_asn1 enckdcreppart, Shishi_asn1 kdcrep</var>)<var><a name="index-shishi_005ftkts_005fnew-176"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>ticket</var>: input ticket variable.

        <p><var>enckdcreppart</var>: input ticket detail variable.

        <p><var>kdcrep</var>: input KDC-REP variable.

        <p>Allocate a new ticket and add it to the ticket set.

        <p>Note that <code>ticket</code>, <code>enckdcreppart</code> and <code>kdcrep</code> are stored by
reference, so you must not de-allocate them before the ticket is
removed from the ticket set and de-allocated.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_read</h4>

<p><a name="shishi_005ftkts_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_read</b> (<var>Shishi_tkts * tkts, FILE * fh</var>)<var><a name="index-shishi_005ftkts_005fread-177"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>fh</var>: file descriptor to read from.

        <p>Read tickets from file descriptor and add them to the ticket set.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_from_file</h4>

<p><a name="shishi_005ftkts_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_from_file</b> (<var>Shishi_tkts * tkts, const char * filename</var>)<var><a name="index-shishi_005ftkts_005ffrom_005ffile-178"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>filename</var>: filename to read tickets from.

        <p>Read tickets from file and add them to the ticket set.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_write</h4>

<p><a name="shishi_005ftkts_005fwrite"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_write</b> (<var>Shishi_tkts * tkts, FILE * fh</var>)<var><a name="index-shishi_005ftkts_005fwrite-179"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>fh</var>: file descriptor to write tickets to.

        <p>Write tickets in set to file descriptor.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_expire</h4>

<p><a name="shishi_005ftkts_005fexpire"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_expire</b> (<var>Shishi_tkts * tkts</var>)<var><a name="index-shishi_005ftkts_005fexpire-180"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p>Remove expired tickets from ticket set.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_to_file</h4>

<p><a name="shishi_005ftkts_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_to_file</b> (<var>Shishi_tkts * tkts, const char * filename</var>)<var><a name="index-shishi_005ftkts_005fto_005ffile-181"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>filename</var>: filename to write tickets to.

        <p>Write tickets in set to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_print_for_service</h4>

<p><a name="shishi_005ftkts_005fprint_005ffor_005fservice"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_print_for_service</b> (<var>Shishi_tkts * tkts, FILE * fh, const char * service</var>)<var><a name="index-shishi_005ftkts_005fprint_005ffor_005fservice-182"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>fh</var>: file descriptor to print to.

        <p><var>service</var>: service to limit tickets printed to, or NULL.

        <p>Print description of tickets for specified service to file
descriptor.  If service is NULL, all tickets are printed.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_print</h4>

<p><a name="shishi_005ftkts_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkts_print</b> (<var>Shishi_tkts * tkts, FILE * fh</var>)<var><a name="index-shishi_005ftkts_005fprint-183"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>fh</var>: file descriptor to print to.

        <p>Print description of all tickets to file descriptor.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_match_p</h4>

<p><a name="shishi_005ftkt_005fmatch_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_match_p</b> (<var>Shishi_tkt * tkt, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005ftkt_005fmatch_005fp-184"></a></var><br>
<blockquote><p><var>tkt</var>: ticket to test hints on.

        <p><var>hint</var>: structure with characteristics of ticket to be found.

        <p>Test if a ticket matches specified hints.

        <p><strong>Return value:</strong> Returns 0 iff ticket fails to match given criteria. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_find</h4>

<p><a name="shishi_005ftkts_005ffind"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_find</b> (<var>Shishi_tkts * tkts, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005ftkts_005ffind-185"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>hint</var>: structure with characteristics of ticket to be found.

        <p>Search the ticketset sequentially (from ticket number 0 through all
tickets in the set) for a ticket that fits the given
characteristics.  If a ticket is found, the hint-&gt;startpos field is
updated to point to the next ticket in the set, so this function
can be called repeatedly with the same hint argument in order to
find all tickets matching a certain criterium.  Note that if
tickets are added to, or removed from, the ticketset during a query
with the same hint argument, the hint-&gt;startpos field must be
updated appropriately.

        <p><strong>Here is how you would typically use this function:</strong>
Shishi_tkts_hint  hint;

        <p>Shishi_tkt  tkt;

        <p>memset(&amp;hint, 0, sizeof(hint));

        <p>hint.server = "imap/mail.example.org";

        <p>tkt = shishi_tkts_find (shishi_tkts_default(handle), &amp;hint);

        <p>if (!tkt)

        <p>printf("No ticket found...\n");

        <p>else

        <p>do_something_with_ticket (tkt);

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL if no further
matching tickets could be found. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_find_for_clientserver</h4>

<p><a name="shishi_005ftkts_005ffind_005ffor_005fclientserver"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_find_for_clientserver</b> (<var>Shishi_tkts * tkts, const char * client, const char * server</var>)<var><a name="index-shishi_005ftkts_005ffind_005ffor_005fclientserver-186"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>client</var>: client name to find ticket for.

        <p><var>server</var>: server name to find ticket for.

        <p>Short-hand function for searching the ticket set for a ticket for
the given client and server.  See <code>shishi_tkts_find()</code>.

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_find_for_server</h4>

<p><a name="shishi_005ftkts_005ffind_005ffor_005fserver"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_find_for_server</b> (<var>Shishi_tkts * tkts, const char * server</var>)<var><a name="index-shishi_005ftkts_005ffind_005ffor_005fserver-187"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>server</var>: server name to find ticket for.

        <p>Short-hand function for searching the ticket set for a ticket for
the given server using the default client principal.  See
<code>shishi_tkts_find_for_clientserver()</code> and <code>shishi_tkts_find()</code>.

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_get_tgt</h4>

<p><a name="shishi_005ftkts_005fget_005ftgt"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_get_tgt</b> (<var>Shishi_tkts * tkts, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005ftkts_005fget_005ftgt-188"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>hint</var>: structure with characteristics of ticket to begot.

        <p>Get a ticket granting ticket (TGT) suitable for acquiring ticket
matching the hint.  I.e., get a TGT for the server realm in the
hint structure (hint-&gt;serverrealm), or the default realm if the
serverrealm field is NULL.  Can result in AS exchange.

        <p>Currently this function do not implement cross realm logic.

        <p>This function is used by <code>shishi_tkts_get()</code>, which is probably what
you really want to use unless you have special needs.

        <p><strong>Return value:</strong> Returns a ticket granting ticket if successful, or
NULL if this function is unable to acquire on. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_get_tgs</h4>

<p><a name="shishi_005ftkts_005fget_005ftgs"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_get_tgs</b> (<var>Shishi_tkts * tkts, Shishi_tkts_hint * hint, Shishi_tkt * tgt</var>)<var><a name="index-shishi_005ftkts_005fget_005ftgs-189"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>hint</var>: structure with characteristics of ticket to begot.

        <p><var>tgt</var>: ticket granting ticket to use.

        <p>Get a ticket via TGS exchange using specified ticket granting
ticket.

        <p>This function is used by <code>shishi_tkts_get()</code>, which is probably what
you really want to use unless you have special needs.

        <p><strong>Return value:</strong> Returns a ticket if successful, or NULL if this
function is unable to acquire on. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_get</h4>

<p><a name="shishi_005ftkts_005fget"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_get</b> (<var>Shishi_tkts * tkts, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005ftkts_005fget-190"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>hint</var>: structure with characteristics of ticket to begot.

        <p>Get a ticket matching given characteristics.  This function first
looks in the ticket set for the ticket, then tries to find a
suitable TGT, possibly via an AS exchange, using
<code>shishi_tkts_get_tgt()</code>, and then use that TGT in a TGS exchange to
get the ticket.

        <p>Currently this function do not implement cross realm logic.

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL if this function
is unable to get the ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_get_for_clientserver</h4>

<p><a name="shishi_005ftkts_005fget_005ffor_005fclientserver"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_get_for_clientserver</b> (<var>Shishi_tkts * tkts, const char * client, const char * server</var>)<var><a name="index-shishi_005ftkts_005fget_005ffor_005fclientserver-191"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>client</var>: client name to get ticket for.

        <p><var>server</var>: server name to get ticket for.

        <p>Short-hand function for getting a ticket for the given client and
server.  See <code>shishi_tkts_get()</code>.

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkts_get_for_server</h4>

<p><a name="shishi_005ftkts_005fget_005ffor_005fserver"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkts_get_for_server</b> (<var>Shishi_tkts * tkts, const char * server</var>)<var><a name="index-shishi_005ftkts_005fget_005ffor_005fserver-192"></a></var><br>
<blockquote><p><var>tkts</var>: ticket set handle as allocated by <code>shishi_tkts()</code>.

        <p><var>server</var>: server name to get ticket for.

        <p>Short-hand function for getting a ticket for the given server and
the default principal client.  See <code>shishi_tkts_get()</code>.

        <p><strong>Return value:</strong> Returns a ticket if found, or NULL. 
</p></blockquote></div>

<div class="node">
<a name="AP-REQ-and-AP-REP-Functions"></a>
<a name="AP_002dREQ-and-AP_002dREP-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ticket-Set-Functions">Ticket Set Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.4 AP-REQ and AP-REP Functions</h3>

<p>The &ldquo;AP-REQ&rdquo; and &ldquo;AP-REP&rdquo; are ASN.1 structures used by application
client and servers to prove to each other who they are.  The
structures contain auxilliary information, together with an
authenticator (see <a href="#Authenticator-Functions">Authenticator Functions</a>) which is the real
cryptographic proof.  The following illustrates the AP-REQ and AP-REP
ASN.1 structures.

<pre class="verbatim">AP-REQ		::= [APPLICATION 14] SEQUENCE {
	pvno		[0] INTEGER (5),
	msg-type	[1] INTEGER (14),
	ap-options	[2] APOptions,
	ticket		[3] Ticket,
	authenticator	[4] EncryptedData {Authenticator,
				{ keyuse-pa-TGSReq-authenticator
				  | keyuse-APReq-authenticator }}
}

AP-REP		::= [APPLICATION 15] SEQUENCE {
	pvno		[0] INTEGER (5),
	msg-type	[1] INTEGER (15),
	enc-part	[2] EncryptedData {EncAPRepPart,
				{ keyuse-EncAPRepPart }}
}

EncAPRepPart	::= [APPLICATION 27] SEQUENCE {
	ctime		[0] KerberosTime,
	cusec		[1] Microseconds,
	subkey		[2] EncryptionKey OPTIONAL,
	seq-number	[3] UInt32 OPTIONAL
}
</pre>

<h4 class="subheading">shishi_ap</h4>

<p><a name="shishi_005fap"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap</b> (<var>Shishi * handle, Shishi_ap ** ap</var>)<var><a name="index-shishi_005fap-193"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p>Create a new AP exchange with a random subkey of the default
encryption type from configuration.  Note that there is no
guarantee that the receiver will understand that key type, you
should probably use <code>shishi_ap_etype()</code> or <code>shishi_ap_nosubkey()</code>
instead.  In the future, this function will likely behave as
<code>shishi_ap_nosubkey()</code> and <code>shishi_ap_nosubkey()</code> will be removed.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_etype</h4>

<p><a name="shishi_005fap_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_etype</b> (<var>Shishi * handle, Shishi_ap ** ap, int etype</var>)<var><a name="index-shishi_005fap_005fetype-194"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>etype</var>: encryption type of newly generated random subkey.

        <p>Create a new AP exchange with a random subkey of indicated
encryption type.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_nosubkey</h4>

<p><a name="shishi_005fap_005fnosubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_nosubkey</b> (<var>Shishi * handle, Shishi_ap ** ap</var>)<var><a name="index-shishi_005fap_005fnosubkey-195"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p>Create a new AP exchange without subkey in authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_done</h4>

<p><a name="shishi_005fap_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_done</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005fdone-196"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Deallocate resources associated with AP exchange.  This should be
called by the application when it no longer need to utilize the AP
exchange handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_set_tktoptions</h4>

<p><a name="shishi_005fap_005fset_005ftktoptions"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_set_tktoptions</b> (<var>Shishi_ap * ap, Shishi_tkt * tkt, int options</var>)<var><a name="index-shishi_005fap_005fset_005ftktoptions-197"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in AP.

        <p><var>options</var>: AP-REQ options to set in AP.

        <p>Set the ticket (see <code>shishi_ap_tkt_set()</code>) and set the AP-REQ
apoptions (see <code>shishi_apreq_options_set()</code>).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_set_tktoptionsdata</h4>

<p><a name="shishi_005fap_005fset_005ftktoptionsdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_set_tktoptionsdata</b> (<var>Shishi_ap * ap, Shishi_tkt * tkt, int options, const char * data, size_t len</var>)<var><a name="index-shishi_005fap_005fset_005ftktoptionsdata-198"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in AP.

        <p><var>options</var>: AP-REQ options to set in AP.

        <p><var>data</var>: input array with data to checksum in Authenticator.

        <p><var>len</var>: length of input array with data to checksum in Authenticator.

        <p>Set the ticket (see <code>shishi_ap_tkt_set()</code>) and set the AP-REQ
apoptions (see <code>shishi_apreq_options_set()</code>) and set the
Authenticator checksum data.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_set_tktoptionsraw</h4>

<p><a name="shishi_005fap_005fset_005ftktoptionsraw"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_set_tktoptionsraw</b> (<var>Shishi_ap * ap, Shishi_tkt * tkt, int options, int32_t cksumtype, const char * data, size_t len</var>)<var><a name="index-shishi_005fap_005fset_005ftktoptionsraw-199"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in AP.

        <p><var>options</var>: AP-REQ options to set in AP.

        <p><var>cksumtype</var>: authenticator checksum type to set in AP.

        <p><var>data</var>: input array with data to store in checksum field in Authenticator.

        <p><var>len</var>: length of input array with data to store in checksum field in
Authenticator.

        <p>Set the ticket (see <code>shishi_ap_tkt_set()</code>) and set the AP-REQ
apoptions (see <code>shishi_apreq_options_set()</code>) and set the raw
Authenticator checksum data.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_set_tktoptionsasn1usage</h4>

<p><a name="shishi_005fap_005fset_005ftktoptionsasn1usage"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_set_tktoptionsasn1usage</b> (<var>Shishi_ap * ap, Shishi_tkt * tkt, int options, Shishi_asn1 node, const char * field, int authenticatorcksumkeyusage, int authenticatorkeyusage</var>)<var><a name="index-shishi_005fap_005fset_005ftktoptionsasn1usage-200"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in AP.

        <p><var>options</var>: AP-REQ options to set in AP.

        <p><var>node</var>: input ASN.1 structure to store as authenticator checksum data.

        <p><var>field</var>: field in ASN.1 structure to use.

        <p><var>authenticatorcksumkeyusage</var>: key usage for checksum in authenticator.

        <p><var>authenticatorkeyusage</var>: key usage for authenticator.

        <p>Set ticket, options and authenticator checksum data using
<code>shishi_ap_set_tktoptionsdata()</code>.  The authenticator checksum data is
the DER encoding of the ASN.1 field provided.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tktoptions</h4>

<p><a name="shishi_005fap_005ftktoptions"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_tktoptions</b> (<var>Shishi * handle, Shishi_ap ** ap, Shishi_tkt * tkt, int options</var>)<var><a name="index-shishi_005fap_005ftktoptions-201"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in newly created AP.

        <p><var>options</var>: AP-REQ options to set in newly created AP.

        <p>Create a new AP exchange using <code>shishi_ap()</code>, and set the ticket and
AP-REQ apoptions using <code>shishi_ap_set_tktoption()</code>.  A random session
key is added to the authenticator, using the same keytype as the
ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tktoptionsdata</h4>

<p><a name="shishi_005fap_005ftktoptionsdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_tktoptionsdata</b> (<var>Shishi * handle, Shishi_ap ** ap, Shishi_tkt * tkt, int options, const char * data, size_t len</var>)<var><a name="index-shishi_005fap_005ftktoptionsdata-202"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in newly created AP.

        <p><var>options</var>: AP-REQ options to set in newly created AP.

        <p><var>data</var>: input array with data to checksum in Authenticator.

        <p><var>len</var>: length of input array with data to checksum in Authenticator.

        <p>Create a new AP exchange using <code>shishi_ap()</code>, and set the ticket,
AP-REQ apoptions and the Authenticator checksum data using
<code>shishi_ap_set_tktoptionsdata()</code>. A random session key is added to
the authenticator, using the same keytype as the ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tktoptionsraw</h4>

<p><a name="shishi_005fap_005ftktoptionsraw"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_tktoptionsraw</b> (<var>Shishi * handle, Shishi_ap ** ap, Shishi_tkt * tkt, int options, int32_t cksumtype, const char * data, size_t len</var>)<var><a name="index-shishi_005fap_005ftktoptionsraw-203"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in newly created AP.

        <p><var>options</var>: AP-REQ options to set in newly created AP.

        <p><var>cksumtype</var>: authenticator checksum type to set in AP.

        <p><var>data</var>: input array with data to store in checksum field in Authenticator.

        <p><var>len</var>: length of input array with data to store in checksum field in
Authenticator.

        <p>Create a new AP exchange using <code>shishi_ap()</code>, and set the ticket,
AP-REQ apoptions and the raw Authenticator checksum data field
using <code>shishi_ap_set_tktoptionsraw()</code>.  A random session key is added
to the authenticator, using the same keytype as the ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_etype_tktoptionsdata</h4>

<p><a name="shishi_005fap_005fetype_005ftktoptionsdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_etype_tktoptionsdata</b> (<var>Shishi * handle, Shishi_ap ** ap, int32_t etype, Shishi_tkt * tkt, int options, const char * data, size_t len</var>)<var><a name="index-shishi_005fap_005fetype_005ftktoptionsdata-204"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>etype</var>: encryption type of newly generated random subkey.

        <p><var>tkt</var>: ticket to set in newly created AP.

        <p><var>options</var>: AP-REQ options to set in newly created AP.

        <p><var>data</var>: input array with data to checksum in Authenticator.

        <p><var>len</var>: length of input array with data to checksum in Authenticator.

        <p>Create a new AP exchange using <code>shishi_ap()</code>, and set the ticket,
AP-REQ apoptions and the Authenticator checksum data using
<code>shishi_ap_set_tktoptionsdata()</code>. A random session key is added to
the authenticator, using the same keytype as the ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tktoptionsasn1usage</h4>

<p><a name="shishi_005fap_005ftktoptionsasn1usage"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_tktoptionsasn1usage</b> (<var>Shishi * handle, Shishi_ap ** ap, Shishi_tkt * tkt, int options, Shishi_asn1 node, const char * field, int authenticatorcksumkeyusage, int authenticatorkeyusage</var>)<var><a name="index-shishi_005fap_005ftktoptionsasn1usage-205"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ap</var>: pointer to new structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to set in newly created AP.

        <p><var>options</var>: AP-REQ options to set in newly created AP.

        <p><var>node</var>: input ASN.1 structure to store as authenticator checksum data.

        <p><var>field</var>: field in ASN.1 structure to use.

        <p><var>authenticatorcksumkeyusage</var>: key usage for checksum in authenticator.

        <p><var>authenticatorkeyusage</var>: key usage for authenticator.

        <p>Create a new AP exchange using <code>shishi_ap()</code>, and set ticket, options
and authenticator checksum data from the DER encoding of the ASN.1
field using <code>shishi_ap_set_tktoptionsasn1usage()</code>.  A random session
key is added to the authenticator, using the same keytype as the
ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tkt</h4>

<p><a name="shishi_005fap_005ftkt"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_ap_tkt</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005ftkt-206"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get Ticket from AP exchange.

        <p><strong>Return value:</strong> Returns the ticket from the AP exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_tkt_set</h4>

<p><a name="shishi_005fap_005ftkt_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_tkt_set</b> (<var>Shishi_ap * ap, Shishi_tkt * tkt</var>)<var><a name="index-shishi_005fap_005ftkt_005fset-207"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>tkt</var>: ticket to store in AP.

        <p>Set the Ticket in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_cksumdata</h4>

<p><a name="shishi_005fap_005fauthenticator_005fcksumdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_authenticator_cksumdata</b> (<var>Shishi_ap * ap, char * out, size_t * len</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fcksumdata-208"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>out</var>: output array that holds authenticator checksum data.

        <p><var>len</var>: on input, maximum length of output array that holds
authenticator checksum data, on output actual length of
output array that holds authenticator checksum data.

        <p>Get checksum data from Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful, or
SHISHI_TOO_SMALL_BUFFER if buffer provided was too small. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_cksumdata_set</h4>

<p><a name="shishi_005fap_005fauthenticator_005fcksumdata_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_authenticator_cksumdata_set</b> (<var>Shishi_ap * ap, const char * authenticatorcksumdata, size_t authenticatorcksumdatalen</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fcksumdata_005fset-209"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>authenticatorcksumdata</var>: input array with data to compute checksum
on and store in Authenticator in AP-REQ.

        <p><var>authenticatorcksumdatalen</var>: length of input array with data to
compute checksum on and store in Authenticator in AP-REQ.

        <p>Set the Authenticator Checksum Data in the AP exchange.  This is
the data that will be checksumed, and the checksum placed in the
checksum field.  It is not the actual checksum field.  See also
shishi_ap_authenticator_cksumraw_set. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_cksumraw_set</h4>

<p><a name="shishi_005fap_005fauthenticator_005fcksumraw_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_authenticator_cksumraw_set</b> (<var>Shishi_ap * ap, int32_t authenticatorcksumtype, const char * authenticatorcksumraw, size_t authenticatorcksumrawlen</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fcksumraw_005fset-210"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>authenticatorcksumtype</var>: authenticator checksum type to set in AP.

        <p><var>authenticatorcksumraw</var>: input array with authenticator checksum
field value to set in Authenticator in AP-REQ.

        <p><var>authenticatorcksumrawlen</var>: length of input array with
authenticator checksum field value to set in Authenticator in AP-REQ.

        <p>Set the Authenticator Checksum Data in the AP exchange.  This is
the actual checksum field, not data to compute checksum on and then
store in the checksum field.  See also
shishi_ap_authenticator_cksumdata_set. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_cksumtype</h4>

<p><a name="shishi_005fap_005fauthenticator_005fcksumtype"></a>

<div class="defun">
&mdash; Function: int32_t <b>shishi_ap_authenticator_cksumtype</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fcksumtype-211"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get the Authenticator Checksum Type in the AP exchange.

        <p><strong>Return value:</strong> Return the authenticator checksum type. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_cksumtype_set</h4>

<p><a name="shishi_005fap_005fauthenticator_005fcksumtype_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_authenticator_cksumtype_set</b> (<var>Shishi_ap * ap, int32_t cksumtype</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fcksumtype_005fset-212"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>cksumtype</var>: authenticator checksum type to set in AP.

        <p>Set the Authenticator Checksum Type in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator</h4>

<p><a name="shishi_005fap_005fauthenticator"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_ap_authenticator</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005fauthenticator-213"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get ASN.1 Authenticator structure from AP exchange.

        <p><strong>Return value:</strong> Returns the Authenticator from the AP exchange, or
NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_authenticator_set</h4>

<p><a name="shishi_005fap_005fauthenticator_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_authenticator_set</b> (<var>Shishi_ap * ap, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fap_005fauthenticator_005fset-214"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>authenticator</var>: authenticator to store in AP.

        <p>Set the Authenticator in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req</h4>

<p><a name="shishi_005fap_005freq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_ap_req</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005freq-215"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get ASN.1 AP-REQ structure from AP exchange.

        <p><strong>Return value:</strong> Returns the AP-REQ from the AP exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_set</h4>

<p><a name="shishi_005fap_005freq_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_req_set</b> (<var>Shishi_ap * ap, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fap_005freq_005fset-216"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>apreq</var>: apreq to store in AP.

        <p>Set the AP-REQ in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_der</h4>

<p><a name="shishi_005fap_005freq_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_der</b> (<var>Shishi_ap * ap, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fap_005freq_005fder-217"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>out</var>: pointer to output array with der encoding of AP-REQ.

        <p><var>outlen</var>: pointer to length of output array with der encoding of AP-REQ.

        <p>Build AP-REQ using <code>shishi_ap_req_build()</code> and DER encode it.  <code>out</code>
is allocated by this function, and it is the responsibility of
caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_der_set</h4>

<p><a name="shishi_005fap_005freq_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_der_set</b> (<var>Shishi_ap * ap, char * der, size_t derlen</var>)<var><a name="index-shishi_005fap_005freq_005fder_005fset-218"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>der</var>: input array with DER encoded AP-REQ.

        <p><var>derlen</var>: length of input array with DER encoded AP-REQ.

        <p>DER decode AP-REQ and set it AP exchange.  If decoding fails, the
AP-REQ in the AP exchange is lost.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_build</h4>

<p><a name="shishi_005fap_005freq_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_build</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005freq_005fbuild-219"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Checksum data in authenticator and add ticket and authenticator to
AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_decode</h4>

<p><a name="shishi_005fap_005freq_005fdecode"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_decode</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005freq_005fdecode-220"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Decode ticket in AP-REQ and set the Ticket fields in the AP
exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_process_keyusage</h4>

<p><a name="shishi_005fap_005freq_005fprocess_005fkeyusage"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_process_keyusage</b> (<var>Shishi_ap * ap, Shishi_key * key, int32_t keyusage</var>)<var><a name="index-shishi_005fap_005freq_005fprocess_005fkeyusage-221"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>key</var>: cryptographic key used to decrypt ticket in AP-REQ.

        <p><var>keyusage</var>: key usage to use during decryption, for normal
AP-REQ's this is normally SHISHI_KEYUSAGE_APREQ_AUTHENTICATOR,
for AP-REQ's part of TGS-REQ's, this is normally
SHISHI_KEYUSAGE_TGSREQ_APREQ_AUTHENTICATOR.

        <p>Decrypt ticket in AP-REQ using supplied key and decrypt
Authenticator in AP-REQ using key in decrypted ticket, and on
success set the Ticket and Authenticator fields in the AP exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_process</h4>

<p><a name="shishi_005fap_005freq_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_process</b> (<var>Shishi_ap * ap, Shishi_key * key</var>)<var><a name="index-shishi_005fap_005freq_005fprocess-222"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>key</var>: cryptographic key used to decrypt ticket in AP-REQ.

        <p>Decrypt ticket in AP-REQ using supplied key and decrypt
Authenticator in AP-REQ using key in decrypted ticket, and on
success set the Ticket and Authenticator fields in the AP exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_req_asn1</h4>

<p><a name="shishi_005fap_005freq_005fasn1"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_req_asn1</b> (<var>Shishi_ap * ap, Shishi_asn1 * apreq</var>)<var><a name="index-shishi_005fap_005freq_005fasn1-223"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>apreq</var>: output AP-REQ variable.

        <p>Build AP-REQ using <code>shishi_ap_req_build()</code> and return it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_key</h4>

<p><a name="shishi_005fap_005fkey"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_ap_key</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005fkey-224"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Extract the application key from AP.  If subkeys are used, it is
taken from the Authenticator, otherwise the session key is used.

        <p><strong>Return value:</strong> Return application key from AP. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep</h4>

<p><a name="shishi_005fap_005frep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_ap_rep</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005frep-225"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get ASN.1 AP-REP structure from AP exchange.

        <p><strong>Return value:</strong> Returns the AP-REP from the AP exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_set</h4>

<p><a name="shishi_005fap_005frep_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_rep_set</b> (<var>Shishi_ap * ap, Shishi_asn1 aprep</var>)<var><a name="index-shishi_005fap_005frep_005fset-226"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>aprep</var>: aprep to store in AP.

        <p>Set the AP-REP in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_der</h4>

<p><a name="shishi_005fap_005frep_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_der</b> (<var>Shishi_ap * ap, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fap_005frep_005fder-227"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>out</var>: output array with newly allocated DER encoding of AP-REP.

        <p><var>outlen</var>: length of output array with DER encoding of AP-REP.

        <p>Build AP-REP using <code>shishi_ap_rep_build()</code> and DER encode it.  <code>out</code>
is allocated by this function, and it is the responsibility of
caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_der_set</h4>

<p><a name="shishi_005fap_005frep_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_der_set</b> (<var>Shishi_ap * ap, char * der, size_t derlen</var>)<var><a name="index-shishi_005fap_005frep_005fder_005fset-228"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>der</var>: input array with DER encoded AP-REP.

        <p><var>derlen</var>: length of input array with DER encoded AP-REP.

        <p>DER decode AP-REP and set it AP exchange.  If decoding fails, the
AP-REP in the AP exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_build</h4>

<p><a name="shishi_005fap_005frep_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_build</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005frep_005fbuild-229"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Checksum data in authenticator and add ticket and authenticator to
AP-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_asn1</h4>

<p><a name="shishi_005fap_005frep_005fasn1"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_asn1</b> (<var>Shishi_ap * ap, Shishi_asn1 * aprep</var>)<var><a name="index-shishi_005fap_005frep_005fasn1-230"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>aprep</var>: output AP-REP variable.

        <p>Build AP-REP using <code>shishi_ap_rep_build()</code> and return it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_verify</h4>

<p><a name="shishi_005fap_005frep_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_verify</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005frep_005fverify-231"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Verify AP-REP compared to Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_verify_der</h4>

<p><a name="shishi_005fap_005frep_005fverify_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_verify_der</b> (<var>Shishi_ap * ap, char * der, size_t derlen</var>)<var><a name="index-shishi_005fap_005frep_005fverify_005fder-232"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>der</var>: input array with DER encoded AP-REP.

        <p><var>derlen</var>: length of input array with DER encoded AP-REP.

        <p>DER decode AP-REP and set it in AP exchange using
<code>shishi_ap_rep_der_set()</code> and verify it using <code>shishi_ap_rep_verify()</code>.

        <p><strong>Return value:</strong> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_rep_verify_asn1</h4>

<p><a name="shishi_005fap_005frep_005fverify_005fasn1"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ap_rep_verify_asn1</b> (<var>Shishi_ap * ap, Shishi_asn1 aprep</var>)<var><a name="index-shishi_005fap_005frep_005fverify_005fasn1-233"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>aprep</var>: input AP-REP.

        <p>Set the AP-REP in the AP exchange using <code>shishi_ap_rep_set()</code> and
verify it using <code>shishi_ap_rep_verify()</code>.

        <p><strong>Return value:</strong> Returns SHISHI_OK, SHISHI_APREP_VERIFY_FAILED or an
error. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_encapreppart</h4>

<p><a name="shishi_005fap_005fencapreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_ap_encapreppart</b> (<var>Shishi_ap * ap</var>)<var><a name="index-shishi_005fap_005fencapreppart-234"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p>Get ASN.1 EncAPRepPart structure from AP exchange.

        <p><strong>Return value:</strong> Returns the EncAPREPPart from the AP exchange, or
NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_encapreppart_set</h4>

<p><a name="shishi_005fap_005fencapreppart_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_ap_encapreppart_set</b> (<var>Shishi_ap * ap, Shishi_asn1 encapreppart</var>)<var><a name="index-shishi_005fap_005fencapreppart_005fset-235"></a></var><br>
<blockquote><p><var>ap</var>: structure that holds information about AP exchange

        <p><var>encapreppart</var>: EncAPRepPart to store in AP.

        <p>Set the EncAPRepPart in the AP exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_option2string</h4>

<p><a name="shishi_005fap_005foption2string"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_ap_option2string</b> (<var>Shishi_apoptions option</var>)<var><a name="index-shishi_005fap_005foption2string-236"></a></var><br>
<blockquote><p><var>option</var>: enumerated AP-Option type, see Shishi_apoptions.

        <p>Convert AP-Option type to AP-Option name string.  Note that <code>option</code>
must be just one of the AP-Option types, it cannot be an binary
ORed indicating several AP-Options.

        <p><strong>Return value:</strong> Returns static string with name of AP-Option that
must not be deallocated, or "unknown" if AP-Option was not understood. 
</p></blockquote></div>

<h4 class="subheading">shishi_ap_string2option</h4>

<p><a name="shishi_005fap_005fstring2option"></a>

<div class="defun">
&mdash; Function: Shishi_apoptions <b>shishi_ap_string2option</b> (<var>const char * str</var>)<var><a name="index-shishi_005fap_005fstring2option-237"></a></var><br>
<blockquote><p><var>str</var>: zero terminated character array with name of AP-Option,
e.g. "use-session-key".

        <p>Convert AP-Option name to AP-Option type.

        <p><strong>Return value:</strong> Returns enumerated type member corresponding to AP-Option,
or 0 if string was not understood. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq</h4>

<p><a name="shishi_005fapreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_apreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fapreq-238"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new AP-REQ, populated with some default
values.

        <p><strong>Return value:</strong> Returns the AP-REQ or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_print</h4>

<p><a name="shishi_005fapreq_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fapreq_005fprint-239"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>apreq</var>: AP-REQ to print.

        <p>Print ASCII armored DER encoding of AP-REQ to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_save</h4>

<p><a name="shishi_005fapreq_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fapreq_005fsave-240"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>apreq</var>: AP-REQ to save.

        <p>Save DER encoding of AP-REQ to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_to_file</h4>

<p><a name="shishi_005fapreq_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_to_file</b> (<var>Shishi * handle, Shishi_asn1 apreq, int filetype, const char * filename</var>)<var><a name="index-shishi_005fapreq_005fto_005ffile-241"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write AP-REQ to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_parse</h4>

<p><a name="shishi_005fapreq_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * apreq</var>)<var><a name="index-shishi_005fapreq_005fparse-242"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>apreq</var>: output variable with newly allocated AP-REQ.

        <p>Read ASCII armored DER encoded AP-REQ from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_read</h4>

<p><a name="shishi_005fapreq_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * apreq</var>)<var><a name="index-shishi_005fapreq_005fread-243"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>apreq</var>: output variable with newly allocated AP-REQ.

        <p>Read DER encoded AP-REQ from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_from_file</h4>

<p><a name="shishi_005fapreq_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_from_file</b> (<var>Shishi * handle, Shishi_asn1 * apreq, int filetype, const char * filename</var>)<var><a name="index-shishi_005fapreq_005ffrom_005ffile-244"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: output variable with newly allocated AP-REQ.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read AP-REQ from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_set_authenticator</h4>

<p><a name="shishi_005fapreq_005fset_005fauthenticator"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_set_authenticator</b> (<var>Shishi * handle, Shishi_asn1 apreq, int32_t etype, uint32_t kvno, const char * buf, size_t buflen</var>)<var><a name="index-shishi_005fapreq_005fset_005fauthenticator-245"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ to add authenticator field to.

        <p><var>etype</var>: encryption type used to encrypt authenticator.

        <p><var>kvno</var>: version of the key used to encrypt authenticator.

        <p><var>buf</var>: input array with encrypted authenticator.

        <p><var>buflen</var>: size of input array with encrypted authenticator.

        <p>Set the encrypted authenticator field in the AP-REP.  The encrypted
data is usually created by calling <code>shishi_encrypt()</code> on the DER
encoded authenticator.  To save time, you may want to use
<code>shishi_apreq_add_authenticator()</code> instead, which calculates the
encrypted data and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK on success. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_add_authenticator</h4>

<p><a name="shishi_005fapreq_005fadd_005fauthenticator"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_add_authenticator</b> (<var>Shishi * handle, Shishi_asn1 apreq, Shishi_key * key, int keyusage, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fapreq_005fadd_005fauthenticator-246"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ to add authenticator field to.

        <p><var>key</var>: key to to use for encryption.

        <p><var>keyusage</var>: cryptographic key usage value to use in encryption.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Encrypts DER encoded authenticator using key and store it in the
AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_set_ticket</h4>

<p><a name="shishi_005fapreq_005fset_005fticket"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_set_ticket</b> (<var>Shishi * handle, Shishi_asn1 apreq, Shishi_asn1 ticket</var>)<var><a name="index-shishi_005fapreq_005fset_005fticket-247"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ to add ticket field to.

        <p><var>ticket</var>: input ticket to copy into AP-REQ ticket field.

        <p>Copy ticket into AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_options</h4>

<p><a name="shishi_005fapreq_005foptions"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_options</b> (<var>Shishi * handle, Shishi_asn1 apreq, uint32_t * flags</var>)<var><a name="index-shishi_005fapreq_005foptions-248"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ to get options from.

        <p><var>flags</var>: Output integer containing options from AP-REQ.

        <p>Extract the AP-Options from AP-REQ into output integer.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_use_session_key_p</h4>

<p><a name="shishi_005fapreq_005fuse_005fsession_005fkey_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_use_session_key_p</b> (<var>Shishi * handle, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fapreq_005fuse_005fsession_005fkey_005fp-249"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ as allocated by <code>shishi_apreq()</code>.

        <p>Return non-0 iff the "Use session key" option is set in the AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_mutual_required_p</h4>

<p><a name="shishi_005fapreq_005fmutual_005frequired_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_mutual_required_p</b> (<var>Shishi * handle, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fapreq_005fmutual_005frequired_005fp-250"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ as allocated by <code>shishi_apreq()</code>.

        <p>Return non-0 iff the "Mutual required" option is set in the AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_options_set</h4>

<p><a name="shishi_005fapreq_005foptions_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_options_set</b> (<var>Shishi * handle, Shishi_asn1 apreq, uint32_t options</var>)<var><a name="index-shishi_005fapreq_005foptions_005fset-251"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ as allocated by <code>shishi_apreq()</code>.

        <p><var>options</var>: Options to set in AP-REQ.

        <p>Set the AP-Options in AP-REQ to indicate integer.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_options_add</h4>

<p><a name="shishi_005fapreq_005foptions_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_options_add</b> (<var>Shishi * handle, Shishi_asn1 apreq, uint32_t option</var>)<var><a name="index-shishi_005fapreq_005foptions_005fadd-252"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ as allocated by <code>shishi_apreq()</code>.

        <p><var>option</var>: Options to add in AP-REQ.

        <p>Add the AP-Options in AP-REQ.  Options not set in input parameter
<code>option</code> are preserved in the AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_options_remove</h4>

<p><a name="shishi_005fapreq_005foptions_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_options_remove</b> (<var>Shishi * handle, Shishi_asn1 apreq, uint32_t option</var>)<var><a name="index-shishi_005fapreq_005foptions_005fremove-253"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ as allocated by <code>shishi_apreq()</code>.

        <p><var>option</var>: Options to remove from AP-REQ.

        <p>Remove the AP-Options from AP-REQ.  Options not set in input
parameter <code>option</code> are preserved in the AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_get_authenticator_etype</h4>

<p><a name="shishi_005fapreq_005fget_005fauthenticator_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_get_authenticator_etype</b> (<var>Shishi * handle, Shishi_asn1 apreq, int32_t * etype</var>)<var><a name="index-shishi_005fapreq_005fget_005fauthenticator_005fetype-254"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ variable to get value from.

        <p><var>etype</var>: output variable that holds the value.

        <p>Extract AP-REQ.authenticator.etype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_apreq_get_ticket</h4>

<p><a name="shishi_005fapreq_005fget_005fticket"></a>

<div class="defun">
&mdash; Function: int <b>shishi_apreq_get_ticket</b> (<var>Shishi * handle, Shishi_asn1 apreq, Shishi_asn1 * ticket</var>)<var><a name="index-shishi_005fapreq_005fget_005fticket-255"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>apreq</var>: AP-REQ variable to get ticket from.

        <p><var>ticket</var>: output variable to hold extracted ticket.

        <p>Extract ticket from AP-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep</h4>

<p><a name="shishi_005faprep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_aprep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005faprep-256"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new AP-REP, populated with some default
values.

        <p><strong>Return value:</strong> Returns the authenticator or NULL on
failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_print</h4>

<p><a name="shishi_005faprep_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 aprep</var>)<var><a name="index-shishi_005faprep_005fprint-257"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>aprep</var>: AP-REP to print.

        <p>Print ASCII armored DER encoding of AP-REP to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_save</h4>

<p><a name="shishi_005faprep_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 aprep</var>)<var><a name="index-shishi_005faprep_005fsave-258"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>aprep</var>: AP-REP to save.

        <p>Save DER encoding of AP-REP to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_to_file</h4>

<p><a name="shishi_005faprep_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_to_file</b> (<var>Shishi * handle, Shishi_asn1 aprep, int filetype, const char * filename</var>)<var><a name="index-shishi_005faprep_005fto_005ffile-259"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>aprep</var>: AP-REP to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write AP-REP to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_parse</h4>

<p><a name="shishi_005faprep_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * aprep</var>)<var><a name="index-shishi_005faprep_005fparse-260"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>aprep</var>: output variable with newly allocated AP-REP.

        <p>Read ASCII armored DER encoded AP-REP from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_read</h4>

<p><a name="shishi_005faprep_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * aprep</var>)<var><a name="index-shishi_005faprep_005fread-261"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>aprep</var>: output variable with newly allocated AP-REP.

        <p>Read DER encoded AP-REP from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_from_file</h4>

<p><a name="shishi_005faprep_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_from_file</b> (<var>Shishi * handle, Shishi_asn1 * aprep, int filetype, const char * filename</var>)<var><a name="index-shishi_005faprep_005ffrom_005ffile-262"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>aprep</var>: output variable with newly allocated AP-REP.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read AP-REP from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aprep_get_enc_part_etype</h4>

<p><a name="shishi_005faprep_005fget_005fenc_005fpart_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aprep_get_enc_part_etype</b> (<var>Shishi * handle, Shishi_asn1 aprep, int32_t * etype</var>)<var><a name="index-shishi_005faprep_005fget_005fenc_005fpart_005fetype-263"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>aprep</var>: AP-REP variable to get value from.

        <p><var>etype</var>: output variable that holds the value.

        <p>Extract AP-REP.enc-part.etype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart</h4>

<p><a name="shishi_005fencapreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_encapreppart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fencapreppart-264"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new EncAPRepPart, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields.

        <p><strong>Return value:</strong> Returns the encapreppart or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_print</h4>

<p><a name="shishi_005fencapreppart_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 encapreppart</var>)<var><a name="index-shishi_005fencapreppart_005fprint-265"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>encapreppart</var>: EncAPRepPart to print.

        <p>Print ASCII armored DER encoding of EncAPRepPart to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_save</h4>

<p><a name="shishi_005fencapreppart_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 encapreppart</var>)<var><a name="index-shishi_005fencapreppart_005fsave-266"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>encapreppart</var>: EncAPRepPart to save.

        <p>Save DER encoding of EncAPRepPart to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_to_file</h4>

<p><a name="shishi_005fencapreppart_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_to_file</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, int filetype, const char * filename</var>)<var><a name="index-shishi_005fencapreppart_005fto_005ffile-267"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write EncAPRepPart to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_parse</h4>

<p><a name="shishi_005fencapreppart_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * encapreppart</var>)<var><a name="index-shishi_005fencapreppart_005fparse-268"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>encapreppart</var>: output variable with newly allocated EncAPRepPart.

        <p>Read ASCII armored DER encoded EncAPRepPart from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_read</h4>

<p><a name="shishi_005fencapreppart_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * encapreppart</var>)<var><a name="index-shishi_005fencapreppart_005fread-269"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>encapreppart</var>: output variable with newly allocated EncAPRepPart.

        <p>Read DER encoded EncAPRepPart from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_from_file</h4>

<p><a name="shishi_005fencapreppart_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_from_file</b> (<var>Shishi * handle, Shishi_asn1 * encapreppart, int filetype, const char * filename</var>)<var><a name="index-shishi_005fencapreppart_005ffrom_005ffile-270"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: output variable with newly allocated EncAPRepPart.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read EncAPRepPart from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_get_key</h4>

<p><a name="shishi_005fencapreppart_005fget_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_get_key</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, Shishi_key ** key</var>)<var><a name="index-shishi_005fencapreppart_005fget_005fkey-271"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: input EncAPRepPart variable.

        <p><var>key</var>: newly allocated key.

        <p>Extract the subkey from the encrypted AP-REP part.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_ctime</h4>

<p><a name="shishi_005fencapreppart_005fctime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_ctime</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, char ** t</var>)<var><a name="index-shishi_005fencapreppart_005fctime-272"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>t</var>: newly allocated zero-terminated character array with client time.

        <p>Extract client time from EncAPRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_ctime_set</h4>

<p><a name="shishi_005fencapreppart_005fctime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_ctime_set</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, const char * t</var>)<var><a name="index-shishi_005fencapreppart_005fctime_005fset-273"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>t</var>: string with generalized time value to store in EncAPRepPart.

        <p>Store client time in EncAPRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_cusec_get</h4>

<p><a name="shishi_005fencapreppart_005fcusec_005fget"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_cusec_get</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, uint32_t * cusec</var>)<var><a name="index-shishi_005fencapreppart_005fcusec_005fget-274"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>cusec</var>: output integer with client microseconds field.

        <p>Extract client microseconds field from EncAPRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_cusec_set</h4>

<p><a name="shishi_005fencapreppart_005fcusec_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_cusec_set</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, uint32_t cusec</var>)<var><a name="index-shishi_005fencapreppart_005fcusec_005fset-275"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>cusec</var>: client microseconds to set in authenticator, 0-999999.

        <p>Set the cusec field in the Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_seqnumber_get</h4>

<p><a name="shishi_005fencapreppart_005fseqnumber_005fget"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_seqnumber_get</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, uint32_t * seqnumber</var>)<var><a name="index-shishi_005fencapreppart_005fseqnumber_005fget-276"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>seqnumber</var>: output integer with sequence number field.

        <p>Extract sequence number field from EncAPRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_seqnumber_remove</h4>

<p><a name="shishi_005fencapreppart_005fseqnumber_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_seqnumber_remove</b> (<var>Shishi * handle, Shishi_asn1 encapreppart</var>)<var><a name="index-shishi_005fencapreppart_005fseqnumber_005fremove-277"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: encapreppart as allocated by <code>shishi_encapreppart()</code>.

        <p>Remove sequence number field in EncAPRepPart.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_seqnumber_set</h4>

<p><a name="shishi_005fencapreppart_005fseqnumber_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_seqnumber_set</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, uint32_t seqnumber</var>)<var><a name="index-shishi_005fencapreppart_005fseqnumber_005fset-278"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: encapreppart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>seqnumber</var>: integer with sequence number field to store in encapreppart.

        <p>Store sequence number field in EncAPRepPart.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encapreppart_time_copy</h4>

<p><a name="shishi_005fencapreppart_005ftime_005fcopy"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encapreppart_time_copy</b> (<var>Shishi * handle, Shishi_asn1 encapreppart, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fencapreppart_005ftime_005fcopy-279"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encapreppart</var>: EncAPRepPart as allocated by <code>shishi_encapreppart()</code>.

        <p><var>authenticator</var>: Authenticator to copy time fields from.

        <p>Copy time fields from Authenticator into EncAPRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="SAFE-and-PRIV-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Ticket-Functions">Ticket Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.5 SAFE and PRIV Functions</h3>

<p>The &ldquo;KRB-SAFE&rdquo; is an ASN.1 structure used by application client and
servers to exchange integrity protected data.  The integrity
protection is keyed, usually with a key agreed on via the AP exchange
(see <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>).  The following illustrates the
KRB-SAFE ASN.1 structure.

<pre class="verbatim">   KRB-SAFE        ::= [APPLICATION 20] SEQUENCE {
           pvno            [0] INTEGER (5),
           msg-type        [1] INTEGER (20),
           safe-body       [2] KRB-SAFE-BODY,
           cksum           [3] Checksum
   }

   KRB-SAFE-BODY   ::= SEQUENCE {
           user-data       [0] OCTET STRING,
           timestamp       [1] KerberosTime OPTIONAL,
           usec            [2] Microseconds OPTIONAL,
           seq-number      [3] UInt32 OPTIONAL,
           s-address       [4] HostAddress,
           r-address       [5] HostAddress OPTIONAL
   }
</pre>

<h4 class="subheading">shishi_safe</h4>

<p><a name="shishi_005fsafe"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe</b> (<var>Shishi * handle, Shishi_safe ** safe</var>)<var><a name="index-shishi_005fsafe-280"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: pointer to new structure that holds information about SAFE exchange

        <p>Create a new SAFE exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_done</h4>

<p><a name="shishi_005fsafe_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_safe_done</b> (<var>Shishi_safe * safe</var>)<var><a name="index-shishi_005fsafe_005fdone-281"></a></var><br>
<blockquote><p><var>safe</var>: structure that holds information about SAFE exchange

        <p>Deallocate resources associated with SAFE exchange.  This should be
called by the application when it no longer need to utilize the
SAFE exchange handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_key</h4>

<p><a name="shishi_005fsafe_005fkey"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_safe_key</b> (<var>Shishi_safe * safe</var>)<var><a name="index-shishi_005fsafe_005fkey-282"></a></var><br>
<blockquote><p><var>safe</var>: structure that holds information about SAFE exchange

        <p>Get key structured from SAFE exchange.

        <p><strong>Return value:</strong> Returns the key used in the SAFE exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_key_set</h4>

<p><a name="shishi_005fsafe_005fkey_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_safe_key_set</b> (<var>Shishi_safe * safe, Shishi_key * key</var>)<var><a name="index-shishi_005fsafe_005fkey_005fset-283"></a></var><br>
<blockquote><p><var>safe</var>: structure that holds information about SAFE exchange

        <p><var>key</var>: key to store in SAFE.

        <p>Set the Key in the SAFE exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_safe</h4>

<p><a name="shishi_005fsafe_005fsafe"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_safe_safe</b> (<var>Shishi_safe * safe</var>)<var><a name="index-shishi_005fsafe_005fsafe-284"></a></var><br>
<blockquote><p><var>safe</var>: structure that holds information about SAFE exchange

        <p>Get ASN.1 SAFE structured from SAFE exchange.

        <p><strong>Return value:</strong> Returns the ASN.1 safe in the SAFE exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_safe_set</h4>

<p><a name="shishi_005fsafe_005fsafe_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_safe_safe_set</b> (<var>Shishi_safe * safe, Shishi_asn1 asn1safe</var>)<var><a name="index-shishi_005fsafe_005fsafe_005fset-285"></a></var><br>
<blockquote><p><var>safe</var>: structure that holds information about SAFE exchange

        <p><var>asn1safe</var>: KRB-SAFE to store in SAFE exchange.

        <p>Set the KRB-SAFE in the SAFE exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_safe_der</h4>

<p><a name="shishi_005fsafe_005fsafe_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_safe_der</b> (<var>Shishi_safe * safe, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fsafe_005fsafe_005fder-286"></a></var><br>
<blockquote><p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>out</var>: output array with newly allocated DER encoding of SAFE.

        <p><var>outlen</var>: length of output array with DER encoding of SAFE.

        <p>DER encode SAFE structure.  Typically <code>shishi_safe_build()</code> is used
to build the SAFE structure first.  <code>out</code> is allocated by this
function, and it is the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_safe_der_set</h4>

<p><a name="shishi_005fsafe_005fsafe_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_safe_der_set</b> (<var>Shishi_safe * safe, char * der, size_t derlen</var>)<var><a name="index-shishi_005fsafe_005fsafe_005fder_005fset-287"></a></var><br>
<blockquote><p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>der</var>: input array with DER encoded KRB-SAFE.

        <p><var>derlen</var>: length of input array with DER encoded KRB-SAFE.

        <p>DER decode KRB-SAFE and set it SAFE exchange.  If decoding fails, the
KRB-SAFE in the SAFE exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_print</h4>

<p><a name="shishi_005fsafe_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 safe</var>)<var><a name="index-shishi_005fsafe_005fprint-288"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>safe</var>: SAFE to print.

        <p>Print ASCII armored DER encoding of SAFE to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_save</h4>

<p><a name="shishi_005fsafe_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 safe</var>)<var><a name="index-shishi_005fsafe_005fsave-289"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>safe</var>: SAFE to save.

        <p>Save DER encoding of SAFE to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_to_file</h4>

<p><a name="shishi_005fsafe_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_to_file</b> (<var>Shishi * handle, Shishi_asn1 safe, int filetype, const char * filename</var>)<var><a name="index-shishi_005fsafe_005fto_005ffile-290"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: SAFE to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write SAFE to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_parse</h4>

<p><a name="shishi_005fsafe_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * safe</var>)<var><a name="index-shishi_005fsafe_005fparse-291"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>safe</var>: output variable with newly allocated SAFE.

        <p>Read ASCII armored DER encoded SAFE from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_read</h4>

<p><a name="shishi_005fsafe_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * safe</var>)<var><a name="index-shishi_005fsafe_005fread-292"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>safe</var>: output variable with newly allocated SAFE.

        <p>Read DER encoded SAFE from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_from_file</h4>

<p><a name="shishi_005fsafe_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_from_file</b> (<var>Shishi * handle, Shishi_asn1 * safe, int filetype, const char * filename</var>)<var><a name="index-shishi_005fsafe_005ffrom_005ffile-293"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: output variable with newly allocated SAFE.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read SAFE from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_cksum</h4>

<p><a name="shishi_005fsafe_005fcksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_cksum</b> (<var>Shishi * handle, Shishi_asn1 safe, int32_t * cksumtype, char ** cksum, size_t * cksumlen</var>)<var><a name="index-shishi_005fsafe_005fcksum-294"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>cksumtype</var>: output checksum type.

        <p><var>cksum</var>: output array with newly allocated checksum data from SAFE.

        <p><var>cksumlen</var>: output size of output checksum data buffer.

        <p>Read checksum value from KRB-SAFE.  <code>cksum</code> is allocated by this
function, and it is the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_set_cksum</h4>

<p><a name="shishi_005fsafe_005fset_005fcksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_set_cksum</b> (<var>Shishi * handle, Shishi_asn1 safe, int32_t cksumtype, const char * cksum, size_t cksumlen</var>)<var><a name="index-shishi_005fsafe_005fset_005fcksum-295"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>cksumtype</var>: input checksum type to store in SAFE.

        <p><var>cksum</var>: input checksum data to store in SAFE.

        <p><var>cksumlen</var>: size of input checksum data to store in SAFE.

        <p>Store checksum value in SAFE.  A checksum is usually created by
calling <code>shishi_checksum()</code> on some application specific data using
the key from the ticket that is being used.  To save time, you may
want to use <code>shishi_safe_build()</code> instead, which calculates the
checksum and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_user_data</h4>

<p><a name="shishi_005fsafe_005fuser_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_user_data</b> (<var>Shishi * handle, Shishi_asn1 safe, char ** userdata, size_t * userdatalen</var>)<var><a name="index-shishi_005fsafe_005fuser_005fdata-296"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>userdata</var>: output array with newly allocated user data from KRB-SAFE.

        <p><var>userdatalen</var>: output size of output user data buffer.

        <p>Read user data value from KRB-SAFE.  <code>userdata</code> is allocated by this
function, and it is the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_set_user_data</h4>

<p><a name="shishi_005fsafe_005fset_005fuser_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_set_user_data</b> (<var>Shishi * handle, Shishi_asn1 safe, const char * userdata, size_t userdatalen</var>)<var><a name="index-shishi_005fsafe_005fset_005fuser_005fdata-297"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>userdata</var>: input user application to store in SAFE.

        <p><var>userdatalen</var>: size of input user application to store in SAFE.

        <p>Set the application data in SAFE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_build</h4>

<p><a name="shishi_005fsafe_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_build</b> (<var>Shishi_safe * safe, Shishi_key * key</var>)<var><a name="index-shishi_005fsafe_005fbuild-298"></a></var><br>
<blockquote><p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>key</var>: key for session, used to compute checksum.

        <p>Build checksum and set it in KRB-SAFE.  Note that this follows RFC
1510bis and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_safe_verify</h4>

<p><a name="shishi_005fsafe_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>shishi_safe_verify</b> (<var>Shishi_safe * safe, Shishi_key * key</var>)<var><a name="index-shishi_005fsafe_005fverify-299"></a></var><br>
<blockquote><p><var>safe</var>: safe as allocated by <code>shishi_safe()</code>.

        <p><var>key</var>: key for session, used to verify checksum.

        <p>Verify checksum in KRB-SAFE.  Note that this follows RFC 1510bis
and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful,
SHISHI_SAFE_BAD_KEYTYPE if an incompatible key type is used, or
SHISHI_SAFE_VERIFY_FAILED if the actual verification failed. 
</p></blockquote></div>

   <p>The &ldquo;KRB-PRIV&rdquo; is an ASN.1 structure used by application client and
servers to exchange confidential data.  The confidentiality is keyed,
usually with a key agreed on via the AP exchange (see <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>).  The following illustrates the KRB-PRIV ASN.1
structure.

<pre class="verbatim">   KRB-PRIV        ::= [APPLICATION 21] SEQUENCE {
           pvno            [0] INTEGER (5),
           msg-type        [1] INTEGER (21),
                           -- NOTE: there is no [2] tag
           enc-part        [3] EncryptedData -- EncKrbPrivPart
   }

   EncKrbPrivPart  ::= [APPLICATION 28] SEQUENCE {
           user-data       [0] OCTET STRING,
           timestamp       [1] KerberosTime OPTIONAL,
           usec            [2] Microseconds OPTIONAL,
           seq-number      [3] UInt32 OPTIONAL,
           s-address       [4] HostAddress -- sender's addr --,
           r-address       [5] HostAddress OPTIONAL -- recip's addr
   }
</pre>

<h4 class="subheading">shishi_priv</h4>

<p><a name="shishi_005fpriv"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv</b> (<var>Shishi * handle, Shishi_priv ** priv</var>)<var><a name="index-shishi_005fpriv-300"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>priv</var>: pointer to new structure that holds information about PRIV exchange

        <p>Create a new PRIV exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_done</h4>

<p><a name="shishi_005fpriv_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_priv_done</b> (<var>Shishi_priv * priv</var>)<var><a name="index-shishi_005fpriv_005fdone-301"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p>Deallocate resources associated with PRIV exchange.  This should be
called by the application when it no longer need to utilize the
PRIV exchange handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_key</h4>

<p><a name="shishi_005fpriv_005fkey"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_priv_key</b> (<var>Shishi_priv * priv</var>)<var><a name="index-shishi_005fpriv_005fkey-302"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p>Get key from PRIV exchange.

        <p><strong>Return value:</strong> Returns the key used in the PRIV exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_key_set</h4>

<p><a name="shishi_005fpriv_005fkey_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_priv_key_set</b> (<var>Shishi_priv * priv, Shishi_key * key</var>)<var><a name="index-shishi_005fpriv_005fkey_005fset-303"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p><var>key</var>: key to store in PRIV.

        <p>Set the Key in the PRIV exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_priv</h4>

<p><a name="shishi_005fpriv_005fpriv"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_priv_priv</b> (<var>Shishi_priv * priv</var>)<var><a name="index-shishi_005fpriv_005fpriv-304"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p>Get ASN.1 PRIV structure in PRIV exchange.

        <p><strong>Return value:</strong> Returns the ASN.1 priv in the PRIV exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_priv_set</h4>

<p><a name="shishi_005fpriv_005fpriv_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_priv_priv_set</b> (<var>Shishi_priv * priv, Shishi_asn1 asn1priv</var>)<var><a name="index-shishi_005fpriv_005fpriv_005fset-305"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p><var>asn1priv</var>: KRB-PRIV to store in PRIV exchange.

        <p>Set the KRB-PRIV in the PRIV exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_priv_der</h4>

<p><a name="shishi_005fpriv_005fpriv_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_priv_der</b> (<var>Shishi_priv * priv, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fpriv_005fpriv_005fder-306"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>out</var>: output array with newly allocated DER encoding of PRIV.

        <p><var>outlen</var>: length of output array with DER encoding of PRIV.

        <p>DER encode PRIV structure.  Typically <code>shishi_priv_build()</code> is used
to build the PRIV structure first.  <code>out</code> is allocated by this
function, and it is the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_priv_der_set</h4>

<p><a name="shishi_005fpriv_005fpriv_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_priv_der_set</b> (<var>Shishi_priv * priv, char * der, size_t derlen</var>)<var><a name="index-shishi_005fpriv_005fpriv_005fder_005fset-307"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>der</var>: input array with DER encoded KRB-PRIV.

        <p><var>derlen</var>: length of input array with DER encoded KRB-PRIV.

        <p>DER decode KRB-PRIV and set it PRIV exchange.  If decoding fails, the
KRB-PRIV in the PRIV exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_encprivpart</h4>

<p><a name="shishi_005fpriv_005fencprivpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_priv_encprivpart</b> (<var>Shishi_priv * priv</var>)<var><a name="index-shishi_005fpriv_005fencprivpart-308"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p>Get ASN.1 EncPrivPart structure from PRIV exchange.

        <p><strong>Return value:</strong> Returns the ASN.1 encprivpart in the PRIV exchange, or NULL if
not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_encprivpart_set</h4>

<p><a name="shishi_005fpriv_005fencprivpart_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_priv_encprivpart_set</b> (<var>Shishi_priv * priv, Shishi_asn1 asn1encprivpart</var>)<var><a name="index-shishi_005fpriv_005fencprivpart_005fset-309"></a></var><br>
<blockquote><p><var>priv</var>: structure that holds information about PRIV exchange

        <p><var>asn1encprivpart</var>: ENCPRIVPART to store in PRIV exchange.

        <p>Set the ENCPRIVPART in the PRIV exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_encprivpart_der</h4>

<p><a name="shishi_005fpriv_005fencprivpart_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_encprivpart_der</b> (<var>Shishi_priv * priv, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fpriv_005fencprivpart_005fder-310"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>out</var>: output array with newly allocated DER encoding of ENCPRIVPART.

        <p><var>outlen</var>: length of output array with DER encoding of ENCPRIVPART.

        <p>DER encode ENCPRIVPART structure.  Typically
<code>shishi_encprivpart_build()</code> is used to build the ENCPRIVPART
structure first.  <code>out</code> is allocated by this function, and it is the
responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_encprivpart_der_set</h4>

<p><a name="shishi_005fpriv_005fencprivpart_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_encprivpart_der_set</b> (<var>Shishi_priv * priv, char * der, size_t derlen</var>)<var><a name="index-shishi_005fpriv_005fencprivpart_005fder_005fset-311"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>der</var>: input array with DER encoded ENCPRIVPART.

        <p><var>derlen</var>: length of input array with DER encoded ENCPRIVPART.

        <p>DER decode ENCPRIVPART and set it PRIV exchange.  If decoding
fails, the ENCPRIVPART in the PRIV exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_print</h4>

<p><a name="shishi_005fpriv_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 priv</var>)<var><a name="index-shishi_005fpriv_005fprint-312"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>priv</var>: PRIV to print.

        <p>Print ASCII armored DER encoding of PRIV to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_save</h4>

<p><a name="shishi_005fpriv_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 priv</var>)<var><a name="index-shishi_005fpriv_005fsave-313"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>priv</var>: PRIV to save.

        <p>Save DER encoding of PRIV to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_to_file</h4>

<p><a name="shishi_005fpriv_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_to_file</b> (<var>Shishi * handle, Shishi_asn1 priv, int filetype, const char * filename</var>)<var><a name="index-shishi_005fpriv_005fto_005ffile-314"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>priv</var>: PRIV to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write PRIV to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_parse</h4>

<p><a name="shishi_005fpriv_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * priv</var>)<var><a name="index-shishi_005fpriv_005fparse-315"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>priv</var>: output variable with newly allocated PRIV.

        <p>Read ASCII armored DER encoded PRIV from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_read</h4>

<p><a name="shishi_005fpriv_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * priv</var>)<var><a name="index-shishi_005fpriv_005fread-316"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>priv</var>: output variable with newly allocated PRIV.

        <p>Read DER encoded PRIV from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_from_file</h4>

<p><a name="shishi_005fpriv_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_from_file</b> (<var>Shishi * handle, Shishi_asn1 * priv, int filetype, const char * filename</var>)<var><a name="index-shishi_005fpriv_005ffrom_005ffile-317"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>priv</var>: output variable with newly allocated PRIV.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read PRIV from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_enc_part_etype</h4>

<p><a name="shishi_005fpriv_005fenc_005fpart_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_enc_part_etype</b> (<var>Shishi * handle, Shishi_asn1 priv, int32_t * etype</var>)<var><a name="index-shishi_005fpriv_005fenc_005fpart_005fetype-318"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>priv</var>: PRIV variable to get value from.

        <p><var>etype</var>: output variable that holds the value.

        <p>Extract PRIV.enc-part.etype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_set_enc_part</h4>

<p><a name="shishi_005fpriv_005fset_005fenc_005fpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_set_enc_part</b> (<var>Shishi * handle, Shishi_asn1 priv, int32_t etype, const char * encpart, size_t encpartlen</var>)<var><a name="index-shishi_005fpriv_005fset_005fenc_005fpart-319"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>etype</var>: input encryption type to store in PRIV.

        <p><var>encpart</var>: input encrypted data to store in PRIV.

        <p><var>encpartlen</var>: size of input encrypted data to store in PRIV.

        <p>Store encrypted data in PRIV.  The encrypted data is usually
created by calling <code>shishi_encrypt()</code> on some application specific
data using the key from the ticket that is being used.  To save
time, you may want to use <code>shishi_priv_build()</code> instead, which
encryptes the data and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encprivpart_user_data</h4>

<p><a name="shishi_005fencprivpart_005fuser_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encprivpart_user_data</b> (<var>Shishi * handle, Shishi_asn1 encprivpart, char ** userdata, size_t * userdatalen</var>)<var><a name="index-shishi_005fencprivpart_005fuser_005fdata-320"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encprivpart</var>: encprivpart as allocated by <code>shishi_priv()</code>.

        <p><var>userdata</var>: output array with newly allocated user data from KRB-PRIV.

        <p><var>userdatalen</var>: output size of output user data buffer.

        <p>Read user data value from KRB-PRIV.  <code>userdata</code> is allocated by this
function, and it is the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encprivpart_set_user_data</h4>

<p><a name="shishi_005fencprivpart_005fset_005fuser_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encprivpart_set_user_data</b> (<var>Shishi * handle, Shishi_asn1 encprivpart, const char * userdata, size_t userdatalen</var>)<var><a name="index-shishi_005fencprivpart_005fset_005fuser_005fdata-321"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encprivpart</var>: encprivpart as allocated by <code>shishi_priv()</code>.

        <p><var>userdata</var>: input user application to store in PRIV.

        <p><var>userdatalen</var>: size of input user application to store in PRIV.

        <p>Set the application data in PRIV.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_build</h4>

<p><a name="shishi_005fpriv_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_build</b> (<var>Shishi_priv * priv, Shishi_key * key</var>)<var><a name="index-shishi_005fpriv_005fbuild-322"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>key</var>: key for session, used to encrypt data.

        <p>Build checksum and set it in KRB-PRIV.  Note that this follows RFC
1510bis and is incompatible with RFC 1510, although presumably few
implementations use the RFC1510 algorithm.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_priv_process</h4>

<p><a name="shishi_005fpriv_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_priv_process</b> (<var>Shishi_priv * priv, Shishi_key * key</var>)<var><a name="index-shishi_005fpriv_005fprocess-323"></a></var><br>
<blockquote><p><var>priv</var>: priv as allocated by <code>shishi_priv()</code>.

        <p><var>key</var>: key to use to decrypt EncPrivPart.

        <p>Decrypt encrypted data in KRB-PRIV and set the EncPrivPart in the
PRIV exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful,
SHISHI_PRIV_BAD_KEYTYPE if an incompatible key type is used, or
SHISHI_CRYPTO_ERROR if the actual decryption failed. 
</p></blockquote></div>

<div class="node">
<a name="Ticket-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#AS-Functions">AS Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.6 Ticket Functions</h3>

<p>A Ticket is an ASN.1 structured that can be used to authenticate the
holder to services.  It contain an encrypted part, which the ticket
holder cannot see, but can be encrypted by the service, and various
information about the user and service, including an encryption key to
use for the connection.  See <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a>, for more
details on the ASN.1 structure of a ticket.

<h4 class="subheading">shishi_tkt</h4>

<p><a name="shishi_005ftkt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt</b> (<var>Shishi * handle, Shishi_tkt ** tkt</var>)<var><a name="index-shishi_005ftkt-324"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>tkt</var>: output variable with newly allocated ticket.

        <p>Create a new ticket handle.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt2</h4>

<p><a name="shishi_005ftkt2"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tkt2</b> (<var>Shishi * handle, Shishi_asn1 ticket, Shishi_asn1 enckdcreppart, Shishi_asn1 kdcrep</var>)<var><a name="index-shishi_005ftkt2-325"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: input variable with ticket.

        <p><var>enckdcreppart</var>: input variable with auxilliary ticket information.

        <p><var>kdcrep</var>: input variable with KDC-REP ticket information.

        <p>Create a new ticket handle.

        <p><strong>Return value:</strong> Returns new ticket handle, or <code>NULL</code> on error. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_done</h4>

<p><a name="shishi_005ftkt_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_done</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fdone-326"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Deallocate resources associated with ticket.  The ticket must not
be used again after this call. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_ticket</h4>

<p><a name="shishi_005ftkt_005fticket"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tkt_ticket</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fticket-327"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Get ASN.1 Ticket structure from ticket.

        <p><strong>Return value:</strong> Returns actual ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_ticket_set</h4>

<p><a name="shishi_005ftkt_005fticket_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_ticket_set</b> (<var>Shishi_tkt * tkt, Shishi_asn1 ticket</var>)<var><a name="index-shishi_005ftkt_005fticket_005fset-328"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>ticket</var>: ASN.1 Ticket to store in ticket.

        <p>Set the ASN.1 Ticket in the Ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_enckdcreppart</h4>

<p><a name="shishi_005ftkt_005fenckdcreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tkt_enckdcreppart</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fenckdcreppart-329"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Get ASN.1 EncKDCRepPart structure from ticket.

        <p><strong>Return value:</strong> Returns auxilliary ticket information. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_enckdcreppart_set</h4>

<p><a name="shishi_005ftkt_005fenckdcreppart_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_enckdcreppart_set</b> (<var>Shishi_tkt * tkt, Shishi_asn1 enckdcreppart</var>)<var><a name="index-shishi_005ftkt_005fenckdcreppart_005fset-330"></a></var><br>
<blockquote><p><var>tkt</var>: structure that holds information about Ticket exchange

        <p><var>enckdcreppart</var>: EncKDCRepPart to store in Ticket.

        <p>Set the EncKDCRepPart in the Ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_kdcrep</h4>

<p><a name="shishi_005ftkt_005fkdcrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tkt_kdcrep</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fkdcrep-331"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Get ASN.1 KDCRep structure from ticket.

        <p><strong>Return value:</strong> Returns KDC-REP information. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_encticketpart</h4>

<p><a name="shishi_005ftkt_005fencticketpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tkt_encticketpart</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fencticketpart-332"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Get ASN.1 EncTicketPart structure from ticket.

        <p><strong>Return value:</strong> Returns EncTicketPart information. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_encticketpart_set</h4>

<p><a name="shishi_005ftkt_005fencticketpart_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_encticketpart_set</b> (<var>Shishi_tkt * tkt, Shishi_asn1 encticketpart</var>)<var><a name="index-shishi_005ftkt_005fencticketpart_005fset-333"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>encticketpart</var>: encticketpart to store in ticket.

        <p>Set the EncTicketPart in the Ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_key</h4>

<p><a name="shishi_005ftkt_005fkey"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_tkt_key</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fkey-334"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Get key used in ticket, by looking first in EncKDCRepPart and then
in EncTicketPart.  If key is already populated, it is not extracted
again.

        <p><strong>Return value:</strong> Returns key extracted from EncKDCRepPart or
EncTicketPart. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_key_set</h4>

<p><a name="shishi_005ftkt_005fkey_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_key_set</b> (<var>Shishi_tkt * tkt, Shishi_key * key</var>)<var><a name="index-shishi_005ftkt_005fkey_005fset-335"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>key</var>: key to store in ticket.

        <p>Set the key in the EncTicketPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_client</h4>

<p><a name="shishi_005ftkt_005fclient"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_client</b> (<var>Shishi_tkt * tkt, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005ftkt_005fclient-336"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Represent client principal name in Ticket KDC-REP as
zero-terminated string.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <code>clientlen</code> does not include the terminating
zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_client_p</h4>

<p><a name="shishi_005ftkt_005fclient_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_client_p</b> (<var>Shishi_tkt * tkt, const char * client</var>)<var><a name="index-shishi_005ftkt_005fclient_005fp-337"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>client</var>: client name of ticket.

        <p>Determine if ticket is for specified client.

        <p><strong>Return value:</strong> Returns non-0 iff ticket is for specified client. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_clientrealm</h4>

<p><a name="shishi_005ftkt_005fclientrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_clientrealm</b> (<var>Shishi_tkt * tkt, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005ftkt_005fclientrealm-338"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name and realm.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Convert cname and realm fields from AS-REQ to printable principal
name format.  The string is allocate by this function, and it is
the responsibility of the caller to deallocate it.  Note that the
output length <code>clientlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_clientrealm_p</h4>

<p><a name="shishi_005ftkt_005fclientrealm_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_clientrealm_p</b> (<var>Shishi_tkt * tkt, const char * client</var>)<var><a name="index-shishi_005ftkt_005fclientrealm_005fp-339"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>client</var>: principal name (client name and realm) of ticket.

        <p>Determine if ticket is for specified client principal.

        <p><strong>Return value:</strong> Returns non-0 iff ticket is for specified client principal. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_realm</h4>

<p><a name="shishi_005ftkt_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_realm</b> (<var>Shishi_tkt * tkt, char ** realm, size_t * realmlen</var>)<var><a name="index-shishi_005ftkt_005frealm-340"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>realm</var>: pointer to newly allocated character array with realm name.

        <p><var>realmlen</var>: length of newly allocated character array with realm name.

        <p>Extract realm of server in ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_server</h4>

<p><a name="shishi_005ftkt_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_server</b> (<var>Shishi_tkt * tkt, char ** server, size_t * serverlen</var>)<var><a name="index-shishi_005ftkt_005fserver-341"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>server</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>serverlen</code>).

        <p><var>serverlen</var>: pointer to length of <code>server</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>server</code>).

        <p>Represent server principal name in Ticket as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>serverlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_server_p</h4>

<p><a name="shishi_005ftkt_005fserver_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_server_p</b> (<var>Shishi_tkt * tkt, const char * server</var>)<var><a name="index-shishi_005ftkt_005fserver_005fp-342"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>server</var>: server name of ticket.

        <p>Determine if ticket is for specified server.

        <p><strong>Return value:</strong> Returns non-0 iff ticket is for specified server. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_flags</h4>

<p><a name="shishi_005ftkt_005fflags"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_flags</b> (<var>Shishi_tkt * tkt, uint32_t * flags</var>)<var><a name="index-shishi_005ftkt_005fflags-343"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>flags</var>: pointer to output integer with flags.

        <p>Extract flags in ticket (i.e., EncKDCRepPart).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_flags_set</h4>

<p><a name="shishi_005ftkt_005fflags_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_flags_set</b> (<var>Shishi_tkt * tkt, uint32_t flags</var>)<var><a name="index-shishi_005ftkt_005fflags_005fset-344"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>flags</var>: integer with flags to store in ticket.

        <p>Set flags in ticket, i.e., both EncTicketPart and EncKDCRepPart. 
Note that this reset any already existing flags.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_flags_add</h4>

<p><a name="shishi_005ftkt_005fflags_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_flags_add</b> (<var>Shishi_tkt * tkt, uint32_t flag</var>)<var><a name="index-shishi_005ftkt_005fflags_005fadd-345"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>flag</var>: integer with flags to store in ticket.

        <p>Add ticket flags to Ticket and EncKDCRepPart.  This preserves all
existing options.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_forwardable_p</h4>

<p><a name="shishi_005ftkt_005fforwardable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_forwardable_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fforwardable_005fp-346"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is forwardable.

        <p>The FORWARDABLE flag in a ticket is normally only interpreted by
the ticket-granting service. It can be ignored by application
servers.  The FORWARDABLE flag has an interpretation similar to
that of the PROXIABLE flag, except ticket-granting tickets may also
be issued with different network addresses. This flag is reset by
default, but users MAY request that it be set by setting the
FORWARDABLE option in the AS request when they request their
initial ticket-granting ticket.

        <p><strong>Return value:</strong> Returns non-0 iff forwardable flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_forwarded_p</h4>

<p><a name="shishi_005ftkt_005fforwarded_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_forwarded_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fforwarded_005fp-347"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is forwarded.

        <p>The FORWARDED flag is set by the TGS when a client presents a
ticket with the FORWARDABLE flag set and requests a forwarded
ticket by specifying the FORWARDED KDC option and supplying a set
of addresses for the new ticket. It is also set in all tickets
issued based on tickets with the FORWARDED flag set. Application
servers may choose to process FORWARDED tickets differently than
non-FORWARDED tickets.

        <p><strong>Return value:</strong> Returns non-0 iff forwarded flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_proxiable_p</h4>

<p><a name="shishi_005ftkt_005fproxiable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_proxiable_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fproxiable_005fp-348"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is proxiable.

        <p>The PROXIABLE flag in a ticket is normally only interpreted by the
ticket-granting service. It can be ignored by application servers. 
When set, this flag tells the ticket-granting server that it is OK
to issue a new ticket (but not a ticket-granting ticket) with a
different network address based on this ticket. This flag is set if
requested by the client on initial authentication. By default, the
client will request that it be set when requesting a
ticket-granting ticket, and reset when requesting any other ticket.

        <p><strong>Return value:</strong> Returns non-0 iff proxiable flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_proxy_p</h4>

<p><a name="shishi_005ftkt_005fproxy_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_proxy_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fproxy_005fp-349"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is proxy ticket.

        <p>The PROXY flag is set in a ticket by the TGS when it issues a proxy
ticket.  Application servers MAY check this flag and at their
option they MAY require additional authentication from the agent
presenting the proxy in order to provide an audit trail.

        <p><strong>Return value:</strong> Returns non-0 iff proxy flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_may_postdate_p</h4>

<p><a name="shishi_005ftkt_005fmay_005fpostdate_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_may_postdate_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fmay_005fpostdate_005fp-350"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket may be used to grant postdated tickets.

        <p>The MAY-POSTDATE flag in a ticket is normally only interpreted by
the ticket-granting service. It can be ignored by application
servers.  This flag MUST be set in a ticket-granting ticket in
order to issue a postdated ticket based on the presented ticket. It
is reset by default; it MAY be requested by a client by setting the
ALLOW- POSTDATE option in the KRB_AS_REQ message.  This flag does
not allow a client to obtain a postdated ticket-granting ticket;
postdated ticket-granting tickets can only by obtained by
requesting the postdating in the KRB_AS_REQ message. The life
(endtime-starttime) of a postdated ticket will be the remaining
life of the ticket-granting ticket at the time of the request,
unless the RENEWABLE option is also set, in which case it can be
the full life (endtime-starttime) of the ticket-granting
ticket. The KDC MAY limit how far in the future a ticket may be
postdated.

        <p><strong>Return value:</strong> Returns non-0 iff may-postdate flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_postdated_p</h4>

<p><a name="shishi_005ftkt_005fpostdated_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_postdated_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fpostdated_005fp-351"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is postdated.

        <p>The POSTDATED flag indicates that a ticket has been postdated. The
application server can check the authtime field in the ticket to
see when the original authentication occurred. Some services MAY
choose to reject postdated tickets, or they may only accept them
within a certain period after the original authentication. When the
KDC issues a POSTDATED ticket, it will also be marked as INVALID,
so that the application client MUST present the ticket to the KDC
to be validated before use.

        <p><strong>Return value:</strong> Returns non-0 iff postdated flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_invalid_p</h4>

<p><a name="shishi_005ftkt_005finvalid_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_invalid_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005finvalid_005fp-352"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is invalid.

        <p>The INVALID flag indicates that a ticket is invalid. Application
servers MUST reject tickets which have this flag set. A postdated
ticket will be issued in this form. Invalid tickets MUST be
validated by the KDC before use, by presenting them to the KDC in a
TGS request with the VALIDATE option specified. The KDC will only
validate tickets after their starttime has passed. The validation
is required so that postdated tickets which have been stolen before
their starttime can be rendered permanently invalid (through a
hot-list mechanism).

        <p><strong>Return value:</strong> Returns non-0 iff invalid flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_renewable_p</h4>

<p><a name="shishi_005ftkt_005frenewable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_renewable_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005frenewable_005fp-353"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is renewable.

        <p>The RENEWABLE flag in a ticket is normally only interpreted by the
ticket-granting service (discussed below in section 3.3). It can
usually be ignored by application servers. However, some
particularly careful application servers MAY disallow renewable
tickets.

        <p><strong>Return value:</strong> Returns non-0 iff renewable flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_initial_p</h4>

<p><a name="shishi_005ftkt_005finitial_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_initial_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005finitial_005fp-354"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket was issued using AS exchange.

        <p>The INITIAL flag indicates that a ticket was issued using the AS
protocol, rather than issued based on a ticket-granting ticket. 
Application servers that want to require the demonstrated knowledge
of a client's secret key (e.g. a password-changing program) can
insist that this flag be set in any tickets they accept, and thus
be assured that the client's key was recently presented to the
application client.

        <p><strong>Return value:</strong> Returns non-0 iff initial flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_pre_authent_p</h4>

<p><a name="shishi_005ftkt_005fpre_005fauthent_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_pre_authent_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fpre_005fauthent_005fp-355"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket was pre-authenticated.

        <p>The PRE-AUTHENT and HW-AUTHENT flags provide additional information
about the initial authentication, regardless of whether the current
ticket was issued directly (in which case INITIAL will also be set)
or issued on the basis of a ticket-granting ticket (in which case
the INITIAL flag is clear, but the PRE-AUTHENT and HW-AUTHENT flags
are carried forward from the ticket-granting ticket).

        <p><strong>Return value:</strong> Returns non-0 iff pre-authent flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_hw_authent_p</h4>

<p><a name="shishi_005ftkt_005fhw_005fauthent_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_hw_authent_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fhw_005fauthent_005fp-356"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is authenticated using a hardware token.

        <p>The PRE-AUTHENT and HW-AUTHENT flags provide additional information
about the initial authentication, regardless of whether the current
ticket was issued directly (in which case INITIAL will also be set)
or issued on the basis of a ticket-granting ticket (in which case
the INITIAL flag is clear, but the PRE-AUTHENT and HW-AUTHENT flags
are carried forward from the ticket-granting ticket).

        <p><strong>Return value:</strong> Returns non-0 iff hw-authent flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_transited_policy_checked_p</h4>

<p><a name="shishi_005ftkt_005ftransited_005fpolicy_005fchecked_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_transited_policy_checked_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005ftransited_005fpolicy_005fchecked_005fp-357"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket has been policy checked for transit.

        <p>The application server is ultimately responsible for accepting or
rejecting authentication and SHOULD check that only suitably
trusted KDCs are relied upon to authenticate a principal.  The
transited field in the ticket identifies which realms (and thus
which KDCs) were involved in the authentication process and an
application server would normally check this field. If any of these
are untrusted to authenticate the indicated client principal
(probably determined by a realm-based policy), the authentication
attempt MUST be rejected. The presence of trusted KDCs in this list
does not provide any guarantee; an untrusted KDC may have
fabricated the list.

        <p>While the end server ultimately decides whether authentication is
valid, the KDC for the end server's realm MAY apply a realm
specific policy for validating the transited field and accepting
credentials for cross-realm authentication. When the KDC applies
such checks and accepts such cross-realm authentication it will set
the TRANSITED-POLICY-CHECKED flag in the service tickets it issues
based on the cross-realm TGT. A client MAY request that the KDCs
not check the transited field by setting the
DISABLE-TRANSITED-CHECK flag. KDCs are encouraged but not required
to honor this flag.

        <p>Application servers MUST either do the transited-realm checks
themselves, or reject cross-realm tickets without TRANSITED-POLICY-
CHECKED set.

        <p><strong>Return value:</strong> Returns non-0 iff transited-policy-checked flag is
set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_ok_as_delegate_p</h4>

<p><a name="shishi_005ftkt_005fok_005fas_005fdelegate_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_ok_as_delegate_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fok_005fas_005fdelegate_005fp-358"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is ok as delegated ticket.

        <p>The copy of the ticket flags in the encrypted part of the KDC reply
may have the OK-AS-DELEGATE flag set to indicates to the client
that the server specified in the ticket has been determined by
policy of the realm to be a suitable recipient of delegation.  A
client can use the presence of this flag to help it make a decision
whether to delegate credentials (either grant a proxy or a
forwarded ticket- granting ticket) to this server.  It is
acceptable to ignore the value of this flag. When setting this
flag, an administrator should consider the security and placement
of the server on which the service will run, as well as whether the
service requires the use of delegated credentials.

        <p><strong>Return value:</strong> Returns non-0 iff ok-as-delegate flag is set in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_keytype</h4>

<p><a name="shishi_005ftkt_005fkeytype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_keytype</b> (<var>Shishi_tkt * tkt, int32_t * etype</var>)<var><a name="index-shishi_005ftkt_005fkeytype-359"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>etype</var>: pointer to encryption type that is set, see Shishi_etype.

        <p>Extract encryption type of key in ticket (really EncKDCRepPart).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_keytype_fast</h4>

<p><a name="shishi_005ftkt_005fkeytype_005ffast"></a>

<div class="defun">
&mdash; Function: int32_t <b>shishi_tkt_keytype_fast</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fkeytype_005ffast-360"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Extract encryption type of key in ticket (really EncKDCRepPart).

        <p><strong>Return value:</strong> Returns encryption type of session key in ticket
(really EncKDCRepPart), or -1 on error. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_keytype_p</h4>

<p><a name="shishi_005ftkt_005fkeytype_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_keytype_p</b> (<var>Shishi_tkt * tkt, int32_t etype</var>)<var><a name="index-shishi_005ftkt_005fkeytype_005fp-361"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>etype</var>: encryption type, see Shishi_etype.

        <p>Determine if key in ticket (really EncKDCRepPart) is of specified
key type (really encryption type).

        <p><strong>Return value:</strong> Returns non-0 iff key in ticket is of specified
encryption type. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_lastreqc</h4>

<p><a name="shishi_005ftkt_005flastreqc"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_tkt_lastreqc</b> (<var>Shishi_tkt * tkt, Shishi_lrtype lrtype</var>)<var><a name="index-shishi_005ftkt_005flastreqc-362"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>lrtype</var>: lastreq type to extract, see Shishi_lrtype.  E.g.,
SHISHI_LRTYPE_LAST_REQUEST.

        <p>Extract C time corresponding to given lastreq type field in the
ticket.

        <p><strong>Return value:</strong> Returns C time interpretation of the specified
lastreq field, or (time_t) -1. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_authctime</h4>

<p><a name="shishi_005ftkt_005fauthctime"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_tkt_authctime</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fauthctime-363"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Extract C time corresponding to the authtime field.  The field
holds the time when the original authentication took place that
later resulted in this ticket.

        <p><strong>Return value:</strong> Returns C time interpretation of the endtime in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_startctime</h4>

<p><a name="shishi_005ftkt_005fstartctime"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_tkt_startctime</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fstartctime-364"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Extract C time corresponding to the starttime field.  The field
holds the time where the ticket start to be valid (typically in the
past).

        <p><strong>Return value:</strong> Returns C time interpretation of the endtime in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_endctime</h4>

<p><a name="shishi_005ftkt_005fendctime"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_tkt_endctime</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fendctime-365"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Extract C time corresponding to the endtime field.  The field holds
the time where the ticket stop being valid.

        <p><strong>Return value:</strong> Returns C time interpretation of the endtime in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_renew_tillc</h4>

<p><a name="shishi_005ftkt_005frenew_005ftillc"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_tkt_renew_tillc</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005frenew_005ftillc-366"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Extract C time corresponding to the renew-till field.  The field
holds the time where the ticket stop being valid for renewal.

        <p><strong>Return value:</strong> Returns C time interpretation of the renew-till in ticket. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_valid_at_time_p</h4>

<p><a name="shishi_005ftkt_005fvalid_005fat_005ftime_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_valid_at_time_p</b> (<var>Shishi_tkt * tkt, time_t now</var>)<var><a name="index-shishi_005ftkt_005fvalid_005fat_005ftime_005fp-367"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>now</var>: time to check for.

        <p>Determine if ticket is valid at a specific point in time.

        <p><strong>Return value:</strong> Returns non-0 iff ticket is valid (not expired and
after starttime) at specified time. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_valid_now_p</h4>

<p><a name="shishi_005ftkt_005fvalid_005fnow_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_valid_now_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fvalid_005fnow_005fp-368"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket is valid now.

        <p><strong>Return value:</strong> Returns 0 iff ticket is invalid (expired or not yet
valid). 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_expired_p</h4>

<p><a name="shishi_005ftkt_005fexpired_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tkt_expired_p</b> (<var>Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftkt_005fexpired_005fp-369"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p>Determine if ticket has expired (i.e., endtime is in the past).

        <p><strong>Return value:</strong> Returns 0 iff ticket has expired. 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_lastreq_pretty_print</h4>

<p><a name="shishi_005ftkt_005flastreq_005fpretty_005fprint"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_lastreq_pretty_print</b> (<var>Shishi_tkt * tkt, FILE * fh</var>)<var><a name="index-shishi_005ftkt_005flastreq_005fpretty_005fprint-370"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>fh</var>: file handle open for writing.

        <p>Print a human readable representation of the various lastreq fields
in the ticket (really EncKDCRepPart). 
</p></blockquote></div>

<h4 class="subheading">shishi_tkt_pretty_print</h4>

<p><a name="shishi_005ftkt_005fpretty_005fprint"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tkt_pretty_print</b> (<var>Shishi_tkt * tkt, FILE * fh</var>)<var><a name="index-shishi_005ftkt_005fpretty_005fprint-371"></a></var><br>
<blockquote><p><var>tkt</var>: input variable with ticket info.

        <p><var>fh</var>: file handle open for writing.

        <p>Print a human readable representation of a ticket to file handle. 
</p></blockquote></div>

<div class="node">
<a name="AS-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TGS-Functions">TGS Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ticket-Functions">Ticket Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.7 AS Functions</h3>

<p>The Authentication Service (AS) is used to get an initial ticket using
e.g. your password.  The following illustrates the AS-REQ and AS-REP
ASN.1 structures.

<pre class="verbatim">-- Request --

AS-REQ		::= KDC-REQ {10}

KDC-REQ {INTEGER:tagnum}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[1] INTEGER (5) -- first tag is [1], not [0] --,
	msg-type	[2] INTEGER (tagnum),
	padata		[3] SEQUENCE OF PA-DATA OPTIONAL,
	req-body	[4] KDC-REQ-BODY
}

KDC-REQ-BODY	::= SEQUENCE {
	kdc-options		[0] KDCOptions,
	cname			[1] PrincipalName OPTIONAL
				    -- Used only in AS-REQ --,
	realm			[2] Realm
				    -- Server's realm
				    -- Also client's in AS-REQ --,
	sname			[3] PrincipalName OPTIONAL,
	from			[4] KerberosTime OPTIONAL,
	till			[5] KerberosTime,
	rtime			[6] KerberosTime OPTIONAL,
	nonce			[7] UInt32,
	etype			[8] SEQUENCE OF Int32 -- EncryptionType
				    -- in preference order --,
	addresses		[9] HostAddresses OPTIONAL,
	enc-authorization-data	[10] EncryptedData {
					AuthorizationData,
					{ keyuse-TGSReqAuthData-sesskey
					  | keyuse-TGSReqAuthData-subkey }
				     } OPTIONAL,
	additional-tickets	[11] SEQUENCE OF Ticket OPTIONAL
}

-- Reply --

AS-REP		::= KDC-REP {11, EncASRepPart, {keyuse-EncASRepPart}}

KDC-REP {INTEGER:tagnum,
	 TypeToEncrypt,
	 UInt32:KeyUsages}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[0] INTEGER (5),
	msg-type	[1] INTEGER (tagnum),
	padata		[2] SEQUENCE OF PA-DATA OPTIONAL,
	crealm		[3] Realm,
	cname		[4] PrincipalName,
	ticket		[5] Ticket,
	enc-part	[6] EncryptedData {TypeToEncrypt, KeyUsages}
}

EncASRepPart	::= [APPLICATION 25] EncKDCRepPart

EncKDCRepPart	::= SEQUENCE {
	key		[0] EncryptionKey,
	last-req	[1] LastReq,
	nonce		[2] UInt32,
	key-expiration	[3] KerberosTime OPTIONAL,
	flags		[4] TicketFlags,
	authtime	[5] KerberosTime,
	starttime	[6] KerberosTime OPTIONAL,
	endtime		[7] KerberosTime,
	renew-till	[8] KerberosTime OPTIONAL,
	srealm		[9] Realm,
	sname		[10] PrincipalName,
	caddr		[11] HostAddresses OPTIONAL
}
</pre>

<h4 class="subheading">shishi_as</h4>

<p><a name="shishi_005fas"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as</b> (<var>Shishi * handle, Shishi_as ** as</var>)<var><a name="index-shishi_005fas-372"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>as</var>: holds pointer to newly allocate Shishi_as structure.

        <p>Allocate a new AS exchange variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_done</h4>

<p><a name="shishi_005fas_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_as_done</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005fdone-373"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Deallocate resources associated with AS exchange.  This should be
called by the application when it no longer need to utilize the AS
exchange handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_req</h4>

<p><a name="shishi_005fas_005freq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_as_req</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005freq-374"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Get ASN.1 AS-REQ structure from AS exchange.

        <p><strong>Return value:</strong> Returns the generated AS-REQ packet from the AS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_req_build</h4>

<p><a name="shishi_005fas_005freq_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_req_build</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005freq_005fbuild-375"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Possibly remove unset fields (e.g., rtime).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_req_set</h4>

<p><a name="shishi_005fas_005freq_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_as_req_set</b> (<var>Shishi_as * as, Shishi_asn1 asreq</var>)<var><a name="index-shishi_005fas_005freq_005fset-376"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>asreq</var>: asreq to store in AS.

        <p>Set the AS-REQ in the AS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_req_der</h4>

<p><a name="shishi_005fas_005freq_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_req_der</b> (<var>Shishi_as * as, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fas_005freq_005fder-377"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of AS-REQ.

        <p><var>outlen</var>: length of output array with DER encoding of AS-REQ.

        <p>DER encode AS-REQ.  <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_req_der_set</h4>

<p><a name="shishi_005fas_005freq_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_req_der_set</b> (<var>Shishi_as * as, char * der, size_t derlen</var>)<var><a name="index-shishi_005fas_005freq_005fder_005fset-378"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>der</var>: input array with DER encoded AP-REQ.

        <p><var>derlen</var>: length of input array with DER encoded AP-REQ.

        <p>DER decode AS-REQ and set it AS exchange.  If decoding fails, the
AS-REQ in the AS exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep</h4>

<p><a name="shishi_005fas_005frep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_as_rep</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005frep-379"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Get ASN.1 AS-REP structure from AS exchange.

        <p><strong>Return value:</strong> Returns the received AS-REP packet from the AS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep_process</h4>

<p><a name="shishi_005fas_005frep_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_rep_process</b> (<var>Shishi_as * as, Shishi_key * key, const char * password</var>)<var><a name="index-shishi_005fas_005frep_005fprocess-380"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>key</var>: user's key, used to encrypt the encrypted part of the AS-REP.

        <p><var>password</var>: user's password, used if key is NULL.

        <p>Process new AS-REP and set ticket.  The key is used to decrypt the
AP-REP.  If both key and password is NULL, the user is queried for
it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep_build</h4>

<p><a name="shishi_005fas_005frep_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_rep_build</b> (<var>Shishi_as * as, Shishi_key * key</var>)<var><a name="index-shishi_005fas_005frep_005fbuild-381"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>key</var>: user's key, used to encrypt the encrypted part of the AS-REP.

        <p>Build AS-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep_der</h4>

<p><a name="shishi_005fas_005frep_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_rep_der</b> (<var>Shishi_as * as, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fas_005frep_005fder-382"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of AS-REP.

        <p><var>outlen</var>: length of output array with DER encoding of AS-REP.

        <p>DER encode AS-REP. <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep_set</h4>

<p><a name="shishi_005fas_005frep_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_as_rep_set</b> (<var>Shishi_as * as, Shishi_asn1 asrep</var>)<var><a name="index-shishi_005fas_005frep_005fset-383"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>asrep</var>: asrep to store in AS.

        <p>Set the AS-REP in the AS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_rep_der_set</h4>

<p><a name="shishi_005fas_005frep_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_rep_der_set</b> (<var>Shishi_as * as, char * der, size_t derlen</var>)<var><a name="index-shishi_005fas_005frep_005fder_005fset-384"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>der</var>: input array with DER encoded AP-REP.

        <p><var>derlen</var>: length of input array with DER encoded AP-REP.

        <p>DER decode AS-REP and set it AS exchange.  If decoding fails, the
AS-REP in the AS exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_krberror</h4>

<p><a name="shishi_005fas_005fkrberror"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_as_krberror</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005fkrberror-385"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Get ASN.1 KRB-ERROR structure from AS exchange.

        <p><strong>Return value:</strong> Returns the received KRB-ERROR packet from the AS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_krberror_der</h4>

<p><a name="shishi_005fas_005fkrberror_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_krberror_der</b> (<var>Shishi_as * as, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fas_005fkrberror_005fder-386"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of KRB-ERROR.

        <p><var>outlen</var>: length of output array with DER encoding of KRB-ERROR.

        <p>DER encode KRB-ERROR. <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_krberror_set</h4>

<p><a name="shishi_005fas_005fkrberror_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_as_krberror_set</b> (<var>Shishi_as * as, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fas_005fkrberror_005fset-387"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>krberror</var>: krberror to store in AS.

        <p>Set the KRB-ERROR in the AS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_tkt</h4>

<p><a name="shishi_005fas_005ftkt"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_as_tkt</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005ftkt-388"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Get Ticket in AS exchange.

        <p><strong>Return value:</strong> Returns the newly aquired tkt from the AS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_tkt_set</h4>

<p><a name="shishi_005fas_005ftkt_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_as_tkt_set</b> (<var>Shishi_as * as, Shishi_tkt * tkt</var>)<var><a name="index-shishi_005fas_005ftkt_005fset-389"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>tkt</var>: tkt to store in AS.

        <p>Set the Tkt in the AS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_sendrecv_hint</h4>

<p><a name="shishi_005fas_005fsendrecv_005fhint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_sendrecv_hint</b> (<var>Shishi_as * as, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005fas_005fsendrecv_005fhint-390"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p><var>hint</var>: additional parameters that modify connection behaviour, or <code>NULL</code>.

        <p>Send AS-REQ and receive AS-REP or KRB-ERROR.  This is the initial
authentication, usually used to acquire a Ticket Granting Ticket. 
The <code>hint</code> structure can be used to set, e.g., parameters for TLS
authentication.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_sendrecv</h4>

<p><a name="shishi_005fas_005fsendrecv"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_sendrecv</b> (<var>Shishi_as * as</var>)<var><a name="index-shishi_005fas_005fsendrecv-391"></a></var><br>
<blockquote><p><var>as</var>: structure that holds information about AS exchange

        <p>Send AS-REQ and receive AS-REP or KRB-ERROR.  This is the initial
authentication, usually used to acquire a Ticket Granting Ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="TGS-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#AS-Functions">AS Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.8 TGS Functions</h3>

<p>The Ticket Granting Service (TGS) is used to get subsequent tickets,
authenticated by other tickets (so called ticket granting tickets). 
The following illustrates the TGS-REQ and TGS-REP ASN.1 structures.

<pre class="verbatim">-- Request --

TGS-REQ		::= KDC-REQ {12}

KDC-REQ {INTEGER:tagnum}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[1] INTEGER (5) -- first tag is [1], not [0] --,
	msg-type	[2] INTEGER (tagnum),
	padata		[3] SEQUENCE OF PA-DATA OPTIONAL,
	req-body	[4] KDC-REQ-BODY
}

KDC-REQ-BODY	::= SEQUENCE {
	kdc-options		[0] KDCOptions,
	cname			[1] PrincipalName OPTIONAL
				    -- Used only in AS-REQ --,
	realm			[2] Realm
				    -- Server's realm
				    -- Also client's in AS-REQ --,
	sname			[3] PrincipalName OPTIONAL,
	from			[4] KerberosTime OPTIONAL,
	till			[5] KerberosTime,
	rtime			[6] KerberosTime OPTIONAL,
	nonce			[7] UInt32,
	etype			[8] SEQUENCE OF Int32 -- EncryptionType
				    -- in preference order --,
	addresses		[9] HostAddresses OPTIONAL,
	enc-authorization-data	[10] EncryptedData {
					AuthorizationData,
					{ keyuse-TGSReqAuthData-sesskey
					  | keyuse-TGSReqAuthData-subkey }
				     } OPTIONAL,
	additional-tickets	[11] SEQUENCE OF Ticket OPTIONAL
}

-- Reply --

TGS-REP		::= KDC-REP {13, EncTGSRepPart,
			{ keyuse-EncTGSRepPart-sesskey
			  | keyuse-EncTGSRepPart-subkey }}

KDC-REP {INTEGER:tagnum,
	 TypeToEncrypt,
	 UInt32:KeyUsages}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[0] INTEGER (5),
	msg-type	[1] INTEGER (tagnum),
	padata		[2] SEQUENCE OF PA-DATA OPTIONAL,
	crealm		[3] Realm,
	cname		[4] PrincipalName,
	ticket		[5] Ticket,
	enc-part	[6] EncryptedData {TypeToEncrypt, KeyUsages}
}

EncTGSRepPart	::= [APPLICATION 26] EncKDCRepPart

EncKDCRepPart	::= SEQUENCE {
	key		[0] EncryptionKey,
	last-req	[1] LastReq,
	nonce		[2] UInt32,
	key-expiration	[3] KerberosTime OPTIONAL,
	flags		[4] TicketFlags,
	authtime	[5] KerberosTime,
	starttime	[6] KerberosTime OPTIONAL,
	endtime		[7] KerberosTime,
	renew-till	[8] KerberosTime OPTIONAL,
	srealm		[9] Realm,
	sname		[10] PrincipalName,
	caddr		[11] HostAddresses OPTIONAL
}
</pre>

<h4 class="subheading">shishi_tgs</h4>

<p><a name="shishi_005ftgs"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs</b> (<var>Shishi * handle, Shishi_tgs ** tgs</var>)<var><a name="index-shishi_005ftgs-392"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>tgs</var>: holds pointer to newly allocate Shishi_tgs structure.

        <p>Allocate a new TGS exchange variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_done</h4>

<p><a name="shishi_005ftgs_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tgs_done</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005fdone-393"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about AS exchange

        <p>Deallocate resources associated with TGS exchange.  This should be
called by the application when it no longer need to utilize the TGS
exchange handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_tgtkt</h4>

<p><a name="shishi_005ftgs_005ftgtkt"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tgs_tgtkt</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005ftgtkt-394"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get Ticket-granting-ticket from TGS exchange.

        <p><strong>Return value:</strong> Returns the ticket-granting-ticket used in the TGS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_tgtkt_set</h4>

<p><a name="shishi_005ftgs_005ftgtkt_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tgs_tgtkt_set</b> (<var>Shishi_tgs * tgs, Shishi_tkt * tgtkt</var>)<var><a name="index-shishi_005ftgs_005ftgtkt_005fset-395"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>tgtkt</var>: ticket granting ticket to store in TGS.

        <p>Set the Ticket in the TGS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_ap</h4>

<p><a name="shishi_005ftgs_005fap"></a>

<div class="defun">
&mdash; Function: Shishi_ap * <b>shishi_tgs_ap</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005fap-396"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get the AP from TGS exchange.

        <p><strong>Return value:</strong> Returns the AP exchange (part of TGS-REQ) from the
TGS exchange, or NULL if not yet set or an error
occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req</h4>

<p><a name="shishi_005ftgs_005freq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tgs_req</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005freq-397"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get the TGS-REQ from TGS exchange.

        <p><strong>Return value:</strong> Returns the generated TGS-REQ from the TGS exchange,
or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req_set</h4>

<p><a name="shishi_005ftgs_005freq_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tgs_req_set</b> (<var>Shishi_tgs * tgs, Shishi_asn1 tgsreq</var>)<var><a name="index-shishi_005ftgs_005freq_005fset-398"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>tgsreq</var>: tgsreq to store in TGS.

        <p>Set the TGS-REQ in the TGS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req_der</h4>

<p><a name="shishi_005ftgs_005freq_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_req_der</b> (<var>Shishi_tgs * tgs, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005ftgs_005freq_005fder-399"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of TGS-REQ.

        <p><var>outlen</var>: length of output array with DER encoding of TGS-REQ.

        <p>DER encode TGS-REQ. <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req_der_set</h4>

<p><a name="shishi_005ftgs_005freq_005fder_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_req_der_set</b> (<var>Shishi_tgs * tgs, char * der, size_t derlen</var>)<var><a name="index-shishi_005ftgs_005freq_005fder_005fset-400"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>der</var>: input array with DER encoded AP-REQ.

        <p><var>derlen</var>: length of input array with DER encoded AP-REQ.

        <p>DER decode TGS-REQ and set it TGS exchange.  If decoding fails, the
TGS-REQ in the TGS exchange remains.

        <p><strong>Return value:</strong> Returns SHISHI_OK. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req_process</h4>

<p><a name="shishi_005ftgs_005freq_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_req_process</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005freq_005fprocess-401"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Process new TGS-REQ and set ticket.  The key to decrypt the TGS-REQ
is taken from the EncKDCReqPart of the TGS tgticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_req_build</h4>

<p><a name="shishi_005ftgs_005freq_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_req_build</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005freq_005fbuild-402"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Checksum data in authenticator and add ticket and authenticator to
TGS-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_rep</h4>

<p><a name="shishi_005ftgs_005frep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tgs_rep</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005frep-403"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get TGS-REP from TGS exchange.

        <p><strong>Return value:</strong> Returns the received TGS-REP from the TGS exchange,
or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_rep_der</h4>

<p><a name="shishi_005ftgs_005frep_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_rep_der</b> (<var>Shishi_tgs * tgs, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005ftgs_005frep_005fder-404"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of TGS-REP.

        <p><var>outlen</var>: length of output array with DER encoding of TGS-REP.

        <p>DER encode TGS-REP. <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_rep_process</h4>

<p><a name="shishi_005ftgs_005frep_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_rep_process</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005frep_005fprocess-405"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Process new TGS-REP and set ticket.  The key to decrypt the TGS-REP
is taken from the EncKDCRepPart of the TGS tgticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_rep_build</h4>

<p><a name="shishi_005ftgs_005frep_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_rep_build</b> (<var>Shishi_tgs * tgs, int keyusage, Shishi_key * key</var>)<var><a name="index-shishi_005ftgs_005frep_005fbuild-406"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>keyusage</var>: keyusage integer.

        <p><var>key</var>: user's key, used to encrypt the encrypted part of the TGS-REP.

        <p>Build TGS-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_krberror</h4>

<p><a name="shishi_005ftgs_005fkrberror"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tgs_krberror</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005fkrberror-407"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get KRB-ERROR from TGS exchange.

        <p><strong>Return value:</strong> Returns the received TGS-REP from the TGS exchange,
or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_krberror_der</h4>

<p><a name="shishi_005ftgs_005fkrberror_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_krberror_der</b> (<var>Shishi_tgs * tgs, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005ftgs_005fkrberror_005fder-408"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>out</var>: output array with newly allocated DER encoding of KRB-ERROR.

        <p><var>outlen</var>: length of output array with DER encoding of KRB-ERROR.

        <p>DER encode KRB-ERROR.  <code>out</code> is allocated by this function, and it is
the responsibility of caller to deallocate it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_krberror_set</h4>

<p><a name="shishi_005ftgs_005fkrberror_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tgs_krberror_set</b> (<var>Shishi_tgs * tgs, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005ftgs_005fkrberror_005fset-409"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>krberror</var>: krberror to store in TGS.

        <p>Set the KRB-ERROR in the TGS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_tkt</h4>

<p><a name="shishi_005ftgs_005ftkt"></a>

<div class="defun">
&mdash; Function: Shishi_tkt * <b>shishi_tgs_tkt</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005ftkt-410"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Get Ticket from TGS exchange.

        <p><strong>Return value:</strong> Returns the newly aquired ticket from the TGS
exchange, or NULL if not yet set or an error occured. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_tkt_set</h4>

<p><a name="shishi_005ftgs_005ftkt_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_tgs_tkt_set</b> (<var>Shishi_tgs * tgs, Shishi_tkt * tkt</var>)<var><a name="index-shishi_005ftgs_005ftkt_005fset-411"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>tkt</var>: ticket to store in TGS.

        <p>Set the Ticket in the TGS exchange. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_sendrecv_hint</h4>

<p><a name="shishi_005ftgs_005fsendrecv_005fhint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_sendrecv_hint</b> (<var>Shishi_tgs * tgs, Shishi_tkts_hint * hint</var>)<var><a name="index-shishi_005ftgs_005fsendrecv_005fhint-412"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>hint</var>: additional parameters that modify connection behaviour, or <code>NULL</code>.

        <p>Send TGS-REQ and receive TGS-REP or KRB-ERROR.  This is the
subsequent authentication, usually used to acquire server tickets. 
The <code>hint</code> structure can be used to set, e.g., parameters for TLS
authentication.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_sendrecv</h4>

<p><a name="shishi_005ftgs_005fsendrecv"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_sendrecv</b> (<var>Shishi_tgs * tgs</var>)<var><a name="index-shishi_005ftgs_005fsendrecv-413"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p>Send TGS-REQ and receive TGS-REP or KRB-ERROR.  This is the
subsequent authentication, usually used to acquire server tickets.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_set_server</h4>

<p><a name="shishi_005ftgs_005fset_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_set_server</b> (<var>Shishi_tgs * tgs, const char * server</var>)<var><a name="index-shishi_005ftgs_005fset_005fserver-414"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>server</var>: indicates the server to acquire ticket for.

        <p>Set the server in the TGS-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_set_realm</h4>

<p><a name="shishi_005ftgs_005fset_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_set_realm</b> (<var>Shishi_tgs * tgs, const char * realm</var>)<var><a name="index-shishi_005ftgs_005fset_005frealm-415"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>realm</var>: indicates the realm to acquire ticket for.

        <p>Set the server in the TGS-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_set_realmserver</h4>

<p><a name="shishi_005ftgs_005fset_005frealmserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_set_realmserver</b> (<var>Shishi_tgs * tgs, const char * realm, const char * server</var>)<var><a name="index-shishi_005ftgs_005fset_005frealmserver-416"></a></var><br>
<blockquote><p><var>tgs</var>: structure that holds information about TGS exchange

        <p><var>realm</var>: indicates the realm to acquire ticket for.

        <p><var>server</var>: indicates the server to acquire ticket for.

        <p>Set the realm and server in the TGS-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="Ticket-(ASN.1)-Functions"></a>
<a name="Ticket-_0028ASN_002e1_0029-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#AS_002fTGS-Functions">AS/TGS Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TGS-Functions">TGS Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.9 Ticket (ASN.1) Functions</h3>

<p>See <a href="#Ticket-Functions">Ticket Functions</a>, for an high-level overview of tickets.  The
following illustrates the Ticket and EncTicketPart ASN.1 structures.

<pre class="verbatim">Ticket          ::= [APPLICATION 1] SEQUENCE {
        tkt-vno         [0] INTEGER (5),
        realm           [1] Realm,
        sname           [2] PrincipalName,
        enc-part        [3] EncryptedData -- EncTicketPart
}

-- Encrypted part of ticket
EncTicketPart   ::= [APPLICATION 3] SEQUENCE {
        flags                   [0] TicketFlags,
        key                     [1] EncryptionKey,
        crealm                  [2] Realm,
        cname                   [3] PrincipalName,
        transited               [4] TransitedEncoding,
        authtime                [5] KerberosTime,
        starttime               [6] KerberosTime OPTIONAL,
        endtime                 [7] KerberosTime,
        renew-till              [8] KerberosTime OPTIONAL,
        caddr                   [9] HostAddresses OPTIONAL,
        authorization-data      [10] AuthorizationData OPTIONAL
}
</pre>

<h4 class="subheading">shishi_ticket</h4>

<p><a name="shishi_005fticket"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_ticket</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fticket-417"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new ASN.1 Ticket, populated with some
default values.

        <p><strong>Return value:</strong> Returns the ticket or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_realm_get</h4>

<p><a name="shishi_005fticket_005frealm_005fget"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_realm_get</b> (<var>Shishi * handle, Shishi_asn1 ticket, char ** realm, size_t * realmlen</var>)<var><a name="index-shishi_005fticket_005frealm_005fget-418"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: input variable with ticket info.

        <p><var>realm</var>: output array with newly allocated name of realm in ticket.

        <p><var>realmlen</var>: size of output array.

        <p>Extract realm from ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_realm_set</h4>

<p><a name="shishi_005fticket_005frealm_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_realm_set</b> (<var>Shishi * handle, Shishi_asn1 ticket, const char * realm</var>)<var><a name="index-shishi_005fticket_005frealm_005fset-419"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: input variable with ticket info.

        <p><var>realm</var>: input array with name of realm.

        <p>Set the realm field in the Ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_server</h4>

<p><a name="shishi_005fticket_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_server</b> (<var>Shishi * handle, Shishi_asn1 ticket, char ** server, size_t * serverlen</var>)<var><a name="index-shishi_005fticket_005fserver-420"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>ticket</var>: ASN.1 Ticket variable to get server name from.

        <p><var>server</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>serverlen</code>).

        <p><var>serverlen</var>: pointer to length of <code>server</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>server</code>).

        <p>Represent server principal name in Ticket as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>serverlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_sname_set</h4>

<p><a name="shishi_005fticket_005fsname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_sname_set</b> (<var>Shishi * handle, Shishi_asn1 ticket, Shishi_name_type name_type, char * </var>[]<var> sname</var>)<var><a name="index-shishi_005fticket_005fsname_005fset-421"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: Ticket variable to set server name field in.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>sname</var>: input array with principal name.

        <p>Set the server name field in the Ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_get_enc_part_etype</h4>

<p><a name="shishi_005fticket_005fget_005fenc_005fpart_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_get_enc_part_etype</b> (<var>Shishi * handle, Shishi_asn1 ticket, int32_t * etype</var>)<var><a name="index-shishi_005fticket_005fget_005fenc_005fpart_005fetype-422"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: Ticket variable to get value from.

        <p><var>etype</var>: output variable that holds the value.

        <p>Extract Ticket.enc-part.etype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_set_enc_part</h4>

<p><a name="shishi_005fticket_005fset_005fenc_005fpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_set_enc_part</b> (<var>Shishi * handle, Shishi_asn1 ticket, int32_t etype, uint32_t kvno, const char * buf, size_t buflen</var>)<var><a name="index-shishi_005fticket_005fset_005fenc_005fpart-423"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: Ticket to add enc-part field to.

        <p><var>etype</var>: encryption type used to encrypt enc-part.

        <p><var>kvno</var>: key version number.

        <p><var>buf</var>: input array with encrypted enc-part.

        <p><var>buflen</var>: size of input array with encrypted enc-part.

        <p>Set the encrypted enc-part field in the Ticket.  The encrypted data
is usually created by calling <code>shishi_encrypt()</code> on the DER encoded
enc-part.  To save time, you may want to use
<code>shishi_ticket_add_enc_part()</code> instead, which calculates the
encrypted data and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ticket_add_enc_part</h4>

<p><a name="shishi_005fticket_005fadd_005fenc_005fpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ticket_add_enc_part</b> (<var>Shishi * handle, Shishi_asn1 ticket, Shishi_key * key, Shishi_asn1 encticketpart</var>)<var><a name="index-shishi_005fticket_005fadd_005fenc_005fpart-424"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>ticket</var>: Ticket to add enc-part field to.

        <p><var>key</var>: key used to encrypt enc-part.

        <p><var>encticketpart</var>: EncTicketPart to add.

        <p>Encrypts DER encoded EncTicketPart using key and stores it in the
Ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_get_key</h4>

<p><a name="shishi_005fencticketpart_005fget_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_get_key</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, Shishi_key ** key</var>)<var><a name="index-shishi_005fencticketpart_005fget_005fkey-425"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>key</var>: newly allocated key.

        <p>Extract the session key in the Ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_key_set</h4>

<p><a name="shishi_005fencticketpart_005fkey_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_key_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, Shishi_key * key</var>)<var><a name="index-shishi_005fencticketpart_005fkey_005fset-426"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>key</var>: key handle with information to store in encticketpart.

        <p>Set the EncTicketPart.key field to key type and value of supplied
key.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_flags_set</h4>

<p><a name="shishi_005fencticketpart_005fflags_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_flags_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, int flags</var>)<var><a name="index-shishi_005fencticketpart_005fflags_005fset-427"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>flags</var>: flags to set in encticketpart.

        <p>Set the EncTicketPart.flags to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_crealm_set</h4>

<p><a name="shishi_005fencticketpart_005fcrealm_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_crealm_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, const char * realm</var>)<var><a name="index-shishi_005fencticketpart_005fcrealm_005fset-428"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>realm</var>: input array with name of realm.

        <p>Set the realm field in the KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_cname_set</h4>

<p><a name="shishi_005fencticketpart_005fcname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_cname_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, Shishi_name_type name_type, const char * principal</var>)<var><a name="index-shishi_005fencticketpart_005fcname_005fset-429"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>principal</var>: input array with principal name.

        <p>Set the client name field in the EncTicketPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_transited_set</h4>

<p><a name="shishi_005fencticketpart_005ftransited_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_transited_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, int32_t trtype, const char * trdata, size_t trdatalen</var>)<var><a name="index-shishi_005fencticketpart_005ftransited_005fset-430"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>trtype</var>: transitedencoding type, e.g. SHISHI_TR_DOMAIN_X500_COMPRESS.

        <p><var>trdata</var>: actual transited realm data.

        <p><var>trdatalen</var>: length of actual transited realm data.

        <p>Set the EncTicketPart.transited field to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_authtime_set</h4>

<p><a name="shishi_005fencticketpart_005fauthtime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_authtime_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, const char * authtime</var>)<var><a name="index-shishi_005fencticketpart_005fauthtime_005fset-431"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>authtime</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.authtime to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_endtime_set</h4>

<p><a name="shishi_005fencticketpart_005fendtime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_endtime_set</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, const char * endtime</var>)<var><a name="index-shishi_005fencticketpart_005fendtime_005fset-432"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p><var>endtime</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.endtime to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_client</h4>

<p><a name="shishi_005fencticketpart_005fclient"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_client</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fencticketpart_005fclient-433"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: EncTicketPart variable to get client name from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Represent client principal name in EncTicketPart as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>clientlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encticketpart_clientrealm</h4>

<p><a name="shishi_005fencticketpart_005fclientrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encticketpart_clientrealm</b> (<var>Shishi * handle, Shishi_asn1 encticketpart, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fencticketpart_005fclientrealm-434"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>encticketpart</var>: EncTicketPart variable to get client name and realm from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name and realm.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Convert cname and realm fields from EncTicketPart to printable
principal name format.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <code>clientlen</code> does not include the terminating
zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="AS%2fTGS-Functions"></a>
<a name="AS_002fTGS-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authenticator-Functions">Authenticator Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.10 AS/TGS Functions</h3>

<p>The Authentication Service (AS) is used to get an initial ticket using
e.g. your password.  The Ticket Granting Service (TGS) is used to get
subsequent tickets using other tickets.  Protocol wise the procedures
are very similar, which is the reason they are described together. 
The following illustrates the AS-REQ, TGS-REQ and AS-REP, TGS-REP
ASN.1 structures.  Most of the functions use the mnemonic &ldquo;KDC&rdquo;
instead of either AS or TGS, which means the function operates on both
AS and TGS types.  Only where the distinction between AS and TGS is
important are the AS and TGS names used.  Remember, these are
low-level functions, and normal applications will likely be satisfied
with the AS (see <a href="#AS-Functions">AS Functions</a>) and TGS (see <a href="#TGS-Functions">TGS Functions</a>)
interfaces, or the even more high-level Ticket Set (see <a href="#Ticket-Set-Functions">Ticket Set Functions</a>) interface.

<pre class="verbatim">-- Request --

AS-REQ		::= KDC-REQ {10}
TGS-REQ		::= KDC-REQ {12}

KDC-REQ {INTEGER:tagnum}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[1] INTEGER (5) -- first tag is [1], not [0] --,
	msg-type	[2] INTEGER (tagnum),
	padata		[3] SEQUENCE OF PA-DATA OPTIONAL,
	req-body	[4] KDC-REQ-BODY
}

KDC-REQ-BODY	::= SEQUENCE {
	kdc-options		[0] KDCOptions,
	cname			[1] PrincipalName OPTIONAL
				    -- Used only in AS-REQ --,
	realm			[2] Realm
				    -- Server's realm
				    -- Also client's in AS-REQ --,
	sname			[3] PrincipalName OPTIONAL,
	from			[4] KerberosTime OPTIONAL,
	till			[5] KerberosTime,
	rtime			[6] KerberosTime OPTIONAL,
	nonce			[7] UInt32,
	etype			[8] SEQUENCE OF Int32 -- EncryptionType
				    -- in preference order --,
	addresses		[9] HostAddresses OPTIONAL,
	enc-authorization-data	[10] EncryptedData {
					AuthorizationData,
					{ keyuse-TGSReqAuthData-sesskey
					  | keyuse-TGSReqAuthData-subkey }
				     } OPTIONAL,
	additional-tickets	[11] SEQUENCE OF Ticket OPTIONAL
}

-- Reply --

AS-REP		::= KDC-REP {11, EncASRepPart, {keyuse-EncASRepPart}}
TGS-REP		::= KDC-REP {13, EncTGSRepPart,
			{ keyuse-EncTGSRepPart-sesskey
			  | keyuse-EncTGSRepPart-subkey }}

KDC-REP {INTEGER:tagnum,
	 TypeToEncrypt,
	 UInt32:KeyUsages}	::= [APPLICATION tagnum] SEQUENCE {
	pvno		[0] INTEGER (5),
	msg-type	[1] INTEGER (tagnum),
	padata		[2] SEQUENCE OF PA-DATA OPTIONAL,
	crealm		[3] Realm,
	cname		[4] PrincipalName,
	ticket		[5] Ticket,
	enc-part	[6] EncryptedData {TypeToEncrypt, KeyUsages}
}

EncASRepPart	::= [APPLICATION 25] EncKDCRepPart
EncTGSRepPart	::= [APPLICATION 26] EncKDCRepPart

EncKDCRepPart	::= SEQUENCE {
	key		[0] EncryptionKey,
	last-req	[1] LastReq,
	nonce		[2] UInt32,
	key-expiration	[3] KerberosTime OPTIONAL,
	flags		[4] TicketFlags,
	authtime	[5] KerberosTime,
	starttime	[6] KerberosTime OPTIONAL,
	endtime		[7] KerberosTime,
	renew-till	[8] KerberosTime OPTIONAL,
	srealm		[9] Realm,
	sname		[10] PrincipalName,
	caddr		[11] HostAddresses OPTIONAL
}
</pre>

<h4 class="subheading">shishi_as_derive_salt</h4>

<p><a name="shishi_005fas_005fderive_005fsalt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_derive_salt</b> (<var>Shishi * handle, Shishi_asn1 asreq, Shishi_asn1 asrep, char ** salt, size_t * saltlen</var>)<var><a name="index-shishi_005fas_005fderive_005fsalt-435"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>asreq</var>: input AS-REQ variable.

        <p><var>asrep</var>: input AS-REP variable.

        <p><var>salt</var>: newly allocated output array with salt.

        <p><var>saltlen</var>: holds actual size of output array with salt.

        <p>Derive the salt that should be used when deriving a key via
<code>shishi_string_to_key()</code> for an AS exchange.  Currently this searches
for PA-DATA of type SHISHI_PA_PW_SALT in the AS-REP and returns it
if found, otherwise the salt is derived from the client name and
realm in AS-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdc_copy_crealm</h4>

<p><a name="shishi_005fkdc_005fcopy_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdc_copy_crealm</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_asn1 encticketpart</var>)<var><a name="index-shishi_005fkdc_005fcopy_005fcrealm-436"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to read crealm from.

        <p><var>encticketpart</var>: EncTicketPart to set crealm in.

        <p>Set crealm in KDC-REP to value in EncTicketPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_check_crealm</h4>

<p><a name="shishi_005fas_005fcheck_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_check_crealm</b> (<var>Shishi * handle, Shishi_asn1 asreq, Shishi_asn1 asrep</var>)<var><a name="index-shishi_005fas_005fcheck_005fcrealm-437"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>asreq</var>: AS-REQ to compare realm field in.

        <p><var>asrep</var>: AS-REP to compare realm field in.

        <p>Verify that AS-REQ.req-body.realm and AS-REP.crealm fields matches. 
This is one of the steps that has to be performed when processing a
AS-REQ and AS-REP exchange, see <code>shishi_kdc_process()</code>.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_REALM_MISMATCH if the values differ, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdc_copy_cname</h4>

<p><a name="shishi_005fkdc_005fcopy_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdc_copy_cname</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_asn1 encticketpart</var>)<var><a name="index-shishi_005fkdc_005fcopy_005fcname-438"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REQ to read cname from.

        <p><var>encticketpart</var>: EncTicketPart to set cname in.

        <p>Set cname in KDC-REP to value in EncTicketPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_check_cname</h4>

<p><a name="shishi_005fas_005fcheck_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_check_cname</b> (<var>Shishi * handle, Shishi_asn1 asreq, Shishi_asn1 asrep</var>)<var><a name="index-shishi_005fas_005fcheck_005fcname-439"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>asreq</var>: AS-REQ to compare client name field in.

        <p><var>asrep</var>: AS-REP to compare client name field in.

        <p>Verify that AS-REQ.req-body.realm and AS-REP.crealm fields matches. 
This is one of the steps that has to be performed when processing a
AS-REQ and AS-REP exchange, see <code>shishi_kdc_process()</code>.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_CNAME_MISMATCH if the values differ, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdc_copy_nonce</h4>

<p><a name="shishi_005fkdc_005fcopy_005fnonce"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdc_copy_nonce</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_asn1 enckdcreppart</var>)<var><a name="index-shishi_005fkdc_005fcopy_005fnonce-440"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to read nonce from.

        <p><var>enckdcreppart</var>: EncKDCRepPart to set nonce in.

        <p>Set nonce in EncKDCRepPart to value in KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdc_check_nonce</h4>

<p><a name="shishi_005fkdc_005fcheck_005fnonce"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdc_check_nonce</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_asn1 enckdcreppart</var>)<var><a name="index-shishi_005fkdc_005fcheck_005fnonce-441"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to compare nonce field in.

        <p><var>enckdcreppart</var>: Encrypted KDC-REP part to compare nonce field in.

        <p>Verify that KDC-REQ.req-body.nonce and EncKDCRepPart.nonce fields
matches.  This is one of the steps that has to be performed when
processing a KDC-REQ and KDC-REP exchange.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_NONCE_LENGTH_MISMATCH if the nonces have different lengths
(usually indicates that buggy server truncated nonce to 4 bytes),
SHISHI_NONCE_MISMATCH if the values differ, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgs_process</h4>

<p><a name="shishi_005ftgs_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_tgs_process</b> (<var>Shishi * handle, Shishi_asn1 tgsreq, Shishi_asn1 tgsrep, Shishi_asn1 authenticator, Shishi_asn1 oldenckdcreppart, Shishi_asn1 * enckdcreppart</var>)<var><a name="index-shishi_005ftgs_005fprocess-442"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>tgsreq</var>: input variable that holds the sent KDC-REQ.

        <p><var>tgsrep</var>: input variable that holds the received KDC-REP.

        <p><var>authenticator</var>: input variable with Authenticator from AP-REQ in KDC-REQ.

        <p><var>oldenckdcreppart</var>: input variable with EncKDCRepPart used in request.

        <p><var>enckdcreppart</var>: output variable that holds new EncKDCRepPart.

        <p>Process a TGS client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  This function
simply derives the encryption key from the ticket used to construct
the TGS request and calls <code>shishi_kdc_process()</code>, which see.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff the TGS client exchange was
successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_as_process</h4>

<p><a name="shishi_005fas_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_as_process</b> (<var>Shishi * handle, Shishi_asn1 asreq, Shishi_asn1 asrep, const char * string, Shishi_asn1 * enckdcreppart</var>)<var><a name="index-shishi_005fas_005fprocess-443"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>asreq</var>: input variable that holds the sent KDC-REQ.

        <p><var>asrep</var>: input variable that holds the received KDC-REP.

        <p><var>string</var>: input variable with zero terminated password.

        <p><var>enckdcreppart</var>: output variable that holds new EncKDCRepPart.

        <p>Process an AS client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  This function
simply derives the encryption key from the password and calls
<code>shishi_kdc_process()</code>, which see.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff the AS client exchange was
successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdc_process</h4>

<p><a name="shishi_005fkdc_005fprocess"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdc_process</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_asn1 kdcrep, Shishi_key * key, int keyusage, Shishi_asn1 * enckdcreppart</var>)<var><a name="index-shishi_005fkdc_005fprocess-444"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: input variable that holds the sent KDC-REQ.

        <p><var>kdcrep</var>: input variable that holds the received KDC-REP.

        <p><var>key</var>: input array with key to decrypt encrypted part of KDC-REP with.

        <p><var>keyusage</var>: kereros key usage value.

        <p><var>enckdcreppart</var>: output variable that holds new EncKDCRepPart.

        <p>Process a KDC client exchange and output decrypted EncKDCRepPart
which holds details for the new ticket received.  Use
<code>shishi_kdcrep_get_ticket()</code> to extract the ticket.  This function
verifies the various conditions that must hold if the response is
to be considered valid, specifically it compares nonces
(<code>shishi_check_nonces()</code>) and if the exchange was a AS exchange, it
also compares cname and crealm (<code>shishi_check_cname()</code> and
<code>shishi_check_crealm()</code>).

        <p>Usually the <code>shishi_as_process()</code> and <code>shishi_tgs_process()</code> functions
should be used instead, since they simplify the decryption key
computation.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff the KDC client exchange was
successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_asreq</h4>

<p><a name="shishi_005fasreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasreq-445"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new AS-REQ, populated with some default
values.

        <p><strong>Return value:</strong> Returns the AS-REQ or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgsreq</h4>

<p><a name="shishi_005ftgsreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tgsreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ftgsreq-446"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new TGS-REQ, populated with some default
values.

        <p><strong>Return value:</strong> Returns the TGS-REQ or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_print</h4>

<p><a name="shishi_005fkdcreq_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fprint-447"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>kdcreq</var>: KDC-REQ to print.

        <p>Print ASCII armored DER encoding of KDC-REQ to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_save</h4>

<p><a name="shishi_005fkdcreq_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fsave-448"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>kdcreq</var>: KDC-REQ to save.

        <p>Print DER encoding of KDC-REQ to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_to_file</h4>

<p><a name="shishi_005fkdcreq_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_to_file</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkdcreq_005fto_005ffile-449"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write KDC-REQ to file in specified TYPE.  The file will be truncated
if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_parse</h4>

<p><a name="shishi_005fkdcreq_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fparse-450"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>kdcreq</var>: output variable with newly allocated KDC-REQ.

        <p>Read ASCII armored DER encoded KDC-REQ from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_read</h4>

<p><a name="shishi_005fkdcreq_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fread-451"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>kdcreq</var>: output variable with newly allocated KDC-REQ.

        <p>Read DER encoded KDC-REQ from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_from_file</h4>

<p><a name="shishi_005fkdcreq_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_from_file</b> (<var>Shishi * handle, Shishi_asn1 * kdcreq, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkdcreq_005ffrom_005ffile-452"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: output variable with newly allocated KDC-REQ.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read KDC-REQ from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_nonce_set</h4>

<p><a name="shishi_005fkdcreq_005fnonce_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_nonce_set</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, uint32_t nonce</var>)<var><a name="index-shishi_005fkdcreq_005fnonce_005fset-453"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set client name field in.

        <p><var>nonce</var>: integer nonce to store in KDC-REQ.

        <p>Store nonce number field in KDC-REQ.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_set_cname</h4>

<p><a name="shishi_005fkdcreq_005fset_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_set_cname</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_name_type name_type, const char * principal</var>)<var><a name="index-shishi_005fkdcreq_005fset_005fcname-454"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set client name field in.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>principal</var>: input array with principal name.

        <p>Set the client name field in the KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_client</h4>

<p><a name="shishi_005fkdcreq_005fclient"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_client</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fkdcreq_005fclient-455"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get client name from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Represent client principal name in KDC-REQ as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>clientlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_asreq_clientrealm</h4>

<p><a name="shishi_005fasreq_005fclientrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asreq_clientrealm</b> (<var>Shishi * handle, Shishi_asn1 asreq, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fasreq_005fclientrealm-456"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>asreq</var>: AS-REQ variable to get client name and realm from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name and realm.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Convert cname and realm fields from AS-REQ to printable principal
name format.  The string is allocate by this function, and it is
the responsibility of the caller to deallocate it.  Note that the
output length <code>clientlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_realm</h4>

<p><a name="shishi_005fkdcreq_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_realm</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, char ** realm, size_t * realmlen</var>)<var><a name="index-shishi_005fkdcreq_005frealm-457"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get client name from.

        <p><var>realm</var>: pointer to newly allocated zero terminated string containing
realm.  May be <code>NULL</code> (to only populate <code>realmlen</code>).

        <p><var>realmlen</var>: pointer to length of <code>realm</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>realmlen</code>).

        <p>Get realm field in KDC-REQ as zero-terminated string.  The string
is allocate by this function, and it is the responsibility of the
caller to deallocate it.  Note that the output length <code>realmlen</code>
does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_set_realm</h4>

<p><a name="shishi_005fkdcreq_005fset_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_set_realm</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, const char * realm</var>)<var><a name="index-shishi_005fkdcreq_005fset_005frealm-458"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set realm field in.

        <p><var>realm</var>: input array with name of realm.

        <p>Set the realm field in the KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_server</h4>

<p><a name="shishi_005fkdcreq_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_server</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, char ** server, size_t * serverlen</var>)<var><a name="index-shishi_005fkdcreq_005fserver-459"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get server name from.

        <p><var>server</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>serverlen</code>).

        <p><var>serverlen</var>: pointer to length of <code>server</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>server</code>).

        <p>Represent server principal name in KDC-REQ as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>serverlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_set_sname</h4>

<p><a name="shishi_005fkdcreq_005fset_005fsname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_set_sname</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_name_type name_type, const char * </var>[]<var> sname</var>)<var><a name="index-shishi_005fkdcreq_005fset_005fsname-460"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set server name field in.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>sname</var>: input array with principal name.

        <p>Set the server name field in the KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_till</h4>

<p><a name="shishi_005fkdcreq_005ftill"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_till</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, char ** till, size_t * tilllen</var>)<var><a name="index-shishi_005fkdcreq_005ftill-461"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get client name from.

        <p><var>till</var>: pointer to newly allocated zero terminated string containing
"till" field with generalized time.  May be <code>NULL</code> (to only
populate <code>realmlen</code>).

        <p><var>tilllen</var>: pointer to length of <code>till</code> on output, excluding
terminating zero.  May be <code>NULL</code> (to only populate <code>tilllen</code>).

        <p>Get "till" field (i.e. "endtime") in KDC-REQ, as zero-terminated
string.  The string is typically 15 characters long.  The string is
allocated by this function, and it is the responsibility of the
caller to deallocate it.  Note that the output length <code>realmlen</code>
does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_tillc</h4>

<p><a name="shishi_005fkdcreq_005ftillc"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_kdcreq_tillc</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005ftillc-462"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get till field from.

        <p>Extract C time corresponding to the "till" field.

        <p><strong>Return value:</strong> Returns C time interpretation of the "till" field in
KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_etype</h4>

<p><a name="shishi_005fkdcreq_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_etype</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, int32_t * etype, int netype</var>)<var><a name="index-shishi_005fkdcreq_005fetype-463"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get etype field from.

        <p><var>etype</var>: output encryption type.

        <p><var>netype</var>: element number to return.

        <p><strong>Return the netype:</strong> th encryption type from KDC-REQ.  The first etype
is number 1.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff etype successful set. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_set_etype</h4>

<p><a name="shishi_005fkdcreq_005fset_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_set_etype</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, int32_t * etype, int netype</var>)<var><a name="index-shishi_005fkdcreq_005fset_005fetype-464"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set etype field in.

        <p><var>etype</var>: input array with encryption types.

        <p><var>netype</var>: number of elements in input array with encryption types.

        <p>Set the list of supported or wanted encryption types in the
request.  The list should be sorted in priority order.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_options</h4>

<p><a name="shishi_005fkdcreq_005foptions"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_options</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, uint32_t * flags</var>)<var><a name="index-shishi_005fkdcreq_005foptions-465"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p><var>flags</var>: pointer to output integer with flags.

        <p>Extract KDC-Options from KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_forwardable_p</h4>

<p><a name="shishi_005fkdcreq_005fforwardable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_forwardable_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fforwardable_005fp-466"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option forwardable flag is set.

        <p>The FORWARDABLE option indicates that the ticket to be issued is to
have its forwardable flag set. It may only be set on the initial
request, or in a subsequent request if the ticket-granting ticket
on which it is based is also forwardable.

        <p><strong>Return value:</strong> Returns non-0 iff forwardable flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_forwarded_p</h4>

<p><a name="shishi_005fkdcreq_005fforwarded_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_forwarded_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fforwarded_005fp-467"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option forwarded flag is set.

        <p>The FORWARDED option is only specified in a request to the
ticket-granting server and will only be honored if the
ticket-granting ticket in the request has its FORWARDABLE bit
set. This option indicates that this is a request for
forwarding. The address(es) of the host from which the resulting
ticket is to be valid are included in the addresses field of the
request.

        <p><strong>Return value:</strong> Returns non-0 iff forwarded flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_proxiable_p</h4>

<p><a name="shishi_005fkdcreq_005fproxiable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_proxiable_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fproxiable_005fp-468"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option proxiable flag is set.

        <p>The PROXIABLE option indicates that the ticket to be issued is to
have its proxiable flag set. It may only be set on the initial
request, or in a subsequent request if the ticket-granting ticket
on which it is based is also proxiable.

        <p><strong>Return value:</strong> Returns non-0 iff proxiable flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_proxy_p</h4>

<p><a name="shishi_005fkdcreq_005fproxy_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_proxy_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fproxy_005fp-469"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option proxy flag is set.

        <p>The PROXY option indicates that this is a request for a proxy. This
option will only be honored if the ticket-granting ticket in the
request has its PROXIABLE bit set.  The address(es) of the host
from which the resulting ticket is to be valid are included in the
addresses field of the request.

        <p><strong>Return value:</strong> Returns non-0 iff proxy flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_allow_postdate_p</h4>

<p><a name="shishi_005fkdcreq_005fallow_005fpostdate_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_allow_postdate_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fallow_005fpostdate_005fp-470"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option allow-postdate flag is set.

        <p>The ALLOW-POSTDATE option indicates that the ticket to be issued is
to have its MAY-POSTDATE flag set. It may only be set on the
initial request, or in a subsequent request if the ticket-granting
ticket on which it is based also has its MAY-POSTDATE flag set.

        <p><strong>Return value:</strong> Returns non-0 iff allow-postdate flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_postdated_p</h4>

<p><a name="shishi_005fkdcreq_005fpostdated_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_postdated_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fpostdated_005fp-471"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option postdated flag is set.

        <p>The POSTDATED option indicates that this is a request for a
postdated ticket. This option will only be honored if the
ticket-granting ticket on which it is based has its MAY-POSTDATE
flag set. The resulting ticket will also have its INVALID flag set,
and that flag may be reset by a subsequent request to the KDC after
the starttime in the ticket has been reached.

        <p><strong>Return value:</strong> Returns non-0 iff postdated flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_renewable_p</h4>

<p><a name="shishi_005fkdcreq_005frenewable_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_renewable_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005frenewable_005fp-472"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option renewable flag is set.

        <p>The RENEWABLE option indicates that the ticket to be issued is to
have its RENEWABLE flag set. It may only be set on the initial
request, or when the ticket-granting ticket on which the request is
based is also renewable. If this option is requested, then the
rtime field in the request contains the desired absolute expiration
time for the ticket.

        <p><strong>Return value:</strong> Returns non-0 iff renewable flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_disable_transited_check_p</h4>

<p><a name="shishi_005fkdcreq_005fdisable_005ftransited_005fcheck_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_disable_transited_check_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fdisable_005ftransited_005fcheck_005fp-473"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option disable-transited-check flag is set.

        <p>By default the KDC will check the transited field of a
ticket-granting-ticket against the policy of the local realm before
it will issue derivative tickets based on the ticket-granting
ticket. If this flag is set in the request, checking of the
transited field is disabled. Tickets issued without the performance
of this check will be noted by the reset (0) value of the
TRANSITED-POLICY-CHECKED flag, indicating to the application server
that the tranisted field must be checked locally. KDCs are
encouraged but not required to honor the DISABLE-TRANSITED-CHECK
option.

        <p>This flag is new since RFC 1510

        <p><strong>Return value:</strong> Returns non-0 iff disable-transited-check flag is set
in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_renewable_ok_p</h4>

<p><a name="shishi_005fkdcreq_005frenewable_005fok_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_renewable_ok_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005frenewable_005fok_005fp-474"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option renewable-ok flag is set.

        <p>The RENEWABLE-OK option indicates that a renewable ticket will be
acceptable if a ticket with the requested life cannot otherwise be
provided. If a ticket with the requested life cannot be provided,
then a renewable ticket may be issued with a renew-till equal to
the requested endtime. The value of the renew-till field may still
be limited by local limits, or limits selected by the individual
principal or server.

        <p><strong>Return value:</strong> Returns non-0 iff renewable-ok flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_enc_tkt_in_skey_p</h4>

<p><a name="shishi_005fkdcreq_005fenc_005ftkt_005fin_005fskey_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_enc_tkt_in_skey_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fenc_005ftkt_005fin_005fskey_005fp-475"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option enc-tkt-in-skey flag is set.

        <p>This option is used only by the ticket-granting service. The
ENC-TKT-IN-SKEY option indicates that the ticket for the end server
is to be encrypted in the session key from the additional
ticket-granting ticket provided.

        <p><strong>Return value:</strong> Returns non-0 iff enc-tkt-in-skey flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_renew_p</h4>

<p><a name="shishi_005fkdcreq_005frenew_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_renew_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005frenew_005fp-476"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option renew flag is set.

        <p>This option is used only by the ticket-granting service. The RENEW
option indicates that the present request is for a renewal. The
ticket provided is encrypted in the secret key for the server on
which it is valid. This option will only be honored if the ticket
to be renewed has its RENEWABLE flag set and if the time in its
renew-till field has not passed. The ticket to be renewed is passed
in the padata field as part of the authentication header.

        <p><strong>Return value:</strong> Returns non-0 iff renew flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_validate_p</h4>

<p><a name="shishi_005fkdcreq_005fvalidate_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_validate_p</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fvalidate_005fp-477"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to get kdc-options field from.

        <p>Determine if KDC-Option validate flag is set.

        <p>This option is used only by the ticket-granting service. The
VALIDATE option indicates that the request is to validate a
postdated ticket. It will only be honored if the ticket presented
is postdated, presently has its INVALID flag set, and would be
otherwise usable at this time. A ticket cannot be validated before
its starttime. The ticket presented for validation is encrypted in
the key of the server for which it is valid and is passed in the
padata field as part of the authentication header.

        <p><strong>Return value:</strong> Returns non-0 iff validate flag is set in KDC-REQ. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_options_set</h4>

<p><a name="shishi_005fkdcreq_005foptions_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_options_set</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, uint32_t options</var>)<var><a name="index-shishi_005fkdcreq_005foptions_005fset-478"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set etype field in.

        <p><var>options</var>: integer with flags to store in KDC-REQ.

        <p>Set options in KDC-REQ.  Note that this reset any already existing
flags.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_options_add</h4>

<p><a name="shishi_005fkdcreq_005foptions_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_options_add</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, uint32_t option</var>)<var><a name="index-shishi_005fkdcreq_005foptions_005fadd-479"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ variable to set etype field in.

        <p><var>option</var>: integer with options to add in KDC-REQ.

        <p>Add KDC-Option to KDC-REQ.  This preserves all existing options.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_clear_padata</h4>

<p><a name="shishi_005fkdcreq_005fclear_005fpadata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_clear_padata</b> (<var>Shishi * handle, Shishi_asn1 kdcreq</var>)<var><a name="index-shishi_005fkdcreq_005fclear_005fpadata-480"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to remove PA-DATA from.

        <p>Remove the padata field from KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_get_padata</h4>

<p><a name="shishi_005fkdcreq_005fget_005fpadata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_get_padata</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_padata_type padatatype, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fkdcreq_005fget_005fpadata-481"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to get PA-DATA from.

        <p><var>padatatype</var>: type of PA-DATA, see Shishi_padata_type.

        <p><var>out</var>: output array with newly allocated PA-DATA value.

        <p><var>outlen</var>: size of output array with PA-DATA value.

        <p>Get pre authentication data (PA-DATA) from KDC-REQ.  Pre
authentication data is used to pass various information to KDC,
such as in case of a SHISHI_PA_TGS_REQ padatatype the AP-REQ that
authenticates the user to get the ticket.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_get_padata_tgs</h4>

<p><a name="shishi_005fkdcreq_005fget_005fpadata_005ftgs"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_get_padata_tgs</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_asn1 * apreq</var>)<var><a name="index-shishi_005fkdcreq_005fget_005fpadata_005ftgs-482"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to get PA-TGS-REQ from.

        <p><var>apreq</var>: Output variable with newly allocated AP-REQ.

        <p>Extract TGS pre-authentication data from KDC-REQ.  The data is an
AP-REQ that authenticates the request.  This function call
<code>shishi_kdcreq_get_padata()</code> with a SHISHI_PA_TGS_REQ padatatype and
DER decode the result (if any).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_add_padata</h4>

<p><a name="shishi_005fkdcreq_005fadd_005fpadata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_add_padata</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, int padatatype, const char * data, size_t datalen</var>)<var><a name="index-shishi_005fkdcreq_005fadd_005fpadata-483"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to add PA-DATA to.

        <p><var>padatatype</var>: type of PA-DATA, see Shishi_padata_type.

        <p><var>data</var>: input array with PA-DATA value.

        <p><var>datalen</var>: size of input array with PA-DATA value.

        <p>Add new pre authentication data (PA-DATA) to KDC-REQ.  This is used
to pass various information to KDC, such as in case of a
SHISHI_PA_TGS_REQ padatatype the AP-REQ that authenticates the user
to get the ticket.  (But also see <code>shishi_kdcreq_add_padata_tgs()</code>
which takes an AP-REQ directly.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_add_padata_tgs</h4>

<p><a name="shishi_005fkdcreq_005fadd_005fpadata_005ftgs"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_add_padata_tgs</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_asn1 apreq</var>)<var><a name="index-shishi_005fkdcreq_005fadd_005fpadata_005ftgs-484"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to add PA-DATA to.

        <p><var>apreq</var>: AP-REQ to add as PA-DATA.

        <p>Add TGS pre-authentication data to KDC-REQ.  The data is an AP-REQ
that authenticates the request.  This functions simply DER encodes
the AP-REQ and calls <code>shishi_kdcreq_add_padata()</code> with a
SHISHI_PA_TGS_REQ padatatype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcreq_add_padata_preauth</h4>

<p><a name="shishi_005fkdcreq_005fadd_005fpadata_005fpreauth"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcreq_add_padata_preauth</b> (<var>Shishi * handle, Shishi_asn1 kdcreq, Shishi_key * key</var>)<var><a name="index-shishi_005fkdcreq_005fadd_005fpadata_005fpreauth-485"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcreq</var>: KDC-REQ to add pre-authentication data to.

        <p><var>key</var>: Key used to encrypt pre-auth data.

        <p>Add pre-authentication data to KDC-REQ.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_asrep</h4>

<p><a name="shishi_005fasrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asrep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasrep-486"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new AS-REP, populated with some default
values.

        <p><strong>Return value:</strong> Returns the AS-REP or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_tgsrep</h4>

<p><a name="shishi_005ftgsrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_tgsrep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ftgsrep-487"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new TGS-REP, populated with some default
values.

        <p><strong>Return value:</strong> Returns the TGS-REP or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_print</h4>

<p><a name="shishi_005fkdcrep_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 kdcrep</var>)<var><a name="index-shishi_005fkdcrep_005fprint-488"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>kdcrep</var>: KDC-REP to print.

        <p>Print ASCII armored DER encoding of KDC-REP to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_save</h4>

<p><a name="shishi_005fkdcrep_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 kdcrep</var>)<var><a name="index-shishi_005fkdcrep_005fsave-489"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>kdcrep</var>: KDC-REP to save.

        <p>Print  DER encoding of KDC-REP to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_to_file</h4>

<p><a name="shishi_005fkdcrep_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_to_file</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkdcrep_005fto_005ffile-490"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write KDC-REP to file in specified TYPE.  The file will be truncated
if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_parse</h4>

<p><a name="shishi_005fkdcrep_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * kdcrep</var>)<var><a name="index-shishi_005fkdcrep_005fparse-491"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>kdcrep</var>: output variable with newly allocated KDC-REP.

        <p>Read ASCII armored DER encoded KDC-REP from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_read</h4>

<p><a name="shishi_005fkdcrep_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * kdcrep</var>)<var><a name="index-shishi_005fkdcrep_005fread-492"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>kdcrep</var>: output variable with newly allocated KDC-REP.

        <p>Read DER encoded KDC-REP from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_from_file</h4>

<p><a name="shishi_005fkdcrep_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_from_file</b> (<var>Shishi * handle, Shishi_asn1 * kdcrep, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkdcrep_005ffrom_005ffile-493"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: output variable with newly allocated KDC-REP.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read KDC-REP from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_crealm_set</h4>

<p><a name="shishi_005fkdcrep_005fcrealm_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_crealm_set</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, const char * crealm</var>)<var><a name="index-shishi_005fkdcrep_005fcrealm_005fset-494"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: Kdcrep variable to set realm field in.

        <p><var>crealm</var>: input array with name of realm.

        <p>Set the client realm field in the KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_cname_set</h4>

<p><a name="shishi_005fkdcrep_005fcname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_cname_set</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_name_type name_type, const char * </var>[]<var> cname</var>)<var><a name="index-shishi_005fkdcrep_005fcname_005fset-495"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: Kdcrep variable to set server name field in.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>cname</var>: input array with principal name.

        <p>Set the server name field in the KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_client_set</h4>

<p><a name="shishi_005fkdcrep_005fclient_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_client_set</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, const char * client</var>)<var><a name="index-shishi_005fkdcrep_005fclient_005fset-496"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: Kdcrep variable to set server name field in.

        <p><var>client</var>: zero-terminated string with principal name on RFC 1964 form.

        <p>Set the client name field in the KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_get_enc_part_etype</h4>

<p><a name="shishi_005fkdcrep_005fget_005fenc_005fpart_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_get_enc_part_etype</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, int32_t * etype</var>)<var><a name="index-shishi_005fkdcrep_005fget_005fenc_005fpart_005fetype-497"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP variable to get value from.

        <p><var>etype</var>: output variable that holds the value.

        <p>Extract KDC-REP.enc-part.etype.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_get_ticket</h4>

<p><a name="shishi_005fkdcrep_005fget_005fticket"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_get_ticket</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_asn1 * ticket</var>)<var><a name="index-shishi_005fkdcrep_005fget_005fticket-498"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP variable to get ticket from.

        <p><var>ticket</var>: output variable to hold extracted ticket.

        <p>Extract ticket from KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_set_ticket</h4>

<p><a name="shishi_005fkdcrep_005fset_005fticket"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_set_ticket</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_asn1 ticket</var>)<var><a name="index-shishi_005fkdcrep_005fset_005fticket-499"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to add ticket field to.

        <p><var>ticket</var>: input ticket to copy into KDC-REP ticket field.

        <p>Copy ticket into KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_set_enc_part</h4>

<p><a name="shishi_005fkdcrep_005fset_005fenc_005fpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_set_enc_part</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, int32_t etype, uint32_t kvno, const char * buf, size_t buflen</var>)<var><a name="index-shishi_005fkdcrep_005fset_005fenc_005fpart-500"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to add enc-part field to.

        <p><var>etype</var>: encryption type used to encrypt enc-part.

        <p><var>kvno</var>: key version number.

        <p><var>buf</var>: input array with encrypted enc-part.

        <p><var>buflen</var>: size of input array with encrypted enc-part.

        <p>Set the encrypted enc-part field in the KDC-REP.  The encrypted
data is usually created by calling <code>shishi_encrypt()</code> on the DER
encoded enc-part.  To save time, you may want to use
<code>shishi_kdcrep_add_enc_part()</code> instead, which calculates the
encrypted data and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_add_enc_part</h4>

<p><a name="shishi_005fkdcrep_005fadd_005fenc_005fpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_add_enc_part</b> (<var>Shishi * handle, Shishi_asn1 kdcrep, Shishi_key * key, int keyusage, Shishi_asn1 enckdcreppart</var>)<var><a name="index-shishi_005fkdcrep_005fadd_005fenc_005fpart-501"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to add enc-part field to.

        <p><var>key</var>: key used to encrypt enc-part.

        <p><var>keyusage</var>: key usage to use, normally SHISHI_KEYUSAGE_ENCASREPPART,
SHISHI_KEYUSAGE_ENCTGSREPPART_SESSION_KEY or
SHISHI_KEYUSAGE_ENCTGSREPPART_AUTHENTICATOR_KEY.

        <p><var>enckdcreppart</var>: EncKDCRepPart to add.

        <p>Encrypts DER encoded EncKDCRepPart using key and stores it in the
KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_kdcrep_clear_padata</h4>

<p><a name="shishi_005fkdcrep_005fclear_005fpadata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_kdcrep_clear_padata</b> (<var>Shishi * handle, Shishi_asn1 kdcrep</var>)<var><a name="index-shishi_005fkdcrep_005fclear_005fpadata-502"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>kdcrep</var>: KDC-REP to remove PA-DATA from.

        <p>Remove the padata field from KDC-REP.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_get_key</h4>

<p><a name="shishi_005fenckdcreppart_005fget_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_get_key</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, Shishi_key ** key</var>)<var><a name="index-shishi_005fenckdcreppart_005fget_005fkey-503"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>key</var>: newly allocated encryption key handle.

        <p>Extract the key to use with the ticket sent in the KDC-REP
associated with the EncKDCRepPart input variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_key_set</h4>

<p><a name="shishi_005fenckdcreppart_005fkey_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_key_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, Shishi_key * key</var>)<var><a name="index-shishi_005fenckdcreppart_005fkey_005fset-504"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>key</var>: key handle with information to store in enckdcreppart.

        <p>Set the EncKDCRepPart.key field to key type and value of supplied
key.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_nonce_set</h4>

<p><a name="shishi_005fenckdcreppart_005fnonce_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_nonce_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, uint32_t nonce</var>)<var><a name="index-shishi_005fenckdcreppart_005fnonce_005fset-505"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>nonce</var>: nonce to set in EncKDCRepPart.

        <p>Set the EncKDCRepPart.nonce field.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_flags_set</h4>

<p><a name="shishi_005fenckdcreppart_005fflags_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_flags_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, int flags</var>)<var><a name="index-shishi_005fenckdcreppart_005fflags_005fset-506"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>flags</var>: flags to set in EncKDCRepPart.

        <p>Set the EncKDCRepPart.flags field.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_authtime_set</h4>

<p><a name="shishi_005fenckdcreppart_005fauthtime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_authtime_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, const char * authtime</var>)<var><a name="index-shishi_005fenckdcreppart_005fauthtime_005fset-507"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>authtime</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.authtime to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_starttime_set</h4>

<p><a name="shishi_005fenckdcreppart_005fstarttime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_starttime_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, const char * starttime</var>)<var><a name="index-shishi_005fenckdcreppart_005fstarttime_005fset-508"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>starttime</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.starttime to supplied value.  Use a NULL
value for <code>starttime</code> to remove the field.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_endtime_set</h4>

<p><a name="shishi_005fenckdcreppart_005fendtime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_endtime_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, const char * endtime</var>)<var><a name="index-shishi_005fenckdcreppart_005fendtime_005fset-509"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>endtime</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.endtime to supplied value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_renew_till_set</h4>

<p><a name="shishi_005fenckdcreppart_005frenew_005ftill_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_renew_till_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, const char * renew_till</var>)<var><a name="index-shishi_005fenckdcreppart_005frenew_005ftill_005fset-510"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>renew_till</var>: character buffer containing a generalized time string.

        <p>Set the EncTicketPart.renew-till to supplied value.  Use a NULL
value for <code>renew_till</code> to remove the field.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_srealm_set</h4>

<p><a name="shishi_005fenckdcreppart_005fsrealm_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_srealm_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, const char * srealm</var>)<var><a name="index-shishi_005fenckdcreppart_005fsrealm_005fset-511"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: EncKDCRepPart variable to set realm field in.

        <p><var>srealm</var>: input array with name of realm.

        <p>Set the server realm field in the EncKDCRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_sname_set</h4>

<p><a name="shishi_005fenckdcreppart_005fsname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_sname_set</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, Shishi_name_type name_type, char * </var>[]<var> sname</var>)<var><a name="index-shishi_005fenckdcreppart_005fsname_005fset-512"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: EncKDCRepPart variable to set server name field in.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>sname</var>: input array with principal name.

        <p>Set the server name field in the EncKDCRepPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_enckdcreppart_populate_encticketpart</h4>

<p><a name="shishi_005fenckdcreppart_005fpopulate_005fencticketpart"></a>

<div class="defun">
&mdash; Function: int <b>shishi_enckdcreppart_populate_encticketpart</b> (<var>Shishi * handle, Shishi_asn1 enckdcreppart, Shishi_asn1 encticketpart</var>)<var><a name="index-shishi_005fenckdcreppart_005fpopulate_005fencticketpart-513"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>enckdcreppart</var>: input EncKDCRepPart variable.

        <p><var>encticketpart</var>: input EncTicketPart variable.

        <p>Set the flags, authtime, starttime, endtime, renew-till and caddr
fields of the EncKDCRepPart to the corresponding values in the
EncTicketPart.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<div class="node">
<a name="Authenticator-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#AS_002fTGS-Functions">AS/TGS Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.11 Authenticator Functions</h3>

<p>An &ldquo;Authenticator&rdquo; is an ASN.1 structure that work as a proof that
an entity owns a ticket.  It is usually embedded in the AP-REQ
structure (see <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a>), and you most likely
want to use an AP-REQ instead of a Authenticator in normal
applications.  The following illustrates the Authenticator ASN.1
structure.

<pre class="verbatim">Authenticator	::= [APPLICATION 2] SEQUENCE  {
	authenticator-vno	[0] INTEGER (5),
	crealm			[1] Realm,
	cname			[2] PrincipalName,
	cksum			[3] Checksum OPTIONAL,
	cusec			[4] Microseconds,
	ctime			[5] KerberosTime,
	subkey			[6] EncryptionKey OPTIONAL,
	seq-number		[7] UInt32 OPTIONAL,
	authorization-data	[8] AuthorizationData OPTIONAL
}
</pre>

<h4 class="subheading">shishi_authenticator</h4>

<p><a name="shishi_005fauthenticator"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_authenticator</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fauthenticator-514"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new Authenticator, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields.

        <p><strong>Return value:</strong> Returns the authenticator or NULL on
failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_subkey</h4>

<p><a name="shishi_005fauthenticator_005fsubkey"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_authenticator_subkey</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fauthenticator_005fsubkey-515"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new Authenticator, populated with some
default values.  It uses the current time as returned by the system
for the ctime and cusec fields. It adds a random subkey.

        <p><strong>Return value:</strong> Returns the authenticator or NULL on
failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_print</h4>

<p><a name="shishi_005fauthenticator_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fprint-516"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Print ASCII armored DER encoding of authenticator to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_save</h4>

<p><a name="shishi_005fauthenticator_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fsave-517"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Save DER encoding of authenticator to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_to_file</h4>

<p><a name="shishi_005fauthenticator_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_to_file</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int filetype, const char * filename</var>)<var><a name="index-shishi_005fauthenticator_005fto_005ffile-518"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write Authenticator to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_parse</h4>

<p><a name="shishi_005fauthenticator_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fparse-519"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>authenticator</var>: output variable with newly allocated authenticator.

        <p>Read ASCII armored DER encoded authenticator from file and populate
given authenticator variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_read</h4>

<p><a name="shishi_005fauthenticator_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fread-520"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>authenticator</var>: output variable with newly allocated authenticator.

        <p>Read DER encoded authenticator from file and populate given
authenticator variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_from_file</h4>

<p><a name="shishi_005fauthenticator_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_from_file</b> (<var>Shishi * handle, Shishi_asn1 * authenticator, int filetype, const char * filename</var>)<var><a name="index-shishi_005fauthenticator_005ffrom_005ffile-521"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: output variable with newly allocated Authenticator.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read Authenticator from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_set_crealm</h4>

<p><a name="shishi_005fauthenticator_005fset_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_set_crealm</b> (<var>Shishi * handle, Shishi_asn1 authenticator, const char * crealm</var>)<var><a name="index-shishi_005fauthenticator_005fset_005fcrealm-522"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>crealm</var>: input array with realm.

        <p>Set realm field in authenticator to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_set_cname</h4>

<p><a name="shishi_005fauthenticator_005fset_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_set_cname</b> (<var>Shishi * handle, Shishi_asn1 authenticator, Shishi_name_type name_type, const char * </var>[]<var> cname</var>)<var><a name="index-shishi_005fauthenticator_005fset_005fcname-523"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>cname</var>: input array with principal name.

        <p>Set principal field in authenticator to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_client_set</h4>

<p><a name="shishi_005fauthenticator_005fclient_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_client_set</b> (<var>Shishi * handle, Shishi_asn1 authenticator, const char * client</var>)<var><a name="index-shishi_005fauthenticator_005fclient_005fset-524"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator to set client name field in.

        <p><var>client</var>: zero-terminated string with principal name on RFC 1964 form.

        <p>Set the client name field in the Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_ctime</h4>

<p><a name="shishi_005fauthenticator_005fctime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_ctime</b> (<var>Shishi * handle, Shishi_asn1 authenticator, char ** t</var>)<var><a name="index-shishi_005fauthenticator_005fctime-525"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>t</var>: newly allocated zero-terminated character array with client time.

        <p>Extract client time from Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_ctime_set</h4>

<p><a name="shishi_005fauthenticator_005fctime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_ctime_set</b> (<var>Shishi * handle, Shishi_asn1 authenticator, const char * t</var>)<var><a name="index-shishi_005fauthenticator_005fctime_005fset-526"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>t</var>: string with generalized time value to store in Authenticator.

        <p>Store client time in Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_cusec_get</h4>

<p><a name="shishi_005fauthenticator_005fcusec_005fget"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_cusec_get</b> (<var>Shishi * handle, Shishi_asn1 authenticator, uint32_t * cusec</var>)<var><a name="index-shishi_005fauthenticator_005fcusec_005fget-527"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>cusec</var>: output integer with client microseconds field.

        <p>Extract client microseconds field from Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_cusec_set</h4>

<p><a name="shishi_005fauthenticator_005fcusec_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_cusec_set</b> (<var>Shishi * handle, Shishi_asn1 authenticator, uint32_t cusec</var>)<var><a name="index-shishi_005fauthenticator_005fcusec_005fset-528"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>cusec</var>: client microseconds to set in authenticator, 0-999999.

        <p>Set the cusec field in the Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_seqnumber_get</h4>

<p><a name="shishi_005fauthenticator_005fseqnumber_005fget"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_seqnumber_get</b> (<var>Shishi * handle, Shishi_asn1 authenticator, uint32_t * seqnumber</var>)<var><a name="index-shishi_005fauthenticator_005fseqnumber_005fget-529"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>seqnumber</var>: output integer with sequence number field.

        <p>Extract sequence number field from Authenticator.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_seqnumber_remove</h4>

<p><a name="shishi_005fauthenticator_005fseqnumber_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_seqnumber_remove</b> (<var>Shishi * handle, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fseqnumber_005fremove-530"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Remove sequence number field in Authenticator.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_seqnumber_set</h4>

<p><a name="shishi_005fauthenticator_005fseqnumber_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_seqnumber_set</b> (<var>Shishi * handle, Shishi_asn1 authenticator, uint32_t seqnumber</var>)<var><a name="index-shishi_005fauthenticator_005fseqnumber_005fset-531"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>seqnumber</var>: integer with sequence number field to store in Authenticator.

        <p>Store sequence number field in Authenticator.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_client</h4>

<p><a name="shishi_005fauthenticator_005fclient"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_client</b> (<var>Shishi * handle, Shishi_asn1 authenticator, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fauthenticator_005fclient-532"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator variable to get client name from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Represent client principal name in Authenticator as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>clientlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_clientrealm</h4>

<p><a name="shishi_005fauthenticator_005fclientrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_clientrealm</b> (<var>Shishi * handle, Shishi_asn1 authenticator, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fauthenticator_005fclientrealm-533"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator variable to get client name and realm from.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name and realm.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Convert cname and realm fields from Authenticator to printable
principal name format.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <code>clientlen</code> does not include the terminating
zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_cksum</h4>

<p><a name="shishi_005fauthenticator_005fcksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_cksum</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int32_t * cksumtype, char ** cksum, size_t * cksumlen</var>)<var><a name="index-shishi_005fauthenticator_005fcksum-534"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>cksumtype</var>: output checksum type.

        <p><var>cksum</var>: newly allocated output checksum data from authenticator.

        <p><var>cksumlen</var>: on output, actual size of allocated output checksum data buffer.

        <p>Read checksum value from authenticator.  <code>cksum</code> is allocated by
this function, and it is the responsibility of caller to deallocate
it.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_set_cksum</h4>

<p><a name="shishi_005fauthenticator_005fset_005fcksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_set_cksum</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int32_t cksumtype, char * cksum, size_t cksumlen</var>)<var><a name="index-shishi_005fauthenticator_005fset_005fcksum-535"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>cksumtype</var>: input checksum type to store in authenticator.

        <p><var>cksum</var>: input checksum data to store in authenticator.

        <p><var>cksumlen</var>: size of input checksum data to store in authenticator.

        <p>Store checksum value in authenticator.  A checksum is usually created
by calling <code>shishi_checksum()</code> on some application specific data using
the key from the ticket that is being used.  To save time, you may
want to use <code>shishi_authenticator_add_cksum()</code> instead, which calculates
the checksum and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_cksum</h4>

<p><a name="shishi_005fauthenticator_005fadd_005fcksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_cksum</b> (<var>Shishi * handle, Shishi_asn1 authenticator, Shishi_key * key, int keyusage, char * data, size_t datalen</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005fcksum-536"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>key</var>: key to to use for encryption.

        <p><var>keyusage</var>: cryptographic key usage value to use in encryption.

        <p><var>data</var>: input array with data to calculate checksum on.

        <p><var>datalen</var>: size of input array with data to calculate checksum on.

        <p>Calculate checksum for data and store it in the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_cksum_type</h4>

<p><a name="shishi_005fauthenticator_005fadd_005fcksum_005ftype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_cksum_type</b> (<var>Shishi * handle, Shishi_asn1 authenticator, Shishi_key * key, int keyusage, int cksumtype, char * data, size_t datalen</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005fcksum_005ftype-537"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>key</var>: key to to use for encryption.

        <p><var>keyusage</var>: cryptographic key usage value to use in encryption.

        <p><var>cksumtype</var>: checksum to type to calculate checksum.

        <p><var>data</var>: input array with data to calculate checksum on.

        <p><var>datalen</var>: size of input array with data to calculate checksum on.

        <p>Calculate checksum for data and store it in the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_clear_authorizationdata</h4>

<p><a name="shishi_005fauthenticator_005fclear_005fauthorizationdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_clear_authorizationdata</b> (<var>Shishi * handle, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fclear_005fauthorizationdata-538"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: Authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Remove the authorization-data field from Authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_authorizationdata</h4>

<p><a name="shishi_005fauthenticator_005fadd_005fauthorizationdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_authorizationdata</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int32_t adtype, const char * addata, size_t addatalen</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005fauthorizationdata-539"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>adtype</var>: input authorization data type to add.

        <p><var>addata</var>: input authorization data to add.

        <p><var>addatalen</var>: size of input authorization data to add.

        <p>Add authorization data to authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_authorizationdata</h4>

<p><a name="shishi_005fauthenticator_005fauthorizationdata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_authorizationdata</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int32_t * adtype, char ** addata, size_t * addatalen, size_t nth</var>)<var><a name="index-shishi_005fauthenticator_005fauthorizationdata-540"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>adtype</var>: output authorization data type.

        <p><var>addata</var>: newly allocated output authorization data.

        <p><var>addatalen</var>: on output, actual size of newly allocated authorization data.

        <p><var>nth</var>: element number of authorization-data to extract.

        <p><strong>Extract n:</strong> th authorization data from authenticator.  The first
field is 1.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_remove_subkey</h4>

<p><a name="shishi_005fauthenticator_005fremove_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_remove_subkey</b> (<var>Shishi * handle, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fremove_005fsubkey-541"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Remove subkey from the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_get_subkey</h4>

<p><a name="shishi_005fauthenticator_005fget_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_get_subkey</b> (<var>Shishi * handle, Shishi_asn1 authenticator, Shishi_key ** subkey</var>)<var><a name="index-shishi_005fauthenticator_005fget_005fsubkey-542"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>subkey</var>: output newly allocated subkey from authenticator.

        <p>Read subkey value from authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful or SHISHI_ASN1_NO_ELEMENT
if subkey is not present. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_set_subkey</h4>

<p><a name="shishi_005fauthenticator_005fset_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_set_subkey</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int32_t subkeytype, const char * subkey, size_t subkeylen</var>)<var><a name="index-shishi_005fauthenticator_005fset_005fsubkey-543"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>subkeytype</var>: input subkey type to store in authenticator.

        <p><var>subkey</var>: input subkey data to store in authenticator.

        <p><var>subkeylen</var>: size of input subkey data to store in authenticator.

        <p>Store subkey value in authenticator.  A subkey is usually created
by calling <code>shishi_key_random()</code> using the default encryption type of
the key from the ticket that is being used.  To save time, you may
want to use <code>shishi_authenticator_add_subkey()</code> instead, which calculates
the subkey and calls this function in one step.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_random_subkey</h4>

<p><a name="shishi_005fauthenticator_005fadd_005frandom_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_random_subkey</b> (<var>Shishi * handle, Shishi_asn1 authenticator</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005frandom_005fsubkey-544"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p>Generate random subkey, of the default encryption type from
configuration, and store it in the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_random_subkey_etype</h4>

<p><a name="shishi_005fauthenticator_005fadd_005frandom_005fsubkey_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_random_subkey_etype</b> (<var>Shishi * handle, Shishi_asn1 authenticator, int etype</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005frandom_005fsubkey_005fetype-545"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>etype</var>: encryption type of random key to generate.

        <p>Generate random subkey of indicated encryption type, and store it
in the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_authenticator_add_subkey</h4>

<p><a name="shishi_005fauthenticator_005fadd_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authenticator_add_subkey</b> (<var>Shishi * handle, Shishi_asn1 authenticator, Shishi_key * subkey</var>)<var><a name="index-shishi_005fauthenticator_005fadd_005fsubkey-546"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>authenticator</var>: authenticator as allocated by <code>shishi_authenticator()</code>.

        <p><var>subkey</var>: subkey to add to authenticator.

        <p>Store subkey in the authenticator.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="KRB-ERROR-Functions"></a>
<a name="KRB_002dERROR-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cryptographic-Functions">Cryptographic Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Authenticator-Functions">Authenticator Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.12 KRB-ERROR Functions</h3>

<p>The &ldquo;KRB-ERROR&rdquo; is an ASN.1 structure that can be returned, instead
of, e.g., KDC-REP or AP-REP, to indicate various error conditions. 
Unfortunately, the semantics of several of the fields are ill
specified, so the typically procedure is to extract &ldquo;e-text&rdquo; and/or
&ldquo;e-data&rdquo; and show it to the user.  The following illustrates the
KRB-ERROR ASN.1 structure.

<pre class="verbatim">KRB-ERROR       ::= [APPLICATION 30] SEQUENCE {
        pvno            [0] INTEGER (5),
        msg-type        [1] INTEGER (30),
        ctime           [2] KerberosTime OPTIONAL,
        cusec           [3] Microseconds OPTIONAL,
        stime           [4] KerberosTime,
        susec           [5] Microseconds,
        error-code      [6] Int32,
        crealm          [7] Realm OPTIONAL,
        cname           [8] PrincipalName OPTIONAL,
        realm           [9] Realm -- service realm --,
        sname           [10] PrincipalName -- service name --,
        e-text          [11] KerberosString OPTIONAL,
        e-data          [12] OCTET STRING OPTIONAL
}
</pre>

<h4 class="subheading">shishi_krberror</h4>

<p><a name="shishi_005fkrberror"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_krberror</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fkrberror-547"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>This function creates a new KRB-ERROR, populated with some default
values.

        <p><strong>Return value:</strong> Returns the KRB-ERROR or NULL on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_print</h4>

<p><a name="shishi_005fkrberror_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fprint-548"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>krberror</var>: KRB-ERROR to print.

        <p>Print ASCII armored DER encoding of KRB-ERROR to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_save</h4>

<p><a name="shishi_005fkrberror_005fsave"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_save</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fsave-549"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for writing.

        <p><var>krberror</var>: KRB-ERROR to save.

        <p>Save DER encoding of KRB-ERROR to file.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_to_file</h4>

<p><a name="shishi_005fkrberror_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_to_file</b> (<var>Shishi * handle, Shishi_asn1 krberror, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkrberror_005fto_005ffile-550"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR to save.

        <p><var>filetype</var>: input variable specifying type of file to be written,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to write to.

        <p>Write KRB-ERROR to file in specified TYPE.  The file will be
truncated if it exists.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_parse</h4>

<p><a name="shishi_005fkrberror_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_parse</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * krberror</var>)<var><a name="index-shishi_005fkrberror_005fparse-551"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>krberror</var>: output variable with newly allocated KRB-ERROR.

        <p>Read ASCII armored DER encoded KRB-ERROR from file and populate given
variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_read</h4>

<p><a name="shishi_005fkrberror_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_read</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 * krberror</var>)<var><a name="index-shishi_005fkrberror_005fread-552"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle open for reading.

        <p><var>krberror</var>: output variable with newly allocated KRB-ERROR.

        <p>Read DER encoded KRB-ERROR from file and populate given variable.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_from_file</h4>

<p><a name="shishi_005fkrberror_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_from_file</b> (<var>Shishi * handle, Shishi_asn1 * krberror, int filetype, const char * filename</var>)<var><a name="index-shishi_005fkrberror_005ffrom_005ffile-553"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: output variable with newly allocated KRB-ERROR.

        <p><var>filetype</var>: input variable specifying type of file to be read,
see Shishi_filetype.

        <p><var>filename</var>: input variable with filename to read from.

        <p>Read KRB-ERROR from file in specified TYPE.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_build</h4>

<p><a name="shishi_005fkrberror_005fbuild"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_build</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fbuild-554"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p>Finish KRB-ERROR, called before e.g. shishi_krberror_der.  This
function removes empty but OPTIONAL fields (such as cname), and

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_der</h4>

<p><a name="shishi_005fkrberror_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_der</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fkrberror_005fder-555"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>out</var>: output array with newly allocated DER encoding of KRB-ERROR.

        <p><var>outlen</var>: length of output array with DER encoding of KRB-ERROR.

        <p>DER encode KRB-ERROR.  The caller must deallocate the OUT buffer.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_crealm</h4>

<p><a name="shishi_005fkrberror_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_crealm</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** realm, size_t * realmlen</var>)<var><a name="index-shishi_005fkrberror_005fcrealm-556"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>realm</var>: output array with newly allocated name of realm in KRB-ERROR.

        <p><var>realmlen</var>: size of output array.

        <p>Extract client realm from KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_crealm</h4>

<p><a name="shishi_005fkrberror_005fremove_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_crealm</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fcrealm-557"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove client realm field in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_crealm</h4>

<p><a name="shishi_005fkrberror_005fset_005fcrealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_crealm</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * crealm</var>)<var><a name="index-shishi_005fkrberror_005fset_005fcrealm-558"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>crealm</var>: input array with realm.

        <p>Set realm field in krberror to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_client</h4>

<p><a name="shishi_005fkrberror_005fclient"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_client</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** client, size_t * clientlen</var>)<var><a name="index-shishi_005fkrberror_005fclient-559"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>client</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>clientlen</code>).

        <p><var>clientlen</var>: pointer to length of <code>client</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>client</code>).

        <p>Return client principal name in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_cname</h4>

<p><a name="shishi_005fkrberror_005fset_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_cname</b> (<var>Shishi * handle, Shishi_asn1 krberror, Shishi_name_type name_type, const char * </var>[]<var> cname</var>)<var><a name="index-shishi_005fkrberror_005fset_005fcname-560"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>cname</var>: input array with principal name.

        <p>Set principal field in krberror to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_cname</h4>

<p><a name="shishi_005fkrberror_005fremove_005fcname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_cname</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fcname-561"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove client realm field in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_client_set</h4>

<p><a name="shishi_005fkrberror_005fclient_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_client_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * client</var>)<var><a name="index-shishi_005fkrberror_005fclient_005fset-562"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror to set client name field in.

        <p><var>client</var>: zero-terminated string with principal name on RFC 1964 form.

        <p>Set the client name field in the Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_realm</h4>

<p><a name="shishi_005fkrberror_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_realm</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** realm, size_t * realmlen</var>)<var><a name="index-shishi_005fkrberror_005frealm-563"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>realm</var>: output array with newly allocated name of realm in KRB-ERROR.

        <p><var>realmlen</var>: size of output array.

        <p>Extract (server) realm from KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_realm</h4>

<p><a name="shishi_005fkrberror_005fset_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_realm</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * realm</var>)<var><a name="index-shishi_005fkrberror_005fset_005frealm-564"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>realm</var>: input array with (server) realm.

        <p>Set (server) realm field in krberror to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_server</h4>

<p><a name="shishi_005fkrberror_005fserver"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_server</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** server, size_t * serverlen</var>)<var><a name="index-shishi_005fkrberror_005fserver-565"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>server</var>: pointer to newly allocated zero terminated string containing
server name.  May be <code>NULL</code> (to only populate <code>serverlen</code>).

        <p><var>serverlen</var>: pointer to length of <code>server</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>server</code>).

        <p>Return server principal name in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_sname</h4>

<p><a name="shishi_005fkrberror_005fremove_005fsname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_sname</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fsname-566"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror to set server name field in.

        <p>Remove server name field in KRB-ERROR.  (Since it is not marked
OPTIONAL in the ASN.1 profile, what is done is to set the name-type
to UNKNOWN and make sure the name-string sequence is empty.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_sname</h4>

<p><a name="shishi_005fkrberror_005fset_005fsname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_sname</b> (<var>Shishi * handle, Shishi_asn1 krberror, Shishi_name_type name_type, const char * </var>[]<var> sname</var>)<var><a name="index-shishi_005fkrberror_005fset_005fsname-567"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>sname</var>: input array with principal name.

        <p>Set principal field in krberror to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_server_set</h4>

<p><a name="shishi_005fkrberror_005fserver_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_server_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * server</var>)<var><a name="index-shishi_005fkrberror_005fserver_005fset-568"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror to set server name field in.

        <p><var>server</var>: zero-terminated string with principal name on RFC 1964 form.

        <p>Set the server name field in the Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_ctime</h4>

<p><a name="shishi_005fkrberror_005fctime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_ctime</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** t</var>)<var><a name="index-shishi_005fkrberror_005fctime-569"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror to set client name field in.

        <p><var>t</var>: newly allocated zero-terminated output array with client time.

        <p>Extract client time from KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_ctime_set</h4>

<p><a name="shishi_005fkrberror_005fctime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_ctime_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * t</var>)<var><a name="index-shishi_005fkrberror_005fctime_005fset-570"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>t</var>: string with generalized time value to store in Krberror.

        <p>Store client time in Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_ctime</h4>

<p><a name="shishi_005fkrberror_005fremove_005fctime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_ctime</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fctime-571"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove client time field in Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_cusec</h4>

<p><a name="shishi_005fkrberror_005fcusec"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_cusec</b> (<var>Shishi * handle, Shishi_asn1 krberror, uint32_t * cusec</var>)<var><a name="index-shishi_005fkrberror_005fcusec-572"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>cusec</var>: output integer with client microseconds field.

        <p>Extract client microseconds field from Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_cusec_set</h4>

<p><a name="shishi_005fkrberror_005fcusec_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_cusec_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, uint32_t cusec</var>)<var><a name="index-shishi_005fkrberror_005fcusec_005fset-573"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>cusec</var>: client microseconds to set in krberror, 0-999999.

        <p>Set the cusec field in the Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_cusec</h4>

<p><a name="shishi_005fkrberror_005fremove_005fcusec"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_cusec</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fcusec-574"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove client usec field in Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_stime</h4>

<p><a name="shishi_005fkrberror_005fstime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_stime</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** t</var>)<var><a name="index-shishi_005fkrberror_005fstime-575"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror to set client name field in.

        <p><var>t</var>: newly allocated zero-terminated output array with server time.

        <p>Extract server time from KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_stime_set</h4>

<p><a name="shishi_005fkrberror_005fstime_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_stime_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * t</var>)<var><a name="index-shishi_005fkrberror_005fstime_005fset-576"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>t</var>: string with generalized time value to store in Krberror.

        <p>Store server time in Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_susec</h4>

<p><a name="shishi_005fkrberror_005fsusec"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_susec</b> (<var>Shishi * handle, Shishi_asn1 krberror, uint32_t * susec</var>)<var><a name="index-shishi_005fkrberror_005fsusec-577"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: Krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>susec</var>: output integer with server microseconds field.

        <p>Extract server microseconds field from Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_susec_set</h4>

<p><a name="shishi_005fkrberror_005fsusec_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_susec_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, uint32_t susec</var>)<var><a name="index-shishi_005fkrberror_005fsusec_005fset-578"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>susec</var>: server microseconds to set in krberror, 0-999999.

        <p>Set the susec field in the Krberror.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_errorcode</h4>

<p><a name="shishi_005fkrberror_005ferrorcode"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_errorcode</b> (<var>Shishi * handle, Shishi_asn1 krberror, int32_t * errorcode</var>)<var><a name="index-shishi_005fkrberror_005ferrorcode-579"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p><var>errorcode</var>: output integer KRB-ERROR error code.

        <p>Extract error code from KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_errorcode_fast</h4>

<p><a name="shishi_005fkrberror_005ferrorcode_005ffast"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_errorcode_fast</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005ferrorcode_005ffast-580"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p>Get error code from KRB-ERROR, without error checking.

        <p><strong>Return value:</strong> Return error code (see <code>shishi_krberror_errorcode()</code>)
directly, or -1 on error. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_errorcode_set</h4>

<p><a name="shishi_005fkrberror_005ferrorcode_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_errorcode_set</b> (<var>Shishi * handle, Shishi_asn1 krberror, int errorcode</var>)<var><a name="index-shishi_005fkrberror_005ferrorcode_005fset-581"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code to set.

        <p><var>errorcode</var>: new error code to set in krberror.

        <p>Set the error-code field to a new error code.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_etext</h4>

<p><a name="shishi_005fkrberror_005fetext"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_etext</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** etext, size_t * etextlen</var>)<var><a name="index-shishi_005fkrberror_005fetext-582"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p><var>etext</var>: output array with newly allocated error text.

        <p><var>etextlen</var>: output length of error text.

        <p>Extract additional error text from server (possibly empty).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_etext</h4>

<p><a name="shishi_005fkrberror_005fset_005fetext"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_etext</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * etext</var>)<var><a name="index-shishi_005fkrberror_005fset_005fetext-583"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>etext</var>: input array with error text to set.

        <p>Set error text (e-text) field in KRB-ERROR to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_etext</h4>

<p><a name="shishi_005fkrberror_005fremove_005fetext"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_etext</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fetext-584"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove error text (e-text) field in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_edata</h4>

<p><a name="shishi_005fkrberror_005fedata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_edata</b> (<var>Shishi * handle, Shishi_asn1 krberror, char ** edata, size_t * edatalen</var>)<var><a name="index-shishi_005fkrberror_005fedata-585"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p><var>edata</var>: output array with newly allocated error data.

        <p><var>edatalen</var>: output length of error data.

        <p>Extract additional error data from server (possibly empty).

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_methoddata</h4>

<p><a name="shishi_005fkrberror_005fmethoddata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_methoddata</b> (<var>Shishi * handle, Shishi_asn1 krberror, Shishi_asn1 * methoddata</var>)<var><a name="index-shishi_005fkrberror_005fmethoddata-586"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p><var>methoddata</var>: output ASN.1 METHOD-DATA.

        <p>Extract METHOD-DATA ASN.1 object from the e-data field.  The e-data
field will only contain a METHOD-DATA if the krberror error code is
<code>SHISHI_KDC_ERR_PREAUTH_REQUIRED</code>.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_set_edata</h4>

<p><a name="shishi_005fkrberror_005fset_005fedata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_set_edata</b> (<var>Shishi * handle, Shishi_asn1 krberror, const char * edata</var>)<var><a name="index-shishi_005fkrberror_005fset_005fedata-587"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p><var>edata</var>: input array with error text to set.

        <p>Set error text (e-data) field in KRB-ERROR to specified value.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_remove_edata</h4>

<p><a name="shishi_005fkrberror_005fremove_005fedata"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_remove_edata</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fremove_005fedata-588"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: krberror as allocated by <code>shishi_krberror()</code>.

        <p>Remove error text (e-data) field in KRB-ERROR.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_pretty_print</h4>

<p><a name="shishi_005fkrberror_005fpretty_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_krberror_pretty_print</b> (<var>Shishi * handle, FILE * fh, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fpretty_005fprint-589"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>fh</var>: file handle opened for writing.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p>Print KRB-ERROR error condition and some explanatory text to file
descriptor.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_errorcode_message</h4>

<p><a name="shishi_005fkrberror_005ferrorcode_005fmessage"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_krberror_errorcode_message</b> (<var>Shishi * handle, int errorcode</var>)<var><a name="index-shishi_005fkrberror_005ferrorcode_005fmessage-590"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>errorcode</var>: integer KRB-ERROR error code.

        <p>Get human readable string describing KRB-ERROR code.

        <p><strong>Return value:</strong> Return a string describing error code.  This function
will always return a string even if the error code
isn't known. 
</p></blockquote></div>

<h4 class="subheading">shishi_krberror_message</h4>

<p><a name="shishi_005fkrberror_005fmessage"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_krberror_message</b> (<var>Shishi * handle, Shishi_asn1 krberror</var>)<var><a name="index-shishi_005fkrberror_005fmessage-591"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>krberror</var>: KRB-ERROR structure with error code.

        <p>Extract error code (see <code>shishi_krberror_errorcode_fast()</code>) and
return error message (see <code>shishi_krberror_errorcode_message()</code>).

        <p><strong>Return value:</strong> Return a string describing error code.  This function
will always return a string even if the error code
isn't known. 
</p></blockquote></div>

<div class="node">
<a name="Cryptographic-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#X_002e509-Functions">X.509 Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.13 Cryptographic Functions</h3>

<p>Underneath the high-level functions described earlier, cryptographic
operations are happening.  If you need to access these cryptographic
primitives directly, this section describes the functions available.

   <p>Most cryptographic operations need keying material, and cryptographic
keys have been isolated into it's own data structure
<code>Shishi_key</code>.  The following illustrates it's contents, but note
that you cannot access it's elements directly but must use the
accessor functions described below.

<pre class="verbatim">struct Shishi_key
{
  int type;    /* RFC 1510 encryption integer type */
  char *value; /* Cryptographic key data */
  int version; /* RFC 1510 ``kvno'' */
};
</pre>

   <p>All functions that operate on this data structure are described now.

<h4 class="subheading">shishi_key_principal</h4>

<p><a name="shishi_005fkey_005fprincipal"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_key_principal</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005fprincipal-592"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Get the principal part of the key owner principal name, i.e.,
except the realm.

        <p><strong>Return value:</strong> Returns the principal owning the key.  (Not a copy of
it, so don't modify or deallocate it.) 
</p></blockquote></div>

<h4 class="subheading">shishi_key_principal_set</h4>

<p><a name="shishi_005fkey_005fprincipal_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_principal_set</b> (<var>Shishi_key * key, const char * principal</var>)<var><a name="index-shishi_005fkey_005fprincipal_005fset-593"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p><var>principal</var>: string with new principal name.

        <p>Set the principal owning the key. The string is copied into the
key, so you can dispose of the variable immediately after calling
this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_realm</h4>

<p><a name="shishi_005fkey_005frealm"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_key_realm</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005frealm-594"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Get the realm part of the key owner principal name.

        <p><strong>Return value:</strong> Returns the realm for the principal owning the key. 
(Not a copy of it, so don't modify or deallocate it.) 
</p></blockquote></div>

<h4 class="subheading">shishi_key_realm_set</h4>

<p><a name="shishi_005fkey_005frealm_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_realm_set</b> (<var>Shishi_key * key, const char * realm</var>)<var><a name="index-shishi_005fkey_005frealm_005fset-595"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p><var>realm</var>: string with new realm name.

        <p>Set the realm for the principal owning the key. The string is
copied into the key, so you can dispose of the variable immediately
after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_type</h4>

<p><a name="shishi_005fkey_005ftype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_type</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005ftype-596"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Get key type.

        <p><strong>Return value:</strong> Returns the type of key as an integer as described in
the standard. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_type_set</h4>

<p><a name="shishi_005fkey_005ftype_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_type_set</b> (<var>Shishi_key * key, int32_t type</var>)<var><a name="index-shishi_005fkey_005ftype_005fset-597"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p><var>type</var>: type to set in key.

        <p>Set the type of key in key structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_value</h4>

<p><a name="shishi_005fkey_005fvalue"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_key_value</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005fvalue-598"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Get the raw key bytes.

        <p><strong>Return value:</strong> Returns the key value as a pointer which is valid
throughout the lifetime of the key structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_value_set</h4>

<p><a name="shishi_005fkey_005fvalue_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_value_set</b> (<var>Shishi_key * key, const char * value</var>)<var><a name="index-shishi_005fkey_005fvalue_005fset-599"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p><var>value</var>: input array with key data.

        <p>Set the key value and length in key structure.  The value is copied
into the key (in other words, you can deallocate <code>value</code> right after
calling this function without modifying the value inside the key). 
</p></blockquote></div>

<h4 class="subheading">shishi_key_version</h4>

<p><a name="shishi_005fkey_005fversion"></a>

<div class="defun">
&mdash; Function: uint32_t <b>shishi_key_version</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005fversion-600"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Get the "kvno" (key version) of key.  It will be UINT32_MAX if the
key is not long-lived.

        <p><strong>Return value:</strong> Returns the version of key ("kvno"). 
</p></blockquote></div>

<h4 class="subheading">shishi_key_version_set</h4>

<p><a name="shishi_005fkey_005fversion_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_version_set</b> (<var>Shishi_key * key, uint32_t kvno</var>)<var><a name="index-shishi_005fkey_005fversion_005fset-601"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p><var>kvno</var>: new version integer.

        <p>Set the version of key ("kvno") in key structure.  Use UINT32_MAX
for non-ptermanent keys. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_name</h4>

<p><a name="shishi_005fkey_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_key_name</b> (<var>Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005fname-602"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Calls shishi_cipher_name for key type.

        <p><strong>Return value:</strong> Return name of key. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_length</h4>

<p><a name="shishi_005fkey_005flength"></a>

<div class="defun">
&mdash; Function: size_t <b>shishi_key_length</b> (<var>const Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005flength-603"></a></var><br>
<blockquote><p><var>key</var>: structure that holds key information

        <p>Calls shishi_cipher_keylen for key type.

        <p><strong>Return value:</strong> Returns the length of the key value. 
</p></blockquote></div>

<h4 class="subheading">shishi_key</h4>

<p><a name="shishi_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key</b> (<var>Shishi * handle, Shishi_key ** key</var>)<var><a name="index-shishi_005fkey-604"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>key</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_done</h4>

<p><a name="shishi_005fkey_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_done</b> (<var>Shishi_key * key</var>)<var><a name="index-shishi_005fkey_005fdone-605"></a></var><br>
<blockquote><p><var>key</var>: pointer to structure that holds key information.

        <p>Deallocates key information structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_copy</h4>

<p><a name="shishi_005fkey_005fcopy"></a>

<div class="defun">
&mdash; Function: void <b>shishi_key_copy</b> (<var>Shishi_key * dstkey, Shishi_key * srckey</var>)<var><a name="index-shishi_005fkey_005fcopy-606"></a></var><br>
<blockquote><p><var>dstkey</var>: structure that holds destination key information

        <p><var>srckey</var>: structure that holds source key information

        <p>Copies source key into existing allocated destination key. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_from_value</h4>

<p><a name="shishi_005fkey_005ffrom_005fvalue"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_from_value</b> (<var>Shishi * handle, int32_t type, const char * value, Shishi_key ** key</var>)<var><a name="index-shishi_005fkey_005ffrom_005fvalue-607"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>value</var>: input array with key value, or NULL.

        <p><var>key</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure, and set the key type and
key value. KEY contains a newly allocated structure only if this
function is successful.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_from_base64</h4>

<p><a name="shishi_005fkey_005ffrom_005fbase64"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_from_base64</b> (<var>Shishi * handle, int32_t type, const char * value, Shishi_key ** key</var>)<var><a name="index-shishi_005fkey_005ffrom_005fbase64-608"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>value</var>: input string with base64 encoded key value, or NULL.

        <p><var>key</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure, and set the key type and
key value. KEY contains a newly allocated structure only if this
function is successful.

        <p><strong>Return value:</strong> Returns SHISHI_INVALID_KEY if the base64 encoded key
length doesn't match the key type, and SHISHI_OK on
success. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_random</h4>

<p><a name="shishi_005fkey_005frandom"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_random</b> (<var>Shishi * handle, int32_t type, Shishi_key ** key</var>)<var><a name="index-shishi_005fkey_005frandom-609"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>key</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure for the key type and some
random data.  KEY contains a newly allocated structure only if this
function is successful.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_from_random</h4>

<p><a name="shishi_005fkey_005ffrom_005frandom"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_from_random</b> (<var>Shishi * handle, int32_t type, const char * rnd, size_t rndlen, Shishi_key ** outkey</var>)<var><a name="index-shishi_005fkey_005ffrom_005frandom-610"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>rnd</var>: random data.

        <p><var>rndlen</var>: length of random data.

        <p><var>outkey</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure, and set the key type and
key value using <code>shishi_random_to_key()</code>.  KEY contains a newly
allocated structure only if this function is successful.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_from_string</h4>

<p><a name="shishi_005fkey_005ffrom_005fstring"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_from_string</b> (<var>Shishi * handle, int32_t type, const char * password, size_t passwordlen, const char * salt, size_t saltlen, const char * parameter, Shishi_key ** outkey</var>)<var><a name="index-shishi_005fkey_005ffrom_005fstring-611"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>password</var>: input array containing password.

        <p><var>passwordlen</var>: length of input array containing password.

        <p><var>salt</var>: input array containing salt.

        <p><var>saltlen</var>: length of input array containing salt.

        <p><var>parameter</var>: input array with opaque encryption type specific information.

        <p><var>outkey</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure, and set the key type and
key value using <code>shishi_string_to_key()</code>.  KEY contains a newly
allocated structure only if this function is successful.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_key_from_name</h4>

<p><a name="shishi_005fkey_005ffrom_005fname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_key_from_name</b> (<var>Shishi * handle, int32_t type, const char * name, const char * password, size_t passwordlen, const char * parameter, Shishi_key ** outkey</var>)<var><a name="index-shishi_005fkey_005ffrom_005fname-612"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>type</var>: type of key.

        <p><var>name</var>: principal name of user.

        <p><var>password</var>: input array containing password.

        <p><var>passwordlen</var>: length of input array containing password.

        <p><var>parameter</var>: input array with opaque encryption type specific information.

        <p><var>outkey</var>: pointer to structure that will hold newly created key information

        <p>Create a new Key information structure, and derive the key from
principal name and password using <code>shishi_key_from_name()</code>.  The salt
is derived from the principal name by concatenating the decoded
realm and principal.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

   <p>Applications that run uninteractively may need keying material.  In
these cases, the keys are stored in a file, a file that is normally
stored on the local host.  The file should be protected from
unauthorized access.  The file is in ASCII format and contains keys as
outputed by <code>shishi_key_print</code>.  All functions that handle these
keys sets are described now.

<h4 class="subheading">shishi_keys</h4>

<p><a name="shishi_005fkeys"></a>

<div class="defun">
&mdash; Function: int <b>shishi_keys</b> (<var>Shishi * handle, Shishi_keys ** keys</var>)<var><a name="index-shishi_005fkeys-613"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>keys</var>: output pointer to newly allocated keys handle.

        <p>Get a new key set handle.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_done</h4>

<p><a name="shishi_005fkeys_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_keys_done</b> (<var>Shishi_keys ** keys</var>)<var><a name="index-shishi_005fkeys_005fdone-614"></a></var><br>
<blockquote><p><var>keys</var>: key set handle as allocated by <code>shishi_keys()</code>.

        <p>Deallocates all resources associated with key set.  The key set
handle must not be used in calls to other shishi_keys_*() functions
after this. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_size</h4>

<p><a name="shishi_005fkeys_005fsize"></a>

<div class="defun">
&mdash; Function: int <b>shishi_keys_size</b> (<var>Shishi_keys * keys</var>)<var><a name="index-shishi_005fkeys_005fsize-615"></a></var><br>
<blockquote><p><var>keys</var>: key set handle as allocated by <code>shishi_keys()</code>.

        <p>Get size of key set.

        <p><strong>Return value:</strong> Returns number of keys stored in key set. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_nth</h4>

<p><a name="shishi_005fkeys_005fnth"></a>

<div class="defun">
&mdash; Function: const Shishi_key * <b>shishi_keys_nth</b> (<var>Shishi_keys * keys, int keyno</var>)<var><a name="index-shishi_005fkeys_005fnth-616"></a></var><br>
<blockquote><p><var>keys</var>: key set handle as allocated by <code>shishi_keys()</code>.

        <p><var>keyno</var>: integer indicating requested key in key set.

        <p><strong>Get the n:</strong> th ticket in key set.

        <p><strong>Return value:</strong> Returns a key handle to the keyno:th key in the key
set, or NULL if <code>keys</code> is invalid or <code>keyno</code> is out of bounds.  The
first key is <code>keyno</code> 0, the second key <code>keyno</code> 1, and so on. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_remove</h4>

<p><a name="shishi_005fkeys_005fremove"></a>

<div class="defun">
&mdash; Function: void <b>shishi_keys_remove</b> (<var>Shishi_keys * keys, int keyno</var>)<var><a name="index-shishi_005fkeys_005fremove-617"></a></var><br>
<blockquote><p><var>keys</var>: key set handle as allocated by <code>shishi_keys()</code>.

        <p><var>keyno</var>: key number of key in the set to remove.  The first
key is key number 0.

        <p>Remove a key, indexed by <code>keyno</code>, in given key set. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_add</h4>

<p><a name="shishi_005fkeys_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shishi_keys_add</b> (<var>Shishi_keys * keys, Shishi_key * key</var>)<var><a name="index-shishi_005fkeys_005fadd-618"></a></var><br>
<blockquote><p><var>keys</var>: key set handle as allocated by <code>shishi_keys()</code>.

        <p><var>key</var>: key to be added to key set.

        <p>Add a key to the key set.  A deep copy of the key is stored, so
changing <code>key</code>, or deallocating it, will not modify the value stored
in the key set.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_print</h4>

<p><a name="shishi_005fkeys_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>shishi_keys_print</b> (<var>Shishi_keys * keys, FILE * fh</var>)<var><a name="index-shishi_005fkeys_005fprint-619"></a></var><br>
<blockquote><p><var>keys</var>: key set to print.

        <p><var>fh</var>: file handle, open for writing, to print keys to.

        <p>Print all keys in set using shishi_key_print.

        <p><strong>Returns:</strong> Returns <code>SHISHI_OK</code> on success. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_to_file</h4>

<p><a name="shishi_005fkeys_005fto_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shishi_keys_to_file</b> (<var>Shishi * handle, const char * filename, Shishi_keys * keys</var>)<var><a name="index-shishi_005fkeys_005fto_005ffile-620"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>filename</var>: filename to append key to.

        <p><var>keys</var>: set of keys to print.

        <p>Print an ASCII representation of a key structure to a file, for
each key in the key set.  The file is appended to if it exists. 
See <code>shishi_key_print()</code> for the format of the output.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_for_serverrealm_in_file</h4>

<p><a name="shishi_005fkeys_005ffor_005fserverrealm_005fin_005ffile"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_keys_for_serverrealm_in_file</b> (<var>Shishi * handle, const char * filename, const char * server, const char * realm</var>)<var><a name="index-shishi_005fkeys_005ffor_005fserverrealm_005fin_005ffile-621"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>filename</var>: file to read keys from.

        <p><var>server</var>: server name to get key for.

        <p><var>realm</var>: realm of server to get key for.

        <p>Get keys that match specified <code>server</code> and <code>realm</code> from the key set
file <code>filename</code>.

        <p><strong>Return value:</strong> Returns the key for specific server and realm, read
from the indicated file, or NULL if no key could be found or an
error encountered. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_for_server_in_file</h4>

<p><a name="shishi_005fkeys_005ffor_005fserver_005fin_005ffile"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_keys_for_server_in_file</b> (<var>Shishi * handle, const char * filename, const char * server</var>)<var><a name="index-shishi_005fkeys_005ffor_005fserver_005fin_005ffile-622"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>filename</var>: file to read keys from.

        <p><var>server</var>: server name to get key for.

        <p>Get key for specified <code>server</code> from <code>filename</code>.

        <p><strong>Return value:</strong> Returns the key for specific server, read from the
indicated file, or NULL if no key could be found or an error
encountered. 
</p></blockquote></div>

<h4 class="subheading">shishi_keys_for_localservicerealm_in_file</h4>

<p><a name="shishi_005fkeys_005ffor_005flocalservicerealm_005fin_005ffile"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_keys_for_localservicerealm_in_file</b> (<var>Shishi * handle, const char * filename, const char * service, const char * realm</var>)<var><a name="index-shishi_005fkeys_005ffor_005flocalservicerealm_005fin_005ffile-623"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>filename</var>: file to read keys from.

        <p><var>service</var>: service to get key for.

        <p><var>realm</var>: realm of server to get key for, or NULL for default realm.

        <p>Get key for specified <code>service</code> and <code>realm</code> from <code>filename</code>.

        <p><strong>Return value:</strong> Returns the key for the server
"SERVICE/HOSTNAME<code>REALM</code>" (where HOSTNAME is the current system's
hostname), read from the default host keys file (see
<code>shishi_hostkeys_default_file()</code>), or NULL if no key could be found
or an error encountered. 
</p></blockquote></div>

   <p>The previous functions require that the filename is known.  For some
applications, servers, it makes sense to provide a system default. 
These key sets used by server applications are known as &ldquo;hostkeys&rdquo;. 
Here are the functions that operate on hostkeys (they are mostly
wrappers around generic key sets).

<h4 class="subheading">shishi_hostkeys_default_file</h4>

<p><a name="shishi_005fhostkeys_005fdefault_005ffile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_hostkeys_default_file</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fhostkeys_005fdefault_005ffile-624"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get file name of default host key file.

        <p><strong>Return value:</strong> Returns the default host key filename used in the
library.  (Not a copy of it, so don't modify or deallocate it.) 
</p></blockquote></div>

<h4 class="subheading">shishi_hostkeys_default_file_set</h4>

<p><a name="shishi_005fhostkeys_005fdefault_005ffile_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_hostkeys_default_file_set</b> (<var>Shishi * handle, const char * hostkeysfile</var>)<var><a name="index-shishi_005fhostkeys_005fdefault_005ffile_005fset-625"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>hostkeysfile</var>: string with new default hostkeys file name, or
NULL to reset to default.

        <p>Set the default host key filename used in the library.  The
string is copied into the library, so you can dispose of the
variable immediately after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_hostkeys_for_server</h4>

<p><a name="shishi_005fhostkeys_005ffor_005fserver"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_hostkeys_for_server</b> (<var>Shishi * handle, const char * server</var>)<var><a name="index-shishi_005fhostkeys_005ffor_005fserver-626"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>server</var>: server name to get key for

        <p>Get host key for <code>server</code>.

        <p><strong>Return value:</strong> Returns the key for specific server, read from the
default host keys file (see <code>shishi_hostkeys_default_file()</code>), or
NULL if no key could be found or an error encountered. 
</p></blockquote></div>

<h4 class="subheading">shishi_hostkeys_for_serverrealm</h4>

<p><a name="shishi_005fhostkeys_005ffor_005fserverrealm"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_hostkeys_for_serverrealm</b> (<var>Shishi * handle, const char * server, const char * realm</var>)<var><a name="index-shishi_005fhostkeys_005ffor_005fserverrealm-627"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>server</var>: server name to get key for

        <p><var>realm</var>: realm of server to get key for.

        <p>Get host key for <code>server</code> in <code>realm</code>.

        <p><strong>Return value:</strong> Returns the key for specific server and realm, read
from the default host keys file (see
<code>shishi_hostkeys_default_file()</code>), or NULL if no key could be found
or an error encountered. 
</p></blockquote></div>

<h4 class="subheading">shishi_hostkeys_for_localservicerealm</h4>

<p><a name="shishi_005fhostkeys_005ffor_005flocalservicerealm"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_hostkeys_for_localservicerealm</b> (<var>Shishi * handle, const char * service, const char * realm</var>)<var><a name="index-shishi_005fhostkeys_005ffor_005flocalservicerealm-628"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>service</var>: service to get key for.

        <p><var>realm</var>: realm of server to get key for, or NULL for default realm.

        <p>Get host key for <code>service</code> on current host in <code>realm</code>.

        <p><strong>Return value:</strong> Returns the key for the server
"SERVICE/HOSTNAME<code>REALM</code>" (where HOSTNAME is the current system's
hostname), read from the default host keys file (see
<code>shishi_hostkeys_default_file()</code>), or NULL if no key could be found
or an error encountered. 
</p></blockquote></div>

<h4 class="subheading">shishi_hostkeys_for_localservice</h4>

<p><a name="shishi_005fhostkeys_005ffor_005flocalservice"></a>

<div class="defun">
&mdash; Function: Shishi_key * <b>shishi_hostkeys_for_localservice</b> (<var>Shishi * handle, const char * service</var>)<var><a name="index-shishi_005fhostkeys_005ffor_005flocalservice-629"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>service</var>: service to get key for.

        <p>Get host key for <code>service</code> on current host in default realm.

        <p><strong>Return value:</strong> Returns the key for the server "SERVICE/HOSTNAME"
(where HOSTNAME is the current system's hostname), read from the
default host keys file (see <code>shishi_hostkeys_default_file()</code>), or
NULL if no key could be found or an error encountered. 
</p></blockquote></div>

   <p>After creating the key structure, it can be used to encrypt and
decrypt data, calculate checksum on data etc.  All available functions
are described now.

<h4 class="subheading">shishi_cipher_supported_p</h4>

<p><a name="shishi_005fcipher_005fsupported_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cipher_supported_p</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fsupported_005fp-630"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Find out if cipher is supported.

        <p><strong>Return value:</strong> Return 0 iff cipher is unsupported. 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_name</h4>

<p><a name="shishi_005fcipher_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_cipher_name</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fname-631"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Read humanly readable string for cipher.

        <p><strong>Return value:</strong> Return name of encryption type,
e.g. "des3-cbc-sha1-kd", as defined in the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_blocksize</h4>

<p><a name="shishi_005fcipher_005fblocksize"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cipher_blocksize</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fblocksize-632"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Get block size for cipher.

        <p><strong>Return value:</strong> Return block size for encryption type, as defined in
the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_confoundersize</h4>

<p><a name="shishi_005fcipher_005fconfoundersize"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cipher_confoundersize</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fconfoundersize-633"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Get length of confounder for cipher.

        <p><strong>Return value:</strong> Returns the size of the confounder (random data) for
encryption type, as defined in the standards, or (size_t)-1 on
error (e.g., unsupported encryption type). 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_keylen</h4>

<p><a name="shishi_005fcipher_005fkeylen"></a>

<div class="defun">
&mdash; Function: size_t <b>shishi_cipher_keylen</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fkeylen-634"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Get key length for cipher.

        <p><strong>Return value:</strong> Return length of key used for the encryption type, as
defined in the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_randomlen</h4>

<p><a name="shishi_005fcipher_005frandomlen"></a>

<div class="defun">
&mdash; Function: size_t <b>shishi_cipher_randomlen</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005frandomlen-635"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Get length of random data for cipher.

        <p><strong>Return value:</strong> Return length of random used for the encryption type,
as defined in the standards, or (size_t)-1 on error (e.g.,
unsupported encryption type). 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_defaultcksumtype</h4>

<p><a name="shishi_005fcipher_005fdefaultcksumtype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cipher_defaultcksumtype</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fcipher_005fdefaultcksumtype-636"></a></var><br>
<blockquote><p><var>type</var>: encryption type, see Shishi_etype.

        <p>Get the default checksum associated with cipher.

        <p><strong>Return value:</strong> Return associated checksum mechanism for the
encryption type, as defined in the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_cipher_parse</h4>

<p><a name="shishi_005fcipher_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_cipher_parse</b> (<var>const char * cipher</var>)<var><a name="index-shishi_005fcipher_005fparse-637"></a></var><br>
<blockquote><p><var>cipher</var>: name of encryption type, e.g. "des3-cbc-sha1-kd".

        <p>Get cipher number by parsing string.

        <p><strong>Return value:</strong> Return encryption type corresponding to a string. 
</p></blockquote></div>

<h4 class="subheading">shishi_checksum_supported_p</h4>

<p><a name="shishi_005fchecksum_005fsupported_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_checksum_supported_p</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fchecksum_005fsupported_005fp-638"></a></var><br>
<blockquote><p><var>type</var>: checksum type, see Shishi_cksumtype.

        <p>Find out whether checksum is supported.

        <p><strong>Return value:</strong> Return 0 iff checksum is unsupported. 
</p></blockquote></div>

<h4 class="subheading">shishi_checksum_name</h4>

<p><a name="shishi_005fchecksum_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_checksum_name</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fchecksum_005fname-639"></a></var><br>
<blockquote><p><var>type</var>: checksum type, see Shishi_cksumtype.

        <p>Get name of checksum.

        <p><strong>Return value:</strong> Return name of checksum type,
e.g. "hmac-sha1-96-aes256", as defined in the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_checksum_cksumlen</h4>

<p><a name="shishi_005fchecksum_005fcksumlen"></a>

<div class="defun">
&mdash; Function: size_t <b>shishi_checksum_cksumlen</b> (<var>int32_t type</var>)<var><a name="index-shishi_005fchecksum_005fcksumlen-640"></a></var><br>
<blockquote><p><var>type</var>: checksum type, see Shishi_cksumtype.

        <p>Get length of checksum output.

        <p><strong>Return value:</strong> Return length of checksum used for the checksum type,
as defined in the standards. 
</p></blockquote></div>

<h4 class="subheading">shishi_checksum_parse</h4>

<p><a name="shishi_005fchecksum_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_checksum_parse</b> (<var>const char * checksum</var>)<var><a name="index-shishi_005fchecksum_005fparse-641"></a></var><br>
<blockquote><p><var>checksum</var>: name of checksum type, e.g. "hmac-sha1-96-aes256".

        <p>Get checksum number by parsing a string.

        <p><strong>Return value:</strong> Return checksum type, see Shishi_cksumtype,
corresponding to a string. 
</p></blockquote></div>

<h4 class="subheading">shishi_string_to_key</h4>

<p><a name="shishi_005fstring_005fto_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_string_to_key</b> (<var>Shishi * handle, int32_t keytype, const char * password, size_t passwordlen, const char * salt, size_t saltlen, const char * parameter, Shishi_key * outkey</var>)<var><a name="index-shishi_005fstring_005fto_005fkey-642"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>keytype</var>: cryptographic encryption type, see Shishi_etype.

        <p><var>password</var>: input array with password.

        <p><var>passwordlen</var>: length of input array with password.

        <p><var>salt</var>: input array with salt.

        <p><var>saltlen</var>: length of input array with salt.

        <p><var>parameter</var>: input array with opaque encryption type specific information.

        <p><var>outkey</var>: allocated key handle that will contain new key.

        <p>Derive key from a string (password) and salt (commonly
concatenation of realm and principal) for specified key type, and
set the type and value in the given key to the computed values. 
The parameter value is specific for each keytype, and can be set if
the parameter information is not available.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_random_to_key</h4>

<p><a name="shishi_005frandom_005fto_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>shishi_random_to_key</b> (<var>Shishi * handle, int32_t keytype, const char * rnd, size_t rndlen, Shishi_key * outkey</var>)<var><a name="index-shishi_005frandom_005fto_005fkey-643"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>keytype</var>: cryptographic encryption type, see Shishi_etype.

        <p><var>rnd</var>: input array with random data.

        <p><var>rndlen</var>: length of input array with random data.

        <p><var>outkey</var>: allocated key handle that will contain new key.

        <p>Derive key from random data for specified key type, and set the
type and value in the given key to the computed values.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_checksum</h4>

<p><a name="shishi_005fchecksum"></a>

<div class="defun">
&mdash; Function: int <b>shishi_checksum</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int cksumtype, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fchecksum-644"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to compute checksum with.

        <p><var>keyusage</var>: integer specifying what this key is used for.

        <p><var>cksumtype</var>: the checksum algorithm to use.

        <p><var>in</var>: input array with data to integrity protect.

        <p><var>inlen</var>: size of input array with data to integrity protect.

        <p><var>out</var>: output array with newly allocated integrity protected data.

        <p><var>outlen</var>: output variable with length of output array with checksum.

        <p>Integrity protect data using key, possibly altered by supplied key
usage.  If key usage is 0, no key derivation is used.  The OUT
buffer must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_verify</h4>

<p><a name="shishi_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>shishi_verify</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int cksumtype, const char * in, size_t inlen, const char * cksum, size_t cksumlen</var>)<var><a name="index-shishi_005fverify-645"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to verify checksum with.

        <p><var>keyusage</var>: integer specifying what this key is used for.

        <p><var>cksumtype</var>: the checksum algorithm to use.

        <p><var>in</var>: input array with data that was integrity protected.

        <p><var>inlen</var>: size of input array with data that was integrity protected.

        <p><var>cksum</var>: input array with alleged checksum of data.

        <p><var>cksumlen</var>: size of input array with alleged checksum of data.

        <p>Verify checksum of data using key, possibly altered by supplied key
usage.  If key usage is 0, no key derivation is used.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt_ivupdate_etype</h4>

<p><a name="shishi_005fencrypt_005fivupdate_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt_ivupdate_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * iv, size_t ivlen, char ** ivout, size_t * ivoutlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt_005fivupdate_005fetype-646"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>ivout</var>: output array with newly allocated updated initialization vector.

        <p><var>ivoutlen</var>: size of output array with updated initialization vector.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  If IVOUT or
IVOUTLEN is NULL, the updated IV is not saved anywhere.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt_iv_etype</h4>

<p><a name="shishi_005fencrypt_005fiv_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt_iv_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * iv, size_t ivlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt_005fiv_005fetype-647"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  The next IV is
lost, see shishi_encrypt_ivupdate_etype if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt_etype</h4>

<p><a name="shishi_005fencrypt_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt_005fetype-648"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  The default IV
is used, see shishi_encrypt_iv_etype if you need to alter it. The
next IV is lost, see shishi_encrypt_ivupdate_etype if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt_ivupdate</h4>

<p><a name="shishi_005fencrypt_005fivupdate"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt_ivupdate</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, const char * iv, size_t ivlen, char ** ivout, size_t * ivoutlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt_005fivupdate-649"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>ivout</var>: output array with newly allocated updated initialization vector.

        <p><var>ivoutlen</var>: size of output array with updated initialization vector.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  If IVOUT or IVOUTLEN is NULL, the updated IV is not
saved anywhere.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt_iv</h4>

<p><a name="shishi_005fencrypt_005fiv"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt_iv</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, const char * iv, size_t ivlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt_005fiv-650"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The next IV is lost, see shishi_encrypt_ivupdate if
you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_encrypt</h4>

<p><a name="shishi_005fencrypt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_encrypt</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fencrypt-651"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key is encrypting.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypts data using specified key.  The key actually used is
derived using the key usage.  If key usage is 0, no key derivation
is used.  The OUT buffer must be deallocated by the caller.  The
default IV is used, see shishi_encrypt_iv if you need to alter it. 
The next IV is lost, see shishi_encrypt_ivupdate if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt_ivupdate_etype</h4>

<p><a name="shishi_005fdecrypt_005fivupdate_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt_ivupdate_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * iv, size_t ivlen, char ** ivout, size_t * ivoutlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt_005fivupdate_005fetype-652"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>ivout</var>: output array with newly allocated updated initialization vector.

        <p><var>ivoutlen</var>: size of output array with updated initialization vector.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  If IVOUT or
IVOUTLEN is NULL, the updated IV is not saved anywhere.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt_iv_etype</h4>

<p><a name="shishi_005fdecrypt_005fiv_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt_iv_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * iv, size_t ivlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt_005fiv_005fetype-653"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data as per encryption method using specified
initialization vector and key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  The next IV is
lost, see shishi_decrypt_ivupdate_etype if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt_etype</h4>

<p><a name="shishi_005fdecrypt_005fetype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt_etype</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt_005fetype-654"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data as per encryption method using specified key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The default IV is used, see shishi_decrypt_iv_etype
if you need to alter it.  The next IV is lost, see
shishi_decrypt_ivupdate_etype if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt_ivupdate</h4>

<p><a name="shishi_005fdecrypt_005fivupdate"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt_ivupdate</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, const char * iv, size_t ivlen, char ** ivout, size_t * ivoutlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt_005fivupdate-655"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>ivout</var>: output array with newly allocated updated initialization vector.

        <p><var>ivoutlen</var>: size of output array with updated initialization vector.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  If IVOUT or IVOUTLEN is NULL, the updated IV is not
saved anywhere.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt_iv</h4>

<p><a name="shishi_005fdecrypt_005fiv"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt_iv</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, const char * iv, size_t ivlen, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt_005fiv-656"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data using specified initialization vector and key.  The
key actually used is derived using the key usage.  If key usage is
0, no key derivation is used.  The OUT buffer must be deallocated
by the caller.  The next IV is lost, see
shishi_decrypt_ivupdate_etype if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_decrypt</h4>

<p><a name="shishi_005fdecrypt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_decrypt</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fdecrypt-657"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to decrypt with.

        <p><var>keyusage</var>: integer specifying what this key is decrypting.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypts data specified key.  The key actually used is derived
using the key usage.  If key usage is 0, no key derivation is used. 
The OUT buffer must be deallocated by the caller.  The default IV
is used, see shishi_decrypt_iv if you need to alter it.  The next
IV is lost, see shishi_decrypt_ivupdate if you need it.

        <p>Note that DECRYPT(ENCRYPT(data)) does not necessarily yield data
exactly.  Some encryption types add pad to make the data fit into
the block size of the encryption algorithm.  Furthermore, the pad
is not guaranteed to look in any special way, although existing
implementations often pad with the zero byte.  This means that you
may have to "frame" data, so it is possible to infer the original
length after decryption.  Compare ASN.1 DER which contains such
information.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_n_fold</h4>

<p><a name="shishi_005fn_005ffold"></a>

<div class="defun">
&mdash; Function: int <b>shishi_n_fold</b> (<var>Shishi * handle, const char * in, size_t inlen, char * out, size_t outlen</var>)<var><a name="index-shishi_005fn_005ffold-658"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt ("M").

        <p><var>out</var>: output array with decrypted data.

        <p><var>outlen</var>: size of output array ("N").

        <p>Fold data into a fixed length output array, with the intent to give
each input bit approximately equal weight in determining the value
of each output bit.

        <p>The algorithm is from "A Better Key Schedule For DES-like Ciphers"
by Uri Blumenthal and Steven M. Bellovin,
http://www.research.att.com/~smb/papers/ides.pdf, although the
sample vectors provided by the paper are incorrect.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_dr</h4>

<p><a name="shishi_005fdr"></a>

<div class="defun">
&mdash; Function: int <b>shishi_dr</b> (<var>Shishi * handle, Shishi_key * key, const char * prfconstant, size_t prfconstantlen, char * derivedrandom, size_t derivedrandomlen</var>)<var><a name="index-shishi_005fdr-659"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: input array with cryptographic key to use.

        <p><var>prfconstant</var>: input array with the constant string.

        <p><var>prfconstantlen</var>: size of input array with the constant string.

        <p><var>derivedrandom</var>: output array with derived random data.

        <p><var>derivedrandomlen</var>: size of output array with derived random data.

        <p>Derive "random" data from a key and a constant thusly:
DR(KEY, PRFCONSTANT) = TRUNCATE(DERIVEDRANDOMLEN,
SHISHI_ENCRYPT(KEY, PRFCONSTANT)).

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_dk</h4>

<p><a name="shishi_005fdk"></a>

<div class="defun">
&mdash; Function: int <b>shishi_dk</b> (<var>Shishi * handle, Shishi_key * key, const char * prfconstant, size_t prfconstantlen, Shishi_key * derivedkey</var>)<var><a name="index-shishi_005fdk-660"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: input cryptographic key to use.

        <p><var>prfconstant</var>: input array with the constant string.

        <p><var>prfconstantlen</var>: size of input array with the constant string.

        <p><var>derivedkey</var>: pointer to derived key (allocated by caller).

        <p><strong>Derive a key from a key and a constant thusly:</strong> DK(KEY, PRFCONSTANT) = SHISHI_RANDOM-TO-KEY(SHISHI_DR(KEY, PRFCONSTANT)).

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

   <p>An easier way to use encryption and decryption if your application
repeatedly calls, e.g., <code>shishi_encrypt_ivupdate</code>, is to use the
following functions.  They store the key, initialization vector, etc,
in a context, and the encryption and decryption operations update the
IV within the context automatically.

<h4 class="subheading">shishi_crypto</h4>

<p><a name="shishi_005fcrypto"></a>

<div class="defun">
&mdash; Function: Shishi_crypto * <b>shishi_crypto</b> (<var>Shishi * handle, Shishi_key * key, int keyusage, int32_t etype, const char * iv, size_t ivlen</var>)<var><a name="index-shishi_005fcrypto-661"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: key to encrypt with.

        <p><var>keyusage</var>: integer specifying what this key will encrypt/decrypt.

        <p><var>etype</var>: integer specifying what cipher to use.

        <p><var>iv</var>: input array with initialization vector

        <p><var>ivlen</var>: size of input array with initialization vector.

        <p>Initialize a crypto context.  This store a key, keyusage,
encryption type and initialization vector in a "context", and the
caller can then use this context to perform encryption via
<code>shishi_crypto_encrypt()</code> and decryption via <code>shishi_crypto_encrypt()</code>
without supplying all those details again.  The functions also
takes care of propagating the IV between calls.

        <p>When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code>shishi_crypto_done()</code>.

        <p><strong>Return value:</strong> Return a newly allocated crypto context. 
</p></blockquote></div>

<h4 class="subheading">shishi_crypto_encrypt</h4>

<p><a name="shishi_005fcrypto_005fencrypt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_crypto_encrypt</b> (<var>Shishi_crypto * ctx, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fcrypto_005fencrypt-662"></a></var><br>
<blockquote><p><var>ctx</var>: crypto context as returned by <code>shishi_crypto()</code>.

        <p><var>in</var>: input array with data to encrypt.

        <p><var>inlen</var>: size of input array with data to encrypt.

        <p><var>out</var>: output array with newly allocated encrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Encrypt data, using information (e.g., key and initialization
vector) from context.  The IV is updated inside the context after
this call.

        <p>When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code>shishi_crypto_done()</code>.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_crypto_decrypt</h4>

<p><a name="shishi_005fcrypto_005fdecrypt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_crypto_decrypt</b> (<var>Shishi_crypto * ctx, const char * in, size_t inlen, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fcrypto_005fdecrypt-663"></a></var><br>
<blockquote><p><var>ctx</var>: crypto context as returned by <code>shishi_crypto()</code>.

        <p><var>in</var>: input array with data to decrypt.

        <p><var>inlen</var>: size of input array with data to decrypt.

        <p><var>out</var>: output array with newly allocated decrypted data.

        <p><var>outlen</var>: output variable with size of newly allocated output array.

        <p>Decrypt data, using information (e.g., key and initialization
vector) from context.  The IV is updated inside the context after
this call.

        <p>When the application no longer need to use the context, it should
deallocate resources associated with it by calling
<code>shishi_crypto_done()</code>.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_crypto_close</h4>

<p><a name="shishi_005fcrypto_005fclose"></a>

<div class="defun">
&mdash; Function: void <b>shishi_crypto_close</b> (<var>Shishi_crypto * ctx</var>)<var><a name="index-shishi_005fcrypto_005fclose-664"></a></var><br>
<blockquote><p><var>ctx</var>: crypto context as returned by <code>shishi_crypto()</code>.

        <p>Deallocate resources associated with the crypto context. 
</p></blockquote></div>

   <p>Also included in Shishi is an interface to the really low-level
cryptographic primitives.  They map directly on the underlying
cryptographic library used (i.e., Gnulib or Libgcrypt) and is used
internally by Shishi.

<h4 class="subheading">shishi_randomize</h4>

<p><a name="shishi_005frandomize"></a>

<div class="defun">
&mdash; Function: int <b>shishi_randomize</b> (<var>Shishi * handle, int strong, void * data, size_t datalen</var>)<var><a name="index-shishi_005frandomize-665"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>strong</var>: 0 iff operation should not block, non-0 for very strong randomness.

        <p><var>data</var>: output array to be filled with random data.

        <p><var>datalen</var>: size of output array.

        <p>Store cryptographically random data of given size in the provided
buffer.

        <p><strong>Return value:</strong> Returns <code>SHISHI_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_crc</h4>

<p><a name="shishi_005fcrc"></a>

<div class="defun">
&mdash; Function: int <b>shishi_crc</b> (<var>Shishi * handle, const char * in, size_t inlen, char * out[4]</var>)<var><a name="index-shishi_005fcrc-666"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>in</var>: input character array of data to checksum.

        <p><var>inlen</var>: length of input character array of data to checksum.

        <p>Compute checksum of data using CRC32 modified according to RFC
1510.  The <code>out</code> buffer must be deallocated by the caller.

        <p>The modifications compared to standard CRC32 is that no initial and
final XOR is performed, and that the output is returned in
LSB-first order.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_md4</h4>

<p><a name="shishi_005fmd4"></a>

<div class="defun">
&mdash; Function: int <b>shishi_md4</b> (<var>Shishi * handle, const char * in, size_t inlen, char * out[16]</var>)<var><a name="index-shishi_005fmd4-667"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>in</var>: input character array of data to hash.

        <p><var>inlen</var>: length of input character array of data to hash.

        <p>Compute hash of data using MD4.  The <code>out</code> buffer must be
deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_md5</h4>

<p><a name="shishi_005fmd5"></a>

<div class="defun">
&mdash; Function: int <b>shishi_md5</b> (<var>Shishi * handle, const char * in, size_t inlen, char * out[16]</var>)<var><a name="index-shishi_005fmd5-668"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>in</var>: input character array of data to hash.

        <p><var>inlen</var>: length of input character array of data to hash.

        <p>Compute hash of data using MD5.  The <code>out</code> buffer must be
deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_hmac_md5</h4>

<p><a name="shishi_005fhmac_005fmd5"></a>

<div class="defun">
&mdash; Function: int <b>shishi_hmac_md5</b> (<var>Shishi * handle, const char * key, size_t keylen, const char * in, size_t inlen, char * outhash[16]</var>)<var><a name="index-shishi_005fhmac_005fmd5-669"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: input character array with key to use.

        <p><var>keylen</var>: length of input character array with key to use.

        <p><var>in</var>: input character array of data to hash.

        <p><var>inlen</var>: length of input character array of data to hash.

        <p>Compute keyed checksum of data using HMAC-MD5.  The <code>outhash</code> buffer
must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_hmac_sha1</h4>

<p><a name="shishi_005fhmac_005fsha1"></a>

<div class="defun">
&mdash; Function: int <b>shishi_hmac_sha1</b> (<var>Shishi * handle, const char * key, size_t keylen, const char * in, size_t inlen, char * outhash[20]</var>)<var><a name="index-shishi_005fhmac_005fsha1-670"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>key</var>: input character array with key to use.

        <p><var>keylen</var>: length of input character array with key to use.

        <p><var>in</var>: input character array of data to hash.

        <p><var>inlen</var>: length of input character array of data to hash.

        <p>Compute keyed checksum of data using HMAC-SHA1.  The <code>outhash</code>
buffer must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_des_cbc_mac</h4>

<p><a name="shishi_005fdes_005fcbc_005fmac"></a>

<div class="defun">
&mdash; Function: int <b>shishi_des_cbc_mac</b> (<var>Shishi * handle, const char key[8], const char iv[8], const char * in, size_t inlen, char * out[8]</var>)<var><a name="index-shishi_005fdes_005fcbc_005fmac-671"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>in</var>: input character array of data to hash.

        <p><var>inlen</var>: length of input character array of data to hash.

        <p>Computed keyed checksum of data using DES-CBC-MAC.  The <code>out</code> buffer
must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_arcfour</h4>

<p><a name="shishi_005farcfour"></a>

<div class="defun">
&mdash; Function: int <b>shishi_arcfour</b> (<var>Shishi * handle, int decryptp, const char * key, size_t keylen, const char iv[258], char * ivout[258], const char * in, size_t inlen, char ** out</var>)<var><a name="index-shishi_005farcfour-672"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>decryptp</var>: 0 to indicate encryption, non-0 to indicate decryption.

        <p><var>key</var>: input character array with key to use.

        <p><var>keylen</var>: length of input key array.

        <p><var>in</var>: input character array of data to encrypt/decrypt.

        <p><var>inlen</var>: length of input character array of data to encrypt/decrypt.

        <p><var>out</var>: newly allocated character array with encrypted/decrypted data.

        <p>Encrypt or decrypt data (depending on <code>decryptp</code>) using ARCFOUR. 
The <code>out</code> buffer must be deallocated by the caller.

        <p>The "initialization vector" used here is the concatenation of the
sbox and i and j, and is thus always of size 256 + 1 + 1.  This is
a slight abuse of terminology, and assumes you know what you are
doing.  Don't use it if you can avoid to.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_des</h4>

<p><a name="shishi_005fdes"></a>

<div class="defun">
&mdash; Function: int <b>shishi_des</b> (<var>Shishi * handle, int decryptp, const char key[8], const char iv[8], char * ivout[8], const char * in, size_t inlen, char ** out</var>)<var><a name="index-shishi_005fdes-673"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>decryptp</var>: 0 to indicate encryption, non-0 to indicate decryption.

        <p><var>in</var>: input character array of data to encrypt/decrypt.

        <p><var>inlen</var>: length of input character array of data to encrypt/decrypt.

        <p><var>out</var>: newly allocated character array with encrypted/decrypted data.

        <p>Encrypt or decrypt data (depending on <code>decryptp</code>) using DES in CBC
mode.  The <code>out</code> buffer must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_3des</h4>

<p><a name="shishi_005f3des"></a>

<div class="defun">
&mdash; Function: int <b>shishi_3des</b> (<var>Shishi * handle, int decryptp, const char key[8], const char iv[8], char * ivout[8], const char * in, size_t inlen, char ** out</var>)<var><a name="index-shishi_005f3des-674"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>decryptp</var>: 0 to indicate encryption, non-0 to indicate decryption.

        <p><var>in</var>: input character array of data to encrypt/decrypt.

        <p><var>inlen</var>: length of input character array of data to encrypt/decrypt.

        <p><var>out</var>: newly allocated character array with encrypted/decrypted data.

        <p>Encrypt or decrypt data (depending on <code>decryptp</code>) using 3DES in CBC
mode.  The <code>out</code> buffer must be deallocated by the caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_aes_cts</h4>

<p><a name="shishi_005faes_005fcts"></a>

<div class="defun">
&mdash; Function: int <b>shishi_aes_cts</b> (<var>Shishi * handle, int decryptp, const char * key, size_t keylen, const char iv[16], char * ivout[16], const char * in, size_t inlen, char ** out</var>)<var><a name="index-shishi_005faes_005fcts-675"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>decryptp</var>: 0 to indicate encryption, non-0 to indicate decryption.

        <p><var>key</var>: input character array with key to use.

        <p><var>keylen</var>: length of input character array with key to use.

        <p><var>in</var>: input character array of data to encrypt/decrypt.

        <p><var>inlen</var>: length of input character array of data to encrypt/decrypt.

        <p><var>out</var>: newly allocated character array with encrypted/decrypted data.

        <p>Encrypt or decrypt data (depending on <code>decryptp</code>) using AES in
CBC-CTS mode.  The length of the key, <code>keylen</code>, decide if AES 128 or
AES 256 should be used.  The <code>out</code> buffer must be deallocated by the
caller.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_pbkdf2_sha1</h4>

<p><a name="shishi_005fpbkdf2_005fsha1"></a>

<div class="defun">
&mdash; Function: int <b>shishi_pbkdf2_sha1</b> (<var>Shishi * handle, const char * P, size_t Plen, const char * S, size_t Slen, unsigned int c, unsigned int dkLen, char * DK</var>)<var><a name="index-shishi_005fpbkdf2_005fsha1-676"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>P</var>: input password, an octet string

        <p><var>Plen</var>: length of password, an octet string

        <p><var>S</var>: input salt, an octet string

        <p><var>Slen</var>: length of salt, an octet string

        <p><var>c</var>: iteration count, a positive integer

        <p><var>dkLen</var>: intended length in octets of the derived key, a positive integer,
at most (2^32 - 1) * hLen.  The DK array must have room for this many
characters.

        <p><var>DK</var>: output derived key, a dkLen-octet string

        <p>Derive key using the PBKDF2 defined in PKCS5.  PBKDF2 applies a
pseudorandom function to derive keys. The length of the derived key
is essentially unbounded. (However, the maximum effective search
space for the derived key may be limited by the structure of the
underlying pseudorandom function, which is this function is always
SHA1.)

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<div class="node">
<a name="X.509-Functions"></a>
<a name="X_002e509-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Utility-Functions">Utility Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cryptographic-Functions">Cryptographic Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.14 X.509 Functions</h3>

<p>The functions described in this section are used by the STARTTLS
functionality, see <a href="#Kerberos-via-TLS">Kerberos via TLS</a>.

<h4 class="subheading">shishi_x509ca_default_file_guess</h4>

<p><a name="shishi_005fx509ca_005fdefault_005ffile_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_x509ca_default_file_guess</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509ca_005fdefault_005ffile_005fguess-677"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Guesses the default X.509 CA certificate filename; it is
$HOME/.shishi/client.ca.

        <p><strong>Return value:</strong> Returns default X.509 client certificate filename as
a string that has to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509ca_default_file_set</h4>

<p><a name="shishi_005fx509ca_005fdefault_005ffile_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_x509ca_default_file_set</b> (<var>Shishi * handle, const char * x509cafile</var>)<var><a name="index-shishi_005fx509ca_005fdefault_005ffile_005fset-678"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>x509cafile</var>: string with new default x509 client certificate file name,
or NULL to reset to default.

        <p>Set the default X.509 CA certificate filename used in the library. 
The certificate is used during TLS connections with the KDC to
authenticate the KDC.  The string is copied into the library, so
you can dispose of the variable immediately after calling this
function. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509ca_default_file</h4>

<p><a name="shishi_005fx509ca_005fdefault_005ffile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_x509ca_default_file</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509ca_005fdefault_005ffile-679"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get filename for default X.509 CA certificate.

        <p><strong>Return value:</strong> Returns the default X.509 CA certificate filename
used in the library.  The certificate is used during TLS
connections with the KDC to authenticate the KDC.  The string is
not a copy, so don't modify or deallocate it. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509cert_default_file_guess</h4>

<p><a name="shishi_005fx509cert_005fdefault_005ffile_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_x509cert_default_file_guess</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509cert_005fdefault_005ffile_005fguess-680"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Guesses the default X.509 client certificate filename; it is
$HOME/.shishi/client.certs.

        <p><strong>Return value:</strong> Returns default X.509 client certificate filename as
a string that has to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509cert_default_file_set</h4>

<p><a name="shishi_005fx509cert_005fdefault_005ffile_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_x509cert_default_file_set</b> (<var>Shishi * handle, const char * x509certfile</var>)<var><a name="index-shishi_005fx509cert_005fdefault_005ffile_005fset-681"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>x509certfile</var>: string with new default x509 client certificate file name,
or NULL to reset to default.

        <p>Set the default X.509 client certificate filename used in the
library.  The certificate is used during TLS connections with the
KDC to authenticate the client.  The string is copied into the
library, so you can dispose of the variable immediately after
calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509cert_default_file</h4>

<p><a name="shishi_005fx509cert_005fdefault_005ffile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_x509cert_default_file</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509cert_005fdefault_005ffile-682"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get filename for default X.509 certificate.

        <p><strong>Return value:</strong> Returns the default X.509 client certificate filename
used in the library.  The certificate is used during TLS
connections with the KDC to authenticate the client.  The string is
not a copy, so don't modify or deallocate it. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509key_default_file_guess</h4>

<p><a name="shishi_005fx509key_005fdefault_005ffile_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_x509key_default_file_guess</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509key_005fdefault_005ffile_005fguess-683"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Guesses the default X.509 client key filename; it is
$HOME/.shishi/client.key.

        <p><strong>Return value:</strong> Returns default X.509 client key filename as
a string that has to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509key_default_file_set</h4>

<p><a name="shishi_005fx509key_005fdefault_005ffile_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_x509key_default_file_set</b> (<var>Shishi * handle, const char * x509keyfile</var>)<var><a name="index-shishi_005fx509key_005fdefault_005ffile_005fset-684"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>x509keyfile</var>: string with new default x509 client key file name, or
NULL to reset to default.

        <p>Set the default X.509 client key filename used in the library.  The
key is used during TLS connections with the KDC to authenticate the
client.  The string is copied into the library, so you can dispose
of the variable immediately after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_x509key_default_file</h4>

<p><a name="shishi_005fx509key_005fdefault_005ffile"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_x509key_default_file</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fx509key_005fdefault_005ffile-685"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get filename for default X.509 key.

        <p><strong>Return value:</strong> Returns the default X.509 client key filename
used in the library.  The key is used during TLS
connections with the KDC to authenticate the client.  The string is
not a copy, so don't modify or deallocate it. 
</p></blockquote></div>

<div class="node">
<a name="Utility-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ASN_002e1-Functions">ASN.1 Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#X_002e509-Functions">X.509 Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.15 Utility Functions</h3>

<h4 class="subheading">shishi_realm_default_guess</h4>

<p><a name="shishi_005frealm_005fdefault_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_realm_default_guess</b> (<var> void</var>)<var><a name="index-shishi_005frealm_005fdefault_005fguess-686"></a></var><br>
<blockquote>
        <p>Guesses a realm based on <code>getdomainname()</code> (which really is NIS/YP
domain, but if it is set it might be a good guess), or if it fails,
based on <code>gethostname()</code>, or if it fails, the string
"could-not-guess-default-realm". Note that the hostname is not
trimmed off of the data returned by <code>gethostname()</code> to get the domain
name and use that as the realm.

        <p><strong>Return value:</strong> Returns guessed realm for host as a string that has
to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_realm_default</h4>

<p><a name="shishi_005frealm_005fdefault"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_realm_default</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005frealm_005fdefault-687"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>Get name of default realm.

        <p><strong>Return value:</strong> Returns the default realm used in the library.  (Not
a copy of it, so don't modify or deallocate it.) 
</p></blockquote></div>

<h4 class="subheading">shishi_realm_default_set</h4>

<p><a name="shishi_005frealm_005fdefault_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_realm_default_set</b> (<var>Shishi * handle, const char * realm</var>)<var><a name="index-shishi_005frealm_005fdefault_005fset-688"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>realm</var>: string with new default realm name, or NULL to reset to default.

        <p>Set the default realm used in the library.  The string is copied
into the library, so you can dispose of the variable immediately
after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_realm_for_server_file</h4>

<p><a name="shishi_005frealm_005ffor_005fserver_005ffile"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_realm_for_server_file</b> (<var>Shishi * handle, char * server</var>)<var><a name="index-shishi_005frealm_005ffor_005fserver_005ffile-689"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>server</var>: hostname to find realm for.

        <p>Find realm for a host using configuration file.

        <p><strong>Return value:</strong> Returns realm for host, or NULL if not found. 
</p></blockquote></div>

<h4 class="subheading">shishi_realm_for_server_dns</h4>

<p><a name="shishi_005frealm_005ffor_005fserver_005fdns"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_realm_for_server_dns</b> (<var>Shishi * handle, char * server</var>)<var><a name="index-shishi_005frealm_005ffor_005fserver_005fdns-690"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>server</var>: hostname to find realm for.

        <p>Find realm for a host using DNS lookups, according to
draft-ietf-krb-wg-krb-dns-locate-03.txt.  Since DNS lookups may be
spoofed, relying on the realm information may result in a
redirection attack.  In a single-realm scenario, this only achieves
a denial of service, but with cross-realm trust it may redirect you
to a compromised realm.  For this reason, Shishi prints a warning,
suggesting that the user should add the proper 'server-realm'
configuration tokens instead.

        <p>To illustrate the DNS information used, here is an extract from a
zone file for the domain ASDF.COM:

        <p>_kerberos.asdf.com.             IN      TXT     "ASDF.COM"
_kerberos.mrkserver.asdf.com.   IN      TXT     "MARKETING.ASDF.COM"
_kerberos.salesserver.asdf.com. IN      TXT     "SALES.ASDF.COM"

        <p>Let us suppose that in this case, a client wishes to use a service
on the host foo.asdf.com.  It would first query:

        <p>_kerberos.foo.asdf.com. IN TXT

        <p>Finding no match, it would then query:

        <p>_kerberos.asdf.com. IN TXT

        <p><strong>Return value:</strong> Returns realm for host, or NULL if not found. 
</p></blockquote></div>

<h4 class="subheading">shishi_realm_for_server</h4>

<p><a name="shishi_005frealm_005ffor_005fserver"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_realm_for_server</b> (<var>Shishi * handle, char * server</var>)<var><a name="index-shishi_005frealm_005ffor_005fserver-691"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>server</var>: hostname to find realm for.

        <p>Find realm for a host, using various methods.  Currently this
includes static configuration files (see
<code>shishi_realm_for_server_file()</code>) and DNS (see
<code>shishi_realm_for_server_dns()</code>).

        <p><strong>Return value:</strong> Returns realm for host, or NULL if not found. 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_default_guess</h4>

<p><a name="shishi_005fprincipal_005fdefault_005fguess"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_principal_default_guess</b> (<var> void</var>)<var><a name="index-shishi_005fprincipal_005fdefault_005fguess-692"></a></var><br>
<blockquote>
        <p>Guesses the principal name for the user, looking at environment
variables SHISHI_USER and USER, or if that fails, returns the
string "user".

        <p><strong>Return value:</strong> Returns guessed default principal for user as a
string that has to be deallocated with <code>free()</code> by the caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_default</h4>

<p><a name="shishi_005fprincipal_005fdefault"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_principal_default</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fprincipal_005fdefault-693"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p>The default principal name is the name in the environment variable
USER, but can be overridden by specifying the environment variable
SHISHI_USER.

        <p><strong>Return value:</strong> Returns the default principal name used in the
library.  (Not a copy of it, so don't modify or deallocate it.) 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_default_set</h4>

<p><a name="shishi_005fprincipal_005fdefault_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_principal_default_set</b> (<var>Shishi * handle, const char * principal</var>)<var><a name="index-shishi_005fprincipal_005fdefault_005fset-694"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>principal</var>: string with new default principal name, or NULL to
reset to default.

        <p>Set the default realm used in the library.  The string is copied
into the library, so you can dispose of the variable immediately
after calling this function. 
</p></blockquote></div>

<h4 class="subheading">shishi_parse_name</h4>

<p><a name="shishi_005fparse_005fname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_parse_name</b> (<var>Shishi * handle, const char * name, char ** principal, char ** realm</var>)<var><a name="index-shishi_005fparse_005fname-695"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>name</var>: Input principal name string, e.g. imap/mail.gnu.org<code>GNU</code>.ORG.

        <p><var>principal</var>: newly allocated output string with principal name.

        <p><var>realm</var>: newly allocated output string with realm name.

        <p>Split up principal name (e.g., "simon<code>JOSEFSSON</code>.ORG") into two
newly allocated strings, the principal ("simon") and realm
("JOSEFSSON.ORG").  If there is no realm part in NAME, REALM is set
to NULL.

        <p><strong>Return value:</strong> Returns SHISHI_INVALID_PRINCIPAL_NAME if NAME is NULL
or ends with the escape character "\", or SHISHI_OK iff
successful
</p></blockquote></div>

<h4 class="subheading">shishi_principal_name</h4>

<p><a name="shishi_005fprincipal_005fname"></a>

<div class="defun">
&mdash; Function: int <b>shishi_principal_name</b> (<var>Shishi * handle, Shishi_asn1 namenode, const char * namefield, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fprincipal_005fname-696"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>namenode</var>: ASN.1 structure with principal in <code>namefield</code>.

        <p><var>namefield</var>: name of field in <code>namenode</code> containing principal name.

        <p><var>out</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>outlen</code>).

        <p><var>outlen</var>: pointer to length of <code>out</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>out</code>).

        <p>Represent principal name in ASN.1 structure as zero-terminated
string.  The string is allocate by this function, and it is the
responsibility of the caller to deallocate it.  Note that the
output length <code>outlen</code> does not include the terminating zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_name_realm</h4>

<p><a name="shishi_005fprincipal_005fname_005frealm"></a>

<div class="defun">
&mdash; Function: int <b>shishi_principal_name_realm</b> (<var>Shishi * handle, Shishi_asn1 namenode, const char * namefield, Shishi_asn1 realmnode, const char * realmfield, char ** out, size_t * outlen</var>)<var><a name="index-shishi_005fprincipal_005fname_005frealm-697"></a></var><br>
<blockquote><p><var>handle</var>: Shishi library handle create by <code>shishi_init()</code>.

        <p><var>namenode</var>: ASN.1 structure with principal name in <code>namefield</code>.

        <p><var>namefield</var>: name of field in <code>namenode</code> containing principal name.

        <p><var>realmnode</var>: ASN.1 structure with principal realm in <code>realmfield</code>.

        <p><var>realmfield</var>: name of field in <code>realmnode</code> containing principal realm.

        <p><var>out</var>: pointer to newly allocated zero terminated string containing
principal name.  May be <code>NULL</code> (to only populate <code>outlen</code>).

        <p><var>outlen</var>: pointer to length of <code>out</code> on output, excluding terminating
zero.  May be <code>NULL</code> (to only populate <code>out</code>).

        <p>Represent principal name and realm in ASN.1 structure as
zero-terminated string.  The string is allocate by this function,
and it is the responsibility of the caller to deallocate it.  Note
that the output length <code>outlen</code> does not include the terminating
zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_name_set</h4>

<p><a name="shishi_005fprincipal_005fname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_principal_name_set</b> (<var>Shishi * handle, Shishi_asn1 namenode, const char * namefield, Shishi_name_type name_type, const char * </var>[]<var> name</var>)<var><a name="index-shishi_005fprincipal_005fname_005fset-698"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>namenode</var>: ASN.1 structure with principal in <code>namefield</code>.

        <p><var>namefield</var>: name of field in namenode containing principal name.

        <p><var>name_type</var>: type of principial, see Shishi_name_type, usually
SHISHI_NT_UNKNOWN.

        <p><var>name</var>: zero-terminated input array with principal name.

        <p>Set the given principal name field to given name.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_principal_set</h4>

<p><a name="shishi_005fprincipal_005fset"></a>

<div class="defun">
&mdash; Function: int <b>shishi_principal_set</b> (<var>Shishi * handle, Shishi_asn1 namenode, const char * namefield, const char * name</var>)<var><a name="index-shishi_005fprincipal_005fset-699"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>namenode</var>: ASN.1 structure with principal in <code>namefield</code>.

        <p><var>namefield</var>: name of field in namenode containing principal name.

        <p><var>name</var>: zero-terminated string with principal name on RFC 1964 form.

        <p>Set principal name field in ASN.1 structure to given name.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_derive_default_salt</h4>

<p><a name="shishi_005fderive_005fdefault_005fsalt"></a>

<div class="defun">
&mdash; Function: int <b>shishi_derive_default_salt</b> (<var>Shishi * handle, const char * name, char ** salt</var>)<var><a name="index-shishi_005fderive_005fdefault_005fsalt-700"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>name</var>: principal name of user.

        <p><var>salt</var>: output variable with newly allocated salt string.

        <p>Derive the default salt from a principal.  The default salt is the
concatenation of the decoded realm and principal.

        <p><strong>Return value:</strong> Return SHISHI_OK if successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_server_for_local_service</h4>

<p><a name="shishi_005fserver_005ffor_005flocal_005fservice"></a>

<div class="defun">
&mdash; Function: char * <b>shishi_server_for_local_service</b> (<var>Shishi * handle, const char * service</var>)<var><a name="index-shishi_005fserver_005ffor_005flocal_005fservice-701"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>service</var>: zero terminated string with name of service, e.g., "host".

        <p>Construct a service principal (e.g., "imap/yxa.extuno.com") based
on supplied service name (i.e., "imap") and the system hostname as
returned by <code>hostname()</code> (i.e., "yxa.extundo.com").  The string must
be deallocated by the caller.

        <p><strong>Return value:</strong> Return newly allocated service name string. 
</p></blockquote></div>

<h4 class="subheading">shishi_authorization_parse</h4>

<p><a name="shishi_005fauthorization_005fparse"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authorization_parse</b> (<var>const char * authorization</var>)<var><a name="index-shishi_005fauthorization_005fparse-702"></a></var><br>
<blockquote><p><var>authorization</var>: name of authorization type, e.g. "basic".

        <p>Parse authorization type name.

        <p><strong>Return value:</strong> Return authorization type corresponding to a string. 
</p></blockquote></div>

<h4 class="subheading">shishi_authorized_p</h4>

<p><a name="shishi_005fauthorized_005fp"></a>

<div class="defun">
&mdash; Function: int <b>shishi_authorized_p</b> (<var>Shishi * handle, Shishi_tkt * tkt, const char * authzname</var>)<var><a name="index-shishi_005fauthorized_005fp-703"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>tkt</var>: input variable with ticket info.

        <p><var>authzname</var>: authorization name.

        <p>Simplistic authorization of <code>authzname</code> against encrypted client
principal name inside ticket.  Currently this function only compare
the principal name with <code>authzname</code> using <code>strcmp()</code>.

        <p><strong>Return value:</strong> Returns 1 if authzname is authorized for services by
authenticated client principal, or 0 otherwise. 
</p></blockquote></div>

<h4 class="subheading">shishi_generalize_time</h4>

<p><a name="shishi_005fgeneralize_005ftime"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_generalize_time</b> (<var>Shishi * handle, time_t t</var>)<var><a name="index-shishi_005fgeneralize_005ftime-704"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>t</var>: C time to convert.

        <p>Convert C time to KerberosTime.  The string must not be deallocate
by caller.

        <p><strong>Return value:</strong> Return a KerberosTime time string corresponding to C time t. 
</p></blockquote></div>

<h4 class="subheading">shishi_generalize_now</h4>

<p><a name="shishi_005fgeneralize_005fnow"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_generalize_now</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fgeneralize_005fnow-705"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Convert current time to KerberosTime.  The string must not be
deallocate by caller.

        <p><strong>Return value:</strong> Return a KerberosTime time string corresponding to
current time. 
</p></blockquote></div>

<h4 class="subheading">shishi_generalize_ctime</h4>

<p><a name="shishi_005fgeneralize_005fctime"></a>

<div class="defun">
&mdash; Function: time_t <b>shishi_generalize_ctime</b> (<var>Shishi * handle, const char * t</var>)<var><a name="index-shishi_005fgeneralize_005fctime-706"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>t</var>: KerberosTime to convert.

        <p>Convert KerberosTime to C time.

        <p><strong>Return value:</strong> Returns C time corresponding to KerberosTime t. 
</p></blockquote></div>

<h4 class="subheading">shishi_time</h4>

<p><a name="shishi_005ftime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_time</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, char ** t</var>)<var><a name="index-shishi_005ftime-707"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 node to get time from.

        <p><var>field</var>: Name of field in ASN.1 node to get time from.

        <p><var>t</var>: newly allocated output array with zero terminated time string.

        <p>Extract time from ASN.1 structure.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_ctime</h4>

<p><a name="shishi_005fctime"></a>

<div class="defun">
&mdash; Function: int <b>shishi_ctime</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, time_t * t</var>)<var><a name="index-shishi_005fctime-708"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 variable to read field from.

        <p><var>field</var>: name of field in <code>node</code> to read.

        <p><var>t</var>: pointer to time field to set.

        <p>Extract time from ASN.1 structure.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_ASN1_NO_ELEMENT if the element do not exist,
SHISHI_ASN1_NO_VALUE if the field has no value, ot
SHISHI_ASN1_ERROR otherwise. 
</p></blockquote></div>

<h4 class="subheading">shishi_prompt_password_callback_set</h4>

<p><a name="shishi_005fprompt_005fpassword_005fcallback_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_prompt_password_callback_set</b> (<var>Shishi * handle, shishi_prompt_password_func cb</var>)<var><a name="index-shishi_005fprompt_005fpassword_005fcallback_005fset-709"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>cb</var>: function pointer to application password callback, a
<code>shishi_prompt_password_func</code> type.

        <p>Set a callback function that will be used by
<code>shishi_prompt_password()</code> to query the user for a password.  The
function pointer can be retrieved using
<code>shishi_prompt_password_callback_get()</code>.

        <p>The <code>cb</code> function should follow the <code>shishi_prompt_password_func</code> prototype:

        <p>int prompt_password (Shishi * <code>handle</code>, char **<code>s</code>,
const char *<code>format</code>, va_list <code>ap</code>);

        <p>If the function returns 0, the <code>s</code> variable should contain a newly
allocated string with the password read from the user. 
</p></blockquote></div>

<h4 class="subheading">shishi_prompt_password_callback_get</h4>

<p><a name="shishi_005fprompt_005fpassword_005fcallback_005fget"></a>

<div class="defun">
&mdash; Function: shishi_prompt_password_func <b>shishi_prompt_password_callback_get</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fprompt_005fpassword_005fcallback_005fget-710"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Get the application password prompt function callback as set by
<code>shishi_prompt_password_callback_set()</code>.

        <p><strong>Returns:</strong> Returns the callback, a <code>shishi_prompt_password_func</code> type,
or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">shishi_prompt_password</h4>

<p><a name="shishi_005fprompt_005fpassword"></a>

<div class="defun">
&mdash; Function: int <b>shishi_prompt_password</b> (<var>Shishi * handle, char ** s, const char * format, ...</var>)<var><a name="index-shishi_005fprompt_005fpassword-711"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>s</var>: pointer to newly allocated output string with read password.

        <p><var>format</var>: printf(3) style format string. 
...: printf(3) style arguments.

        <p>Format and print a prompt, and read a password from user.  The
password is possibly converted (e.g., converted from Latin-1 to
UTF-8, or processed using Stringprep profile) following any
"stringprocess" keywords in configuration files.

        <p><strong>Return value:</strong> Returns SHISHI_OK iff successful. 
</p></blockquote></div>

<h4 class="subheading">shishi_resolv</h4>

<p><a name="shishi_005fresolv"></a>

<div class="defun">
&mdash; Function: Shishi_dns <b>shishi_resolv</b> (<var>const char * zone, uint16_t querytype</var>)<var><a name="index-shishi_005fresolv-712"></a></var><br>
<blockquote><p><var>zone</var>: owner name of data, e.g. "EXAMPLE.ORG"

        <p><var>querytype</var>: type of data to query for, e.g., SHISHI_DNS_TXT.

        <p>Query DNS resolver for data of type <code>querytype</code> at owner name <code>zone</code>. 
Currently TXT and SRV types are supported.

        <p><strong>Return value:</strong> Returns linked list of DNS records, or NULL if query
failed. 
</p></blockquote></div>

<h4 class="subheading">shishi_resolv_free</h4>

<p><a name="shishi_005fresolv_005ffree"></a>

<div class="defun">
&mdash; Function: void <b>shishi_resolv_free</b> (<var>Shishi_dns rrs</var>)<var><a name="index-shishi_005fresolv_005ffree-713"></a></var><br>
<blockquote><p><var>rrs</var>: list of DNS RR as returned by <code>shishi_resolv()</code>.

        <p>Deallocate list of DNS RR as returned by <code>shishi_resolv()</code>. 
</p></blockquote></div>

<div class="node">
<a name="ASN.1-Functions"></a>
<a name="ASN_002e1-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Error-Handling">Error Handling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Utility-Functions">Utility Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.16 ASN.1 Functions</h3>

<h4 class="subheading">shishi_asn1_read_inline</h4>

<p><a name="shishi_005fasn1_005fread_005finline"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asn1_read_inline</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, char * data, size_t * datalen</var>)<var><a name="index-shishi_005fasn1_005fread_005finline-714"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 variable to read field from.

        <p><var>field</var>: name of field in <code>node</code> to read.

        <p><var>data</var>: pre-allocated output buffer that will hold ASN.1 field data.

        <p><var>datalen</var>: on input, maximum size of output buffer,
on output, actual size of output buffer.

        <p>Extract data stored in a ASN.1 field into a fixed size buffer
allocated by caller.

        <p>Note that since it is difficult to predict the length of the field,
it is often better to use <code>shishi_asn1_read()</code> instead.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_ASN1_NO_ELEMENT if the element do not exist,
SHISHI_ASN1_NO_VALUE if the field has no value, ot
SHISHI_ASN1_ERROR otherwise. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_read</h4>

<p><a name="shishi_005fasn1_005fread"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asn1_read</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, char ** data, size_t * datalen</var>)<var><a name="index-shishi_005fasn1_005fread-715"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 variable to read field from.

        <p><var>field</var>: name of field in <code>node</code> to read.

        <p><var>data</var>: newly allocated output buffer that will hold ASN.1 field data.

        <p><var>datalen</var>: actual size of output buffer.

        <p>Extract data stored in a ASN.1 field into a newly allocated buffer. 
The buffer will always be zero terminated, even though <code>datalen</code>
will not include the added zero.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_ASN1_NO_ELEMENT if the element do not exist,
SHISHI_ASN1_NO_VALUE if the field has no value, ot
SHISHI_ASN1_ERROR otherwise. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_read_optional</h4>

<p><a name="shishi_005fasn1_005fread_005foptional"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asn1_read_optional</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, char ** data, size_t * datalen</var>)<var><a name="index-shishi_005fasn1_005fread_005foptional-716"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 variable to read field from.

        <p><var>field</var>: name of field in <code>node</code> to read.

        <p><var>data</var>: newly allocated output buffer that will hold ASN.1 field data.

        <p><var>datalen</var>: actual size of output buffer.

        <p>Extract data stored in a ASN.1 field into a newly allocated buffer. 
If the field does not exist (i.e., SHISHI_ASN1_NO_ELEMENT), this
function set datalen to 0 and succeeds.  Can be useful to read
ASN.1 fields which are marked OPTIONAL in the grammar, if you want
to avoid special error handling in your code.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful,
SHISHI_ASN1_NO_VALUE if the field has no value, ot
SHISHI_ASN1_ERROR otherwise. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_done</h4>

<p><a name="shishi_005fasn1_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shishi_asn1_done</b> (<var>Shishi * handle, Shishi_asn1 node</var>)<var><a name="index-shishi_005fasn1_005fdone-717"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 node to dellocate.

        <p>Deallocate resources associated with ASN.1 structure.  Note that
the node must not be used after this call. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_pa_enc_ts_enc</h4>

<p><a name="shishi_005fasn1_005fpa_005fenc_005fts_005fenc"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_pa_enc_ts_enc</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fpa_005fenc_005fts_005fenc-718"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for PA-ENC-TS-ENC.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_encrypteddata</h4>

<p><a name="shishi_005fasn1_005fencrypteddata"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_encrypteddata</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fencrypteddata-719"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for EncryptedData

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_padata</h4>

<p><a name="shishi_005fasn1_005fpadata"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_padata</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fpadata-720"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for PA-DATA.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_methoddata</h4>

<p><a name="shishi_005fasn1_005fmethoddata"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_methoddata</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fmethoddata-721"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for METHOD-DATA.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_etype_info</h4>

<p><a name="shishi_005fasn1_005fetype_005finfo"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_etype_info</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fetype_005finfo-722"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for ETYPE-INFO.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_etype_info2</h4>

<p><a name="shishi_005fasn1_005fetype_005finfo2"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_etype_info2</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fetype_005finfo2-723"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for ETYPE-INFO2.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_asreq</h4>

<p><a name="shishi_005fasn1_005fasreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_asreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fasreq-724"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for AS-REQ.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_asrep</h4>

<p><a name="shishi_005fasn1_005fasrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_asrep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fasrep-725"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for AS-REP.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_tgsreq</h4>

<p><a name="shishi_005fasn1_005ftgsreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_tgsreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005ftgsreq-726"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for TGS-REQ.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_tgsrep</h4>

<p><a name="shishi_005fasn1_005ftgsrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_tgsrep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005ftgsrep-727"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for TGS-REP.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_apreq</h4>

<p><a name="shishi_005fasn1_005fapreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_apreq</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fapreq-728"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for AP-REQ.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_aprep</h4>

<p><a name="shishi_005fasn1_005faprep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_aprep</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005faprep-729"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for AP-REP.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_encapreppart</h4>

<p><a name="shishi_005fasn1_005fencapreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_encapreppart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fencapreppart-730"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for AP-REP.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_ticket</h4>

<p><a name="shishi_005fasn1_005fticket"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_ticket</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fticket-731"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for Ticket.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_encticketpart</h4>

<p><a name="shishi_005fasn1_005fencticketpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_encticketpart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fencticketpart-732"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for EncTicketPart.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_authenticator</h4>

<p><a name="shishi_005fasn1_005fauthenticator"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_authenticator</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fauthenticator-733"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for Authenticator.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_enckdcreppart</h4>

<p><a name="shishi_005fasn1_005fenckdcreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_enckdcreppart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fenckdcreppart-734"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for EncKDCRepPart.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_encasreppart</h4>

<p><a name="shishi_005fasn1_005fencasreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_encasreppart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fencasreppart-735"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for EncASRepPart.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_krberror</h4>

<p><a name="shishi_005fasn1_005fkrberror"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_krberror</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fkrberror-736"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for KRB-ERROR.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_krbsafe</h4>

<p><a name="shishi_005fasn1_005fkrbsafe"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_krbsafe</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fkrbsafe-737"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for KRB-SAFE.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_priv</h4>

<p><a name="shishi_005fasn1_005fpriv"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_priv</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fpriv-738"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for KRB-PRIV.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_encprivpart</h4>

<p><a name="shishi_005fasn1_005fencprivpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_asn1_encprivpart</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005fasn1_005fencprivpart-739"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Create new ASN.1 structure for EncKrbPrivPart.

        <p><strong>Return value:</strong> Returns ASN.1 structure. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_to_der_field</h4>

<p><a name="shishi_005fasn1_005fto_005fder_005ffield"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asn1_to_der_field</b> (<var>Shishi * handle, Shishi_asn1 node, const char * field, char ** der, size_t * len</var>)<var><a name="index-shishi_005fasn1_005fto_005fder_005ffield-740"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 data that have field to extract.

        <p><var>field</var>: name of field in <code>node</code> to extract.

        <p><var>der</var>: output array that holds DER encoding of <code>field</code> in <code>node</code>.

        <p><var>len</var>: output variable with length of <code>der</code> output array.

        <p>Extract newly allocated DER representation of specified ASN.1 field.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful, or SHISHI_ASN1_ERROR
if DER encoding fails (common reasons for this is that the ASN.1
is missing required values). 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_to_der</h4>

<p><a name="shishi_005fasn1_005fto_005fder"></a>

<div class="defun">
&mdash; Function: int <b>shishi_asn1_to_der</b> (<var>Shishi * handle, Shishi_asn1 node, char ** der, size_t * len</var>)<var><a name="index-shishi_005fasn1_005fto_005fder-741"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 data to convert to DER.

        <p><var>der</var>: output array that holds DER encoding of <code>node</code>.

        <p><var>len</var>: output variable with length of <code>der</code> output array.

        <p>Extract newly allocated DER representation of specified ASN.1 data.

        <p><strong>Return value:</strong> Returns SHISHI_OK if successful, or SHISHI_ASN1_ERROR
if DER encoding fails (common reasons for this is that the ASN.1
is missing required values). 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_msgtype</h4>

<p><a name="shishi_005fasn1_005fmsgtype"></a>

<div class="defun">
&mdash; Function: Shishi_msgtype <b>shishi_asn1_msgtype</b> (<var>Shishi * handle, Shishi_asn1 node</var>)<var><a name="index-shishi_005fasn1_005fmsgtype-742"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 type to get msg type for.

        <p>Determine msg-type of ASN.1 type of a packet. Currently this uses
the msg-type field instead of the APPLICATION tag, but this may be
changed in the future.

        <p><strong>Return value:</strong> Returns msg-type of ASN.1 type, 0 on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_der_msgtype</h4>

<p><a name="shishi_005fder_005fmsgtype"></a>

<div class="defun">
&mdash; Function: Shishi_msgtype <b>shishi_der_msgtype</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder_005fmsgtype-743"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Determine msg-type of DER coded data of a packet.

        <p><strong>Return value:</strong> Returns msg-type of DER data, 0 on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1</h4>

<p><a name="shishi_005fder2asn1"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1-744"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Convert arbitrary DER data of a packet to a ASN.1 type.

        <p><strong>Return value:</strong> Returns newly allocate ASN.1 corresponding to DER
data, or <code>NULL</code> on failure. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_padata</h4>

<p><a name="shishi_005fder2asn1_005fpadata"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_padata</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fpadata-745"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of PA-DATA and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_methoddata</h4>

<p><a name="shishi_005fder2asn1_005fmethoddata"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_methoddata</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fmethoddata-746"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of METHOD-DATA and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_etype_info</h4>

<p><a name="shishi_005fder2asn1_005fetype_005finfo"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_etype_info</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fetype_005finfo-747"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of ETYPE-INFO and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_etype_info2</h4>

<p><a name="shishi_005fder2asn1_005fetype_005finfo2"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_etype_info2</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fetype_005finfo2-748"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of ETYPE-INFO2 and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_ticket</h4>

<p><a name="shishi_005fder2asn1_005fticket"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_ticket</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fticket-749"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of Ticket and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_encticketpart</h4>

<p><a name="shishi_005fder2asn1_005fencticketpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_encticketpart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fencticketpart-750"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncTicketPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_asreq</h4>

<p><a name="shishi_005fder2asn1_005fasreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_asreq</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fasreq-751"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of AS-REQ and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_tgsreq</h4>

<p><a name="shishi_005fder2asn1_005ftgsreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_tgsreq</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005ftgsreq-752"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of TGS-REQ and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_asrep</h4>

<p><a name="shishi_005fder2asn1_005fasrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_asrep</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fasrep-753"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of AS-REP and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_tgsrep</h4>

<p><a name="shishi_005fder2asn1_005ftgsrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_tgsrep</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005ftgsrep-754"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of TGS-REP and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_kdcrep</h4>

<p><a name="shishi_005fder2asn1_005fkdcrep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_kdcrep</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fkdcrep-755"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of KDC-REP and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_encasreppart</h4>

<p><a name="shishi_005fder2asn1_005fencasreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_encasreppart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fencasreppart-756"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncASRepPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_enctgsreppart</h4>

<p><a name="shishi_005fder2asn1_005fenctgsreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_enctgsreppart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fenctgsreppart-757"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncTGSRepPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_enckdcreppart</h4>

<p><a name="shishi_005fder2asn1_005fenckdcreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_enckdcreppart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fenckdcreppart-758"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncKDCRepPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_authenticator</h4>

<p><a name="shishi_005fder2asn1_005fauthenticator"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_authenticator</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fauthenticator-759"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of Authenticator and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_krberror</h4>

<p><a name="shishi_005fder2asn1_005fkrberror"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_krberror</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fkrberror-760"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of KRB-ERROR and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_krbsafe</h4>

<p><a name="shishi_005fder2asn1_005fkrbsafe"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_krbsafe</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fkrbsafe-761"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of KRB-SAFE and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_priv</h4>

<p><a name="shishi_005fder2asn1_005fpriv"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_priv</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fpriv-762"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of KRB-PRIV and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_encprivpart</h4>

<p><a name="shishi_005fder2asn1_005fencprivpart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_encprivpart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fencprivpart-763"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncKrbPrivPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_apreq</h4>

<p><a name="shishi_005fder2asn1_005fapreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_apreq</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fapreq-764"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of AP-REQ and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_aprep</h4>

<p><a name="shishi_005fder2asn1_005faprep"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_aprep</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005faprep-765"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of AP-REP and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_encapreppart</h4>

<p><a name="shishi_005fder2asn1_005fencapreppart"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_encapreppart</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fencapreppart-766"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of EncAPRepPart and create a ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_der2asn1_kdcreq</h4>

<p><a name="shishi_005fder2asn1_005fkdcreq"></a>

<div class="defun">
&mdash; Function: Shishi_asn1 <b>shishi_der2asn1_kdcreq</b> (<var>Shishi * handle, const char * der, size_t derlen</var>)<var><a name="index-shishi_005fder2asn1_005fkdcreq-767"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>der</var>: input character array with DER encoding.

        <p><var>derlen</var>: length of input character array with DER encoding.

        <p>Decode DER encoding of AS-REQ, TGS-REQ or KDC-REQ and create a
ASN.1 structure.

        <p><strong>Return value:</strong> Returns ASN.1 structure corresponding to DER data. 
</p></blockquote></div>

<h4 class="subheading">shishi_asn1_print</h4>

<p><a name="shishi_005fasn1_005fprint"></a>

<div class="defun">
&mdash; Function: void <b>shishi_asn1_print</b> (<var>Shishi * handle, Shishi_asn1 node, FILE * fh</var>)<var><a name="index-shishi_005fasn1_005fprint-768"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>node</var>: ASN.1 data that have field to extract.

        <p><var>fh</var>: file descriptor to print to, e.g. stdout.

        <p>Print ASN.1 structure in human readable form, typically for
debugging purposes. 
</p></blockquote></div>

<div class="node">
<a name="Error-Handling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Examples">Examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ASN_002e1-Functions">ASN.1 Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.17 Error Handling</h3>

<p><a name="index-Error-Handling-769"></a>
Most functions in `Libshishi' are returning an error if they fail. 
For this reason, the application should always catch the error
condition and take appropriate measures, for example by releasing the
resources and passing the error up to the caller, or by displaying a
descriptive message to the user and cancelling the operation.

   <p>Some error values do not indicate a system error or an error in the
operation, but the result of an operation that failed properly.

<ul class="menu">
<li><a accesskey="1" href="#Error-Values">Error Values</a>:                 A list of all error values used. 
<li><a accesskey="2" href="#Error-Functions">Error Functions</a>:              Error handling related functions. 
</ul>

<div class="node">
<a name="Error-Values"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Error-Functions">Error Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Error-Handling">Error Handling</a>

</div>

<h4 class="subsection">5.17.1 Error Values</h4>

<p>Errors are returned as an <code>int</code>.  Except for the SHISHI_OK case,
an application should always use the constants instead of their
numeric value.  Applications are encouraged to use the constants even
for SHISHI_OK as it improves readability.  Possible values are:

     <dl>
<dt><code>SHISHI_OK</code><dd>This value indicates success.  The value of this error is guaranteed
to always be <code>0</code> so you may use it in boolean constructs.

     <br><dt><code>SHISHI_ASN1_ERROR</code><dd>Error in ASN.1 function (corrupt data?)

     <br><dt><code>SHISHI_FOPEN_ERROR</code><dd>Could not open file

     <br><dt><code>SHISHI_IO_ERROR</code><dd>File input/output error

     <br><dt><code>SHISHI_MALLOC_ERROR</code><dd>Memory allocation error in shishi library.

     <br><dt><code>SHISHI_BASE64_ERROR</code><dd>Base64 encoding or decoding failed. Data corrupt?

     <br><dt><code>SHISHI_REALM_MISMATCH</code><dd>Client realm value differ between request and reply.

     <br><dt><code>SHISHI_CNAME_MISMATCH</code><dd>Client name value differ between request and reply.

     <br><dt><code>SHISHI_NONCE_MISMATCH</code><dd>Replay protection value (nonce) differ between request and reply.

     <br><dt><code>SHISHI_TICKET_BAD_KEYTYPE</code><dd>Keytype used to encrypt ticket doesn't match provided key. This usually indicates an internal application error.

     <br><dt><code>SHISHI_CRYPTO_INTERNAL_ERROR</code><dd>Internal error in low-level crypto routines.

     <br><dt><code>SHISHI_CRYPTO_ERROR</code><dd>Low-level cryptographic primitive failed.  This usually indicates bad password or data corruption.

     <br><dt><code>SHISHI_KDC_TIMEOUT</code><dd>Timedout talking to KDC. This usually indicates a network or KDC address problem.

     <br><dt><code>SHISHI_KDC_NOT_KNOWN_FOR_REALM</code><dd>No KDC for realm known.

     <br><dt><code>SHISHI_SOCKET_ERROR</code><dd>The system call socket() failed.  This usually indicates that your system does not support the socket type.

     <br><dt><code>SHISHI_BIND_ERROR</code><dd>The system call bind() failed.  This usually indicates insufficient permissions.

     <br><dt><code>SHISHI_SENDTO_ERROR</code><dd>The system call sendto() failed.

     <br><dt><code>SHISHI_CLOSE_ERROR</code><dd>The system call close() failed.

     <br><dt><code>SHISHI_GOT_KRBERROR</code><dd>Server replied with an error message to request.

     <br><dt><code>SHISHI_INVALID_TKTS</code><dd>Ticketset not initialized.  This usually indicates an internal application error.

     <br><dt><code>SHISHI_APREQ_DECRYPT_FAILED</code><dd>Could not decrypt AP-REQ using provided key. This usually indicates an internal application error.

     <br><dt><code>SHISHI_TICKET_DECRYPT_FAILED</code><dd>Could not decrypt Ticket using provided key. This usually indicates an internal application error.

     <br><dt><code>SHISHI_KEYTAB_ERROR</code><dd>Failed to parse keytab file

     <br><dt><code>SHISHI_CCACHE_ERROR</code><dd>Failed to parse credential cache file

   </dl>

<div class="node">
<a name="Error-Functions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Error-Values">Error Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Error-Handling">Error Handling</a>

</div>

<h4 class="subsection">5.17.2 Error Functions</h4>

<h4 class="subheading">shishi_strerror</h4>

<p><a name="shishi_005fstrerror"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_strerror</b> (<var>int err</var>)<var><a name="index-shishi_005fstrerror-770"></a></var><br>
<blockquote><p><var>err</var>: shishi error code.

        <p>Convert return code to human readable string.

        <p><strong>Return value:</strong> Returns a pointer to a statically allocated string
containing a description of the error with the error value <code>err</code>. 
This string can be used to output a diagnostic message to the user. 
</p></blockquote></div>

<h4 class="subheading">shishi_error</h4>

<p><a name="shishi_005ferror"></a>

<div class="defun">
&mdash; Function: const char * <b>shishi_error</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ferror-771"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Extract detailed error information string.  Note that the memory is
managed by the Shishi library, so you must not deallocate the
string.

        <p><strong>Return value:</strong> Returns pointer to error information string, that must
not be deallocate by caller. 
</p></blockquote></div>

<h4 class="subheading">shishi_error_clear</h4>

<p><a name="shishi_005ferror_005fclear"></a>

<div class="defun">
&mdash; Function: void <b>shishi_error_clear</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ferror_005fclear-772"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Clear the detailed error information string.  See <code>shishi_error()</code>
for how to access the error string, and <code>shishi_error_set()</code> and
<code>shishi_error_printf()</code> for how to set the error string.  This
function is mostly for Shishi internal use, but if you develop an
extension of Shishi, it may be useful to use the same error
handling infrastructure. 
</p></blockquote></div>

<h4 class="subheading">shishi_error_set</h4>

<p><a name="shishi_005ferror_005fset"></a>

<div class="defun">
&mdash; Function: void <b>shishi_error_set</b> (<var>Shishi * handle, const char * errstr</var>)<var><a name="index-shishi_005ferror_005fset-773"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>errstr</var>: Zero terminated character array containing error description,
or NULL to clear the error description string.

        <p>Set the detailed error information string to specified string.  The
string is copied into the Shishi internal structure, so you can
deallocate the string passed to this function after the call.  This
function is mostly for Shishi internal use, but if you develop an
extension of Shishi, it may be useful to use the same error
handling infrastructure. 
</p></blockquote></div>

<h4 class="subheading">shishi_error_printf</h4>

<p><a name="shishi_005ferror_005fprintf"></a>

<div class="defun">
&mdash; Function: void <b>shishi_error_printf</b> (<var>Shishi * handle, const char * format, ...</var>)<var><a name="index-shishi_005ferror_005fprintf-774"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>format</var>: printf style format string. 
...: print style arguments.

        <p>Set the detailed error information string to a printf formatted
string.  This function is mostly for Shishi internal use, but if
you develop an extension of Shishi, it may be useful to use the
same error handling infrastructure. 
</p></blockquote></div>

<h4 class="subheading">shishi_error_outputtype</h4>

<p><a name="shishi_005ferror_005foutputtype"></a>

<div class="defun">
&mdash; Function: int <b>shishi_error_outputtype</b> (<var>Shishi * handle</var>)<var><a name="index-shishi_005ferror_005foutputtype-775"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p>Get the current output type for logging messages.

        <p><strong>Return value:</strong> Return output type (NULL, stderr or syslog) for
informational and warning messages. 
</p></blockquote></div>

<h4 class="subheading">shishi_error_set_outputtype</h4>

<p><a name="shishi_005ferror_005fset_005foutputtype"></a>

<div class="defun">
&mdash; Function: void <b>shishi_error_set_outputtype</b> (<var>Shishi * handle, int type</var>)<var><a name="index-shishi_005ferror_005fset_005foutputtype-776"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>type</var>: output type.

        <p>Set output type (NULL, stderr or syslog) for informational
and warning messages. 
</p></blockquote></div>

<h4 class="subheading">shishi_info</h4>

<p><a name="shishi_005finfo"></a>

<div class="defun">
&mdash; Function: void <b>shishi_info</b> (<var>Shishi * handle, const char * format, ...</var>)<var><a name="index-shishi_005finfo-777"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>format</var>: printf style format string. 
...: print style arguments.

        <p>Print informational message to output as defined in handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_warn</h4>

<p><a name="shishi_005fwarn"></a>

<div class="defun">
&mdash; Function: void <b>shishi_warn</b> (<var>Shishi * handle, const char * format, ...</var>)<var><a name="index-shishi_005fwarn-778"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>format</var>: printf style format string. 
...: print style arguments.

        <p>Print a warning to output as defined in handle. 
</p></blockquote></div>

<h4 class="subheading">shishi_verbose</h4>

<p><a name="shishi_005fverbose"></a>

<div class="defun">
&mdash; Function: void <b>shishi_verbose</b> (<var>Shishi * handle, const char * format, ...</var>)<var><a name="index-shishi_005fverbose-779"></a></var><br>
<blockquote><p><var>handle</var>: shishi handle as allocated by <code>shishi_init()</code>.

        <p><var>format</var>: printf style format string. 
...: print style arguments.

        <p>Print a diagnostic message to output as defined in handle. 
</p></blockquote></div>

<div class="node">
<a name="Examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Kerberos-Database-Functions">Kerberos Database Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Error-Handling">Error Handling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.18 Examples</h3>

<p><a name="index-Examples-780"></a>
This section will be extended to contain walk-throughs of example code
that demonstrate how `Shishi' is used to write your own applications
that support Kerberos 5.  The rest of the current section consists of
some crude hints for the example client/server applications that is
part of Shishi, taken from an email but saved here for lack of a
better place to put it.

   <p>There are two programs: 'client' and 'server' in src/.

   <p>The client output an AP-REQ, waits for an AP-REP, and then simply
reads data from stdin.

   <p>The server waits for an AP-REQ, parses it and prints an AP-REP, and
then read data from stdin.

   <p>Both programs accept a Kerberos server name as the first command line
argument.  Your KDC must know this server, since the client tries to
get a ticket for it (first it gets a ticket granting ticket for the
default username), and you must write the key for the server into
/usr/local/etc/shishi.keys on the Shishi format, e.g.:

<pre class="example">     -----BEGIN SHISHI KEY-----
     Keytype: 16 (des3-cbc-sha1-kd)
     Principal: sample/latte.josefsson.org
     Realm: JOSEFSSON.ORG
     
     8W0VrQQBpxlACPQEqN91EHxbvFFo2ltt
     -----END SHISHI KEY-----
</pre>
   <p>You must extract the proper encryption key from the KDC in some way. 
(This part will be easier when Shishi include a KDC, a basic one isn't
far away, give me a week or to.)

   <p>The intention is that the data read, after the authentication phase,
should be protected using KRB_SAFE (see RFC) but I haven't added this
yet.

<div class="node">
<a name="Kerberos-Database-Functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Generic-Security-Service">Generic Security Service</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Examples">Examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.19 Kerberos Database Functions</h3>

<p><a name="index-Shisa-API-781"></a><a name="index-Database-interface-782"></a>
Shisa is a separate and standalone library from Shishi
(see <a href="#Introduction-to-Shisa">Introduction to Shisa</a>).  If you only wish to manipulate the
information stored in the Kerberos user database used by Shishi, you
do not need to link or use the Shishi library at all.  However, you
may find it useful to combine the two libraries.

   <p>For two real world examples on using the Shisa library, refer to
<samp><span class="file">src/shisa.c</span></samp> (Shisa command line tool) and <samp><span class="file">src/kdc.c</span></samp>
(part of Shishid server).

   <p>Shisa uses two &lsquo;<samp><span class="samp">struct</span></samp>&rsquo;s to carry information.  The first,
<code>Shisa_principal</code>, is used to hold information about principals. 
The struct does not contain pointers to strings etc, so the library
assumes the caller is responsible for allocating and deallocating the
struct itself.  Each such struct is (uniquely) identified by the
combination of principal name and realm name.

<pre class="example">     struct Shisa_principal
     {
       int isdisabled;
       uint32_t kvno;
       time_t notusedbefore;
       time_t lastinitialtgt;      /* time of last initial request for a TGT */
       time_t lastinitialrequest;  /* time of last initial request */
       time_t lasttgt;             /* time of issue for the newest TGT used */
       time_t lastrenewal;         /* time of the last renewal */
       time_t passwordexpire;      /* time when the password will expire */
       time_t accountexpire;       /* time when the account will expire. */
     };
     typedef struct Shisa_principal Shisa_principal;
</pre>
   <p>The second structure is called <code>Shisa_key</code> and hold information
about cryptographic keys.  Because the struct contain pointers, and
the caller cannot know how many keys a principal have, the Shisa
library manages memory for the struct.  The library allocate the
structs, and the pointers within them.  The caller may deallocate
them, but it is recommended to use <code>shisa_key_free</code> or
<code>shisa_keys_free</code> instead.  Note that each principal may have
multiple keys.

<pre class="example">     struct Shisa_key
     {
       uint32_t kvno;
       int32_t etype;
       int priority;
       char *key;
       size_t keylen;
       char *salt;
       size_t saltlen;
       char *str2keyparam;
       size_t str2keyparamlen;
       char *password;
     };
     typedef struct Shisa_key Shisa_key;
</pre>
   <p>Shisa is typically initialized by calling <code>shisa_init</code>, and
deinitialized (when the application no longer need to use Shisa,
typically when it shuts down) by calling <code>shisa_done</code>, but here
are the complete (de)initialization interface functions.

<h4 class="subheading">shisa</h4>

<p><a name="shisa"></a>

<div class="defun">
&mdash; Function: Shisa * <b>shisa</b> (<var> void</var>)<var><a name="index-shisa-783"></a></var><br>
<blockquote>
        <p>Initializes the Shisa library.  If this function fails, it may
print diagnostic errors to stderr.

        <p><strong>Return value:</strong> Returns Shisa library handle, or <code>NULL</code> on error. 
</p></blockquote></div>

<h4 class="subheading">shisa_done</h4>

<p><a name="shisa_005fdone"></a>

<div class="defun">
&mdash; Function: void <b>shisa_done</b> (<var>Shisa * dbh</var>)<var><a name="index-shisa_005fdone-784"></a></var><br>
<blockquote><p>Deallocates the shisa library handle.  The handle must not be used
in any calls to shisa functions after this. 
</p></blockquote></div>

<h4 class="subheading">shisa_init</h4>

<p><a name="shisa_005finit"></a>

<div class="defun">
&mdash; Function: int <b>shisa_init</b> (<var>Shisa ** dbh</var>)<var><a name="index-shisa_005finit-785"></a></var><br>
<blockquote><p><var>dbh</var>: pointer to library handle to be created.

        <p>Create a Shisa library handle, using <code>shisa()</code>, and read the system
configuration file from their default locations.  The paths to the
default system configuration file is decided at compile time
($sysconfdir/shisa.conf).

        <p>The handle is allocated regardless of return values, except for
SHISA_INIT_ERROR which indicates a problem allocating the handle. 
(The other error conditions comes from reading the files.)

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> iff successful. 
</p></blockquote></div>

<h4 class="subheading">shisa_init_with_paths</h4>

<p><a name="shisa_005finit_005fwith_005fpaths"></a>

<div class="defun">
&mdash; Function: int <b>shisa_init_with_paths</b> (<var>Shisa ** dbh, const char * file</var>)<var><a name="index-shisa_005finit_005fwith_005fpaths-786"></a></var><br>
<blockquote><p><var>dbh</var>: pointer to library handle to be created.

        <p><var>file</var>: Filename of system configuration, or NULL.

        <p>Create a Shisa library handle, using <code>shisa()</code>, and read the system
configuration file indicated location (or the default location, if
<code>NULL</code>).  The paths to the default system configuration file is
decided at compile time ($sysconfdir/shisa.conf).

        <p>The handle is allocated regardless of return values, except for
SHISA_INIT_ERROR which indicates a problem allocating the handle. 
(The other error conditions comes from reading the files.)

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> iff successful. 
</p></blockquote></div>

   <p>The default configuration file is typically read automatically by
calling <code>shisa_init</code>, but if you wish to manually access the
Shisa configuration file functions, here is the complete interface.

<h4 class="subheading">shisa_cfg_db</h4>

<p><a name="shisa_005fcfg_005fdb"></a>

<div class="defun">
&mdash; Function: int <b>shisa_cfg_db</b> (<var>Shisa * dbh, const char * value</var>)<var><a name="index-shisa_005fcfg_005fdb-787"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>value</var>: string with database definition.

        <p>Setup and open a new database.  The syntax of the <code>value</code> parameter
is "TYPE[ LOCATION[ PARAMETER]]", where TYPE is one of the
supported database types (e.g., "file") and LOCATION and PARAMETER
are optional strings passed to the database during initialization. 
Neither TYPE nor LOCATION can contain " " (SPC), but PARAMETER may.

        <p><strong>Return Value:</strong> Returns <code>SHISA_OK</code> if database was parsed and open
successfully. 
</p></blockquote></div>

<h4 class="subheading">shisa_cfg</h4>

<p><a name="shisa_005fcfg"></a>

<div class="defun">
&mdash; Function: int <b>shisa_cfg</b> (<var>Shisa * dbh, const char * option</var>)<var><a name="index-shisa_005fcfg-788"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>option</var>: string with shisa library option.

        <p>Configure shisa library with given option.

        <p><strong>Return Value:</strong> Returns SHISA_OK if option was valid. 
</p></blockquote></div>

<h4 class="subheading">shisa_cfg_from_file</h4>

<p><a name="shisa_005fcfg_005ffrom_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>shisa_cfg_from_file</b> (<var>Shisa * dbh, const char * cfg</var>)<var><a name="index-shisa_005fcfg_005ffrom_005ffile-789"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>cfg</var>: filename to read configuration from.

        <p>Configure shisa library using configuration file.

        <p><strong>Return Value:</strong> Returns <code>SHISA_OK</code> iff succesful. 
</p></blockquote></div>

<h4 class="subheading">shisa_cfg_default_systemfile</h4>

<p><a name="shisa_005fcfg_005fdefault_005fsystemfile"></a>

<div class="defun">
&mdash; Function: const char * <b>shisa_cfg_default_systemfile</b> (<var>Shisa * dbh</var>)<var><a name="index-shisa_005fcfg_005fdefault_005fsystemfile-790"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><strong>Return value:</strong> Return system configuration filename. 
</p></blockquote></div>

   <p>The core part of the Shisa interface follows.  The typical procedure
is to use <code>shisa_principal_find</code> to verify that a specific
principal exists, and to extract some information about it, and then
use <code>shisa_keys_find</code> to get the cryptographic keys for the
principal, usually suppliying some hints as to which of all keys you
are interested in (e.g., key version number and encryption algorithm
number).

<h4 class="subheading">shisa_enumerate_realms</h4>

<p><a name="shisa_005fenumerate_005frealms"></a>

<div class="defun">
&mdash; Function: int <b>shisa_enumerate_realms</b> (<var>Shisa * dbh, char *** realms, size_t * nrealms</var>)<var><a name="index-shisa_005fenumerate_005frealms-791"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realms</var>: Pointer to newly allocated array of newly allocated
zero-terminated UTF-8 strings indicating name of realm.

        <p><var>nrealms</var>: Pointer to number indicating number of allocated realm strings.

        <p>Extract a list of all realm names in backend, as zero-terminated
UTF-8 strings.  The caller must deallocate the strings.

        <p><strong>Return value:</strong> Returns SHISA_OK on success, or error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_enumerate_principals</h4>

<p><a name="shisa_005fenumerate_005fprincipals"></a>

<div class="defun">
&mdash; Function: int <b>shisa_enumerate_principals</b> (<var>Shisa * dbh, const char * realm, char *** principals, size_t * nprincipals</var>)<var><a name="index-shisa_005fenumerate_005fprincipals-792"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm, as zero-terminated UTF-8 string.

        <p><var>nprincipals</var>: Pointer to number indicating number of allocated
realm strings.

        <p>Extract a list of all principal names in realm in backend, as
zero-terminated UTF-8 strings.  The caller must deallocate the
strings.

        <p><strong>Return value:</strong> Returns SHISA_OK on success, SHISA_NO_REALM if the
specified realm does not exist, or error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_principal_find</h4>

<p><a name="shisa_005fprincipal_005ffind"></a>

<div class="defun">
&mdash; Function: int <b>shisa_principal_find</b> (<var>Shisa * dbh, const char * realm, const char * principal, Shisa_principal * ph</var>)<var><a name="index-shisa_005fprincipal_005ffind-793"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to get information on.

        <p><var>ph</var>: Pointer to previously allocated principal structure to fill
out with information about principal.

        <p>Extract information about given PRINCIPAL<code>REALM</code>.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> iff successful, <code>SHISA_NO_REALM</code> if
the indicated realm does not exist, <code>SHISA_NO_PRINCIPAL</code> if the
indicated principal does not exist, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_principal_update</h4>

<p><a name="shisa_005fprincipal_005fupdate"></a>

<div class="defun">
&mdash; Function: int <b>shisa_principal_update</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_principal * ph</var>)<var><a name="index-shisa_005fprincipal_005fupdate-794"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to get information on.

        <p><var>ph</var>: Pointer to principal structure with information to store in database.

        <p>Modify information stored for given PRINCIPAL<code>REALM</code>.  Note that it
is usually a good idea to only set the fields in <code>ph</code> that you
actually want to update.  Specifically, first calling
<code>shisa_principal_find()</code> to get the current information, then
modifying one field, and calling <code>shisa_principal_update()</code> is not
recommended in general, as this will 1) overwrite any modifications
made to other fields between the two calls (by other processes) and
2) will cause all values to be written again, which may generate
more overhead.

        <p><strong>Return value:</strong> Returns SHISA_OK if successful, <code>SHISA_NO_REALM</code> if
the indicated realm does not exist, <code>SHISA_NO_PRINCIPAL</code> if the
indicated principal does not exist, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_principal_add</h4>

<p><a name="shisa_005fprincipal_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shisa_principal_add</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_principal * ph, const Shisa_key * key</var>)<var><a name="index-shisa_005fprincipal_005fadd-795"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to add, may be <code>NULL</code> to indicate that
the <code>realm</code> should be created, in which case <code>ph</code> and <code>key</code> are not used.

        <p><var>ph</var>: Pointer to principal structure with information to store in database.

        <p><var>key</var>: Pointer to key structure with information to store in database.

        <p>Add given information to database as PRINCIPAL<code>REALM</code>.

        <p><strong>Return value:</strong> Returns SHISA_OK iff successfully added, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_principal_remove</h4>

<p><a name="shisa_005fprincipal_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shisa_principal_remove</b> (<var>Shisa * dbh, const char * realm, const char * principal</var>)<var><a name="index-shisa_005fprincipal_005fremove-796"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to remove, may be <code>NULL</code> to indicate
that the <code>realm</code> itself should be removed (requires that the realm
to be empty).

        <p>Remove all information stored in the database for given PRINCIPAL<code>REALM</code>.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> if successful, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_keys_find</h4>

<p><a name="shisa_005fkeys_005ffind"></a>

<div class="defun">
&mdash; Function: int <b>shisa_keys_find</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_key * hint, Shisa_key *** keys, size_t * nkeys</var>)<var><a name="index-shisa_005fkeys_005ffind-797"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to add key for.

        <p><var>hint</var>: Pointer to Shisa key structure with hints on matching the key
to modify, may be <code>NULL</code> to match all keys.

        <p><var>keys</var>: pointer to newly allocated array with Shisa key structures.

        <p><var>nkeys</var>: pointer to number of newly allocated Shisa key structures in <code>keys</code>.

        <p>Iterate through keys for given PRINCIPAL<code>REALM</code> and extract any keys
that match <code>hint</code>.  Not all elements of <code>hint</code> need to be filled out,
only use the fields you are interested in.  For example, if you
want to extract all keys with an etype of 3 (DES-CBC-MD5), set the
<code>key</code>-&gt;etype field to 3, and set all other fields to 0.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> iff successful, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_key_add</h4>

<p><a name="shisa_005fkey_005fadd"></a>

<div class="defun">
&mdash; Function: int <b>shisa_key_add</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_key * key</var>)<var><a name="index-shisa_005fkey_005fadd-798"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to add key for.

        <p><var>key</var>: Pointer to Shisa key structure with key to add.

        <p>Add key to database for given PRINCIPAL<code>REALM</code>.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> iff successful, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_key_update</h4>

<p><a name="shisa_005fkey_005fupdate"></a>

<div class="defun">
&mdash; Function: int <b>shisa_key_update</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_key * oldkey, const Shisa_key * newkey</var>)<var><a name="index-shisa_005fkey_005fupdate-799"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to remove key for.

        <p><var>oldkey</var>: Pointer to Shisa key structure with hints on matching the key
to modify.

        <p><var>newkey</var>: Pointer to Shisa key structure with new values for the
key, note that all fields are used (and not just the ones specified
by <code>oldkey</code>).

        <p>Modify data about a key in the database, for the given
PRINCIPAL<code>REALM</code>.  First the <code>oldkey</code> is used to locate the key to
update (similar to <code>shisa_keys_find()</code>), then that key is modified to
contain whatever information is stored in <code>newkey</code>.  Not all
elements of <code>oldkey</code> need to be filled out, only enough as to
identify the key uniquely.  For example, if you want to modify the
information stored for the only key with an etype of 3
(DES-CBC-MD5), set the <code>key</code>-&gt;etype field to 3, and set all other
fields to 0.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> on success, <code>SHISA_NO_KEY</code> if no key
could be identified, and <code>SHISA_MULTIPLE_KEY_MATCH</code> if more than one
key matched the given criteria, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_key_remove</h4>

<p><a name="shisa_005fkey_005fremove"></a>

<div class="defun">
&mdash; Function: int <b>shisa_key_remove</b> (<var>Shisa * dbh, const char * realm, const char * principal, const Shisa_key * key</var>)<var><a name="index-shisa_005fkey_005fremove-800"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>realm</var>: Name of realm the principal belongs in.

        <p><var>principal</var>: Name of principal to remove key for.

        <p><var>key</var>: Pointer to Shisa key structure with hints on matching the key
to remove.

        <p>Remove a key, matching the hints in <code>key</code>, from the Shisa database
for the user PRINCIPAL<code>REALM</code>.  Not all elements of <code>key</code> need to be
filled out, only those you are interested in.  For example, if you
want to remove the only key with an etype of 3 (DES-CBC-MD5), set
the <code>key</code>-&gt;etype field to 3, and set all other fields to 0.

        <p><strong>Return value:</strong> Returns <code>SHISA_OK</code> on success, <code>SHISA_NO_KEY</code> if no key
could be identified, and <code>SHISA_MULTIPLE_KEY_MATCH</code> if more than one
key matched the given criteria, or an error code. 
</p></blockquote></div>

<h4 class="subheading">shisa_key_free</h4>

<p><a name="shisa_005fkey_005ffree"></a>

<div class="defun">
&mdash; Function: void <b>shisa_key_free</b> (<var>Shisa * dbh, Shisa_key * key</var>)<var><a name="index-shisa_005fkey_005ffree-801"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>key</var>: Pointer to Shisa key structure to deallocate.

        <p>Deallocate the fields of a Shisa key structure, and the structure
itself. 
</p></blockquote></div>

<h4 class="subheading">shisa_keys_free</h4>

<p><a name="shisa_005fkeys_005ffree"></a>

<div class="defun">
&mdash; Function: void <b>shisa_keys_free</b> (<var>Shisa * dbh, Shisa_key ** keys, size_t nkeys</var>)<var><a name="index-shisa_005fkeys_005ffree-802"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>keys</var>: Pointer to array with <code>nkeys</code> elements of keys.

        <p><var>nkeys</var>: Number of key elements in <code>keys</code> array.

        <p>Deallocate each element of an array with Shisa database keys, using
<code>shisa_key_free()</code>. 
</p></blockquote></div>

   <p>Error handling is similar to that for Shishi in general (see <a href="#Error-Handling">Error Handling</a>), i.e., you invoke <code>shisa_strerror</code> on the integer
return value received by some function, if the return value is
non-zero.  Below is the complete interface.

<h4 class="subheading">shisa_strerror</h4>

<p><a name="shisa_005fstrerror"></a>

<div class="defun">
&mdash; Function: const char * <b>shisa_strerror</b> (<var>int err</var>)<var><a name="index-shisa_005fstrerror-803"></a></var><br>
<blockquote><p><var>err</var>: shisa error code

        <p><strong>Return value:</strong> Returns a pointer to a statically allocated string
containing a description of the error with the error value <code>err</code>. 
This string can be used to output a diagnostic message to the user. 
</p></blockquote></div>

<h4 class="subheading">shisa_info</h4>

<p><a name="shisa_005finfo"></a>

<div class="defun">
&mdash; Function: void <b>shisa_info</b> (<var>Shisa * dbh, const char * format, ...</var>)<var><a name="index-shisa_005finfo-804"></a></var><br>
<blockquote><p><var>dbh</var>: Shisa library handle created by <code>shisa()</code>.

        <p><var>format</var>: printf style format string. 
...: print style arguments.

        <p>Print informational message to standard error. 
</p></blockquote></div>

<div class="node">
<a name="Generic-Security-Service"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Kerberos-Database-Functions">Kerberos Database Functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Programming-Manual">Programming Manual</a>

</div>

<h3 class="section">5.20 Generic Security Service</h3>

<p><a name="index-Generic-Security-Service-805"></a><a name="index-GSS_002dAPI-806"></a><a name="index-GSSLib-807"></a>
As an alternative to the native Shishi programming API, it is possible
to program Shishi through the Generic Security Services (GSS) API. 
The advantage of using GSS-API in your security application, instead
of the native Shishi API, is that it will be easier to port your
application between different Kerberos 5 implementations, and even
beyond Kerberos 5 to different security systems, that support GSS-API. 
In the free software world, however, almost the only widely used
security system that supports GSS-API is Kerberos 5, so the last
advantage is somewhat academic.  But if you are porting applications
using GSS-API for other Kerberos 5 implementations, or want a more
mature and stable API than the native Shishi API, you may find using
Shishi's GSS-API interface compelling.  Note that GSS-API only offer
basic services, for more advanced uses you must use the native API.

   <p>Since the GSS-API is not specific to Shishi, it is distributed
independently from Shishi.  Further information on the GSS project can
be found at <a href="http://www.gnu.org/software/gss/">http://www.gnu.org/software/gss/</a>.

<!-- ********************************************************** -->
<!-- *******************  Acknowledgements  ******************* -->
<!-- ********************************************************** -->
<div class="node">
<a name="Acknowledgements"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Criticism-of-Kerberos">Criticism of Kerberos</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Programming-Manual">Programming Manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 Acknowledgements</h2>

<p>Shishi uses Libtasn1 by Fabio Fiorina, Libgcrypt and Libgpg-error by
Werner Koch, Libidn by Simon Josefsson, cvs2cl by Karl Fogel, and gdoc
by Michael Zucchi.

   <p>Several GNU packages simplified development considerably, those
packages include Autoconf, Automake, Libtool, Gnulib, Gettext, Indent,
CVS, Texinfo, Help2man and Emacs.

   <p>Several people reported bugs, sent patches or suggested improvements,
see the file THANKS.

   <p>Nicolas Pouvesle wrote the section about the Kerberos rsh/rlogin
protocol.

   <p>This manual borrows text from the Kerberos 5 specification.

<!-- ********************************************************** -->
<!-- *******************  Appendices  ************************* -->
<!-- ********************************************************** -->
<div class="node">
<a name="Criticism-of-Kerberos"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Protocol-Extensions">Protocol Extensions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Acknowledgements">Acknowledgements</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix A Criticism of Kerberos</h2>

<p>The intention with this section is to discuss various problems with
Kerberos 5, so you can form a conscious decision how to deploy and use
Shishi correctly in your organization.  Currently the issues below are
condensed, and mostly serve as a reminder for the author to elaborate
on them.

   <p>No encryption scheme with security proof.

   <p>No standardized API, and GSS mechanism lack important functionality.

   <p>Lack of authorization system.  (krb5_kuserok())

   <p>Host to realm mapping relies on insecure DNS or static configuration
files.

   <p>Informational model and user database administration.

   <p>Non-formal specification.  Unclear on the etype to use for session
keys (etype in request or database?).  Unclear on how to populate some
&ldquo;evident&rdquo; fields (e.g., cname in tickets for AS-REQ, or crealm,
cname, realm, sname, ctime and cusec in KRB-ERROR).  Unclear error
code semantics (e.g., logic for when to use S_PRINCIPAL_UNKNOWN
absent).  Some KRB-ERROR fields are required, but can't be usefully
populated in some situations, and no guidance is given on what they
should contain.

   <p>RFC 1510/1510bis incompatibilities.  NULL enctype removed without
discussion, and it is still used by some 1964 GSSAPI implementations. 
KRB_SAFE text (3.4.1) says the checksum is generated using the session
or sub-session key, which contradicts itself (compare section 3.2.6)
and also RFC 1510, which both allow the application to define the key. 
Verification of KRB_SAFE now require the key to be compatible with the
(sub-)session key, in 1510 the only requirement was that it was
collision proof.

   <p>Problems with RFC 1510bis.  Uses bignum INTEGER for TYPED-DATA and
AD-AND-OR.

   <p>Problems with crypto specification.  It uses the word &ldquo;random&rdquo; many
times, but there is no discussion on the randomness requirements. 
Practical experience indicate it is impossible to use true randomness
for all &ldquo;random&rdquo; fields, and no implementation does this.  A post by
Don Davis on the ietf-krb-wg list tried to provide insight, but the
information was never added to the specification.

<div class="node">
<a name="Protocol-Extensions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Copying-Information">Copying Information</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Criticism-of-Kerberos">Criticism of Kerberos</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix B Protocol Extensions</h2>

<p>This appendix specifies the non-standard protocol elements implemented
by Shishi.  By nature of being non-standard, everything described here
is experimental.  Comments and feedback is appreciated.

<ul class="menu">
<li><a accesskey="1" href="#STARTTLS-protected-KDC-exchanges">STARTTLS protected KDC exchanges</a>: 	How Shishi talks to KDC protected by TLS. 
<li><a accesskey="2" href="#Telnet-encryption-with-AES_002dCCM">Telnet encryption with AES-CCM</a>:       Integrity and privacy protected telnet. 
<li><a accesskey="3" href="#Kerberized-rsh-and-rlogin">Kerberized rsh and rlogin</a>:            Description of KCMD protocol. 
<li><a accesskey="4" href="#Key-as-initialization-vector">Key as initialization vector</a>:         Some cryptography discussion. 
<li><a accesskey="5" href="#The-Keytab-Binary-File-Format">The Keytab Binary File Format</a>:        Format of keytab files. 
<li><a accesskey="6" href="#The-Credential-Cache-Binary-File-Format">The Credential Cache Binary File Format</a>:  Format of ccache files. 
</ul>

<div class="node">
<a name="STARTTLS-protected-KDC-exchanges"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Telnet-encryption-with-AES_002dCCM">Telnet encryption with AES-CCM</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.1 STARTTLS protected KDC exchanges</h3>

<p>Shishi is able to &ldquo;upgrade&rdquo; TCP communications with the KDC to use
the Transport Layer Security (TLS) protocol.  The TLS protocol offers
integrity and privacy protected exchanges.  TLS also offers
authentication using username and passwords, X.509 certificates, or
OpenPGP certificates.  Kerberos 5 claims to offer some of these
features, although it is not as rich as the TLS protocol.  An
inconclusive list of the motivation for using TLS is given below.

     <ul>
<li>Server authentication of the KDC to the client. 
In traditional Kerberos 5, KDC authentication is only proved as a side
effect that the KDC knows your encryption key (i.e., your password).

     <li>Client authentication against KDC. 
Kerberos 5 assume the user knows a key (usually in the form of a
password).  Sometimes external factors make this hard to fulfill.  In
some situations, users are equipped with smart cards with a RSA
authentication key.  In others, users have a OpenPGP client on their
desktop, with a public OpenPGP key known to the server.  In some
situations, the policy may be that password authentication may only be
done through SRP.

     <li>Kerberos exchanges are privacy protected. 
Part of many Kerberos packets are transfered without privacy
protection (i.e., encryption).  That part contains information, such
as the client principal name, the server principal name, the
encryption types supported by the client, the lifetime of tickets,
etc.  Revealing such information is, in some threat models, considered
a problem.  Thus, this enables &ldquo;anonymity&rdquo;.

     <li>Prevents downgrade attacks affecting encryption types. 
The encryption type of the ticket in KDC-REQ are sent in the clear in
Kerberos 5.  This allows an attacker to replace the encryption type
with a compromised mechanisms, e.g. 56-bit DES.  Since clients in
general cannot know the encryption types other servers support, it is
difficult for the client to detect if there was a man-in-the-middle or
if the remote server simply did not support a stronger mechanism. 
Clients may chose to refuse 56-bit DES altogether, but in some
environments this leads to operational difficulties.

     <li>TLS is well-proved and the protocol is studied by many parties. 
This is an advantage in network design, where TLS is often already
assumed as part of the solution since it is used to protect HTTP,
IMAP, SMTP etc.  In some threat models, the designer prefer to reduce
the number of protocols that can hurt the overall system security if
they are compromised.

   </ul>

   <p>Other reasons for using TLS exists.

<h4 class="subsection">B.1.1 TCP/IP transport with TLS upgrade (STARTTLS)</h4>

<p>RFC 1510bis requires Kerberos servers (KDCs) to accept TCP requests. 
Each request and response is prefixed by a 4 octet integer in network
byte order, indicating the length of the packet.  The high bit of the
length was reserved for future expansion, and servers that do not
understand how to interpret a set high bit must return a
<code>KRB-ERROR</code> with a <code>KRB_ERR_FIELD_TOOLONG</code> and close the TCP
stream.

   <p>The TCP/IP transport with TLS upgrade (STARTTLS) uses this reserved
bit as follows.  First we define a new extensible typed hole for
Kerberos 5 messages, because we used the only reserved bit.  It is
thus prudent to offer future extensions on our proposal.  Secondly we
reserve two values in this new typed hole, and described how they are
used to implement STARTTLS.

<h4 class="subsection">B.1.2 Extensible typed hole based on reserved high bit</h4>

<p>When the high bit is set, the remaining 31 bits of the 4 octets are
treated as an extensible typed hole, and thus form a 31 bit integer
enumerating various extensions.  Each of the values indicate a
specific extended operation mode, two of which are used and defined
here, and the rest are left for others to use.  If the KDC do not
understand a requested extension, it MUST return a <code>KRB-ERROR</code>
with a <code>KRB_ERR_FIELD_TOOLONG</code> value (prefixed by the 4 octet
length integer, with the high bit clear, as usual) and close the TCP
stream.

   <p>Meaning of the 31 lower bits in the 4 octet field, when the high bit
is set:

<pre class="verbatim"> 0               RESERVED.
 1               STARTTLS requested by client.
 2               STARTTLS request accepted by server.
 3...2147483647  AVAILABLE for registration (via bug-shishi@josefsson.org).
 2147483648      RESERVED.
</pre>

<h4 class="subsection">B.1.3 STARTTLS requested by client (extension mode 1)</h4>

<p>When this is sent by the client, the client is requesting the server
to start TLS negotiation on the TCP stream.  The client MUST NOT start
TLS negotiation immediately.  Instead, the client wait for either a
KRB-ERROR (sent normally, prefixed by a 4 octet length integer)
indicating the server do not understand the set high bit, or 4 octet
which is to interpreted as an integer in network byte order, where the
high bit is set and the remaining 31 bit are interpreted as an integer
specifying the &ldquo;STARTTLS request accepted by server&rdquo;.  In the first
case, the client infer that the server do not understand (or wish to
support) STARTTLS, and can re-try using normal TCP, if unprotected
Kerberos 5 exchanges are acceptable to the client policy.  In the
latter case, it should invoke TLS negotiation on the stream.  If any
other data is received, the client MUST close the TCP stream.

<h4 class="subsection">B.1.4 STARTTLS request accepted by server (extension mode 2)</h4>

<p>This 4 octet message should be sent by the server when it has received
the previous 4 octet message.  The message is an acknowledgment of the
client's request to initiate STARTTLS on the channel.  The server MUST
then invoke a TLS negotiation.

<h4 class="subsection">B.1.5 Proceeding after successful TLS negotiation</h4>

<p>If the TLS negotiation ended successfully, possibly also considering
client or server policies, the exchange within the TLS protected
stream is performed like normal UDP Kerberos 5 exchanges, i.e., there
is no TCP 4 octet length field before each packet.  Instead each
Kerberos packet MUST be sent within one TLS record, so the application
can use the TLS record length as the Kerberos 5 packet length.

<h4 class="subsection">B.1.6 Proceeding after failed TLS negotiation</h4>

<p>If the TLS negotiation fails, possibly due to client or server policy
(e.g., inadequate support of encryption types in TLS, or lack of
client or server authentication) the entity that detect the failure
MUST disconnected the connection.  It is expected that any error
messages that explain the error condition is transfered by TLS.

<h4 class="subsection">B.1.7 Interaction with KDC addresses in DNS</h4>

<p>Administrators for a KDC may announce the KDC address by placing SRV
records in DNS for the realm, as described in
<samp><span class="file">draft-ietf-krb-wg-krb-dns-locate-03.txt</span></samp>.  That document mention
TLS, but do not reference any work that describe how KDCs uses TLS. 
Until further clarified, consider the TLS field in that document to
refer to implementation supporting this STARTTLS protocol.

<h4 class="subsection">B.1.8 Using TLS authentication logic in Kerberos</h4>

<p>The server MAY consider the authentication performed by the TLS
exchange as sufficient to issue Kerberos 5 tickets to the client,
without requiring, e.g., pre-authentication.  However, it is not an
error to require or use pre-authentication as well.

   <p>The client may also indicate that it wishes to use TLS both for
authentication and data protection by using the &lsquo;<samp><span class="samp">NULL</span></samp>&rsquo; encryption
type in its request.  The server can decide from its local policy
whether or not issuing tickets based solely on TLS authentication, and
whether &lsquo;<samp><span class="samp">NULL</span></samp>&rsquo; encryption within TLS, is acceptable or not.  This
mode is currently under investigation.

<h4 class="subsection">B.1.9 Security considerations</h4>

<p>Because the initial token is not protected, it is possible for an
active attacker to make it appear to the client that the server do not
support this extension.  It is up to client configuration to disallow
non-TLS connections, if this vulnerability is deemed unacceptable. 
For interoperability, we suggest the default behaviour should be to
allow automatic fallback to TCP or UDP.

   <p>The security considerations of both TLS and Kerberos 5 are inherited. 
Using TLS for authentication and/or data protection together with
Kerberos alter the authentication logic fundamentally.  Thus, it may
be that even if the TLS and Kerberos 5 protocols and implementations
were secure, the combination of TLS and Kerberos 5 described here
could be insecure.

   <p>No channel bindings are provided in the Kerberos messages.  It is an
open question whether, and how, this should be fixed.

<div class="node">
<a name="Telnet-encryption-with-AES-CCM"></a>
<a name="Telnet-encryption-with-AES_002dCCM"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Kerberized-rsh-and-rlogin">Kerberized rsh and rlogin</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#STARTTLS-protected-KDC-exchanges">STARTTLS protected KDC exchanges</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.2 Telnet encryption with AES-CCM</h3>

<p>This appendix describe how Shishi use the Advanced Encryption Standard
(AES) encryption algorithm in Counter with CBC-MAC mode (RFC 3610)
with the telnet encryption option (RFC 2946).

<h4 class="subsection">B.2.1 Command Names and Codes</h4>

<pre class="verbatim">Encryption Type

      AES_CCM             12

Suboption Commands

      AES_CCM_INFO         1
      AES_CCM_INFO_OK      2
      AES_CCM_INFO_BAD     3
</pre>

<h4 class="subsection">B.2.2 Command Meanings</h4>

<pre class="verbatim">   IAC SB ENCRYPT IS AES_CCM AES_CCM_INFO &lt;M> &lt;L> &lt;nonce> IAC SE
</pre>

<p>The sender of this command select desired M and L parameters, and
nonce, as described in RFC 3610, and sends it to the other side of the
connection.  The parameters and the nonce are sent in clear text. 
Only the side of the connection that is WILL ENCRYPT may send the
AES_CCM_INFO command.

<pre class="verbatim">   IAC SB ENCRYPT REPLY AES_CCM AES_CCM_INFO_BAD IAC SE
</pre>

   <p>The sender of this command reject the parameters received in the
AES_CCM_INFO command.  Only the side of the connection that is DO
ENCRYPT may send the AES_CCM_INFO_BAD command.  The command MUST be
sent if the nonce field length does not match the selected value for
L.  The command MAY be sent if the receiver do not accept the
parameters for reason such as policy.  No capability is provided to
negotiate these parameters.

<pre class="verbatim">   IAC SB ENCRYPT REPLY AES_CCM AES_CCM_INFO_OK IAC SE
</pre>

   <p>The sender of this command accepts the parameters received in the
AES_CCM_INFO command.  Only the side of the connection that is DO
ENCRYPT may send the AES_CCM_INFO_BAD command.  The command MUST NOT
be sent if the nonce field length does not match the selected value
for L.

<h4 class="subsection">B.2.3 Implementation Rules</h4>

<p>Once a AES_CCM_INFO_OK command has been received, the WILL ENCRYPT
side of the connection should do keyid negotiation using the ENC_KEYID
command.  Once the keyid negotiation has successfully identified a
common keyid, then START and END commands may be sent by the side of
the connection that is WILL ENCRYPT.  Data will be encrypted using the
AES-CCM algorithm, with the negotiated nonce and parameters M and L. 
After each successful encryption and decryption, the nonce is treated
as an integer in network byte order, and incremented by one.

   <p>If encryption (decryption) is turned off and back on again, and the
same keyid is used when re-starting the encryption (decryption), the
intervening clear text must not change the state of the encryption
(decryption) machine.  In particular, the AES-CCM nonce must not be
re-set.

   <p>If a START command is sent (received) with a different keyid, the
encryption (decryption) machine must be re-initialized immediately
following the end of the START command with the new key and the
parameters sent (received) in the last AES_CCM_INFO command.

   <p>If a new AES_CCM_INFO command is sent (received), and encryption
(decryption) is enabled, the encryption (decryption) machine must be
re-initialized immediately following the end of the AES_CCM_INFO
command with the new nonce and parameters, and the keyid sent
(received) in the last START command.

   <p>If encryption (decryption) is not enabled when a AES_CCM_INFO command
is sent (received), the encryption (decryption) machine must be re-
initialized after the next START command, with the keyid sent
(received) in that START command, and the nonce and parameters sent
(received) in this AES_CCM_INFO command.

   <p>At all times MUST each end make sure that a AES-CCM nonce is not used
twice under the same encryption key.  The rules above help accomplish
this in an interoperable way.

<h4 class="subsection">B.2.4 Integration with the AUTHENTICATION telnet option</h4>

<p>&lt;&lt;This section is slightly complicated.  Can't we simplify this?&gt;&gt;

   <p>As noted in the telnet ENCRYPTION option specifications, a keyid value
of zero indicates the default encryption key, as might be derived from
the telnet AUTHENTICATION option.  If the default encryption key
negotiated as a result of the telnet AUTHENTICATION option contains
less than 32 bytes (corresponding to two 128 bit keys), then the
AES_CCM option MUST NOT be offered or used as a valid telnet
encryption option.  Furthermore, depending on policy for key lengths,
the AES_CCM option MAY be disabled if the default encryption key
contain less than 48 bytes (for two 192 bit keys), or less than 64
bytes (for two 256 bit keys), as well.

   <p>The available encrypt key data is divided on two halves, where the
first half is used to encrypt data sent from the server (decrypt data
received by the client), and the second half is used to encrypt data
sent from the client (decrypt data received by the server).

   <p>Note that the above algorithm assumes that the AUTHENTICATION
mechanism generate keying material suitable for AES-CCM as used in
this specification.  This is not necessarily true in general, but we
specify this behaviour as the default since it is true for most
authentication systems in popular use today.  New telnet
AUTHENTICATION mechanisms may specify alternative methods for
determining the keys to be used for this cipher suite in their
specification, if the session key negotiated by that authentication
mechanism is not a DES key and and where this algorithm may not be
safely used.

   <p>Kerberos 5 authentication clarification: The key used to encrypt data
from the client to the server is taken from the sub-session key in the
AP-REQ.  The key used to decrypt data from the server to the client is
taken from the sub-session key in the AP-REP.  If mutual
authentication is not negotiated, the key used to encrypt data from
the client to the server is taken from the session key in the ticket,
and the key used to decrypt data from the server to the client is
taken from the sub-session key in the AP-REQ.  Leaving the AP-REQ
sub-key field empty MUST disable the AES_CCM option.

<h4 class="subsection">B.2.5 Security Considerations</h4>

<p>The protocol must be properly and securely implemented.  For example,
an implementation should not be vulnerable to various
implementation-specific attacks such as buffer overflows or
side-channel analysis.

   <p>We wish to repeat the suggestion from RFC 2946, to investigate in a
STARTTLS approach for Telnet encryption (and also authentication),
when the security level provided by this specification is not
adequate.

<h5 class="subsubsection">B.2.5.1 Telnet Encryption Protocol Security Considerations</h5>

<p>The security consideration of the Telnet encryption protocol are
inherited.

   <p>It should be noted that the it is up to the authentication protocol
used, if any, to bind the authenticity of the peers to a specific
session.

   <p>The Telnet encryption protocol does not, in general, protect against
possibly malicious downgrading to any mutually acceptable, but not
preferred, encryption type.  This places a requirement on each peer to
only accept encryption types it trust fully.  In other words, the
Telnet encryption protocol do not guarantee that the strongest
mutually acceptable encryption type is always selected.

<h5 class="subsubsection">B.2.5.2 AES-CCM Security Considerations</h5>

<p>The integrity and privacy claims are inherited from AES-CCM.  In
particular, the implementation must make sure a nonce is not used more
than once together with the same key.

   <p>Furthermore, the encryption key is assumed to be random, i.e., it
should not be possible to guess it with probability of success higher
than guessing any uniformly selected random key.  RFC 1750 gives an
overview of issues and recommendations related to randomness.

<h4 class="subsection">B.2.6 Acknowledgments</h4>

<p>This document is based on the various Telnet Encryption RFCs (RFC
2946, RFC 2947, RFC 2948, RFC 2952 and RFC 2953).

<div class="node">
<a name="Kerberized-rsh-and-rlogin"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Key-as-initialization-vector">Key as initialization vector</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Telnet-encryption-with-AES_002dCCM">Telnet encryption with AES-CCM</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.3 Kerberized rsh and rlogin</h3>

<p>This appendix describe the KCMDV0.2 protocol used in shishi patched
version of inetutils. The KCMD protocol was developped by the MIT
Kerberos team for kerberized rsh an rlogin programs. Differences
between rlogin an rsh will be explained, like those between v0.1 and
v0.2 of the protocol for compatibility reasons. 
It is possible that some parts of this document are not in conformity
with original KCMD protocol because there is no official specification
about it. However, it seems that shishi implementation is compatible
with MIT's one.

   <p><strong>Warning:</strong> If you are seriously considering using Kerberos rsh
or rlogin, instead of more robust remote access protocols such as
<acronym>SSH</acronym>, you may first want to explore
<a href="http://www.cs.berkeley.edu/~hildrum/kerberos/">http://www.cs.berkeley.edu/~hildrum/kerberos/</a> and the full paper
at <a href="http://www.cs.berkeley.edu/~hildrum/043.pdf">http://www.cs.berkeley.edu/~hildrum/043.pdf</a>.

<h4 class="subsection">B.3.1 Establish connection</h4>

<p>First the client should establish a TCP connection with the
server. Default ports are 543 (klogin), 544 (kshell), 2105 (eklogin). 
eklogin is the same as klogin but with encryption. Their is no longer
ekshell port because encrypted and normal connection use the same port
(kshell). 
Kshell need a second connection for stderr. The client should send a
null terminated string that represent the port of this second
connection. 
Klogin and eklogin does not use a second connection for stderr so the
client must send a null byte to the server. 
Contrary to classic rsh/rlogin, server must not check if the client
port is in the range 0-1023.

<h4 class="subsection">B.3.2 Kerberos identification</h4>

<p>When connections are established, first thing to do is to indicate
kerberos authentication must be used. 
So the client will send a string to indicate it will used kerberos
5. It will call a length-string "strl" the couple (lenght of the string
strl, null terminated string strl). Length of the string is an int32
(32bits int) in MSB order (for the network). 
So the client send this length-string strl :

<pre class="verbatim">   KRB5_SENDAUTH_V1.0
</pre>

   <p>After that the client must indicate which version of the protocol it
will used by sending this length-string strl :

<pre class="verbatim">   KCMDV0.2
</pre>

   <p>It can be V0.1 for older versions. 
If indentification from client is good, server will send a null
byte (0x00). Else if authentication message is wrong, server send byte
0x01, else if protocol version message is wrong server send byte 0x02.

<h4 class="subsection">B.3.3 Kerberos authentication</h4>

<p>When client is indentified, kerberos authentication can begin. The
client must send an AP-REQ to the server. AP-REQ authenticator must
have a subkey (only for KCMDV0.2) and a checksum. 
Authenticator checksum is created on following string :

<pre class="example">     "serverport:""terminaltype""remoteusername"
</pre>
   <p>for example :

<pre class="example">     543:linux/38400user
</pre>
   <p>remoteusername corresponds to the identity of the client on remote machine.

   <p>AP-REQ is sended in der encoded format. The length (int32) of der
encoded AP-REQ is sended in network format (MSB), following by the der
encoded AP-REQ. 
If all is correct, server send a null int32 (MSB format but like it is
null it is not important). 
KCMD protocol use mutual authentication, so server must now send and
AP-REP : (in32 lenght in MSB of der encoded AP-REP)(der encoded
AP-REP).

   <p>Now server and client are partially authenticated.

<h4 class="subsection">B.3.4 Extended authentication</h4>

<p>Client must now send 3 different null terminated strings (without
lenght) :

     <ul>
<li>remote user name (user identity on remote machine)
<li>terminal type for rlogin or command for rsh
<li>local user name (user identity on client machine)
</ul>

   <p>example for rsh :

<pre class="example">     "rname\0"
     "cat /usr/local/etc/shishi.conf"
     "lname\0"
</pre>
   <p>Server must verify that checksum in AP-REQ authenticator is correct by
computing a new hash like client has done.

   <p>Server must verify that principal (in AP-REQ) has right to log in on
the remote user account. 
For the moment shishi only check if remote user name is equal to
principal. A more complex authorization code is planned. 
Look at the end to know how MIT/Heimdal do to check authorization.

   <p>If all is correct server send a null byte, else an error message
string (null terminated string) is sent. User read the first byte. If
it is equal to zero, authentication is correct and is logged on the
remote host. Else user can read the error messsage send by the server.

<h4 class="subsection">B.3.5 Window size</h4>

<p>For rlogin protocol, when authentication is complete, the server can
optionnaly send a message to ask for window terminal size of
user. Then the user can respond but it is not an obligation.

   <p>In KCMDV0.1 server send an urgent TCP message (MSG_OOB) with one byte
:

<pre class="example">     TIOCPKT_WINDOW = 0x80
</pre>
   <p>In KCMDV0.2 server does not send an urgent message but write on the
socket 5 bytes :

<pre class="example">     '\377', '\377', 'o', 'o', TIOCPKT_WINDOW
</pre>
   <p>If encryption is enabled (eklogin) server must send this 5 bytes
encrypted.

   <p>Client can answer in both protocol version with :

<pre class="example">     '\377', '\377', 's', 's', "struct winsize"
</pre>
   <p>The winsize structure is filled with corresponding setting to client's
terminal. 
If encryption is enabled this answer must be send encrypted.

<h4 class="subsection">B.3.6 End of authentication</h4>

<p>The "classic" rsh/rlogin can be used now.

<h4 class="subsection">B.3.7 Encryption</h4>

<p>Encryption mode is used when a connection with eklogin is established. 
Encryption with krsh can be used too. Before, there was a specific port
for that (ekshell), but now to indicate that encryption must be used with
krsh, client must add "-x " before the command when it send it between
remote user name and local user name. 
When the client compute the checksum for AP-REQ authenticator the "-
x" must not be included.

   <p>Encryption in KCMDV0.2 is not the same as in KCMDV0.1. 
KCMDV0.1 uses ticket session key as encryption key, and use standard
Kerberos encryption functions. This protocol only supports des-cbc-crc,
des-cbc-md4, des-cbc-md5 and does not use initialisation vectors.

   <p>For example on each encryption/decryption calls, the following
prototype kerberos function should be used :

<pre class="example">     kerberos_encrypt (key, keyusage, in, out)  (or decrypt)
</pre>
   <p>KCMDV0.2 can be used with all kerberos encryption modes (des, 3des,
aes, arcfour) and use AP-REQ authenticator subkey. In opposite to
KCMDV0.1 initialisation vectors are used. All encryptions/descryptions
must be made using a cryptographic context (for example to use the
updated iv, or sbox) :

<pre class="example">     kerberos_init(ctx, iv, key, keyusage)
     kerberos_encrypt (ctx, in, out)
</pre>
   <p>For both protocols, keyusage id for des-cbc-md5, des-cbc-md4,
des-cbc-crc and des3-cbc-sha1 (for KCMDV0.2) :

<pre class="example">     keyusage = 1026
</pre>
   <p>For other KCMDV0.2 modes keyusage is different for each
encryption/decryption usage. 
To understand, eklogin use 1 socket. It encrypts data (output 1) to
send and decrypts (input 1) received data. 
Kshell use 2 sockets (1 for transmit data, 1 for stderr). So there are
four modes :

<pre class="verbatim">   transmit  : input  1 
	       output 1

   stderr    : input  2
	       output 2
</pre>

   <p>There is a keyusage for each modes. The keyusage must correspond on
client and server side. For example in klogin client input 1 keyusage
will be server output 1 keyusage.

   <p><table summary=""><tr align="left"><td valign="top" width="15%">I/O </td><td valign="top" width="15%">Client </td><td valign="top" width="15%">Server
<br></td></tr><tr align="left"><td valign="top" width="15%">intput 1 </td><td valign="top" width="15%">1028 </td><td valign="top" width="15%">1030
<br></td></tr><tr align="left"><td valign="top" width="15%">output 1 </td><td valign="top" width="15%">1030 </td><td valign="top" width="15%">1028
<br></td></tr><tr align="left"><td valign="top" width="15%">intput 2 </td><td valign="top" width="15%">1032 </td><td valign="top" width="15%">1034
<br></td></tr><tr align="left"><td valign="top" width="15%">output 2 </td><td valign="top" width="15%">1034 </td><td valign="top" width="15%">1032
   <br></td></tr></table>

   <p>Those keyusages must be used with AES and ARCFOUR modes.

   <p>KCMDV0.2 uses IV (initialisation vector). Like for keyusage, client IV
must correspond to server IV. IV size is equal to key type,
blocksize. All bytes of IV must be initialised to :

   <p><table summary=""><tr align="left"><td valign="top" width="15%">I/O </td><td valign="top" width="15%">Client </td><td valign="top" width="15%">Server
<br></td></tr><tr align="left"><td valign="top" width="15%">intput 1 </td><td valign="top" width="15%">0 </td><td valign="top" width="15%">1
<br></td></tr><tr align="left"><td valign="top" width="15%">output 1 </td><td valign="top" width="15%">1 </td><td valign="top" width="15%">0
<br></td></tr><tr align="left"><td valign="top" width="15%">intput 2 </td><td valign="top" width="15%">2 </td><td valign="top" width="15%">3
<br></td></tr><tr align="left"><td valign="top" width="15%">output 2 </td><td valign="top" width="15%">3 </td><td valign="top" width="15%">2
   <br></td></tr></table>

   <p>ARCFOUR mode does not use IV. However, like it is said before, a context
must be used to keep the updated sbox.

   <p>Normal message with klogin and kshell are sent like that :

<pre class="example">     (int 32 lenght of message in MSB order)
     (message)
</pre>
   <p>In encrypted mode it is a bit different :

<pre class="example">     (int 32 length of unencrypted message in MSB order)
     (encrypted message)
</pre>
   <p>In KCMDV0.2 encrypted message is create like that :

<pre class="example">     encrypt (
     (int 32 length of message in MSB order)
     (message)
     )
</pre>
   <p>A check on message size can be made in second version of the protocol.

<h4 class="subsection">B.3.8 KCMDV0.3</h4>

<p>This part only gives possible ways to extend KCMD protocol. Does not
take that as must have in KCMD implementation.

   <p>Extensions of KCMV0.2 could be made. For example kshell supposes there
are no files with name "-x *". I think the same thing can be supposed
with terminal name for klogin. So client could add "-x " to terminal
type it sends to server to indicate it will use encryption. Like that
there will be only one port for klogin/eklogin : 543.

   <p>In encrypted mode kshell send command in clear on the network, this
could be considered as insecure as user have decided to use
encryption. 
This is not really a problem for klogin because it just sends terminal
type.

   <p>In encrypted mode, klogin and kshell clients could only send "-x" as
command or terminal type. 
After that encryption is activated, and the client could send terminal
type or command encrypted. 
The server will send the null byte to say that all is correct, or
error message in encrypted form.

<h4 class="subsection">B.3.9 MIT/Heimdal authorization</h4>

<p>This part describes how MIT/Heimdal version check authorization of the
user to log in on the remote machine.

   <p>Authorization check is made by looking if the file .k5login exists on
the account of the remote user. 
If this file does not exist, remote user name must be the same as
principal in AP-REQ to valid authorization. 
Else if this file exists, check first verify that remote user or root
are the owner of .k5login. 
If it is not the case, the check fails. 
If it is good, check reads each line of that file and compare each
readed name to principal. 
If principal is found in .k5login, authorization is valid, else user
is not allowed to connect on remote host with the specified remote
user name (that can be the same as principal).

   <p>So someone (for example user "user1") can remote log into "user2"
account if .k5login is present in user2 home dir and this file is owned
by user2 or root and user1 name is present in this file.

<div class="node">
<a name="Key-as-initialization-vector"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-Keytab-Binary-File-Format">The Keytab Binary File Format</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Kerberized-rsh-and-rlogin">Kerberized rsh and rlogin</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.4 Key as initialization vector</h3>

<p>The <code>des-cbc-crc</code> algorithm (see <a href="#Cryptographic-Overview">Cryptographic Overview</a>) uses
the <acronym>DES</acronym> key as the initialization vector.  This is
problematic in general (see below<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a>), but
may be mitigated in Kerberos by the CRC checksum that is also
included.

<pre class="verbatim">From daw@espresso.CS.Berkeley.EDU Fri Mar  1 13:32:34 PST 1996
Article: 50440 of sci.crypt
Path: agate!daw
From: daw@espresso.CS.Berkeley.EDU (David A Wagner)
Newsgroups: sci.crypt
Subject: Re: DES-CBC and Initialization Vectors
Date: 29 Feb 1996 21:48:16 GMT
Organization: University of California, Berkeley
Lines: 31
Message-ID: &lt;4h56v0$3no@agate.berkeley.edu>
References: &lt;4h39li$33o@gaia.ns.utk.edu>
NNTP-Posting-Host: espresso.cs.berkeley.edu

In article &lt;4h39li$33o@gaia.ns.utk.edu>,
Nair Venugopal &lt;venu@mars.utcc.utk.edu> wrote:
> Is there anything wrong in using the key as the I.V. in DES-CBC mode?

Yes, you're open to a chosen-ciphertext attack which recovers the key.

Alice is sending stuff DES-CBC encrypted with key K to Bob.  Mary is an
active adversary in the middle.  Suppose Alice encrypts some plaintext
blocks P_1, P_2, P_3, ... in DES-CBC mode with K as the IV, and sends off
the resulting ciphertext
	A->B: C_1, C_2, C_3, ...
where each C_j is a 8-byte DES ciphertext block.  Mary wants to discover
the key K, but doesn't even know any of the P_j's.  She replaces the above
message by
	M->B: C_1, 0, C_1
where 0 is the 8-byte all-zeros block.  Bob will decrypt under DES-CBC,
recovering the blocks
	Q_1, Q_2, Q_3
where
	Q_1 = DES-decrypt(K, C_1) xor K = P_1
	Q_2 = DES-decrypt(K, C_2) xor C_1 = (some unimportant junk)
	Q_3 = DES-decrypt(K, C_1) xor 0 = P_1 xor K
Bob gets this garbage-looking message Q_1,Q_2,Q_3 which Mary recovers
(under the chosen-ciphertext assumption: this is like a known-plaintext
attack, which isn't too implausible).  Notice that Mary can recover K by
	K = Q_1 xor Q_3;
so after this one simple active attack, Mary gets the key back!

So, if you must use a fixed IV, don't use the key-- use 0 or something
like that.  Even better, don't use a fixed IV-- use the DES encryption
of a counter, or something like that.
</pre>

<div class="node">
<a name="The-Keytab-Binary-File-Format"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-Credential-Cache-Binary-File-Format">The Credential Cache Binary File Format</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Key-as-initialization-vector">Key as initialization vector</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.5 The Keytab Binary File Format</h3>

<p>The keytab file format is described in the file <samp><span class="file">keytab.txt</span></samp>,
included in verbatim below.

<pre class="verbatim">The Kerberos Keytab Binary File Format
Copyright (C) 2006 Michael B Allen &lt;mba2000 ioplex.com>
http://www.ioplex.com/utilities/keytab.txt
Last updated: Fri May  5 13:39:40 EDT 2006

The MIT keytab binary format is not a standard format, nor is it
documented anywhere in detail. The format has evolved and may continue
to. It is however understood by several Kerberos implementations including
Heimdal and of course MIT and keytab files are created by the ktpass.exe
utility from Windows. So it has established itself as the defacto format
for storing Kerberos keys.

The following C-like structure definitions illustrate the MIT keytab
file format. All values are in network byte order. All text is ASCII.

  keytab {
      uint16_t file_format_version;                    /* 0x502 */
      keytab_entry entries[*];
  };

  keytab_entry {
      int32_t size;
      uint16_t num_components;    /* sub 1 if version 0x501 */
      counted_octet_string realm;
      counted_octet_string components[num_components];
      uint32_t name_type;   /* not present if version 0x501 */
      uint32_t timestamp;
      uint8_t vno8;
      keyblock key;
      uint32_t vno; /* only present if >= 4 bytes left in entry */
  };

  counted_octet_string {
      uint16_t length;
      uint8_t data[length];
  };

  keyblock {
      uint16_t type;
      counted_octet_string;
  };

The keytab file format begins with the 16 bit file_format_version which
at the time this document was authored is 0x502. The format of older
keytabs is described at the end of this document.

The file_format_version is immediately followed by an array of
keytab_entry structures which are prefixed with a 32 bit size indicating
the number of bytes that follow in the entry. Note that the size should be
evaluated as signed. This is because a negative value indicates that the
entry is in fact empty (e.g. it has been deleted) and that the negative
value of that negative value (which is of course a positive value) is
the offset to the next keytab_entry. Based on these size values alone
the entire keytab file can be traversed.

The size is followed by a 16 bit num_components field indicating the
number of counted_octet_string components in the components array.

The num_components field is followed by a counted_octet_string
representing the realm of the principal.

A counted_octet_string is simply an array of bytes prefixed with a 16
bit length. For the realm and name components, the counted_octet_string
bytes are ASCII encoded text with no zero terminator.

Following the realm is the components array that represents the name of
the principal. The text of these components may be joined with slashs
to construct the typical SPN representation. For example, the service
principal HTTP/www.foo.net@FOO.NET would consist of name components
"HTTP" followed by "www.foo.net".

Following the components array is the 32 bit name_type (e.g. 1 is
KRB5_NT_PRINCIPAL, 2 is KRB5_NT_SRV_INST, 5 is KRB5_NT_UID, etc). In
practice the name_type is almost certainly 1 meaning KRB5_NT_PRINCIPAL.

The 32 bit timestamp indicates the time the key was established for that
principal. The value represents the number of seconds since Jan 1, 1970.

The 8 bit vno8 field is the version number of the key. This value is
overridden by the 32 bit vno field if it is present.

The keyblock structure consists of a 16 bit value indicating the keytype
(e.g. 3 is des-cbc-md5, 23 is arcfour-hmac-md5, 16 is des3-cbc-sha1,
etc). This is followed by a counted_octet_string containing the key.

The last field of the keytab_entry structure is optional. If the size of
the keytab_entry indicates that there are at least 4 bytes remaining,
a 32 bit value representing the key version number is present. This
value supersedes the 8 bit vno8 value preceeding the keyblock.

Older keytabs with a file_format_version of 0x501 are different in
three ways:

  1) All integers are in host byte order [1].
  2) The num_components field is 1 too large (i.e. after decoding,
     decrement by 1).
  3) The 32 bit name_type field is not present.

[1] The file_format_version field should really be treated as two
    separate 8 bit quantities representing the major and minor version
    number respectively.

Permission to copy, modify, and distribute this document, with or
without modification, for any purpose and without fee or royalty is
hereby granted, provided that you include this copyright notice in ALL
copies of the document or portions thereof, including modifications.
</pre>
<div class="node">
<a name="The-Credential-Cache-Binary-File-Format"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Keytab-Binary-File-Format">The Keytab Binary File Format</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Protocol-Extensions">Protocol Extensions</a>

</div>

<h3 class="section">B.6 The Credential Cache Binary File Format</h3>

<p>The credential cache file format is described in the file
<samp><span class="file">keytab.txt</span></samp>, included in verbatim below.

<pre class="verbatim">The Kerberos Credential Cache Binary File Format
Copyright (C) 2006 Simon Josefsson &lt;simon josefsson.org>
http://josefsson.org/shishi/ccache.txt
Last updated: Sat Sep 23 12:04:11 CEST 2006

Like the MIT keytab binary format (see Michael B Allen's reverse
engineered description in keytab.txt), the credential cache format is
not standard nor documented anywhere.

In C style notation, the MIT credential cache file format is as
follows.  All values are in network byte order.  All text is ASCII.

ccache {
          uint16_t file_format_version; /* 0x0504 */
          uint16_t headerlen;           /* only if version is 0x0504 */
          header headers[];             /* only if version is 0x0504 */
          principal primary_principal;
          credential credentials[*];
};

header {
       uint16_t tag;                    /* 1 = DeltaTime */
       uint16_t taglen;
       uint8_t tagdata[taglen]
};

The ccache.taglen and ccache.tags fields are only present in 0x0504
versions, not in earlier.  Both MIT and Heimdal appear to correctly
ignore unknown tags, so it appears safe to add them (although there is
no central place to "register" tags).

Currently only one tag is widely implemented, DeltaTime (0x0001).  Its
taglen is always 8, and tagdata will contain:

DeltaTime {
       uint32_t time_offset;
       uint32_t usec_offset;
};

After reading the file_format_version, header tags, and default
principal, a list of credentials follow.  You deduce from the file
length when there are no more credentials.

credential {
           principal client;
           principal server;
           keyblock key;
           times    time;
           uint8_t  is_skey;            /* 1 if skey, 0 otherwise */
           uint32_t tktflags;           /* stored in reversed byte order */
           uint32_t num_address;
           address  addrs[num_address];
           uint32_t num_authdata;
           authdata authdata[num_authdata];
           countet_octet_string ticket;
           countet_octet_string second_ticket;
};

keyblock {
         uint16_t keytype;
         uint16_t etype;                /* only present if version 0x0503 */
         uint16_t keylen;
         uint8_t keyvalue[keylen];
};

times {
      uint32_t  authtime;
      uint32_t  starttime;
      uint32_t  endtime;
      uint32_t  renew_till;
};

address {
        uint16_t addrtype;
        counted_octet_string addrdata;
};

authdata {
         uint16_t authtype;
         counted_octet_string authdata;
};

principal {
          uint32_t name_type;           /* not present if version 0x0501 */
          uint32_t num_components;      /* sub 1 if version 0x501 */
          counted_octet_string realm;
          counted_octet_string components[num_components];
};

counted_octet_string {
    uint32_t length;
    uint8_t data[length];
};

Permission to copy, modify, and distribute this document, with or
without modification, for any purpose and without fee or royalty is
hereby granted, provided that you include this copyright notice in ALL
copies of the document or portions thereof, including modifications.
</pre>
<div class="node">
<a name="Copying-Information"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-and-Data-Index">Function and Data Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Protocol-Extensions">Protocol Extensions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix C Copying Information</h2>

<ul class="menu">
<li><a accesskey="1" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>:    License for copying this manual. 
<li><a accesskey="2" href="#GNU-GPL">GNU GPL</a>:                           License for copying the programs. 
</ul>

<div class="node">
<a name="GNU-Free-Documentation-License"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#GNU-GPL">GNU GPL</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-Information">Copying Information</a>

</div>

<h3 class="appendixsec">C.1 GNU Free Documentation License</h3>

<p><a name="index-FDL_002c-GNU-Free-Documentation-License-808"></a>

<!-- The GNU Free Documentation License. -->
<div align="center">Version 1.3, 3 November 2008</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
     <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <dfn>free</dfn> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially. 
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent. 
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.

     <p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.

     <p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material. 
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

          <li>Preserve any Warranty Disclaimers.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit. 
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form. 
Otherwise they must appear on printed covers that bracket the whole
aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.

     <p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy's public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.

     <li>RELICENSING

     <p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.

     <p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.

     <p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.

     <p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.

     <p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.

        </ol>

<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.3
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
   <p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with<small class="dots">...</small>Texts.&rdquo; line with this:

<pre class="smallexample">         with the Invariant Sections being <var>list their titles</var>, with
         the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
         being <var>list</var>.
</pre>
   <p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

   <p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<a name="GNU-GPL"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-Information">Copying Information</a>

</div>

<h3 class="appendixsec">C.2 GNU General Public License</h3>

<p><a name="index-GPL_002c-GNU-General-Public-License-809"></a><a name="index-License_002c-GNU-GPL-810"></a>

<!-- The GNU General Public License. -->
<div align="center">Version 3, 29 June 2007</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies of this
     license document, but changing it is not allowed.
</pre>
   <h3 class="heading">Preamble</h3>

<p>The GNU General Public License is a free, copyleft license for
software and other kinds of works.

   <p>The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom
to share and change all versions of a program&mdash;to make sure it remains
free software for all its users.  We, the Free Software Foundation,
use the GNU General Public License for most of our software; it
applies also to any other work released this way by its authors.  You
can apply it to your programs, too.

   <p>When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

   <p>To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you
have certain responsibilities if you distribute copies of the
software, or if you modify it: responsibilities to respect the freedom
of others.

   <p>For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too,
receive or can get the source code.  And you must show them these
terms so they know their rights.

   <p>Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

   <p>For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

   <p>Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the
manufacturer can do so.  This is fundamentally incompatible with the
aim of protecting users' freedom to change the software.  The
systematic pattern of such abuse occurs in the area of products for
individuals to use, which is precisely where it is most unacceptable. 
Therefore, we have designed this version of the GPL to prohibit the
practice for those products.  If such problems arise substantially in
other domains, we stand ready to extend this provision to those
domains in future versions of the GPL, as needed to protect the
freedom of users.

   <p>Finally, every program is threatened constantly by software patents. 
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish
to avoid the special danger that patents applied to a free program
could make it effectively proprietary.  To prevent this, the GPL
assures that patents cannot be used to render the program non-free.

   <p>The precise terms and conditions for copying, distribution and
modification follow.

<h3 class="heading">TERMS AND CONDITIONS</h3>

     <ol type=1 start=0>
<li>Definitions.

     <p>&ldquo;This License&rdquo; refers to version 3 of the GNU General Public License.

     <p>&ldquo;Copyright&rdquo; also means copyright-like laws that apply to other kinds
of works, such as semiconductor masks.

     <p>&ldquo;The Program&rdquo; refers to any copyrightable work licensed under this
License.  Each licensee is addressed as &ldquo;you&rdquo;.  &ldquo;Licensees&rdquo; and
&ldquo;recipients&rdquo; may be individuals or organizations.

     <p>To &ldquo;modify&rdquo; a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of
an exact copy.  The resulting work is called a &ldquo;modified version&rdquo; of
the earlier work or a work &ldquo;based on&rdquo; the earlier work.

     <p>A &ldquo;covered work&rdquo; means either the unmodified Program or a work based
on the Program.

     <p>To &ldquo;propagate&rdquo; a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

     <p>To &ldquo;convey&rdquo; a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user
through a computer network, with no transfer of a copy, is not
conveying.

     <p>An interactive user interface displays &ldquo;Appropriate Legal Notices&rdquo; to
the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

     <li>Source Code.

     <p>The &ldquo;source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  &ldquo;Object code&rdquo; means any non-source form
of a work.

     <p>A &ldquo;Standard Interface&rdquo; means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

     <p>The &ldquo;System Libraries&rdquo; of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
&ldquo;Major Component&rdquo;, in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

     <p>The &ldquo;Corresponding Source&rdquo; for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

     <p>The Corresponding Source need not include anything that users can
regenerate automatically from other parts of the Corresponding Source.

     <p>The Corresponding Source for a work in source code form is that same
work.

     <li>Basic Permissions.

     <p>All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

     <p>You may make, run and propagate covered works that you do not convey,
without conditions so long as your license otherwise remains in force. 
You may convey covered works to others for the sole purpose of having
them make modifications exclusively for you, or provide you with
facilities for running those works, provided that you comply with the
terms of this License in conveying all material for which you do not
control copyright.  Those thus making or running the covered works for
you must do so exclusively on your behalf, under your direction and
control, on terms that prohibit them from making any copies of your
copyrighted material outside their relationship with you.

     <p>Conveying under any other circumstances is permitted solely under the
conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

     <li>Protecting Users' Legal Rights From Anti-Circumvention Law.

     <p>No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

     <p>When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such
circumvention is effected by exercising rights under this License with
respect to the covered work, and you disclaim any intention to limit
operation or modification of the work as a means of enforcing, against
the work's users, your or third parties' legal rights to forbid
circumvention of technological measures.

     <li>Conveying Verbatim Copies.

     <p>You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

     <p>You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

     <li>Conveying Modified Source Versions.

     <p>You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these
conditions:

          <ol type=a start=1>
<li>The work must carry prominent notices stating that you modified it,
and giving a relevant date.

          <li>The work must carry prominent notices stating that it is released
under this License and any conditions added under section 7.  This
requirement modifies the requirement in section 4 to &ldquo;keep intact all
notices&rdquo;.

          <li>You must license the entire work, as a whole, under this License to
anyone who comes into possession of a copy.  This License will
therefore apply, along with any applicable section 7 additional terms,
to the whole of the work, and all its parts, regardless of how they
are packaged.  This License gives no permission to license the work in
any other way, but it does not invalidate such permission if you have
separately received it.

          <li>If the work has interactive user interfaces, each must display
Appropriate Legal Notices; however, if the Program has interactive
interfaces that do not display Appropriate Legal Notices, your work
need not make them do so.
          </ol>

     <p>A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
&ldquo;aggregate&rdquo; if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

     <li>Conveying Non-Source Forms.

     <p>You may convey a covered work in object code form under the terms of
sections 4 and 5, provided that you also convey the machine-readable
Corresponding Source under the terms of this License, in one of these
ways:

          <ol type=a start=1>
<li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by the
Corresponding Source fixed on a durable physical medium customarily
used for software interchange.

          <li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by a written
offer, valid for at least three years and valid for as long as you
offer spare parts or customer support for that product model, to give
anyone who possesses the object code either (1) a copy of the
Corresponding Source for all the software in the product that is
covered by this License, on a durable physical medium customarily used
for software interchange, for a price no more than your reasonable
cost of physically performing this conveying of source, or (2) access
to copy the Corresponding Source from a network server at no charge.

          <li>Convey individual copies of the object code with a copy of the written
offer to provide the Corresponding Source.  This alternative is
allowed only occasionally and noncommercially, and only if you
received the object code with such an offer, in accord with subsection
6b.

          <li>Convey the object code by offering access from a designated place
(gratis or for a charge), and offer equivalent access to the
Corresponding Source in the same way through the same place at no
further charge.  You need not require recipients to copy the
Corresponding Source along with the object code.  If the place to copy
the object code is a network server, the Corresponding Source may be
on a different server (operated by you or a third party) that supports
equivalent copying facilities, provided you maintain clear directions
next to the object code saying where to find the Corresponding Source. 
Regardless of what server hosts the Corresponding Source, you remain
obligated to ensure that it is available for as long as needed to
satisfy these requirements.

          <li>Convey the object code using peer-to-peer transmission, provided you
inform other peers where the object code and Corresponding Source of
the work are being offered to the general public at no charge under
subsection 6d.

          </ol>

     <p>A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

     <p>A &ldquo;User Product&rdquo; is either (1) a &ldquo;consumer product&rdquo;, which means any
tangible personal property which is normally used for personal,
family, or household purposes, or (2) anything designed or sold for
incorporation into a dwelling.  In determining whether a product is a
consumer product, doubtful cases shall be resolved in favor of
coverage.  For a particular product received by a particular user,
&ldquo;normally used&rdquo; refers to a typical or common use of that class of
product, regardless of the status of the particular user or of the way
in which the particular user actually uses, or expects or is expected
to use, the product.  A product is a consumer product regardless of
whether the product has substantial commercial, industrial or
non-consumer uses, unless such uses represent the only significant
mode of use of the product.

     <p>&ldquo;Installation Information&rdquo; for a User Product means any methods,
procedures, authorization keys, or other information required to
install and execute modified versions of a covered work in that User
Product from a modified version of its Corresponding Source.  The
information must suffice to ensure that the continued functioning of
the modified object code is in no case prevented or interfered with
solely because modification has been made.

     <p>If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

     <p>The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or
updates for a work that has been modified or installed by the
recipient, or for the User Product in which it has been modified or
installed.  Access to a network may be denied when the modification
itself materially and adversely affects the operation of the network
or violates the rules and protocols for communication across the
network.

     <p>Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

     <li>Additional Terms.

     <p>&ldquo;Additional permissions&rdquo; are terms that supplement the terms of this
License by making exceptions from one or more of its conditions. 
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

     <p>When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

     <p>Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders
of that material) supplement the terms of this License with terms:

          <ol type=a start=1>
<li>Disclaiming warranty or limiting liability differently from the terms
of sections 15 and 16 of this License; or

          <li>Requiring preservation of specified reasonable legal notices or author
attributions in that material or in the Appropriate Legal Notices
displayed by works containing it; or

          <li>Prohibiting misrepresentation of the origin of that material, or
requiring that modified versions of such material be marked in
reasonable ways as different from the original version; or

          <li>Limiting the use for publicity purposes of names of licensors or
authors of the material; or

          <li>Declining to grant rights under trademark law for use of some trade
names, trademarks, or service marks; or

          <li>Requiring indemnification of licensors and authors of that material by
anyone who conveys the material (or modified versions of it) with
contractual assumptions of liability to the recipient, for any
liability that these contractual assumptions directly impose on those
licensors and authors.
          </ol>

     <p>All other non-permissive additional terms are considered &ldquo;further
restrictions&rdquo; within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

     <p>If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

     <p>Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions; the
above requirements apply either way.

     <li>Termination.

     <p>You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

     <li>Acceptance Not Required for Having Copies.

     <p>You are not required to accept this License in order to receive or run
a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

     <li>Automatic Licensing of Downstream Recipients.

     <p>Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

     <p>An &ldquo;entity transaction&rdquo; is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

     <p>You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

     <li>Patents.

     <p>A &ldquo;contributor&rdquo; is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's &ldquo;contributor version&rdquo;.

     <p>A contributor's &ldquo;essential patent claims&rdquo; are all patent claims owned
or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, &ldquo;control&rdquo; includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

     <p>Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

     <p>In the following three paragraphs, a &ldquo;patent license&rdquo; is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To &ldquo;grant&rdquo; such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

     <p>If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  &ldquo;Knowingly relying&rdquo; means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

     <p>If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

     <p>A patent license is &ldquo;discriminatory&rdquo; if it does not include within the
scope of its coverage, prohibits the exercise of, or is conditioned on
the non-exercise of one or more of the rights that are specifically
granted under this License.  You may not convey a covered work if you
are a party to an arrangement with a third party that is in the
business of distributing software, under which you make payment to the
third party based on the extent of your activity of conveying the
work, and under which the third party grants, to any of the parties
who would receive the covered work from you, a discriminatory patent
license (a) in connection with copies of the covered work conveyed by
you (or copies made from those copies), or (b) primarily for and in
connection with specific products or compilations that contain the
covered work, unless you entered into that arrangement, or that patent
license was granted, prior to 28 March 2007.

     <p>Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

     <li>No Surrender of Others' Freedom.

     <p>If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey
a covered work so as to satisfy simultaneously your obligations under
this License and any other pertinent obligations, then as a
consequence you may not convey it at all.  For example, if you agree
to terms that obligate you to collect a royalty for further conveying
from those to whom you convey the Program, the only way you could
satisfy both those terms and this License would be to refrain entirely
from conveying the Program.

     <li>Use with the GNU Affero General Public License.

     <p>Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

     <li>Revised Versions of this License.

     <p>The Free Software Foundation may publish revised and/or new versions
of the GNU General Public License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Program
specifies that a certain numbered version of the GNU General Public
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that numbered version or
of any later version published by the Free Software Foundation.  If
the Program does not specify a version number of the GNU General
Public License, you may choose any version ever published by the Free
Software Foundation.

     <p>If the Program specifies that a proxy can decide which future versions
of the GNU General Public License can be used, that proxy's public
statement of acceptance of a version permanently authorizes you to
choose that version for the Program.

     <p>Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

     <li>Disclaimer of Warranty.

     <p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT
WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.

     <li>Limitation of Liability.

     <p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR
CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT
NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM
TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER
PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

     <li>Interpretation of Sections 15 and 16.

     <p>If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

     </ol>

<h3 class="heading">END OF TERMS AND CONDITIONS</h3>

<h3 class="heading">How to Apply These Terms to Your New Programs</h3>

<p>If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these
terms.

   <p>To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the program's name and a brief idea of what it does.</var>
     Copyright (C) <var>year</var> <var>name of author</var>
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or (at
     your option) any later version.
     
     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</pre>
   <p>Also add information on how to contact you by electronic and paper mail.

   <p>If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

<pre class="smallexample">     <var>program</var> Copyright (C) <var>year</var> <var>name of author</var>
     This program comes with ABSOLUTELY NO WARRANTY; for details type &lsquo;<samp><span class="samp">show w</span></samp>&rsquo;.
     This is free software, and you are welcome to redistribute it
     under certain conditions; type &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; for details.
</pre>
   <p>The hypothetical commands &lsquo;<samp><span class="samp">show w</span></samp>&rsquo; and &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; should show
the appropriate parts of the General Public License.  Of course, your
program's commands might be different; for a GUI interface, you would
use an &ldquo;about box&rdquo;.

   <p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if necessary. 
For more information on this, and how to apply and follow the GNU GPL, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

   <p>The GNU General Public License does not permit incorporating your
program into proprietary programs.  If your program is a subroutine
library, you may consider it more useful to permit linking proprietary
applications with the library.  If this is what you want to do, use
the GNU Lesser General Public License instead of this License.  But
first, please read <a href="http://www.gnu.org/philosophy/why-not-lgpl.html">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.

<div class="node">
<a name="Function-and-Data-Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Concept-Index">Concept Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying-Information">Copying Information</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Function and Data Index</h2>

<ul class="index-fn" compact>
<li><a href="#index-ago-_0040r_007bin-date-strings_007d-123"><code>ago </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-am-_0040r_007bin-date-strings_007d-104"><code>am </code><span class="roman">in date strings</span></a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-day-_0040r_007bin-date-strings_007d-120"><code>day </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-first-_0040r_007bin-date-strings_007d-89"><code>first </code><span class="roman">in date strings</span></a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-fortnight-_0040r_007bin-date-strings_007d-118"><code>fortnight </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-get_005fdate-84"><code>get_date</code></a>: <a href="#Date-input-formats">Date input formats</a></li>
<li><a href="#index-hour-_0040r_007bin-date-strings_007d-121"><code>hour </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-last-_0040var_007bday_007d-113"><code>last </code><var>day</var></a>: <a href="#Day-of-week-items">Day of week items</a></li>
<li><a href="#index-last-_0040r_007bin-date-strings_007d-91"><code>last </code><span class="roman">in date strings</span></a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-midnight-_0040r_007bin-date-strings_007d-106"><code>midnight </code><span class="roman">in date strings</span></a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-minute-_0040r_007bin-date-strings_007d-122"><code>minute </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-month-_0040r_007bin-date-strings_007d-117"><code>month </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-next-_0040var_007bday_007d-112"><code>next </code><var>day</var></a>: <a href="#Day-of-week-items">Day of week items</a></li>
<li><a href="#index-next-_0040r_007bin-date-strings_007d-90"><code>next </code><span class="roman">in date strings</span></a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-noon-_0040r_007bin-date-strings_007d-107"><code>noon </code><span class="roman">in date strings</span></a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-now-_0040r_007bin-date-strings_007d-127"><code>now </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-pm-_0040r_007bin-date-strings_007d-105"><code>pm </code><span class="roman">in date strings</span></a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-shisa-783"><code>shisa</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fcfg-788"><code>shisa_cfg</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fcfg_005fdb-787"><code>shisa_cfg_db</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fcfg_005fdefault_005fsystemfile-790"><code>shisa_cfg_default_systemfile</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fcfg_005ffrom_005ffile-789"><code>shisa_cfg_from_file</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fdone-784"><code>shisa_done</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fenumerate_005fprincipals-792"><code>shisa_enumerate_principals</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fenumerate_005frealms-791"><code>shisa_enumerate_realms</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005finfo-804"><code>shisa_info</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005finit-785"><code>shisa_init</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005finit_005fwith_005fpaths-786"><code>shisa_init_with_paths</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkey_005fadd-798"><code>shisa_key_add</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkey_005ffree-801"><code>shisa_key_free</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkey_005fremove-800"><code>shisa_key_remove</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkey_005fupdate-799"><code>shisa_key_update</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkeys_005ffind-797"><code>shisa_keys_find</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fkeys_005ffree-802"><code>shisa_keys_free</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fprincipal_005fadd-795"><code>shisa_principal_add</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fprincipal_005ffind-793"><code>shisa_principal_find</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fprincipal_005fremove-796"><code>shisa_principal_remove</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fprincipal_005fupdate-794"><code>shisa_principal_update</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shisa_005fstrerror-803"><code>shisa_strerror</code></a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-shishi-148"><code>shishi</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005f3des-674"><code>shishi_3des</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005faes_005fcts-675"><code>shishi_aes_cts</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fap-193"><code>shishi_ap</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator-213"><code>shishi_ap_authenticator</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fcksumdata-208"><code>shishi_ap_authenticator_cksumdata</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fcksumdata_005fset-209"><code>shishi_ap_authenticator_cksumdata_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fcksumraw_005fset-210"><code>shishi_ap_authenticator_cksumraw_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fcksumtype-211"><code>shishi_ap_authenticator_cksumtype</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fcksumtype_005fset-212"><code>shishi_ap_authenticator_cksumtype_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fauthenticator_005fset-214"><code>shishi_ap_authenticator_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fdone-196"><code>shishi_ap_done</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fencapreppart-234"><code>shishi_ap_encapreppart</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fencapreppart_005fset-235"><code>shishi_ap_encapreppart_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fetype-194"><code>shishi_ap_etype</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fetype_005ftktoptionsdata-204"><code>shishi_ap_etype_tktoptionsdata</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fkey-224"><code>shishi_ap_key</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fnosubkey-195"><code>shishi_ap_nosubkey</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005foption2string-236"><code>shishi_ap_option2string</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep-225"><code>shishi_ap_rep</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fasn1-230"><code>shishi_ap_rep_asn1</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fbuild-229"><code>shishi_ap_rep_build</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fder-227"><code>shishi_ap_rep_der</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fder_005fset-228"><code>shishi_ap_rep_der_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fset-226"><code>shishi_ap_rep_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fverify-231"><code>shishi_ap_rep_verify</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fverify_005fasn1-233"><code>shishi_ap_rep_verify_asn1</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005frep_005fverify_005fder-232"><code>shishi_ap_rep_verify_der</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq-215"><code>shishi_ap_req</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fasn1-223"><code>shishi_ap_req_asn1</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fbuild-219"><code>shishi_ap_req_build</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fdecode-220"><code>shishi_ap_req_decode</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fder-217"><code>shishi_ap_req_der</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fder_005fset-218"><code>shishi_ap_req_der_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fprocess-222"><code>shishi_ap_req_process</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fprocess_005fkeyusage-221"><code>shishi_ap_req_process_keyusage</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005freq_005fset-216"><code>shishi_ap_req_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fset_005ftktoptions-197"><code>shishi_ap_set_tktoptions</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fset_005ftktoptionsasn1usage-200"><code>shishi_ap_set_tktoptionsasn1usage</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fset_005ftktoptionsdata-198"><code>shishi_ap_set_tktoptionsdata</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fset_005ftktoptionsraw-199"><code>shishi_ap_set_tktoptionsraw</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005fstring2option-237"><code>shishi_ap_string2option</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftkt-206"><code>shishi_ap_tkt</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftkt_005fset-207"><code>shishi_ap_tkt_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftktoptions-201"><code>shishi_ap_tktoptions</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftktoptionsasn1usage-205"><code>shishi_ap_tktoptionsasn1usage</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftktoptionsdata-202"><code>shishi_ap_tktoptionsdata</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fap_005ftktoptionsraw-203"><code>shishi_ap_tktoptionsraw</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep-256"><code>shishi_aprep</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005ffrom_005ffile-262"><code>shishi_aprep_from_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fget_005fenc_005fpart_005fetype-263"><code>shishi_aprep_get_enc_part_etype</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fparse-260"><code>shishi_aprep_parse</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fprint-257"><code>shishi_aprep_print</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fread-261"><code>shishi_aprep_read</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fsave-258"><code>shishi_aprep_save</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005faprep_005fto_005ffile-259"><code>shishi_aprep_to_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq-238"><code>shishi_apreq</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fadd_005fauthenticator-246"><code>shishi_apreq_add_authenticator</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005ffrom_005ffile-244"><code>shishi_apreq_from_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fget_005fauthenticator_005fetype-254"><code>shishi_apreq_get_authenticator_etype</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fget_005fticket-255"><code>shishi_apreq_get_ticket</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fmutual_005frequired_005fp-250"><code>shishi_apreq_mutual_required_p</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005foptions-248"><code>shishi_apreq_options</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005foptions_005fadd-252"><code>shishi_apreq_options_add</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005foptions_005fremove-253"><code>shishi_apreq_options_remove</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005foptions_005fset-251"><code>shishi_apreq_options_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fparse-242"><code>shishi_apreq_parse</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fprint-239"><code>shishi_apreq_print</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fread-243"><code>shishi_apreq_read</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fsave-240"><code>shishi_apreq_save</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fset_005fauthenticator-245"><code>shishi_apreq_set_authenticator</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fset_005fticket-247"><code>shishi_apreq_set_ticket</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fto_005ffile-241"><code>shishi_apreq_to_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fapreq_005fuse_005fsession_005fkey_005fp-249"><code>shishi_apreq_use_session_key_p</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005farcfour-672"><code>shishi_arcfour</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fas-372"><code>shishi_as</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fcheck_005fcname-439"><code>shishi_as_check_cname</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fas_005fcheck_005fcrealm-437"><code>shishi_as_check_crealm</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fas_005fderive_005fsalt-435"><code>shishi_as_derive_salt</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fas_005fdone-373"><code>shishi_as_done</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fkrberror-385"><code>shishi_as_krberror</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fkrberror_005fder-386"><code>shishi_as_krberror_der</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fkrberror_005fset-387"><code>shishi_as_krberror_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fprocess-443"><code>shishi_as_process</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep-379"><code>shishi_as_rep</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep_005fbuild-381"><code>shishi_as_rep_build</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep_005fder-382"><code>shishi_as_rep_der</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep_005fder_005fset-384"><code>shishi_as_rep_der_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep_005fprocess-380"><code>shishi_as_rep_process</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005frep_005fset-383"><code>shishi_as_rep_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005freq-374"><code>shishi_as_req</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005freq_005fbuild-375"><code>shishi_as_req_build</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005freq_005fder-377"><code>shishi_as_req_der</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005freq_005fder_005fset-378"><code>shishi_as_req_der_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005freq_005fset-376"><code>shishi_as_req_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fsendrecv-391"><code>shishi_as_sendrecv</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005fsendrecv_005fhint-390"><code>shishi_as_sendrecv_hint</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005ftkt-388"><code>shishi_as_tkt</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fas_005ftkt_005fset-389"><code>shishi_as_tkt_set</code></a>: <a href="#AS-Functions">AS Functions</a></li>
<li><a href="#index-shishi_005fasn1_005faprep-729"><code>shishi_asn1_aprep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fapreq-728"><code>shishi_asn1_apreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fasrep-725"><code>shishi_asn1_asrep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fasreq-724"><code>shishi_asn1_asreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fauthenticator-733"><code>shishi_asn1_authenticator</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fdone-717"><code>shishi_asn1_done</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fencapreppart-730"><code>shishi_asn1_encapreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fencasreppart-735"><code>shishi_asn1_encasreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fenckdcreppart-734"><code>shishi_asn1_enckdcreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fencprivpart-739"><code>shishi_asn1_encprivpart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fencrypteddata-719"><code>shishi_asn1_encrypteddata</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fencticketpart-732"><code>shishi_asn1_encticketpart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fetype_005finfo-722"><code>shishi_asn1_etype_info</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fetype_005finfo2-723"><code>shishi_asn1_etype_info2</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fkrberror-736"><code>shishi_asn1_krberror</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fkrbsafe-737"><code>shishi_asn1_krbsafe</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fmethoddata-721"><code>shishi_asn1_methoddata</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fmsgtype-742"><code>shishi_asn1_msgtype</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fpa_005fenc_005fts_005fenc-718"><code>shishi_asn1_pa_enc_ts_enc</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fpadata-720"><code>shishi_asn1_padata</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fprint-768"><code>shishi_asn1_print</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fpriv-738"><code>shishi_asn1_priv</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fread-715"><code>shishi_asn1_read</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fread_005finline-714"><code>shishi_asn1_read_inline</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fread_005foptional-716"><code>shishi_asn1_read_optional</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005ftgsrep-727"><code>shishi_asn1_tgsrep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005ftgsreq-726"><code>shishi_asn1_tgsreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fticket-731"><code>shishi_asn1_ticket</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fto_005fder-741"><code>shishi_asn1_to_der</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasn1_005fto_005fder_005ffield-740"><code>shishi_asn1_to_der_field</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fasrep-486"><code>shishi_asrep</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fasreq-445"><code>shishi_asreq</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fasreq_005fclientrealm-456"><code>shishi_asreq_clientrealm</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fauthenticator-514"><code>shishi_authenticator</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005fauthorizationdata-539"><code>shishi_authenticator_add_authorizationdata</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005fcksum-536"><code>shishi_authenticator_add_cksum</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005fcksum_005ftype-537"><code>shishi_authenticator_add_cksum_type</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005frandom_005fsubkey-544"><code>shishi_authenticator_add_random_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005frandom_005fsubkey_005fetype-545"><code>shishi_authenticator_add_random_subkey_etype</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fadd_005fsubkey-546"><code>shishi_authenticator_add_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fauthorizationdata-540"><code>shishi_authenticator_authorizationdata</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fcksum-534"><code>shishi_authenticator_cksum</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fclear_005fauthorizationdata-538"><code>shishi_authenticator_clear_authorizationdata</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fclient-532"><code>shishi_authenticator_client</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fclient_005fset-524"><code>shishi_authenticator_client_set</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fclientrealm-533"><code>shishi_authenticator_clientrealm</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fctime-525"><code>shishi_authenticator_ctime</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fctime_005fset-526"><code>shishi_authenticator_ctime_set</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fcusec_005fget-527"><code>shishi_authenticator_cusec_get</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fcusec_005fset-528"><code>shishi_authenticator_cusec_set</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005ffrom_005ffile-521"><code>shishi_authenticator_from_file</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fget_005fsubkey-542"><code>shishi_authenticator_get_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fparse-519"><code>shishi_authenticator_parse</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fprint-516"><code>shishi_authenticator_print</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fread-520"><code>shishi_authenticator_read</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fremove_005fsubkey-541"><code>shishi_authenticator_remove_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fsave-517"><code>shishi_authenticator_save</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fseqnumber_005fget-529"><code>shishi_authenticator_seqnumber_get</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fseqnumber_005fremove-530"><code>shishi_authenticator_seqnumber_remove</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fseqnumber_005fset-531"><code>shishi_authenticator_seqnumber_set</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fset_005fcksum-535"><code>shishi_authenticator_set_cksum</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fset_005fcname-523"><code>shishi_authenticator_set_cname</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fset_005fcrealm-522"><code>shishi_authenticator_set_crealm</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fset_005fsubkey-543"><code>shishi_authenticator_set_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fsubkey-515"><code>shishi_authenticator_subkey</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthenticator_005fto_005ffile-518"><code>shishi_authenticator_to_file</code></a>: <a href="#Authenticator-Functions">Authenticator Functions</a></li>
<li><a href="#index-shishi_005fauthorization_005fparse-702"><code>shishi_authorization_parse</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fauthorized_005fp-703"><code>shishi_authorized_p</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fcfg-155"><code>shishi_cfg</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fauthorizationtype_005fset-165"><code>shishi_cfg_authorizationtype_set</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fclientkdcetype-162"><code>shishi_cfg_clientkdcetype</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fclientkdcetype_005ffast-163"><code>shishi_cfg_clientkdcetype_fast</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fclientkdcetype_005fset-164"><code>shishi_cfg_clientkdcetype_set</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fdefault_005fsystemfile-158"><code>shishi_cfg_default_systemfile</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fdefault_005fuserdirectory-159"><code>shishi_cfg_default_userdirectory</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fdefault_005fuserfile-161"><code>shishi_cfg_default_userfile</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005ffrom_005ffile-156"><code>shishi_cfg_from_file</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fprint-157"><code>shishi_cfg_print</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcfg_005fuserdirectory_005ffile-160"><code>shishi_cfg_userdirectory_file</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fcheck_005fversion-144"><code>shishi_check_version</code></a>: <a href="#Version-Check">Version Check</a></li>
<li><a href="#index-shishi_005fchecksum-644"><code>shishi_checksum</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fchecksum_005fcksumlen-640"><code>shishi_checksum_cksumlen</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fchecksum_005fname-639"><code>shishi_checksum_name</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fchecksum_005fparse-641"><code>shishi_checksum_parse</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fchecksum_005fsupported_005fp-638"><code>shishi_checksum_supported_p</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fblocksize-632"><code>shishi_cipher_blocksize</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fconfoundersize-633"><code>shishi_cipher_confoundersize</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fdefaultcksumtype-636"><code>shishi_cipher_defaultcksumtype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fkeylen-634"><code>shishi_cipher_keylen</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fname-631"><code>shishi_cipher_name</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fparse-637"><code>shishi_cipher_parse</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005frandomlen-635"><code>shishi_cipher_randomlen</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcipher_005fsupported_005fp-630"><code>shishi_cipher_supported_p</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcrc-666"><code>shishi_crc</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcrypto-661"><code>shishi_crypto</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcrypto_005fclose-664"><code>shishi_crypto_close</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcrypto_005fdecrypt-663"><code>shishi_crypto_decrypt</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fcrypto_005fencrypt-662"><code>shishi_crypto_encrypt</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fctime-708"><code>shishi_ctime</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fdecrypt-657"><code>shishi_decrypt</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdecrypt_005fetype-654"><code>shishi_decrypt_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdecrypt_005fiv-656"><code>shishi_decrypt_iv</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdecrypt_005fiv_005fetype-653"><code>shishi_decrypt_iv_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdecrypt_005fivupdate-655"><code>shishi_decrypt_ivupdate</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdecrypt_005fivupdate_005fetype-652"><code>shishi_decrypt_ivupdate_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fder2asn1-744"><code>shishi_der2asn1</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005faprep-765"><code>shishi_der2asn1_aprep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fapreq-764"><code>shishi_der2asn1_apreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fasrep-753"><code>shishi_der2asn1_asrep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fasreq-751"><code>shishi_der2asn1_asreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fauthenticator-759"><code>shishi_der2asn1_authenticator</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fencapreppart-766"><code>shishi_der2asn1_encapreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fencasreppart-756"><code>shishi_der2asn1_encasreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fenckdcreppart-758"><code>shishi_der2asn1_enckdcreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fencprivpart-763"><code>shishi_der2asn1_encprivpart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fenctgsreppart-757"><code>shishi_der2asn1_enctgsreppart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fencticketpart-750"><code>shishi_der2asn1_encticketpart</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fetype_005finfo-747"><code>shishi_der2asn1_etype_info</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fetype_005finfo2-748"><code>shishi_der2asn1_etype_info2</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fkdcrep-755"><code>shishi_der2asn1_kdcrep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fkdcreq-767"><code>shishi_der2asn1_kdcreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fkrberror-760"><code>shishi_der2asn1_krberror</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fkrbsafe-761"><code>shishi_der2asn1_krbsafe</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fmethoddata-746"><code>shishi_der2asn1_methoddata</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fpadata-745"><code>shishi_der2asn1_padata</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fpriv-762"><code>shishi_der2asn1_priv</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005ftgsrep-754"><code>shishi_der2asn1_tgsrep</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005ftgsreq-752"><code>shishi_der2asn1_tgsreq</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder2asn1_005fticket-749"><code>shishi_der2asn1_ticket</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fder_005fmsgtype-743"><code>shishi_der_msgtype</code></a>: <a href="#ASN_002e1-Functions">ASN.1 Functions</a></li>
<li><a href="#index-shishi_005fderive_005fdefault_005fsalt-700"><code>shishi_derive_default_salt</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fdes-673"><code>shishi_des</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdes_005fcbc_005fmac-671"><code>shishi_des_cbc_mac</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdk-660"><code>shishi_dk</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fdone-150"><code>shishi_done</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fdr-659"><code>shishi_dr</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencapreppart-264"><code>shishi_encapreppart</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fctime-272"><code>shishi_encapreppart_ctime</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fctime_005fset-273"><code>shishi_encapreppart_ctime_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fcusec_005fget-274"><code>shishi_encapreppart_cusec_get</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fcusec_005fset-275"><code>shishi_encapreppart_cusec_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005ffrom_005ffile-270"><code>shishi_encapreppart_from_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fget_005fkey-271"><code>shishi_encapreppart_get_key</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fparse-268"><code>shishi_encapreppart_parse</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fprint-265"><code>shishi_encapreppart_print</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fread-269"><code>shishi_encapreppart_read</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fsave-266"><code>shishi_encapreppart_save</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fseqnumber_005fget-276"><code>shishi_encapreppart_seqnumber_get</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fseqnumber_005fremove-277"><code>shishi_encapreppart_seqnumber_remove</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fseqnumber_005fset-278"><code>shishi_encapreppart_seqnumber_set</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005ftime_005fcopy-279"><code>shishi_encapreppart_time_copy</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fencapreppart_005fto_005ffile-267"><code>shishi_encapreppart_to_file</code></a>: <a href="#AP_002dREQ-and-AP_002dREP-Functions">AP-REQ and AP-REP Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fauthtime_005fset-507"><code>shishi_enckdcreppart_authtime_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fendtime_005fset-509"><code>shishi_enckdcreppart_endtime_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fflags_005fset-506"><code>shishi_enckdcreppart_flags_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fget_005fkey-503"><code>shishi_enckdcreppart_get_key</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fkey_005fset-504"><code>shishi_enckdcreppart_key_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fnonce_005fset-505"><code>shishi_enckdcreppart_nonce_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fpopulate_005fencticketpart-513"><code>shishi_enckdcreppart_populate_encticketpart</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005frenew_005ftill_005fset-510"><code>shishi_enckdcreppart_renew_till_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fsname_005fset-512"><code>shishi_enckdcreppart_sname_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fsrealm_005fset-511"><code>shishi_enckdcreppart_srealm_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fenckdcreppart_005fstarttime_005fset-508"><code>shishi_enckdcreppart_starttime_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fencprivpart_005fset_005fuser_005fdata-321"><code>shishi_encprivpart_set_user_data</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fencprivpart_005fuser_005fdata-320"><code>shishi_encprivpart_user_data</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fencrypt-651"><code>shishi_encrypt</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencrypt_005fetype-648"><code>shishi_encrypt_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencrypt_005fiv-650"><code>shishi_encrypt_iv</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencrypt_005fiv_005fetype-647"><code>shishi_encrypt_iv_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencrypt_005fivupdate-649"><code>shishi_encrypt_ivupdate</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencrypt_005fivupdate_005fetype-646"><code>shishi_encrypt_ivupdate_etype</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fauthtime_005fset-431"><code>shishi_encticketpart_authtime_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fclient-433"><code>shishi_encticketpart_client</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fclientrealm-434"><code>shishi_encticketpart_clientrealm</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fcname_005fset-429"><code>shishi_encticketpart_cname_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fcrealm_005fset-428"><code>shishi_encticketpart_crealm_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fendtime_005fset-432"><code>shishi_encticketpart_endtime_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fflags_005fset-427"><code>shishi_encticketpart_flags_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fget_005fkey-425"><code>shishi_encticketpart_get_key</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005fkey_005fset-426"><code>shishi_encticketpart_key_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fencticketpart_005ftransited_005fset-430"><code>shishi_encticketpart_transited_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005ferror-771"><code>shishi_error</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005ferror_005fclear-772"><code>shishi_error_clear</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005ferror_005foutputtype-775"><code>shishi_error_outputtype</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005ferror_005fprintf-774"><code>shishi_error_printf</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005ferror_005fset-773"><code>shishi_error_set</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005ferror_005fset_005foutputtype-776"><code>shishi_error_set_outputtype</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005fgeneralize_005fctime-706"><code>shishi_generalize_ctime</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fgeneralize_005fnow-705"><code>shishi_generalize_now</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fgeneralize_005ftime-704"><code>shishi_generalize_time</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fhmac_005fmd5-669"><code>shishi_hmac_md5</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhmac_005fsha1-670"><code>shishi_hmac_sha1</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005fdefault_005ffile-624"><code>shishi_hostkeys_default_file</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005fdefault_005ffile_005fset-625"><code>shishi_hostkeys_default_file_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005ffor_005flocalservice-629"><code>shishi_hostkeys_for_localservice</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005ffor_005flocalservicerealm-628"><code>shishi_hostkeys_for_localservicerealm</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005ffor_005fserver-626"><code>shishi_hostkeys_for_server</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fhostkeys_005ffor_005fserverrealm-627"><code>shishi_hostkeys_for_serverrealm</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005finfo-777"><code>shishi_info</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005finit-151"><code>shishi_init</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005finit_005fserver-153"><code>shishi_init_server</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005finit_005fserver_005fwith_005fpaths-154"><code>shishi_init_server_with_paths</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005finit_005fwith_005fpaths-152"><code>shishi_init_with_paths</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fkdc_005fcheck_005fnonce-441"><code>shishi_kdc_check_nonce</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdc_005fcopy_005fcname-438"><code>shishi_kdc_copy_cname</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdc_005fcopy_005fcrealm-436"><code>shishi_kdc_copy_crealm</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdc_005fcopy_005fnonce-440"><code>shishi_kdc_copy_nonce</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdc_005fprocess-444"><code>shishi_kdc_process</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fadd_005fenc_005fpart-501"><code>shishi_kdcrep_add_enc_part</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fclear_005fpadata-502"><code>shishi_kdcrep_clear_padata</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fclient_005fset-496"><code>shishi_kdcrep_client_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fcname_005fset-495"><code>shishi_kdcrep_cname_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fcrealm_005fset-494"><code>shishi_kdcrep_crealm_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005ffrom_005ffile-493"><code>shishi_kdcrep_from_file</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fget_005fenc_005fpart_005fetype-497"><code>shishi_kdcrep_get_enc_part_etype</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fget_005fticket-498"><code>shishi_kdcrep_get_ticket</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fparse-491"><code>shishi_kdcrep_parse</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fprint-488"><code>shishi_kdcrep_print</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fread-492"><code>shishi_kdcrep_read</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fsave-489"><code>shishi_kdcrep_save</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fset_005fenc_005fpart-500"><code>shishi_kdcrep_set_enc_part</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fset_005fticket-499"><code>shishi_kdcrep_set_ticket</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcrep_005fto_005ffile-490"><code>shishi_kdcrep_to_file</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fadd_005fpadata-483"><code>shishi_kdcreq_add_padata</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fadd_005fpadata_005fpreauth-485"><code>shishi_kdcreq_add_padata_preauth</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fadd_005fpadata_005ftgs-484"><code>shishi_kdcreq_add_padata_tgs</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fallow_005fpostdate_005fp-470"><code>shishi_kdcreq_allow_postdate_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fclear_005fpadata-480"><code>shishi_kdcreq_clear_padata</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fclient-455"><code>shishi_kdcreq_client</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fdisable_005ftransited_005fcheck_005fp-473"><code>shishi_kdcreq_disable_transited_check_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fenc_005ftkt_005fin_005fskey_005fp-475"><code>shishi_kdcreq_enc_tkt_in_skey_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fetype-463"><code>shishi_kdcreq_etype</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fforwardable_005fp-466"><code>shishi_kdcreq_forwardable_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fforwarded_005fp-467"><code>shishi_kdcreq_forwarded_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005ffrom_005ffile-452"><code>shishi_kdcreq_from_file</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fget_005fpadata-481"><code>shishi_kdcreq_get_padata</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fget_005fpadata_005ftgs-482"><code>shishi_kdcreq_get_padata_tgs</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fnonce_005fset-453"><code>shishi_kdcreq_nonce_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005foptions-465"><code>shishi_kdcreq_options</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005foptions_005fadd-479"><code>shishi_kdcreq_options_add</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005foptions_005fset-478"><code>shishi_kdcreq_options_set</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fparse-450"><code>shishi_kdcreq_parse</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fpostdated_005fp-471"><code>shishi_kdcreq_postdated_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fprint-447"><code>shishi_kdcreq_print</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fproxiable_005fp-468"><code>shishi_kdcreq_proxiable_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fproxy_005fp-469"><code>shishi_kdcreq_proxy_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fread-451"><code>shishi_kdcreq_read</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005frealm-457"><code>shishi_kdcreq_realm</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005frenew_005fp-476"><code>shishi_kdcreq_renew_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005frenewable_005fok_005fp-474"><code>shishi_kdcreq_renewable_ok_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005frenewable_005fp-472"><code>shishi_kdcreq_renewable_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fsave-448"><code>shishi_kdcreq_save</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fserver-459"><code>shishi_kdcreq_server</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fset_005fcname-454"><code>shishi_kdcreq_set_cname</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fset_005fetype-464"><code>shishi_kdcreq_set_etype</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fset_005frealm-458"><code>shishi_kdcreq_set_realm</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fset_005fsname-460"><code>shishi_kdcreq_set_sname</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005ftill-461"><code>shishi_kdcreq_till</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005ftillc-462"><code>shishi_kdcreq_tillc</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fto_005ffile-449"><code>shishi_kdcreq_to_file</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkdcreq_005fvalidate_005fp-477"><code>shishi_kdcreq_validate_p</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fkey-604"><code>shishi_key</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fcopy-606"><code>shishi_key_copy</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fdone-605"><code>shishi_key_done</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ffrom_005fbase64-608"><code>shishi_key_from_base64</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ffrom_005fname-612"><code>shishi_key_from_name</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ffrom_005frandom-610"><code>shishi_key_from_random</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ffrom_005fstring-611"><code>shishi_key_from_string</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ffrom_005fvalue-607"><code>shishi_key_from_value</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005flength-603"><code>shishi_key_length</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fname-602"><code>shishi_key_name</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fprincipal-592"><code>shishi_key_principal</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fprincipal_005fset-593"><code>shishi_key_principal_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005frandom-609"><code>shishi_key_random</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005frealm-594"><code>shishi_key_realm</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005frealm_005fset-595"><code>shishi_key_realm_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ftype-596"><code>shishi_key_type</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005ftype_005fset-597"><code>shishi_key_type_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fvalue-598"><code>shishi_key_value</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fvalue_005fset-599"><code>shishi_key_value_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fversion-600"><code>shishi_key_version</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkey_005fversion_005fset-601"><code>shishi_key_version_set</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys-613"><code>shishi_keys</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fadd-618"><code>shishi_keys_add</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fdone-614"><code>shishi_keys_done</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005ffor_005flocalservicerealm_005fin_005ffile-623"><code>shishi_keys_for_localservicerealm_in_file</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005ffor_005fserver_005fin_005ffile-622"><code>shishi_keys_for_server_in_file</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005ffor_005fserverrealm_005fin_005ffile-621"><code>shishi_keys_for_serverrealm_in_file</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fnth-616"><code>shishi_keys_nth</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fprint-619"><code>shishi_keys_print</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fremove-617"><code>shishi_keys_remove</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fsize-615"><code>shishi_keys_size</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkeys_005fto_005ffile-620"><code>shishi_keys_to_file</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fkrberror-547"><code>shishi_krberror</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fbuild-554"><code>shishi_krberror_build</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fclient-559"><code>shishi_krberror_client</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fclient_005fset-562"><code>shishi_krberror_client_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fcrealm-556"><code>shishi_krberror_crealm</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fctime-569"><code>shishi_krberror_ctime</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fctime_005fset-570"><code>shishi_krberror_ctime_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fcusec-572"><code>shishi_krberror_cusec</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fcusec_005fset-573"><code>shishi_krberror_cusec_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fder-555"><code>shishi_krberror_der</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fedata-585"><code>shishi_krberror_edata</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005ferrorcode-579"><code>shishi_krberror_errorcode</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005ferrorcode_005ffast-580"><code>shishi_krberror_errorcode_fast</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005ferrorcode_005fmessage-590"><code>shishi_krberror_errorcode_message</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005ferrorcode_005fset-581"><code>shishi_krberror_errorcode_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fetext-582"><code>shishi_krberror_etext</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005ffrom_005ffile-553"><code>shishi_krberror_from_file</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fmessage-591"><code>shishi_krberror_message</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fmethoddata-586"><code>shishi_krberror_methoddata</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fparse-551"><code>shishi_krberror_parse</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fpretty_005fprint-589"><code>shishi_krberror_pretty_print</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fprint-548"><code>shishi_krberror_print</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fread-552"><code>shishi_krberror_read</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005frealm-563"><code>shishi_krberror_realm</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fcname-561"><code>shishi_krberror_remove_cname</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fcrealm-557"><code>shishi_krberror_remove_crealm</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fctime-571"><code>shishi_krberror_remove_ctime</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fcusec-574"><code>shishi_krberror_remove_cusec</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fedata-588"><code>shishi_krberror_remove_edata</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fetext-584"><code>shishi_krberror_remove_etext</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fremove_005fsname-566"><code>shishi_krberror_remove_sname</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fsave-549"><code>shishi_krberror_save</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fserver-565"><code>shishi_krberror_server</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fserver_005fset-568"><code>shishi_krberror_server_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005fcname-560"><code>shishi_krberror_set_cname</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005fcrealm-558"><code>shishi_krberror_set_crealm</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005fedata-587"><code>shishi_krberror_set_edata</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005fetext-583"><code>shishi_krberror_set_etext</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005frealm-564"><code>shishi_krberror_set_realm</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fset_005fsname-567"><code>shishi_krberror_set_sname</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fstime-575"><code>shishi_krberror_stime</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fstime_005fset-576"><code>shishi_krberror_stime_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fsusec-577"><code>shishi_krberror_susec</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fsusec_005fset-578"><code>shishi_krberror_susec_set</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fkrberror_005fto_005ffile-550"><code>shishi_krberror_to_file</code></a>: <a href="#KRB_002dERROR-Functions">KRB-ERROR Functions</a></li>
<li><a href="#index-shishi_005fmd4-667"><code>shishi_md4</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fmd5-668"><code>shishi_md5</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fn_005ffold-658"><code>shishi_n_fold</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fparse_005fname-695"><code>shishi_parse_name</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fpbkdf2_005fsha1-676"><code>shishi_pbkdf2_sha1</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fdefault-693"><code>shishi_principal_default</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fdefault_005fguess-692"><code>shishi_principal_default_guess</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fdefault_005fset-694"><code>shishi_principal_default_set</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fname-696"><code>shishi_principal_name</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fname_005frealm-697"><code>shishi_principal_name_realm</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fname_005fset-698"><code>shishi_principal_name_set</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprincipal_005fset-699"><code>shishi_principal_set</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fpriv-300"><code>shishi_priv</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fbuild-322"><code>shishi_priv_build</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fdone-301"><code>shishi_priv_done</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fenc_005fpart_005fetype-318"><code>shishi_priv_enc_part_etype</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fencprivpart-308"><code>shishi_priv_encprivpart</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fencprivpart_005fder-310"><code>shishi_priv_encprivpart_der</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fencprivpart_005fder_005fset-311"><code>shishi_priv_encprivpart_der_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fencprivpart_005fset-309"><code>shishi_priv_encprivpart_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005ffrom_005ffile-317"><code>shishi_priv_from_file</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fkey-302"><code>shishi_priv_key</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fkey_005fset-303"><code>shishi_priv_key_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fparse-315"><code>shishi_priv_parse</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fprint-312"><code>shishi_priv_print</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fpriv-304"><code>shishi_priv_priv</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fpriv_005fder-306"><code>shishi_priv_priv_der</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fpriv_005fder_005fset-307"><code>shishi_priv_priv_der_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fpriv_005fset-305"><code>shishi_priv_priv_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fprocess-323"><code>shishi_priv_process</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fread-316"><code>shishi_priv_read</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fsave-313"><code>shishi_priv_save</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fset_005fenc_005fpart-319"><code>shishi_priv_set_enc_part</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fpriv_005fto_005ffile-314"><code>shishi_priv_to_file</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fprompt_005fpassword-711"><code>shishi_prompt_password</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprompt_005fpassword_005fcallback_005fget-710"><code>shishi_prompt_password_callback_get</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fprompt_005fpassword_005fcallback_005fset-709"><code>shishi_prompt_password_callback_set</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frandom_005fto_005fkey-643"><code>shishi_random_to_key</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005frandomize-665"><code>shishi_randomize</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005frealm_005fdefault-687"><code>shishi_realm_default</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frealm_005fdefault_005fguess-686"><code>shishi_realm_default_guess</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frealm_005fdefault_005fset-688"><code>shishi_realm_default_set</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frealm_005ffor_005fserver-691"><code>shishi_realm_for_server</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frealm_005ffor_005fserver_005fdns-690"><code>shishi_realm_for_server_dns</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005frealm_005ffor_005fserver_005ffile-689"><code>shishi_realm_for_server_file</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fresolv-712"><code>shishi_resolv</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fresolv_005ffree-713"><code>shishi_resolv_free</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fsafe-280"><code>shishi_safe</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fbuild-298"><code>shishi_safe_build</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fcksum-294"><code>shishi_safe_cksum</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fdone-281"><code>shishi_safe_done</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005ffrom_005ffile-293"><code>shishi_safe_from_file</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fkey-282"><code>shishi_safe_key</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fkey_005fset-283"><code>shishi_safe_key_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fparse-291"><code>shishi_safe_parse</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fprint-288"><code>shishi_safe_print</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fread-292"><code>shishi_safe_read</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fsafe-284"><code>shishi_safe_safe</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fsafe_005fder-286"><code>shishi_safe_safe_der</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fsafe_005fder_005fset-287"><code>shishi_safe_safe_der_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fsafe_005fset-285"><code>shishi_safe_safe_set</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fsave-289"><code>shishi_safe_save</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fset_005fcksum-295"><code>shishi_safe_set_cksum</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fset_005fuser_005fdata-297"><code>shishi_safe_set_user_data</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fto_005ffile-290"><code>shishi_safe_to_file</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fuser_005fdata-296"><code>shishi_safe_user_data</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fsafe_005fverify-299"><code>shishi_safe_verify</code></a>: <a href="#SAFE-and-PRIV-Functions">SAFE and PRIV Functions</a></li>
<li><a href="#index-shishi_005fserver-149"><code>shishi_server</code></a>: <a href="#Initialization-Functions">Initialization Functions</a></li>
<li><a href="#index-shishi_005fserver_005ffor_005flocal_005fservice-701"><code>shishi_server_for_local_service</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005fstrerror-770"><code>shishi_strerror</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005fstring_005fto_005fkey-642"><code>shishi_string_to_key</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005ftgs-392"><code>shishi_tgs</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fap-396"><code>shishi_tgs_ap</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fdone-393"><code>shishi_tgs_done</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fkrberror-407"><code>shishi_tgs_krberror</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fkrberror_005fder-408"><code>shishi_tgs_krberror_der</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fkrberror_005fset-409"><code>shishi_tgs_krberror_set</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fprocess-442"><code>shishi_tgs_process</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005frep-403"><code>shishi_tgs_rep</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005frep_005fbuild-406"><code>shishi_tgs_rep_build</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005frep_005fder-404"><code>shishi_tgs_rep_der</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005frep_005fprocess-405"><code>shishi_tgs_rep_process</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq-397"><code>shishi_tgs_req</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq_005fbuild-402"><code>shishi_tgs_req_build</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq_005fder-399"><code>shishi_tgs_req_der</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq_005fder_005fset-400"><code>shishi_tgs_req_der_set</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq_005fprocess-401"><code>shishi_tgs_req_process</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005freq_005fset-398"><code>shishi_tgs_req_set</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fsendrecv-413"><code>shishi_tgs_sendrecv</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fsendrecv_005fhint-412"><code>shishi_tgs_sendrecv_hint</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fset_005frealm-415"><code>shishi_tgs_set_realm</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fset_005frealmserver-416"><code>shishi_tgs_set_realmserver</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005fset_005fserver-414"><code>shishi_tgs_set_server</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005ftgtkt-394"><code>shishi_tgs_tgtkt</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005ftgtkt_005fset-395"><code>shishi_tgs_tgtkt_set</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005ftkt-410"><code>shishi_tgs_tkt</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgs_005ftkt_005fset-411"><code>shishi_tgs_tkt_set</code></a>: <a href="#TGS-Functions">TGS Functions</a></li>
<li><a href="#index-shishi_005ftgsrep-487"><code>shishi_tgsrep</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005ftgsreq-446"><code>shishi_tgsreq</code></a>: <a href="#AS_002fTGS-Functions">AS/TGS Functions</a></li>
<li><a href="#index-shishi_005fticket-417"><code>shishi_ticket</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005fadd_005fenc_005fpart-424"><code>shishi_ticket_add_enc_part</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005fget_005fenc_005fpart_005fetype-422"><code>shishi_ticket_get_enc_part_etype</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005frealm_005fget-418"><code>shishi_ticket_realm_get</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005frealm_005fset-419"><code>shishi_ticket_realm_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005fserver-420"><code>shishi_ticket_server</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005fset_005fenc_005fpart-423"><code>shishi_ticket_set_enc_part</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005fticket_005fsname_005fset-421"><code>shishi_ticket_sname_set</code></a>: <a href="#Ticket-_0028ASN_002e1_0029-Functions">Ticket (ASN.1) Functions</a></li>
<li><a href="#index-shishi_005ftime-707"><code>shishi_time</code></a>: <a href="#Utility-Functions">Utility Functions</a></li>
<li><a href="#index-shishi_005ftkt-324"><code>shishi_tkt</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt2-325"><code>shishi_tkt2</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fauthctime-363"><code>shishi_tkt_authctime</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fclient-336"><code>shishi_tkt_client</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fclient_005fp-337"><code>shishi_tkt_client_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fclientrealm-338"><code>shishi_tkt_clientrealm</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fclientrealm_005fp-339"><code>shishi_tkt_clientrealm_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fdone-326"><code>shishi_tkt_done</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fenckdcreppart-329"><code>shishi_tkt_enckdcreppart</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fenckdcreppart_005fset-330"><code>shishi_tkt_enckdcreppart_set</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fencticketpart-332"><code>shishi_tkt_encticketpart</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fencticketpart_005fset-333"><code>shishi_tkt_encticketpart_set</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fendctime-365"><code>shishi_tkt_endctime</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fexpired_005fp-369"><code>shishi_tkt_expired_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fflags-343"><code>shishi_tkt_flags</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fflags_005fadd-345"><code>shishi_tkt_flags_add</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fflags_005fset-344"><code>shishi_tkt_flags_set</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fforwardable_005fp-346"><code>shishi_tkt_forwardable_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fforwarded_005fp-347"><code>shishi_tkt_forwarded_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fhw_005fauthent_005fp-356"><code>shishi_tkt_hw_authent_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005finitial_005fp-354"><code>shishi_tkt_initial_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005finvalid_005fp-352"><code>shishi_tkt_invalid_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkdcrep-331"><code>shishi_tkt_kdcrep</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkey-334"><code>shishi_tkt_key</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkey_005fset-335"><code>shishi_tkt_key_set</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkeytype-359"><code>shishi_tkt_keytype</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkeytype_005ffast-360"><code>shishi_tkt_keytype_fast</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fkeytype_005fp-361"><code>shishi_tkt_keytype_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005flastreq_005fpretty_005fprint-370"><code>shishi_tkt_lastreq_pretty_print</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005flastreqc-362"><code>shishi_tkt_lastreqc</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fmatch_005fp-184"><code>shishi_tkt_match_p</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fmay_005fpostdate_005fp-350"><code>shishi_tkt_may_postdate_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fok_005fas_005fdelegate_005fp-358"><code>shishi_tkt_ok_as_delegate_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fpostdated_005fp-351"><code>shishi_tkt_postdated_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fpre_005fauthent_005fp-355"><code>shishi_tkt_pre_authent_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fpretty_005fprint-371"><code>shishi_tkt_pretty_print</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fproxiable_005fp-348"><code>shishi_tkt_proxiable_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fproxy_005fp-349"><code>shishi_tkt_proxy_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005frealm-340"><code>shishi_tkt_realm</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005frenew_005ftillc-366"><code>shishi_tkt_renew_tillc</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005frenewable_005fp-353"><code>shishi_tkt_renewable_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fserver-341"><code>shishi_tkt_server</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fserver_005fp-342"><code>shishi_tkt_server_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fstartctime-364"><code>shishi_tkt_startctime</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fticket-327"><code>shishi_tkt_ticket</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fticket_005fset-328"><code>shishi_tkt_ticket_set</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005ftransited_005fpolicy_005fchecked_005fp-357"><code>shishi_tkt_transited_policy_checked_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fvalid_005fat_005ftime_005fp-367"><code>shishi_tkt_valid_at_time_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkt_005fvalid_005fnow_005fp-368"><code>shishi_tkt_valid_now_p</code></a>: <a href="#Ticket-Functions">Ticket Functions</a></li>
<li><a href="#index-shishi_005ftkts-170"><code>shishi_tkts</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fadd-175"><code>shishi_tkts_add</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fdefault-169"><code>shishi_tkts_default</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fdefault_005ffile-167"><code>shishi_tkts_default_file</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fdefault_005ffile_005fguess-166"><code>shishi_tkts_default_file_guess</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fdefault_005ffile_005fset-168"><code>shishi_tkts_default_file_set</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fdone-171"><code>shishi_tkts_done</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fexpire-180"><code>shishi_tkts_expire</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005ffind-185"><code>shishi_tkts_find</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005ffind_005ffor_005fclientserver-186"><code>shishi_tkts_find_for_clientserver</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005ffind_005ffor_005fserver-187"><code>shishi_tkts_find_for_server</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005ffrom_005ffile-178"><code>shishi_tkts_from_file</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fget-190"><code>shishi_tkts_get</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fget_005ffor_005fclientserver-191"><code>shishi_tkts_get_for_clientserver</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fget_005ffor_005fserver-192"><code>shishi_tkts_get_for_server</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fget_005ftgs-189"><code>shishi_tkts_get_tgs</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fget_005ftgt-188"><code>shishi_tkts_get_tgt</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fnew-176"><code>shishi_tkts_new</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fnth-173"><code>shishi_tkts_nth</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fprint-183"><code>shishi_tkts_print</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fprint_005ffor_005fservice-182"><code>shishi_tkts_print_for_service</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fread-177"><code>shishi_tkts_read</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fremove-174"><code>shishi_tkts_remove</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fsize-172"><code>shishi_tkts_size</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fto_005ffile-181"><code>shishi_tkts_to_file</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005ftkts_005fwrite-179"><code>shishi_tkts_write</code></a>: <a href="#Ticket-Set-Functions">Ticket Set Functions</a></li>
<li><a href="#index-shishi_005fverbose-779"><code>shishi_verbose</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005fverify-645"><code>shishi_verify</code></a>: <a href="#Cryptographic-Functions">Cryptographic Functions</a></li>
<li><a href="#index-shishi_005fwarn-778"><code>shishi_warn</code></a>: <a href="#Error-Functions">Error Functions</a></li>
<li><a href="#index-shishi_005fx509ca_005fdefault_005ffile-679"><code>shishi_x509ca_default_file</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509ca_005fdefault_005ffile_005fguess-677"><code>shishi_x509ca_default_file_guess</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509ca_005fdefault_005ffile_005fset-678"><code>shishi_x509ca_default_file_set</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509cert_005fdefault_005ffile-682"><code>shishi_x509cert_default_file</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509cert_005fdefault_005ffile_005fguess-680"><code>shishi_x509cert_default_file_guess</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509cert_005fdefault_005ffile_005fset-681"><code>shishi_x509cert_default_file_set</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509key_005fdefault_005ffile-685"><code>shishi_x509key_default_file</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509key_005fdefault_005ffile_005fguess-683"><code>shishi_x509key_default_file_guess</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-shishi_005fx509key_005fdefault_005ffile_005fset-684"><code>shishi_x509key_default_file_set</code></a>: <a href="#X_002e509-Functions">X.509 Functions</a></li>
<li><a href="#index-this-_0040r_007bin-date-strings_007d-129"><code>this </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-today-_0040r_007bin-date-strings_007d-128"><code>today </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-tomorrow-_0040r_007bin-date-strings_007d-125"><code>tomorrow </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-week-_0040r_007bin-date-strings_007d-119"><code>week </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-year-_0040r_007bin-date-strings_007d-116"><code>year </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-yesterday-_0040r_007bin-date-strings_007d-126"><code>yesterday </code><span class="roman">in date strings</span></a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
   </ul><div class="node">
<a name="Concept-Index"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-and-Data-Index">Function and Data Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Concept Index</h2>



<ul class="index-cp" compact>
<li><a href="#index-g_t3DES-2">3DES</a>: <a href="#Cryptographic-Overview">Cryptographic Overview</a></li>
<li><a href="#index-abbreviations-for-months-102">abbreviations for months</a>: <a href="#Calendar-date-items">Calendar date items</a></li>
<li><a href="#index-AES-3">AES</a>: <a href="#Cryptographic-Overview">Cryptographic Overview</a></li>
<li><a href="#index-AIX-17">AIX</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-anonymous-tls-37">anonymous tls</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Application-Programming-Interface-_0028API_0029-143">Application Programming Interface (API)</a>: <a href="#Programming-Manual">Programming Manual</a></li>
<li><a href="#index-ARCFOUR-4">ARCFOUR</a>: <a href="#Cryptographic-Overview">Cryptographic Overview</a></li>
<li><a href="#index-authenticated-tls-40">authenticated tls</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Authentication-55">Authentication</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Authentication-header-56">Authentication header</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Authentication-path-57">Authentication path</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Authenticator-58">Authenticator</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Authorization-59">Authorization</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-authors-of-_0040code_007bget_005fdate_007d-134">authors of <code>get_date</code></a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Autoconf-tests-146">Autoconf tests</a>: <a href="#Autoconf-tests">Autoconf tests</a></li>
<li><a href="#index-beginning-of-time_002c-for-_0040acronym_007bPOSIX_007d-131">beginning of time, for <acronym>POSIX</acronym></a>: <a href="#Seconds-since-the-Epoch">Seconds since the Epoch</a></li>
<li><a href="#index-Bellovin_002c-Steven-M_002e-135">Bellovin, Steven M.</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Berets_002c-Jim-137">Berets, Jim</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Berry_002c-K_002e-142">Berry, K.</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-calendar-date-item-98">calendar date item</a>: <a href="#Calendar-date-items">Calendar date items</a></li>
<li><a href="#index-Capability-60">Capability</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-case_002c-ignored-in-dates-96">case, ignored in dates</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-certificate-authority-_0028_0040acronym_007bCA_007d_0029-43">certificate authority (<acronym>CA</acronym>)</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Ciphertext-61">Ciphertext</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Client-62">Client</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-client-authentication-41">client authentication</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-comments_002c-in-dates-97">comments, in dates</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-Compiling-your-application-145">Compiling your application</a>: <a href="#Building-the-source">Building the source</a></li>
<li><a href="#index-concurrent-writers-52">concurrent writers</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-configuration-file-79">configuration file</a>: <a href="#Shishi-Configuration">Shishi Configuration</a></li>
<li><a href="#index-Configure-tests-147">Configure tests</a>: <a href="#Autoconf-tests">Autoconf tests</a></li>
<li><a href="#index-Contributing-30">Contributing</a>: <a href="#Contributing">Contributing</a></li>
<li><a href="#index-Credentials-63">Credentials</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-database-definition-80">database definition</a>: <a href="#Shisa-Configuration">Shisa Configuration</a></li>
<li><a href="#index-Database-interface-782">Database interface</a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-date-format_002c-_0040sc_007biso_007d-8601-100">date format, <span class="sc">iso</span> 8601</a>: <a href="#Calendar-date-items">Calendar date items</a></li>
<li><a href="#index-date-input-formats-83">date input formats</a>: <a href="#Date-input-formats">Date input formats</a></li>
<li><a href="#index-day-of-week-item-111">day of week item</a>: <a href="#Day-of-week-items">Day of week items</a></li>
<li><a href="#index-Debian-5">Debian</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-DES-1">DES</a>: <a href="#Cryptographic-Overview">Cryptographic Overview</a></li>
<li><a href="#index-Diffie-Hellman-key-exchange-38">Diffie Hellman key exchange</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-displacement-of-dates-115">displacement of dates</a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-Download-28">Download</a>: <a href="#Downloading-and-Installing">Downloading and Installing</a></li>
<li><a href="#index-Eggert_002c-Paul-140">Eggert, Paul</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Encryption-Type-_0028etype_0029-64">Encryption Type (etype)</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-End_002duser-Shishi-usage-32">End-user Shishi usage</a>: <a href="#User-Manual">User Manual</a></li>
<li><a href="#index-epoch_002c-for-_0040acronym_007bPOSIX_007d-132">epoch, for <acronym>POSIX</acronym></a>: <a href="#Seconds-since-the-Epoch">Seconds since the Epoch</a></li>
<li><a href="#index-Error-Handling-769">Error Handling</a>: <a href="#Error-Handling">Error Handling</a></li>
<li><a href="#index-Examples-780">Examples</a>: <a href="#Examples">Examples</a></li>
<li><a href="#index-fail-over-54">fail over</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-FDL_002c-GNU-Free-Documentation-License-808">FDL, GNU Free Documentation License</a>: <a href="#GNU-Free-Documentation-License">GNU Free Documentation License</a></li>
<li><a href="#index-FreeBSD-22">FreeBSD</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-general-date-syntax-85">general date syntax</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-Generic-Security-Service-805">Generic Security Service</a>: <a href="#Generic-Security-Service">Generic Security Service</a></li>
<li><a href="#index-GNUTLS-33">GNUTLS</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-GPL_002c-GNU-General-Public-License-809">GPL, GNU General Public License</a>: <a href="#GNU-GPL">GNU GPL</a></li>
<li><a href="#index-GSS_002dAPI-806">GSS-API</a>: <a href="#Generic-Security-Service">Generic Security Service</a></li>
<li><a href="#index-GSSLib-807">GSSLib</a>: <a href="#Generic-Security-Service">Generic Security Service</a></li>
<li><a href="#index-Hacking-31">Hacking</a>: <a href="#Contributing">Contributing</a></li>
<li><a href="#index-High-Availability-53">High Availability</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-HP_002dUX-18">HP-UX</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-Installation-27">Installation</a>: <a href="#Downloading-and-Installing">Downloading and Installing</a></li>
<li><a href="#index-IPSEC-48">IPSEC</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-IRIX-16">IRIX</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-g_t_0040sc_007biso_007d-8601-date-format-99"><span class="sc">iso</span> 8601 date format</a>: <a href="#Calendar-date-items">Calendar date items</a></li>
<li><a href="#index-items-in-date-strings-86">items in date strings</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-KDC-65">KDC</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Kerberos-66">Kerberos</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Kerberos-Ticket-78">Kerberos Ticket</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Key-Version-Number-_0028kvno_0029-67">Key Version Number (kvno)</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-language_002c-in-dates-93">language, in dates</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-LDAP-45">LDAP</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-License_002c-GNU-GPL-810">License, GNU GPL</a>: <a href="#GNU-GPL">GNU GPL</a></li>
<li><a href="#index-MacKenzie_002c-David-138">MacKenzie, David</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-MacOS-X-23">MacOS X</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-Mandrake-15">Mandrake</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-master-server-50">master server</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-Meyering_002c-Jim-139">Meyering, Jim</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-minutes_002c-time-zone-correction-by-109">minutes, time zone correction by</a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-month-names-in-date-strings-101">month names in date strings</a>: <a href="#Calendar-date-items">Calendar date items</a></li>
<li><a href="#index-months_002c-written_002dout-92">months, written-out</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-Motorola-Coldfire-24">Motorola Coldfire</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-NetBSD-20">NetBSD</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-NFS-47">NFS</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-numbers_002c-written_002dout-87">numbers, written-out</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-OpenBSD-21">OpenBSD</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-ordinal-numbers-88">ordinal numbers</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-Pinard_002c-F_002e-141">Pinard, F.</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Plaintext-68">Plaintext</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Principal-69">Principal</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Principal-identifier-70">Principal identifier</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-pure-numbers-in-date-strings-130">pure numbers in date strings</a>: <a href="#Pure-numbers-in-date-strings">Pure numbers in date strings</a></li>
<li><a href="#index-RedHat-11">RedHat</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-RedHat-Advanced-Server-13">RedHat Advanced Server</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-relative-items-in-date-strings-114">relative items in date strings</a>: <a href="#Relative-items-in-date-strings">Relative items in date strings</a></li>
<li><a href="#index-remote-databases-44">remote databases</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-Reporting-Bugs-29">Reporting Bugs</a>: <a href="#Bug-Reports">Bug Reports</a></li>
<li><a href="#index-rsync-49">rsync</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-Salz_002c-Rich-136">Salz, Rich</a>: <a href="#Authors-of-get_005fdate">Authors of get_date</a></li>
<li><a href="#index-Seal-71">Seal</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-secondary-server-51">secondary server</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-Secret-key-72">Secret key</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Server-73">Server</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-server-authentication-42">server authentication</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Service-74">Service</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Session-key-75">Session key</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-Shisa-API-781">Shisa API</a>: <a href="#Kerberos-Database-Functions">Kerberos Database Functions</a></li>
<li><a href="#index-Solaris-19">Solaris</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-specifying-user-database-81">specifying user database</a>: <a href="#Shisa-Configuration">Shisa Configuration</a></li>
<li><a href="#index-SQL-46">SQL</a>: <a href="#Multiple-servers">Multiple servers</a></li>
<li><a href="#index-STARTTLS-35">STARTTLS</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Sub_002dsession-key-76">Sub-session key</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-SuSE-8">SuSE</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-SuSE-Linux-9">SuSE Linux</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-Ticket-77">Ticket</a>: <a href="#Glossary-of-terms">Glossary of terms</a></li>
<li><a href="#index-time-of-day-item-103">time of day item</a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-time-zone-correction-108">time zone correction</a>: <a href="#Time-of-day-items">Time of day items</a></li>
<li><a href="#index-time-zone-item-110">time zone item</a>: <a href="#Time-zone-items">Time zone items</a></li>
<li><a href="#index-time-zone-item-95">time zone item</a>: <a href="#General-date-syntax">General date syntax</a></li>
<li><a href="#index-TLS-34">TLS</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-tls-resume-36">tls resume</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
<li><a href="#index-Tru64-7">Tru64</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-uClibc-26">uClibc</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-uClinux-25">uClinux</a>: <a href="#Supported-Platforms">Supported Platforms</a></li>
<li><a href="#index-user-database-definition-82">user database definition</a>: <a href="#Shisa-Configuration">Shisa Configuration</a></li>
<li><a href="#index-X_002e509-authentication-39">X.509 authentication</a>: <a href="#Kerberos-via-TLS">Kerberos via TLS</a></li>
   </ul>
<div class="shortcontents">
<h2>Short Contents</h2>
<ul>
<li><a href="#toc_Top">Shishi</a></li>
<li><a href="#toc_Introduction">1 Introduction</a></li>
<li><a href="#toc_User-Manual">2 User Manual</a></li>
<li><a href="#toc_Administration-Manual">3 Administration Manual</a></li>
<li><a href="#toc_Reference-Manual">4 Reference Manual</a></li>
<li><a href="#toc_Programming-Manual">5 Programming Manual</a></li>
<li><a href="#toc_Acknowledgements">6 Acknowledgements</a></li>
<li><a href="#toc_Criticism-of-Kerberos">Appendix A Criticism of Kerberos</a></li>
<li><a href="#toc_Protocol-Extensions">Appendix B Protocol Extensions</a></li>
<li><a href="#toc_Copying-Information">Appendix C Copying Information</a></li>
<li><a href="#toc_Function-and-Data-Index">Function and Data Index</a></li>
<li><a href="#toc_Concept-Index">Concept Index</a></li>
</ul>
</div>

   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Shishi</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<ul>
<li><a href="#Getting-Started">1.1 Getting Started</a>
<li><a href="#Features-and-Status">1.2 Features and Status</a>
<li><a href="#Overview">1.3 Overview</a>
<li><a href="#Cryptographic-Overview">1.4 Cryptographic Overview</a>
<li><a href="#Supported-Platforms">1.5 Supported Platforms</a>
<li><a href="#Getting-help">1.6 Getting help</a>
<li><a href="#Commercial-Support">1.7 Commercial Support</a>
<li><a href="#Downloading-and-Installing">1.8 Downloading and Installing</a>
<li><a href="#Bug-Reports">1.9 Bug Reports</a>
<li><a href="#Contributing">1.10 Contributing</a>
</li></ul>
<li><a name="toc_User-Manual" href="#User-Manual">2 User Manual</a>
<ul>
<li><a href="#User-Manual">2.1 Proxiable and Proxy Tickets</a>
<li><a href="#User-Manual">2.2 Forwardable and Forwarded Tickets</a>
</li></ul>
<li><a name="toc_Administration-Manual" href="#Administration-Manual">3 Administration Manual</a>
<ul>
<li><a href="#Introduction-to-Shisa">3.1 Introduction to Shisa</a>
<li><a href="#Configuring-Shisa">3.2 Configuring Shisa</a>
<li><a href="#Using-Shisa">3.3 Using Shisa</a>
<li><a href="#Starting-Shishid">3.4 Starting Shishid</a>
<li><a href="#Configuring-DNS-for-KDC">3.5 Configuring DNS for KDC</a>
<ul>
<li><a href="#Configuring-DNS-for-KDC">3.5.1 DNS vs. Kerberos - Case Sensitivity of Realm Names</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.2 Overview - KDC location information</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.3 Example - KDC location information</a>
<li><a href="#Configuring-DNS-for-KDC">3.5.4 Security considerations</a>
</li></ul>
<li><a href="#Kerberos-via-TLS">3.6 Kerberos via TLS</a>
<ul>
<li><a href="#Kerberos-via-TLS">3.6.1 Setting up TLS resume</a>
<li><a href="#Kerberos-via-TLS">3.6.2 Setting up Anonymous TLS</a>
<li><a href="#Kerberos-via-TLS">3.6.3 Setting up X.509 authenticated TLS</a>
<ul>
<li><a href="#Kerberos-via-TLS">3.6.3.1 Create a Kerberos Certificate Authority</a>
<li><a href="#Kerberos-via-TLS">3.6.3.2 Create a Kerberos KDC Certificate</a>
<li><a href="#Kerberos-via-TLS">3.6.3.3 Create a Kerberos Client Certificate</a>
<li><a href="#Kerberos-via-TLS">3.6.3.4 Starting KDC with X.509 authentication support</a>
</li></ul>
</li></ul>
<li><a href="#Multiple-servers">3.7 Multiple servers</a>
<li><a href="#Developer-information">3.8 Developer information</a>
</li></ul>
<li><a name="toc_Reference-Manual" href="#Reference-Manual">4 Reference Manual</a>
<ul>
<li><a href="#Environmental-Assumptions">4.1 Environmental Assumptions</a>
<li><a href="#Glossary-of-terms">4.2 Glossary of terms</a>
<li><a href="#Realm-and-Principal-Naming">4.3 Realm and Principal Naming</a>
<ul>
<li><a href="#Realm-and-Principal-Naming">4.3.1 Realm Names</a>
<li><a href="#Realm-and-Principal-Naming">4.3.2 Principal Names</a>
<ul>
<li><a href="#Realm-and-Principal-Naming">4.3.2.1 Name of server principals</a>
<li><a href="#Realm-and-Principal-Naming">4.3.2.2 Name of the TGS</a>
</li></ul>
<li><a href="#Realm-and-Principal-Naming">4.3.3 Choosing a principal with which to communicate</a>
<li><a href="#Realm-and-Principal-Naming">4.3.4 Principal Name Form</a>
</li></ul>
<li><a href="#Shishi-Configuration">4.4 Shishi Configuration</a>
<ul>
<li><a href="#Shishi-Configuration">4.4.1 &lsquo;<samp><span class="samp">default-realm</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.2 &lsquo;<samp><span class="samp">default-principal</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.3 &lsquo;<samp><span class="samp">client-kdc-etypes</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.4 &lsquo;<samp><span class="samp">verbose</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-asn1</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-noise</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto</span></samp>&rsquo;, &lsquo;<samp><span class="samp">verbose-crypto-noise</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.5 &lsquo;<samp><span class="samp">realm-kdc</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.6 &lsquo;<samp><span class="samp">server-realm</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.7 &lsquo;<samp><span class="samp">kdc-timeout</span></samp>&rsquo;, &lsquo;<samp><span class="samp">kdc-retries</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.8 &lsquo;<samp><span class="samp">stringprocess</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.9 &lsquo;<samp><span class="samp">ticket-life</span></samp>&rsquo;</a>
<li><a href="#Shishi-Configuration">4.4.10 &lsquo;<samp><span class="samp">renew-life</span></samp>&rsquo;</a>
</li></ul>
<li><a href="#Shisa-Configuration">4.5 Shisa Configuration</a>
<ul>
<li><a href="#Shisa-Configuration">4.5.1 &lsquo;<samp><span class="samp">db</span></samp>&rsquo;</a>
</li></ul>
<li><a href="#Parameters-for-shishi">4.6 Parameters for shishi</a>
<li><a href="#Parameters-for-shishid">4.7 Parameters for shishid</a>
<li><a href="#Parameters-for-shisa">4.8 Parameters for shisa</a>
<li><a href="#Environment-variables">4.9 Environment variables</a>
<li><a href="#Date-input-formats">4.10 Date input formats</a>
<ul>
<li><a href="#General-date-syntax">4.10.1 General date syntax</a>
<li><a href="#Calendar-date-items">4.10.2 Calendar date items</a>
<li><a href="#Time-of-day-items">4.10.3 Time of day items</a>
<li><a href="#Time-zone-items">4.10.4 Time zone items</a>
<li><a href="#Day-of-week-items">4.10.5 Day of week items</a>
<li><a href="#Relative-items-in-date-strings">4.10.6 Relative items in date strings</a>
<li><a href="#Pure-numbers-in-date-strings">4.10.7 Pure numbers in date strings</a>
<li><a href="#Seconds-since-the-Epoch">4.10.8 Seconds since the Epoch</a>
<li><a href="#Specifying-time-zone-rules">4.10.9 Specifying time zone rules</a>
<li><a href="#Authors-of-get_005fdate">4.10.10 Authors of <code>get_date</code></a>
</li></ul>
</li></ul>
<li><a name="toc_Programming-Manual" href="#Programming-Manual">5 Programming Manual</a>
<ul>
<li><a href="#Preparation">5.1 Preparation</a>
<ul>
<li><a href="#Header">5.1.1 Header</a>
<li><a href="#Initialization">5.1.2 Initialization</a>
<li><a href="#Version-Check">5.1.3 Version Check</a>
<li><a href="#Building-the-source">5.1.4 Building the source</a>
<li><a href="#Autoconf-tests">5.1.5 Autoconf tests</a>
<ul>
<li><a href="#Autoconf-tests">5.1.5.1 Autoconf test via &lsquo;<samp><span class="samp">pkg-config</span></samp>&rsquo;</a>
<li><a href="#Autoconf-tests">5.1.5.2 Standalone Autoconf test using Libtool</a>
<li><a href="#Autoconf-tests">5.1.5.3 Standalone Autoconf test</a>
</li></ul>
</li></ul>
<li><a href="#Initialization-Functions">5.2 Initialization Functions</a>
<li><a href="#Ticket-Set-Functions">5.3 Ticket Set Functions</a>
<li><a href="#AP_002dREQ-and-AP_002dREP-Functions">5.4 AP-REQ and AP-REP Functions</a>
<li><a href="#SAFE-and-PRIV-Functions">5.5 SAFE and PRIV Functions</a>
<li><a href="#Ticket-Functions">5.6 Ticket Functions</a>
<li><a href="#AS-Functions">5.7 AS Functions</a>
<li><a href="#TGS-Functions">5.8 TGS Functions</a>
<li><a href="#Ticket-_0028ASN_002e1_0029-Functions">5.9 Ticket (ASN.1) Functions</a>
<li><a href="#AS_002fTGS-Functions">5.10 AS/TGS Functions</a>
<li><a href="#Authenticator-Functions">5.11 Authenticator Functions</a>
<li><a href="#KRB_002dERROR-Functions">5.12 KRB-ERROR Functions</a>
<li><a href="#Cryptographic-Functions">5.13 Cryptographic Functions</a>
<li><a href="#X_002e509-Functions">5.14 X.509 Functions</a>
<li><a href="#Utility-Functions">5.15 Utility Functions</a>
<li><a href="#ASN_002e1-Functions">5.16 ASN.1 Functions</a>
<li><a href="#Error-Handling">5.17 Error Handling</a>
<ul>
<li><a href="#Error-Values">5.17.1 Error Values</a>
<li><a href="#Error-Functions">5.17.2 Error Functions</a>
</li></ul>
<li><a href="#Examples">5.18 Examples</a>
<li><a href="#Kerberos-Database-Functions">5.19 Kerberos Database Functions</a>
<li><a href="#Generic-Security-Service">5.20 Generic Security Service</a>
</li></ul>
<li><a name="toc_Acknowledgements" href="#Acknowledgements">6 Acknowledgements</a>
<li><a name="toc_Criticism-of-Kerberos" href="#Criticism-of-Kerberos">Appendix A Criticism of Kerberos</a>
<li><a name="toc_Protocol-Extensions" href="#Protocol-Extensions">Appendix B Protocol Extensions</a>
<ul>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1 STARTTLS protected KDC exchanges</a>
<ul>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.1 TCP/IP transport with TLS upgrade (STARTTLS)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.2 Extensible typed hole based on reserved high bit</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.3 STARTTLS requested by client (extension mode 1)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.4 STARTTLS request accepted by server (extension mode 2)</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.5 Proceeding after successful TLS negotiation</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.6 Proceeding after failed TLS negotiation</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.7 Interaction with KDC addresses in DNS</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.8 Using TLS authentication logic in Kerberos</a>
<li><a href="#STARTTLS-protected-KDC-exchanges">B.1.9 Security considerations</a>
</li></ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2 Telnet encryption with AES-CCM</a>
<ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.1 Command Names and Codes</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.2 Command Meanings</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.3 Implementation Rules</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.4 Integration with the AUTHENTICATION telnet option</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5 Security Considerations</a>
<ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5.1 Telnet Encryption Protocol Security Considerations</a>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.5.2 AES-CCM Security Considerations</a>
</li></ul>
<li><a href="#Telnet-encryption-with-AES_002dCCM">B.2.6 Acknowledgments</a>
</li></ul>
<li><a href="#Kerberized-rsh-and-rlogin">B.3 Kerberized rsh and rlogin</a>
<ul>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.1 Establish connection</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.2 Kerberos identification</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.3 Kerberos authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.4 Extended authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.5 Window size</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.6 End of authentication</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.7 Encryption</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.8 KCMDV0.3</a>
<li><a href="#Kerberized-rsh-and-rlogin">B.3.9 MIT/Heimdal authorization</a>
</li></ul>
<li><a href="#Key-as-initialization-vector">B.4 Key as initialization vector</a>
<li><a href="#The-Keytab-Binary-File-Format">B.5 The Keytab Binary File Format</a>
<li><a href="#The-Credential-Cache-Binary-File-Format">B.6 The Credential Cache Binary File Format</a>
</li></ul>
<li><a name="toc_Copying-Information" href="#Copying-Information">Appendix C Copying Information</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">C.1 GNU Free Documentation License</a>
<li><a href="#GNU-GPL">C.2 GNU General Public License</a>
</li></ul>
<li><a name="toc_Function-and-Data-Index" href="#Function-and-Data-Index">Function and Data Index</a>
<li><a name="toc_Concept-Index" href="#Concept-Index">Concept Index</a>
</li></ul>
</div>

<div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> The text is a lightly adapted version of the
introduction section from RFC 1510 by J. Kohl and C. Neuman, September
1993, copyright likely owned by the RFC 1510 authors or some
contributor.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> <a href="http://www.research.att.com/~smb/papers/ides.pdf">http://www.research.att.com/~smb/papers/ides.pdf</a></p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> <a href="http://www.rsasecurity.com/rsalabs/pkcs/pkcs-5/">http://www.rsasecurity.com/rsalabs/pkcs/pkcs-5/</a></p>

   <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> And besides, Shishi is
intended to work on non-Unix platforms as well.</p>

   <p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> The post is copyrighted by
David Wagner, included here with permission, the canonical location is
<a href="http://www.cs.berkeley.edu/~daw/my-posts/key-as-iv-broken">http://www.cs.berkeley.edu/~daw/my-posts/key-as-iv-broken</a></p>

   <hr></div>

</body></html>

